[0m14:14:52.722082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A925EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A925E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A925F6B0>]}


============================== 14:14:52.722082 | 538948db-4b93-4df9-9e40-a4146517140f ==============================
[0m14:14:52.722082 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:14:52.722082 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m14:14:52.737982 [info ] [MainThread]: dbt version: 1.11.2
[0m14:14:52.737982 [info ] [MainThread]: python version: 3.12.10
[0m14:14:52.737982 [info ] [MainThread]: python path: C:\repos\livefront\.venv\Scripts\python.exe
[0m14:14:52.737982 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m14:14:52.814879 [info ] [MainThread]: Using profiles dir at .
[0m14:14:52.815881 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m14:14:52.815881 [info ] [MainThread]: Using dbt_project.yml file at C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\dbt_project.yml
[0m14:14:52.816879 [info ] [MainThread]: adapter type: duckdb
[0m14:14:52.817881 [info ] [MainThread]: adapter version: 1.10.0
[0m14:14:52.882837 [info ] [MainThread]: Configuration:
[0m14:14:52.882837 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:14:52.883837 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:14:52.883837 [info ] [MainThread]: Required dependencies:
[0m14:14:52.883837 [debug] [MainThread]: Executing "git --help"
[0m14:14:52.898475 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:14:52.898475 [debug] [MainThread]: STDERR: "b''"
[0m14:14:52.899480 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:14:52.899480 [info ] [MainThread]: Connection:
[0m14:14:52.899480 [info ] [MainThread]:   database: carton_caps
[0m14:14:52.900479 [info ] [MainThread]:   schema: main
[0m14:14:52.900479 [info ] [MainThread]:   path: ../duckdb/carton_caps.duckdb
[0m14:14:52.900479 [info ] [MainThread]:   config_options: None
[0m14:14:52.900479 [info ] [MainThread]:   extensions: None
[0m14:14:52.901479 [info ] [MainThread]:   settings: {}
[0m14:14:52.901479 [info ] [MainThread]:   external_root: .
[0m14:14:52.901479 [info ] [MainThread]:   use_credential_provider: None
[0m14:14:52.901479 [info ] [MainThread]:   attach: None
[0m14:14:52.902478 [info ] [MainThread]:   filesystems: None
[0m14:14:52.902478 [info ] [MainThread]:   remote: None
[0m14:14:52.902478 [info ] [MainThread]:   plugins: None
[0m14:14:52.902478 [info ] [MainThread]:   disable_transactions: False
[0m14:14:52.903478 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:14:53.064332 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m14:14:54.643597 [debug] [MainThread]: Using duckdb connection "debug"
[0m14:14:54.643597 [debug] [MainThread]: On debug: select 1 as id
[0m14:14:54.643597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:54.658885 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m14:14:54.658885 [debug] [MainThread]: On debug: Close
[0m14:14:54.658885 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:14:54.662098 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:14:54.662098 [debug] [MainThread]: Command `dbt debug` succeeded at 14:14:54.662098 after 2.11 seconds
[0m14:14:54.662098 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:14:54.662098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AAF115E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A9C3A930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8AB3B0200>]}
[0m14:14:54.662098 [debug] [MainThread]: Flushing usage events
[0m14:14:54.977574 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:56.383254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F279C42FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F279C43110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F279C40BC0>]}


============================== 14:14:56.387123 | 2834cc34-0696-4f25-9313-5cd42379a3dc ==============================
[0m14:14:56.387123 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:14:56.387123 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m14:14:56.541000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2834cc34-0696-4f25-9313-5cd42379a3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27A2B3E90>]}
[0m14:14:56.583268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2834cc34-0696-4f25-9313-5cd42379a3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27A0E75F0>]}
[0m14:14:56.588808 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:14:56.758301 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:14:56.758301 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:14:56.758301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2834cc34-0696-4f25-9313-5cd42379a3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27A2B0530>]}
[0m14:14:58.231169 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_carton_caps.marts
[0m14:14:58.236777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2834cc34-0696-4f25-9313-5cd42379a3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27B6178C0>]}
[0m14:14:58.277746 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m14:14:58.277746 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m14:14:58.309452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2834cc34-0696-4f25-9313-5cd42379a3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27BD7D460>]}
[0m14:14:58.309452 [info ] [MainThread]: Found 6 models, 17 data tests, 6 sources, 472 macros
[0m14:14:58.309452 [info ] [MainThread]: 
[0m14:14:58.309452 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:14:58.309452 [info ] [MainThread]: 
[0m14:14:58.309452 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:14:58.309452 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps'
[0m14:14:58.369302 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps"
[0m14:14:58.369302 [debug] [ThreadPool]: On list_carton_caps: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps"'
    
  
  
[0m14:14:58.369302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:58.381361 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m14:14:58.382361 [debug] [ThreadPool]: On list_carton_caps: Close
[0m14:14:58.382361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_carton_caps, now create_carton_caps_main)
[0m14:14:58.383361 [debug] [ThreadPool]: Creating schema "database: "carton_caps"
schema: "main"
"
[0m14:14:58.386360 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_main"
[0m14:14:58.387361 [debug] [ThreadPool]: On create_carton_caps_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='carton_caps'
        and type='sqlite'
    
  
[0m14:14:58.387361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:58.387361 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:14:58.388361 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_main"
[0m14:14:58.388361 [debug] [ThreadPool]: On create_carton_caps_main: BEGIN
[0m14:14:58.389361 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:14:58.389361 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_main"
[0m14:14:58.389361 [debug] [ThreadPool]: On create_carton_caps_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_main"} */

    
    
        create schema if not exists "carton_caps"."main"
    
[0m14:14:58.389361 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:14:58.390361 [debug] [ThreadPool]: On create_carton_caps_main: COMMIT
[0m14:14:58.390361 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_main"
[0m14:14:58.390361 [debug] [ThreadPool]: On create_carton_caps_main: COMMIT
[0m14:14:58.391361 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:14:58.391361 [debug] [ThreadPool]: On create_carton_caps_main: Close
[0m14:14:58.392361 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_main'
[0m14:14:58.393361 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_main"
[0m14:14:58.393361 [debug] [ThreadPool]: On list_carton_caps_main: BEGIN
[0m14:14:58.393361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:58.393361 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:14:58.393361 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_main"
[0m14:14:58.393361 [debug] [ThreadPool]: On list_carton_caps_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_main"} */
select
      'carton_caps' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps'
  
[0m14:14:58.403373 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:14:58.403373 [debug] [ThreadPool]: On list_carton_caps_main: ROLLBACK
[0m14:14:58.403373 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_main'
[0m14:14:58.403373 [debug] [ThreadPool]: On list_carton_caps_main: Close
[0m14:14:58.403373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2834cc34-0696-4f25-9313-5cd42379a3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27C29E870>]}
[0m14:14:58.403373 [debug] [MainThread]: Using duckdb connection "master"
[0m14:14:58.403373 [debug] [MainThread]: On master: BEGIN
[0m14:14:58.403373 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:58.403373 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:14:58.403373 [debug] [MainThread]: On master: COMMIT
[0m14:14:58.403373 [debug] [MainThread]: Using duckdb connection "master"
[0m14:14:58.403373 [debug] [MainThread]: On master: COMMIT
[0m14:14:58.403373 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:14:58.403373 [debug] [MainThread]: On master: Close
[0m14:14:58.409317 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_events
[0m14:14:58.409317 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.stg_products
[0m14:14:58.409317 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.stg_purchases
[0m14:14:58.409317 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.stg_referrals
[0m14:14:58.409317 [info ] [Thread-1 (]: 1 of 23 START sql view model main.stg_events ................................... [RUN]
[0m14:14:58.409317 [info ] [Thread-2 (]: 2 of 23 START sql view model main.stg_products ................................. [RUN]
[0m14:14:58.409317 [info ] [Thread-3 (]: 3 of 23 START sql view model main.stg_purchases ................................ [RUN]
[0m14:14:58.409317 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_events'
[0m14:14:58.409317 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_products'
[0m14:14:58.409317 [info ] [Thread-4 (]: 4 of 23 START sql view model main.stg_referrals ................................ [RUN]
[0m14:14:58.409317 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_purchases'
[0m14:14:58.409317 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_events
[0m14:14:58.409317 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.stg_products
[0m14:14:58.409317 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_referrals'
[0m14:14:58.409317 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.stg_purchases
[0m14:14:58.420899 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_events"
[0m14:14:58.420899 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_products"
[0m14:14:58.420899 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.stg_referrals
[0m14:14:58.420899 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_purchases"
[0m14:14:58.427000 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_referrals"
[0m14:14:58.428311 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.stg_purchases
[0m14:14:58.445759 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_purchases"
[0m14:14:58.445759 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.stg_products
[0m14:14:58.446758 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_events
[0m14:14:58.446758 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.stg_referrals
[0m14:14:58.448756 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_products"
[0m14:14:58.450759 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_events"
[0m14:14:58.452761 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_referrals"
[0m14:14:58.452761 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m14:14:58.452761 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: BEGIN
[0m14:14:58.453764 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:14:58.453764 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.454765 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m14:14:58.454765 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m14:14:58.454765 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: BEGIN
[0m14:14:58.454765 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

  
  create view "carton_caps"."main"."stg_purchases__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."purchases"
)
select
  cast(purchase_id as integer) as purchase_id,
  cast(user_id as integer) as user_id,
  cast(product_id as integer) as product_id,
  cast(quantity as integer) as quantity,
  cast(price_paid as double) as price_paid,
  cast(points_earned as integer) as points_earned,
  cast(purchased_at as timestamp) as purchased_at,
  cast(day_of_week as varchar) as day_of_week,
  cast(hour_of_day as integer) as hour_of_day
from src
  );

[0m14:14:58.455763 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:14:58.455763 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m14:14:58.455763 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m14:14:58.456763 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: BEGIN
[0m14:14:58.456763 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: BEGIN
[0m14:14:58.456763 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.457763 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.457763 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:14:58.458263 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:14:58.458263 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m14:14:58.461287 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m14:14:58.462286 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:14:58.462286 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

  
  create view "carton_caps"."main"."stg_products__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."products"
)
select
  cast(product_id as integer) as product_id,
  cast(name as varchar) as name,
  cast(category as varchar) as category,
  cast(price as double) as price,
  cast(points_per_dollar as integer) as points_per_dollar,
  cast(created_at as timestamp) as created_at
from src
  );

[0m14:14:58.462286 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */
alter view "carton_caps"."main"."stg_purchases__dbt_tmp" rename to "stg_purchases"
[0m14:14:58.463287 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:14:58.463287 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m14:14:58.463287 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m14:14:58.464287 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

  
  create view "carton_caps"."main"."stg_events__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."events"
)
select
  cast(event_id as integer) as event_id,
  cast(user_id as integer) as user_id,
  cast(event_type as varchar) as event_type,
  cast(event_at as timestamp) as event_at,
  cast(referral_id as integer) as referral_id,
  cast(metadata_json as varchar) as metadata_json
from src
  );

[0m14:14:58.464287 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.464287 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.464287 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

  
  create view "carton_caps"."main"."stg_referrals__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."referrals"
)
select
  cast(referral_id as integer) as referral_id,
  cast(referrer_user_id as integer) as referrer_user_id,
  lower(cast(referred_email as varchar)) as referred_email,
  cast(referred_user_id as integer) as referred_user_id,
  cast(referral_code as varchar) as referral_code,
  cast(sent_at as timestamp) as sent_at,
  cast(converted_at as timestamp) as converted_at,
  cast(status as varchar) as status
from src
  );

[0m14:14:58.465792 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m14:14:58.470828 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m14:14:58.470828 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m14:14:58.470828 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */
alter view "carton_caps"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:14:58.470828 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m14:14:58.470828 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.470828 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m14:14:58.470828 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m14:14:58.470828 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m14:14:58.470828 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.470828 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */
alter view "carton_caps"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m14:14:58.470828 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */
alter view "carton_caps"."main"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m14:14:58.470828 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m14:14:58.470828 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m14:14:58.470828 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m14:14:58.470828 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.470828 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.470828 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:14:58.481454 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m14:14:58.481454 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m14:14:58.484329 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m14:14:58.484329 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:14:58.484329 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m14:14:58.484329 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m14:14:58.484329 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

      drop view if exists "carton_caps"."main"."stg_purchases__dbt_backup" cascade
    
[0m14:14:58.484329 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m14:14:58.484329 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m14:14:58.484329 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m14:14:58.484329 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

      drop view if exists "carton_caps"."main"."stg_products__dbt_backup" cascade
    
[0m14:14:58.484329 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:14:58.484329 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: Close
[0m14:14:58.484329 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.484329 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.484329 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.484329 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m14:14:58.484329 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m14:14:58.484329 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: Close
[0m14:14:58.484329 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

      drop view if exists "carton_caps"."main"."stg_referrals__dbt_backup" cascade
    
[0m14:14:58.484329 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

      drop view if exists "carton_caps"."main"."stg_events__dbt_backup" cascade
    
[0m14:14:58.484329 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2834cc34-0696-4f25-9313-5cd42379a3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F277AFE900>]}
[0m14:14:58.484329 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2834cc34-0696-4f25-9313-5cd42379a3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F279540E60>]}
[0m14:14:58.484329 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.497231 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: Close
[0m14:14:58.484329 [info ] [Thread-3 (]: 3 of 23 OK created sql view model main.stg_purchases ........................... [[32mOK[0m in 0.08s]
[0m14:14:58.497231 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.497231 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2834cc34-0696-4f25-9313-5cd42379a3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27C381640>]}
[0m14:14:58.497231 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.stg_purchases
[0m14:14:58.484329 [info ] [Thread-2 (]: 2 of 23 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.08s]
[0m14:14:58.497231 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: Close
[0m14:14:58.497231 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.stg_schools
[0m14:14:58.497231 [info ] [Thread-4 (]: 4 of 23 OK created sql view model main.stg_referrals ........................... [[32mOK[0m in 0.09s]
[0m14:14:58.497231 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.stg_products
[0m14:14:58.497231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2834cc34-0696-4f25-9313-5cd42379a3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27C36FF50>]}
[0m14:14:58.497231 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.stg_referrals
[0m14:14:58.497231 [info ] [Thread-3 (]: 5 of 23 START sql view model main.stg_schools .................................. [RUN]
[0m14:14:58.501927 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.stg_users
[0m14:14:58.501927 [info ] [Thread-1 (]: 1 of 23 OK created sql view model main.stg_events .............................. [[32mOK[0m in 0.09s]
[0m14:14:58.502772 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m14:14:58.503292 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_purchases, now model.dbt_carton_caps.stg_schools)
[0m14:14:58.503292 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_events
[0m14:14:58.503292 [info ] [Thread-2 (]: 6 of 23 START sql view model main.stg_users .................................... [RUN]
[0m14:14:58.504307 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.stg_schools
[0m14:14:58.503292 [info ] [Thread-4 (]: 7 of 23 START test not_null_stg_purchases_product_id ........................... [RUN]
[0m14:14:58.504636 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m14:14:58.505086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_products, now model.dbt_carton_caps.stg_users)
[0m14:14:58.507110 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_schools"
[0m14:14:58.507110 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_referrals, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m14:14:58.507110 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.stg_users
[0m14:14:58.507110 [info ] [Thread-1 (]: 8 of 23 START test not_null_stg_purchases_purchase_id .......................... [RUN]
[0m14:14:58.507110 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m14:14:58.509630 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_users"
[0m14:14:58.509630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_events, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m14:14:58.516143 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m14:14:58.516143 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m14:14:58.516143 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.stg_schools
[0m14:14:58.520696 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m14:14:58.521243 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_schools"
[0m14:14:58.521243 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.stg_users
[0m14:14:58.521243 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_users"
[0m14:14:58.521243 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m14:14:58.521243 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m14:14:58.527043 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m14:14:58.569757 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m14:14:58.569757 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_schools: BEGIN
[0m14:14:58.569757 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m14:14:58.569757 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m14:14:58.569757 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:14:58.569757 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: BEGIN
[0m14:14:58.569757 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:14:58.569757 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.569757 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m14:14:58.569757 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m14:14:58.569757 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m14:14:58.569757 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.569757 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m14:14:58.569757 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m14:14:58.569757 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

  
  create view "carton_caps"."main"."stg_schools__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."schools"
)
select
  cast(school_id as integer) as school_id,
  cast(name as varchar) as name,
  cast(address as varchar) as address,
  cast(city as varchar) as city,
  cast(state as varchar) as state,
  cast(zip_code as varchar) as zip_code,
  cast(created_at as timestamp) as created_at
from src
  );

[0m14:14:58.569757 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m14:14:58.569757 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:14:58.569757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:58.569757 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

  
  create view "carton_caps"."main"."stg_users__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."users"
)
select
  cast(user_id as integer) as user_id,
  cast(first_name as varchar) as first_name,
  cast(last_name as varchar) as last_name,
  lower(cast(email as varchar)) as email,
  cast(school_id as integer) as school_id,
  cast(created_at as timestamp) as created_at,
  cast(user_type as varchar) as user_type,
  cast(is_verified as integer) as is_verified,
  cast(device_id as varchar) as device_id,
  cast(marketing_channel as varchar) as marketing_channel
from src
  );

[0m14:14:58.569757 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.585540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.569757 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.585540 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.585540 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m14:14:58.585540 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m14:14:58.585540 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m14:14:58.585540 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m14:14:58.585540 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */
alter view "carton_caps"."main"."stg_schools__dbt_tmp" rename to "stg_schools"
[0m14:14:58.585540 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m14:14:58.585540 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:14:58.585540 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */
alter view "carton_caps"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:14:58.585540 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:14:58.585540 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:14:58.585540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.585540 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m14:14:58.585540 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.585540 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m14:14:58.585540 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m14:14:58.585540 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m14:14:58.596013 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m14:14:58.596013 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m14:14:58.596013 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m14:14:58.596013 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m14:14:58.596013 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m14:14:58.596013 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m14:14:58.596013 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m14:14:58.596013 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m14:14:58.596013 [info ] [Thread-1 (]: 8 of 23 PASS not_null_stg_purchases_purchase_id ................................ [[32mPASS[0m in 0.09s]
[0m14:14:58.601191 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m14:14:58.596013 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.601191 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m14:14:58.601191 [info ] [Thread-4 (]: 7 of 23 PASS not_null_stg_purchases_product_id ................................. [[32mPASS[0m in 0.09s]
[0m14:14:58.601191 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:14:58.601191 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m14:14:58.601191 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m14:14:58.601191 [info ] [Thread-1 (]: 9 of 23 START test not_null_stg_purchases_user_id .............................. [RUN]
[0m14:14:58.601191 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m14:14:58.601191 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

      drop view if exists "carton_caps"."main"."stg_schools__dbt_backup" cascade
    
[0m14:14:58.601191 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m14:14:58.601191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m14:14:58.601191 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

      drop view if exists "carton_caps"."main"."stg_users__dbt_backup" cascade
    
[0m14:14:58.601191 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m14:14:58.601191 [info ] [Thread-4 (]: 10 of 23 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m14:14:58.610425 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m14:14:58.610425 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:14:58.610747 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m14:14:58.611481 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:14:58.612730 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_schools: Close
[0m14:14:58.612730 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m14:14:58.613731 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: Close
[0m14:14:58.613731 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2834cc34-0696-4f25-9313-5cd42379a3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27D4141D0>]}
[0m14:14:58.613731 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m14:14:58.618200 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m14:14:58.618776 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2834cc34-0696-4f25-9313-5cd42379a3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27BC9B020>]}
[0m14:14:58.620338 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m14:14:58.618776 [info ] [Thread-3 (]: 5 of 23 OK created sql view model main.stg_schools ............................. [[32mOK[0m in 0.11s]
[0m14:14:58.621713 [info ] [Thread-2 (]: 6 of 23 OK created sql view model main.stg_users ............................... [[32mOK[0m in 0.11s]
[0m14:14:58.621713 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.stg_schools
[0m14:14:58.621713 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.stg_users
[0m14:14:58.622983 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m14:14:58.622983 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m14:14:58.622983 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m14:14:58.623983 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m14:14:58.625898 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m14:14:58.625898 [info ] [Thread-3 (]: 11 of 23 START test not_null_stg_products_product_id ........................... [RUN]
[0m14:14:58.626903 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m14:14:58.625898 [info ] [Thread-2 (]: 12 of 23 START test unique_stg_products_product_id ............................. [RUN]
[0m14:14:58.626903 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_schools, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m14:14:58.626903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:58.627902 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_users, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m14:14:58.627902 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m14:14:58.627902 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m14:14:58.627902 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m14:14:58.632205 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m14:14:58.632684 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:14:58.632684 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m14:14:58.634659 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m14:14:58.635663 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m14:14:58.635663 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:14:58.635663 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:14:58.636664 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m14:14:58.637664 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m14:14:58.637664 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m14:14:58.638664 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:14:58.639080 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.640592 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m14:14:58.640592 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m14:14:58.640592 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m14:14:58.640592 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:14:58.640592 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m14:14:58.640592 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m14:14:58.640592 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m14:14:58.640592 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m14:14:58.640592 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m14:14:58.640592 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:14:58.640592 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m14:14:58.640592 [info ] [Thread-1 (]: 9 of 23 PASS not_null_stg_purchases_user_id .................................... [[32mPASS[0m in 0.04s]
[0m14:14:58.646284 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:14:58.646284 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m14:14:58.646284 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:14:58.646284 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:14:58.646284 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m14:14:58.646284 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.646284 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m14:14:58.646284 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m14:14:58.646284 [info ] [Thread-1 (]: 13 of 23 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m14:14:58.646284 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m14:14:58.646284 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:14:58.646284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m14:14:58.646284 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m14:14:58.646284 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:14:58.646284 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m14:14:58.646284 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m14:14:58.646284 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.655371 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m14:14:58.655371 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:14:58.655811 [info ] [Thread-4 (]: 10 of 23 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.05s]
[0m14:14:58.656840 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m14:14:58.657840 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m14:14:58.657840 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m14:14:58.658840 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m14:14:58.658840 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m14:14:58.658840 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m14:14:58.659620 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m14:14:58.659620 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m14:14:58.661658 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m14:14:58.661658 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m14:14:58.661658 [info ] [Thread-4 (]: 14 of 23 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m14:14:58.662658 [info ] [Thread-3 (]: 11 of 23 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.04s]
[0m14:14:58.663657 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m14:14:58.662658 [info ] [Thread-2 (]: 12 of 23 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m14:14:58.663657 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m14:14:58.663657 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m14:14:58.664657 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m14:14:58.664657 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m14:14:58.664657 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m14:14:58.667167 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m14:14:58.667167 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m14:14:58.668166 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m14:14:58.668166 [info ] [Thread-3 (]: 15 of 23 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m14:14:58.669167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:58.668166 [info ] [Thread-2 (]: 16 of 23 START test not_null_stg_events_event_id ............................... [RUN]
[0m14:14:58.669167 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m14:14:58.669167 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m14:14:58.670166 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m14:14:58.670166 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m14:14:58.670166 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.670166 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m14:14:58.672167 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m14:14:58.674167 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m14:14:58.675528 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m14:14:58.677210 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m14:14:58.678211 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m14:14:58.678211 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m14:14:58.678211 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m14:14:58.680603 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m14:14:58.680603 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.681244 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m14:14:58.681244 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m14:14:58.682490 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:14:58.682490 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m14:14:58.683132 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m14:14:58.683132 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m14:14:58.686137 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m14:14:58.686137 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m14:14:58.686137 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:14:58.687138 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m14:14:58.687583 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m14:14:58.687583 [info ] [Thread-1 (]: 13 of 23 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.04s]
[0m14:14:58.687583 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:14:58.688471 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m14:14:58.688471 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m14:14:58.688471 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m14:14:58.689827 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m14:14:58.689827 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m14:14:58.689827 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.689827 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:14:58.689827 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.689827 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m14:14:58.689827 [info ] [Thread-1 (]: 17 of 23 START test not_null_stg_events_user_id ................................ [RUN]
[0m14:14:58.689827 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:14:58.689827 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m14:14:58.689827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m14:14:58.689827 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:14:58.694381 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m14:14:58.694683 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m14:14:58.694683 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m14:14:58.695428 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.695428 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m14:14:58.698433 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m14:14:58.698433 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m14:14:58.699434 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m14:14:58.699434 [info ] [Thread-4 (]: 14 of 23 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.04s]
[0m14:14:58.700432 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m14:14:58.701567 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m14:14:58.701887 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.701887 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m14:14:58.702486 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m14:14:58.702486 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m14:14:58.703947 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m14:14:58.703947 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m14:14:58.703947 [info ] [Thread-3 (]: 15 of 23 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m14:14:58.703947 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m14:14:58.703947 [info ] [Thread-4 (]: 18 of 23 START test unique_stg_events_event_id ................................. [RUN]
[0m14:14:58.707793 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m14:14:58.707793 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m14:14:58.708476 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m14:14:58.708476 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m14:14:58.709181 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m14:14:58.709181 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m14:14:58.709181 [info ] [Thread-2 (]: 16 of 23 PASS not_null_stg_events_event_id ..................................... [[32mPASS[0m in 0.04s]
[0m14:14:58.710585 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m14:14:58.712978 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m14:14:58.710194 [info ] [Thread-3 (]: 19 of 23 START test not_null_stg_schools_school_id ............................. [RUN]
[0m14:14:58.714017 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m14:14:58.714017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:58.714521 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m14:14:58.715036 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m14:14:58.715344 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m14:14:58.716042 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m14:14:58.716554 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.716042 [info ] [Thread-2 (]: 20 of 23 START test not_null_stg_users_school_id ............................... [RUN]
[0m14:14:58.719118 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m14:14:58.720645 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m14:14:58.721158 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m14:14:58.721158 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m14:14:58.721671 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:14:58.722182 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m14:14:58.725019 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m14:14:58.725019 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m14:14:58.726050 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m14:14:58.726050 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m14:14:58.727584 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m14:14:58.728090 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:14:58.728090 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:14:58.729503 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m14:14:58.730175 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m14:14:58.730693 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m14:14:58.730693 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:14:58.732732 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m14:14:58.732732 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m14:14:58.733239 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m14:14:58.733239 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m14:14:58.733753 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m14:14:58.734264 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:14:58.734264 [info ] [Thread-1 (]: 17 of 23 PASS not_null_stg_events_user_id ...................................... [[32mPASS[0m in 0.04s]
[0m14:14:58.734803 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:14:58.735315 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m14:14:58.735315 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m14:14:58.736446 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m14:14:58.736446 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m14:14:58.736974 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.736974 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:14:58.737984 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m14:14:58.736974 [info ] [Thread-1 (]: 21 of 23 START test not_null_stg_users_user_id ................................. [RUN]
[0m14:14:58.738808 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m14:14:58.738808 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:14:58.738808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m14:14:58.739830 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.739830 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m14:14:58.740830 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m14:14:58.740830 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m14:14:58.740830 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.742977 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m14:14:58.742977 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m14:14:58.742977 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m14:14:58.742977 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m14:14:58.742977 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m14:14:58.742977 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m14:14:58.742977 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m14:14:58.742977 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m14:14:58.742977 [info ] [Thread-4 (]: 18 of 23 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m14:14:58.742977 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.750654 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m14:14:58.742977 [info ] [Thread-3 (]: 19 of 23 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.03s]
[0m14:14:58.751664 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m14:14:58.752079 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m14:14:58.752079 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m14:14:58.753350 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m14:14:58.753350 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m14:14:58.754349 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m14:14:58.754349 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m14:14:58.754349 [info ] [Thread-4 (]: 22 of 23 START test unique_stg_schools_school_id ............................... [RUN]
[0m14:14:58.754349 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m14:14:58.754349 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m14:14:58.754349 [info ] [Thread-3 (]: 23 of 23 START test unique_stg_users_user_id ................................... [RUN]
[0m14:14:58.755804 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m14:14:58.755804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:58.756809 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m14:14:58.755804 [info ] [Thread-2 (]: 20 of 23 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m14:14:58.756809 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m14:14:58.757526 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m14:14:58.757526 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m14:14:58.757526 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:14:58.760031 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m14:14:58.761033 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m14:14:58.761033 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m14:14:58.763765 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:14:58.764597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.765600 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m14:14:58.766604 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m14:14:58.766604 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m14:14:58.766604 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m14:14:58.768603 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m14:14:58.768603 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m14:14:58.768603 [info ] [Thread-1 (]: 21 of 23 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m14:14:58.770730 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m14:14:58.770730 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m14:14:58.771854 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m14:14:58.771854 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m14:14:58.771854 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:14:58.772854 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m14:14:58.772854 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m14:14:58.772854 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.772854 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:14:58.773856 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m14:14:58.773856 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:14:58.773856 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.774855 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m14:14:58.774855 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:14:58.774855 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.775855 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m14:14:58.775855 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:14:58.776854 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m14:14:58.777855 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m14:14:58.777855 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m14:14:58.778854 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m14:14:58.778854 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m14:14:58.778854 [info ] [Thread-3 (]: 23 of 23 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.02s]
[0m14:14:58.779854 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m14:14:58.779854 [info ] [Thread-4 (]: 22 of 23 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.02s]
[0m14:14:58.779854 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m14:14:58.780854 [debug] [MainThread]: Using duckdb connection "master"
[0m14:14:58.781855 [debug] [MainThread]: On master: BEGIN
[0m14:14:58.781855 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:58.781855 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:14:58.781855 [debug] [MainThread]: On master: COMMIT
[0m14:14:58.781855 [debug] [MainThread]: Using duckdb connection "master"
[0m14:14:58.782856 [debug] [MainThread]: On master: COMMIT
[0m14:14:58.782856 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:14:58.782856 [debug] [MainThread]: On master: Close
[0m14:14:58.782856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:58.782856 [debug] [MainThread]: Connection 'create_carton_caps_main' was properly closed.
[0m14:14:58.783856 [debug] [MainThread]: Connection 'list_carton_caps_main' was properly closed.
[0m14:14:58.783856 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m14:14:58.783856 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a' was properly closed.
[0m14:14:58.783856 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m14:14:58.783856 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6' was properly closed.
[0m14:14:58.784676 [info ] [MainThread]: 
[0m14:14:58.784676 [info ] [MainThread]: Finished running 17 data tests, 6 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m14:14:58.786421 [debug] [MainThread]: Command end result
[0m14:14:58.800366 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m14:14:58.802226 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m14:14:58.806178 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\run_results.json
[0m14:14:58.807189 [info ] [MainThread]: 
[0m14:14:58.807189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:14:58.807189 [info ] [MainThread]: 
[0m14:14:58.807189 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m14:14:58.807189 [debug] [MainThread]: Command `dbt build` succeeded at 14:14:58.807189 after 2.51 seconds
[0m14:14:58.807189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27B5E35F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27C27D640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27BD2CBF0>]}
[0m14:14:58.807189 [debug] [MainThread]: Flushing usage events
[0m14:14:59.144339 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:03.950589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002799E7E8F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002799E261340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002799E27E000>]}


============================== 14:17:03.955458 | 9101917d-38be-4520-8fa3-430bbe7dbac7 ==============================
[0m14:17:03.955458 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:17:03.955458 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt build --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m14:17:04.096916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002799FA722A0>]}
[0m14:17:04.127697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002799E9BF950>]}
[0m14:17:04.127697 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:17:04.292031 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:17:04.371928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 7 files added, 0 files changed.
[0m14:17:04.371928 [debug] [MainThread]: Partial parsing: added file: dbt_carton_caps://models\marts\fct_purchase.sql
[0m14:17:04.371928 [debug] [MainThread]: Partial parsing: added file: dbt_carton_caps://models\marts\dim_school.sql
[0m14:17:04.371928 [debug] [MainThread]: Partial parsing: added file: dbt_carton_caps://models\marts\dim_product.sql
[0m14:17:04.371928 [debug] [MainThread]: Partial parsing: added file: dbt_carton_caps://models\marts\fct_referral.sql
[0m14:17:04.371928 [debug] [MainThread]: Partial parsing: added file: dbt_carton_caps://models\marts\schema.yml
[0m14:17:04.371928 [debug] [MainThread]: Partial parsing: added file: dbt_carton_caps://models\marts\dim_user.sql
[0m14:17:04.371928 [debug] [MainThread]: Partial parsing: added file: dbt_carton_caps://models\marts\fct_rewards.sql
[0m14:17:04.657352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279A052ED20>]}
[0m14:17:04.740814 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m14:17:04.742114 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m14:17:04.753192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279A0209610>]}
[0m14:17:04.753192 [info ] [MainThread]: Found 12 models, 29 data tests, 6 sources, 472 macros
[0m14:17:04.769061 [info ] [MainThread]: 
[0m14:17:04.769061 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:17:04.769061 [info ] [MainThread]: 
[0m14:17:04.769061 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:17:04.772734 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps'
[0m14:17:04.823988 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps"
[0m14:17:04.823988 [debug] [ThreadPool]: On list_carton_caps: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps"'
    
  
  
[0m14:17:04.823988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:04.843439 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m14:17:04.844486 [debug] [ThreadPool]: On list_carton_caps: Close
[0m14:17:04.845443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_carton_caps, now create_carton_caps_main)
[0m14:17:04.845443 [debug] [ThreadPool]: Creating schema "database: "carton_caps"
schema: "main"
"
[0m14:17:04.849412 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_main"
[0m14:17:04.849412 [debug] [ThreadPool]: On create_carton_caps_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='carton_caps'
        and type='sqlite'
    
  
[0m14:17:04.849412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:04.850442 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:17:04.851443 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_main"
[0m14:17:04.851443 [debug] [ThreadPool]: On create_carton_caps_main: BEGIN
[0m14:17:04.851443 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:17:04.851443 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_main"
[0m14:17:04.852432 [debug] [ThreadPool]: On create_carton_caps_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_main"} */

    
    
        create schema if not exists "carton_caps"."main"
    
[0m14:17:04.852432 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:17:04.852432 [debug] [ThreadPool]: On create_carton_caps_main: COMMIT
[0m14:17:04.853455 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_main"
[0m14:17:04.853455 [debug] [ThreadPool]: On create_carton_caps_main: COMMIT
[0m14:17:04.853455 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:17:04.853455 [debug] [ThreadPool]: On create_carton_caps_main: Close
[0m14:17:04.855058 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_main'
[0m14:17:04.857589 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_main"
[0m14:17:04.857589 [debug] [ThreadPool]: On list_carton_caps_main: BEGIN
[0m14:17:04.857589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:04.857589 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:17:04.859594 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_main"
[0m14:17:04.859594 [debug] [ThreadPool]: On list_carton_caps_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_main"} */
select
      'carton_caps' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps'
  
[0m14:17:04.868450 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:17:04.869425 [debug] [ThreadPool]: On list_carton_caps_main: ROLLBACK
[0m14:17:04.869425 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_main'
[0m14:17:04.869425 [debug] [ThreadPool]: On list_carton_caps_main: Close
[0m14:17:04.870473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002799B7C66F0>]}
[0m14:17:04.871473 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:04.871473 [debug] [MainThread]: On master: BEGIN
[0m14:17:04.871473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:04.871473 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:04.872438 [debug] [MainThread]: On master: COMMIT
[0m14:17:04.872438 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:04.872438 [debug] [MainThread]: On master: COMMIT
[0m14:17:04.872438 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:04.872438 [debug] [MainThread]: On master: Close
[0m14:17:04.875795 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_events
[0m14:17:04.875795 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.stg_products
[0m14:17:04.875795 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.stg_purchases
[0m14:17:04.876881 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.stg_referrals
[0m14:17:04.875795 [info ] [Thread-1 (]: 1 of 41 START sql view model main.stg_events ................................... [RUN]
[0m14:17:04.876881 [info ] [Thread-2 (]: 2 of 41 START sql view model main.stg_products ................................. [RUN]
[0m14:17:04.876881 [info ] [Thread-3 (]: 3 of 41 START sql view model main.stg_purchases ................................ [RUN]
[0m14:17:04.877881 [info ] [Thread-4 (]: 4 of 41 START sql view model main.stg_referrals ................................ [RUN]
[0m14:17:04.877881 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_events'
[0m14:17:04.878449 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_products'
[0m14:17:04.878449 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_purchases'
[0m14:17:04.878449 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_referrals'
[0m14:17:04.879581 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_events
[0m14:17:04.879581 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.stg_products
[0m14:17:04.879581 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.stg_purchases
[0m14:17:04.879581 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.stg_referrals
[0m14:17:04.884478 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_events"
[0m14:17:04.885545 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_products"
[0m14:17:04.887545 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_purchases"
[0m14:17:04.889545 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_referrals"
[0m14:17:04.890430 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_events
[0m14:17:04.890430 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.stg_purchases
[0m14:17:04.897133 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.stg_products
[0m14:17:04.910909 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_events"
[0m14:17:04.913200 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_purchases"
[0m14:17:04.913200 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_products"
[0m14:17:04.916232 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.stg_referrals
[0m14:17:04.918261 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_referrals"
[0m14:17:04.918261 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m14:17:04.919261 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m14:17:04.919261 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: BEGIN
[0m14:17:04.919261 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m14:17:04.919261 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: BEGIN
[0m14:17:04.920261 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:17:04.920261 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m14:17:04.920261 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: BEGIN
[0m14:17:04.920261 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:17:04.921262 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: BEGIN
[0m14:17:04.921262 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:17:04.921262 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:17:04.922261 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:17:04.922261 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:17:04.922261 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m14:17:04.923260 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:17:04.923260 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m14:17:04.923260 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:17:04.923260 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

  
  create view "carton_caps"."main"."stg_purchases__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."purchases"
)
select
  cast(purchase_id as integer) as purchase_id,
  cast(user_id as integer) as user_id,
  cast(product_id as integer) as product_id,
  cast(quantity as integer) as quantity,
  cast(price_paid as double) as price_paid,
  cast(points_earned as integer) as points_earned,
  cast(purchased_at as timestamp) as purchased_at,
  cast(day_of_week as varchar) as day_of_week,
  cast(hour_of_day as integer) as hour_of_day
from src
  );

[0m14:17:04.924261 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m14:17:04.924261 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

  
  create view "carton_caps"."main"."stg_events__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."events"
)
select
  cast(event_id as integer) as event_id,
  cast(user_id as integer) as user_id,
  cast(event_type as varchar) as event_type,
  cast(event_at as timestamp) as event_at,
  cast(referral_id as integer) as referral_id,
  cast(metadata_json as varchar) as metadata_json
from src
  );

[0m14:17:04.924261 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m14:17:04.924261 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

  
  create view "carton_caps"."main"."stg_products__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."products"
)
select
  cast(product_id as integer) as product_id,
  cast(name as varchar) as name,
  cast(category as varchar) as category,
  cast(price as double) as price,
  cast(points_per_dollar as integer) as points_per_dollar,
  cast(created_at as timestamp) as created_at
from src
  );

[0m14:17:04.924261 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

  
  create view "carton_caps"."main"."stg_referrals__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."referrals"
)
select
  cast(referral_id as integer) as referral_id,
  cast(referrer_user_id as integer) as referrer_user_id,
  lower(cast(referred_email as varchar)) as referred_email,
  cast(referred_user_id as integer) as referred_user_id,
  cast(referral_code as varchar) as referral_code,
  cast(sent_at as timestamp) as sent_at,
  cast(converted_at as timestamp) as converted_at,
  cast(status as varchar) as status
from src
  );

[0m14:17:04.925560 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:17:04.925560 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:17:04.933461 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m14:17:04.934503 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m14:17:04.935503 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:17:04.935503 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m14:17:04.935503 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */
alter view "carton_caps"."main"."stg_purchases" rename to "stg_purchases__dbt_backup"
[0m14:17:04.935503 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */
alter view "carton_caps"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m14:17:04.937503 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m14:17:04.939427 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m14:17:04.940428 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */
alter view "carton_caps"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m14:17:04.940428 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:17:04.940428 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */
alter view "carton_caps"."main"."stg_referrals" rename to "stg_referrals__dbt_backup"
[0m14:17:04.941427 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:17:04.942429 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m14:17:04.943514 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:17:04.945029 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m14:17:04.945437 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:17:04.945437 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */
alter view "carton_caps"."main"."stg_purchases__dbt_tmp" rename to "stg_purchases"
[0m14:17:04.947451 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m14:17:04.947451 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */
alter view "carton_caps"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m14:17:04.949451 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m14:17:04.949451 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */
alter view "carton_caps"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:17:04.949451 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:17:04.949451 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */
alter view "carton_caps"."main"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m14:17:04.950481 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:17:04.958431 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m14:17:04.958431 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m14:17:04.959432 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m14:17:04.959432 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m14:17:04.959432 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:17:04.960432 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m14:17:04.960432 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m14:17:04.961431 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m14:17:04.962432 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m14:17:04.962432 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m14:17:04.962432 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m14:17:04.962432 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m14:17:04.963432 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m14:17:04.963432 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m14:17:04.965431 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:17:04.968431 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m14:17:04.969431 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

      drop view if exists "carton_caps"."main"."stg_purchases__dbt_backup" cascade
    
[0m14:17:04.969431 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:17:04.969431 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:17:04.970432 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m14:17:04.971431 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m14:17:04.971431 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:17:04.973140 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m14:17:04.974439 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m14:17:04.974439 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

      drop view if exists "carton_caps"."main"."stg_events__dbt_backup" cascade
    
[0m14:17:04.976412 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: Close
[0m14:17:04.976412 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

      drop view if exists "carton_caps"."main"."stg_products__dbt_backup" cascade
    
[0m14:17:04.976412 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

      drop view if exists "carton_caps"."main"."stg_referrals__dbt_backup" cascade
    
[0m14:17:04.977449 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:17:04.978460 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: Close
[0m14:17:04.978460 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:17:04.979799 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: Close
[0m14:17:04.979799 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:17:04.981050 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: Close
[0m14:17:04.981050 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279A0840260>]}
[0m14:17:04.982050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279A09209E0>]}
[0m14:17:04.982050 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279A081F590>]}
[0m14:17:04.982050 [info ] [Thread-3 (]: 3 of 41 OK created sql view model main.stg_purchases ........................... [[32mOK[0m in 0.10s]
[0m14:17:04.982050 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279A038B1D0>]}
[0m14:17:04.983049 [info ] [Thread-1 (]: 1 of 41 OK created sql view model main.stg_events .............................. [[32mOK[0m in 0.10s]
[0m14:17:04.983049 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.stg_purchases
[0m14:17:04.983049 [info ] [Thread-4 (]: 4 of 41 OK created sql view model main.stg_referrals ........................... [[32mOK[0m in 0.10s]
[0m14:17:04.984050 [info ] [Thread-2 (]: 2 of 41 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.10s]
[0m14:17:04.984050 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_events
[0m14:17:04.984050 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.stg_schools
[0m14:17:04.985049 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.stg_referrals
[0m14:17:04.985049 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.stg_products
[0m14:17:04.985049 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_users
[0m14:17:04.986049 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m14:17:04.986049 [info ] [Thread-3 (]: 5 of 41 START sql view model main.stg_schools .................................. [RUN]
[0m14:17:04.986690 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m14:17:04.986690 [info ] [Thread-1 (]: 6 of 41 START sql view model main.stg_users .................................... [RUN]
[0m14:17:04.986690 [info ] [Thread-4 (]: 7 of 41 START test not_null_stg_purchases_product_id ........................... [RUN]
[0m14:17:04.987749 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_purchases, now model.dbt_carton_caps.stg_schools)
[0m14:17:04.987749 [info ] [Thread-2 (]: 8 of 41 START test not_null_stg_purchases_purchase_id .......................... [RUN]
[0m14:17:04.987749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_events, now model.dbt_carton_caps.stg_users)
[0m14:17:04.987749 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_referrals, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m14:17:04.988750 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.stg_schools
[0m14:17:04.988750 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_products, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m14:17:04.988750 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_users
[0m14:17:04.988750 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m14:17:04.990749 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_schools"
[0m14:17:04.990749 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m14:17:04.992748 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_users"
[0m14:17:04.998212 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m14:17:05.001160 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m14:17:05.002399 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.stg_schools
[0m14:17:05.004176 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_schools"
[0m14:17:05.005176 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m14:17:05.005176 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m14:17:05.005176 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_users
[0m14:17:05.014842 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m14:17:05.014842 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m14:17:05.014842 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m14:17:05.014842 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_users"
[0m14:17:05.014842 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_schools: BEGIN
[0m14:17:05.014842 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:17:05.021449 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m14:17:05.021449 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m14:17:05.021449 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.022455 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m14:17:05.022455 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:17:05.022455 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m14:17:05.022455 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m14:17:05.023454 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m14:17:05.023454 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_users: BEGIN
[0m14:17:05.023454 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

  
  create view "carton_caps"."main"."stg_schools__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."schools"
)
select
  cast(school_id as integer) as school_id,
  cast(name as varchar) as name,
  cast(address as varchar) as address,
  cast(city as varchar) as city,
  cast(state as varchar) as state,
  cast(zip_code as varchar) as zip_code,
  cast(created_at as timestamp) as created_at
from src
  );

[0m14:17:05.023454 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.024454 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:17:05.024454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:05.024454 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m14:17:05.025454 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.025454 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.025454 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.025454 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.027455 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m14:17:05.027455 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m14:17:05.028407 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m14:17:05.028407 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */
alter view "carton_caps"."main"."stg_schools" rename to "stg_schools__dbt_backup"
[0m14:17:05.028407 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.029501 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.029501 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

  
  create view "carton_caps"."main"."stg_users__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."users"
)
select
  cast(user_id as integer) as user_id,
  cast(first_name as varchar) as first_name,
  cast(last_name as varchar) as last_name,
  lower(cast(email as varchar)) as email,
  cast(school_id as integer) as school_id,
  cast(created_at as timestamp) as created_at,
  cast(user_type as varchar) as user_type,
  cast(is_verified as integer) as is_verified,
  cast(device_id as varchar) as device_id,
  cast(marketing_channel as varchar) as marketing_channel
from src
  );

[0m14:17:05.031501 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m14:17:05.031501 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.032501 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.032501 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m14:17:05.032501 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.034503 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m14:17:05.035501 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m14:17:05.035501 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m14:17:05.035501 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m14:17:05.035501 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */
alter view "carton_caps"."main"."stg_schools__dbt_tmp" rename to "stg_schools"
[0m14:17:05.035501 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */
alter view "carton_caps"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m14:17:05.035501 [info ] [Thread-4 (]: 7 of 41 PASS not_null_stg_purchases_product_id ................................. [[32mPASS[0m in 0.05s]
[0m14:17:05.035501 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m14:17:05.035501 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m14:17:05.035501 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m14:17:05.035501 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.035501 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.035501 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m14:17:05.035501 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m14:17:05.035501 [info ] [Thread-2 (]: 8 of 41 PASS not_null_stg_purchases_purchase_id ................................ [[32mPASS[0m in 0.05s]
[0m14:17:05.035501 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m14:17:05.035501 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m14:17:05.035501 [info ] [Thread-4 (]: 9 of 41 START test not_null_stg_purchases_user_id .............................. [RUN]
[0m14:17:05.044379 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m14:17:05.044379 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */
alter view "carton_caps"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:17:05.045017 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m14:17:05.045017 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m14:17:05.045017 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m14:17:05.045017 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m14:17:05.046229 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:17:05.048942 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m14:17:05.046680 [info ] [Thread-2 (]: 10 of 41 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m14:17:05.049608 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m14:17:05.049608 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:17:05.049608 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m14:17:05.049608 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m14:17:05.049608 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m14:17:05.049608 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m14:17:05.049608 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m14:17:05.049608 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m14:17:05.049608 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

      drop view if exists "carton_caps"."main"."stg_schools__dbt_backup" cascade
    
[0m14:17:05.057247 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m14:17:05.059756 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m14:17:05.060761 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m14:17:05.060761 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m14:17:05.061761 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m14:17:05.061761 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.063095 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m14:17:05.063095 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.064157 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_schools: Close
[0m14:17:05.064157 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:17:05.065155 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m14:17:05.066411 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279A081FCE0>]}
[0m14:17:05.066411 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m14:17:05.066411 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

      drop view if exists "carton_caps"."main"."stg_users__dbt_backup" cascade
    
[0m14:17:05.067410 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.067410 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m14:17:05.067410 [info ] [Thread-3 (]: 5 of 41 OK created sql view model main.stg_schools ............................. [[32mOK[0m in 0.08s]
[0m14:17:05.068410 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m14:17:05.068410 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:17:05.068410 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.stg_schools
[0m14:17:05.069410 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.069410 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.069410 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m14:17:05.069410 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.070412 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_users: Close
[0m14:17:05.071410 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.071410 [info ] [Thread-3 (]: 11 of 41 START test not_null_stg_events_event_id ............................... [RUN]
[0m14:17:05.071410 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m14:17:05.072410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279A0917C80>]}
[0m14:17:05.072410 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_schools, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m14:17:05.073410 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m14:17:05.073410 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:17:05.074411 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m14:17:05.074411 [info ] [Thread-1 (]: 6 of 41 OK created sql view model main.stg_users ............................... [[32mOK[0m in 0.08s]
[0m14:17:05.074411 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m14:17:05.078412 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m14:17:05.078412 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_users
[0m14:17:05.079412 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:17:05.079412 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m14:17:05.079412 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m14:17:05.081411 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m14:17:05.080410 [info ] [Thread-4 (]: 9 of 41 PASS not_null_stg_purchases_user_id .................................... [[32mPASS[0m in 0.04s]
[0m14:17:05.081411 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m14:17:05.081411 [info ] [Thread-1 (]: 12 of 41 START test not_null_stg_events_user_id ................................ [RUN]
[0m14:17:05.081411 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m14:17:05.081411 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m14:17:05.084532 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m14:17:05.084532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_users, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m14:17:05.084532 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m14:17:05.084532 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m14:17:05.084532 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m14:17:05.084532 [info ] [Thread-2 (]: 10 of 41 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.03s]
[0m14:17:05.088715 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m14:17:05.089713 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m14:17:05.084532 [info ] [Thread-4 (]: 13 of 41 START test unique_stg_events_event_id ................................. [RUN]
[0m14:17:05.089713 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m14:17:05.089713 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m14:17:05.090715 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m14:17:05.090715 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m14:17:05.090715 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:17:05.090715 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m14:17:05.091716 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m14:17:05.091716 [info ] [Thread-2 (]: 14 of 41 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m14:17:05.092716 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m14:17:05.095761 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m14:17:05.095761 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:17:05.095761 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m14:17:05.095761 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m14:17:05.095761 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m14:17:05.097839 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.097839 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m14:17:05.100132 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m14:17:05.100132 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m14:17:05.101132 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m14:17:05.102133 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m14:17:05.102133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:05.103131 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.103131 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m14:17:05.104784 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m14:17:05.104784 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.105788 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m14:17:05.105788 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m14:17:05.107182 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m14:17:05.107182 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.107182 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m14:17:05.107182 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m14:17:05.107182 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m14:17:05.107182 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m14:17:05.107182 [info ] [Thread-3 (]: 11 of 41 PASS not_null_stg_events_event_id ..................................... [[32mPASS[0m in 0.03s]
[0m14:17:05.107182 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m14:17:05.107182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.107182 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:17:05.107182 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m14:17:05.107182 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:17:05.111707 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m14:17:05.112193 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m14:17:05.112193 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.112193 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m14:17:05.112193 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.112193 [info ] [Thread-3 (]: 15 of 41 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m14:17:05.112193 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m14:17:05.112193 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m14:17:05.112193 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m14:17:05.112193 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m14:17:05.112193 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:17:05.115200 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.115200 [info ] [Thread-1 (]: 12 of 41 PASS not_null_stg_events_user_id ...................................... [[32mPASS[0m in 0.03s]
[0m14:17:05.115200 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m14:17:05.116281 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m14:17:05.119286 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m14:17:05.120285 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m14:17:05.120285 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:17:05.121085 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:17:05.121085 [info ] [Thread-1 (]: 16 of 41 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m14:17:05.121698 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m14:17:05.121698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m14:17:05.121698 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m14:17:05.121698 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m14:17:05.121698 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m14:17:05.121698 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m14:17:05.121698 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m14:17:05.125595 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m14:17:05.127756 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m14:17:05.128756 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m14:17:05.129755 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m14:17:05.129755 [info ] [Thread-4 (]: 13 of 41 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m14:17:05.130757 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m14:17:05.129755 [info ] [Thread-2 (]: 14 of 41 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.03s]
[0m14:17:05.130757 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m14:17:05.130757 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m14:17:05.131756 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m14:17:05.131756 [info ] [Thread-4 (]: 17 of 41 START test not_null_stg_products_product_id ........................... [RUN]
[0m14:17:05.132538 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m14:17:05.132538 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m14:17:05.133544 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m14:17:05.132538 [info ] [Thread-2 (]: 18 of 41 START test unique_stg_products_product_id ............................. [RUN]
[0m14:17:05.134543 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m14:17:05.134543 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m14:17:05.134543 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m14:17:05.134543 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m14:17:05.134543 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:17:05.134543 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m14:17:05.134543 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m14:17:05.134543 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m14:17:05.139488 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.141681 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m14:17:05.141681 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m14:17:05.141681 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m14:17:05.142681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:05.142681 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m14:17:05.142681 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.144682 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m14:17:05.144682 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m14:17:05.144682 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.146432 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m14:17:05.146432 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m14:17:05.147436 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.147436 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:17:05.148765 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m14:17:05.148765 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m14:17:05.148765 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.148765 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m14:17:05.148765 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m14:17:05.148765 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m14:17:05.148765 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m14:17:05.148765 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m14:17:05.148765 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m14:17:05.148765 [info ] [Thread-3 (]: 15 of 41 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.04s]
[0m14:17:05.148765 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:17:05.153379 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m14:17:05.153853 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:17:05.153853 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m14:17:05.153853 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m14:17:05.153853 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.153853 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m14:17:05.153853 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.153853 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m14:17:05.153853 [info ] [Thread-1 (]: 16 of 41 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m14:17:05.153853 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m14:17:05.153853 [info ] [Thread-3 (]: 19 of 41 START test not_null_stg_schools_school_id ............................. [RUN]
[0m14:17:05.153853 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.153853 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m14:17:05.153853 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:17:05.153853 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m14:17:05.153853 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m14:17:05.153853 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m14:17:05.153853 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.153853 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.160844 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m14:17:05.153853 [info ] [Thread-1 (]: 20 of 41 START test unique_stg_schools_school_id ............................... [RUN]
[0m14:17:05.162629 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m14:17:05.163655 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m14:17:05.163655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m14:17:05.163655 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m14:17:05.164655 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m14:17:05.164655 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m14:17:05.164655 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m14:17:05.164655 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m14:17:05.164655 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m14:17:05.167266 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m14:17:05.169906 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m14:17:05.169906 [info ] [Thread-4 (]: 17 of 41 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.04s]
[0m14:17:05.170912 [info ] [Thread-2 (]: 18 of 41 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.04s]
[0m14:17:05.170912 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m14:17:05.171911 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m14:17:05.171911 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m14:17:05.171911 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m14:17:05.171911 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m14:17:05.172911 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m14:17:05.172911 [info ] [Thread-4 (]: 21 of 41 START test not_null_stg_users_school_id ............................... [RUN]
[0m14:17:05.174912 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m14:17:05.175912 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m14:17:05.176398 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m14:17:05.176398 [info ] [Thread-2 (]: 22 of 41 START test not_null_stg_users_user_id ................................. [RUN]
[0m14:17:05.176398 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:17:05.177399 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m14:17:05.177399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m14:17:05.177399 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m14:17:05.180400 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m14:17:05.180400 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:17:05.180400 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m14:17:05.180400 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m14:17:05.181400 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m14:17:05.183398 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m14:17:05.183398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:05.184399 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.184399 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m14:17:05.186400 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m14:17:05.186400 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m14:17:05.186400 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.187398 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.188399 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m14:17:05.188399 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m14:17:05.189399 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m14:17:05.190399 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m14:17:05.190399 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:17:05.190399 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m14:17:05.190399 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m14:17:05.190399 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m14:17:05.190399 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m14:17:05.190399 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:17:05.190399 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m14:17:05.190399 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.190399 [info ] [Thread-3 (]: 19 of 41 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.04s]
[0m14:17:05.190399 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:17:05.190399 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.194271 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m14:17:05.195276 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m14:17:05.195276 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m14:17:05.195276 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m14:17:05.196277 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.196277 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.197016 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m14:17:05.197016 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m14:17:05.197016 [info ] [Thread-3 (]: 23 of 41 START test unique_stg_users_user_id ................................... [RUN]
[0m14:17:05.197016 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m14:17:05.198234 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.198234 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m14:17:05.198234 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.198234 [info ] [Thread-1 (]: 20 of 41 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m14:17:05.199233 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m14:17:05.200021 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m14:17:05.202163 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m14:17:05.203162 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m14:17:05.203162 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:17:05.203162 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.fct_rewards
[0m14:17:05.204079 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m14:17:05.205355 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m14:17:05.204079 [info ] [Thread-1 (]: 24 of 41 START sql table model main.fct_rewards ................................ [RUN]
[0m14:17:05.205355 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m14:17:05.205355 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m14:17:05.205355 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m14:17:05.205355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6, now model.dbt_carton_caps.fct_rewards)
[0m14:17:05.208927 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m14:17:05.205355 [info ] [Thread-4 (]: 21 of 41 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m14:17:05.209282 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m14:17:05.209282 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.fct_rewards
[0m14:17:05.210055 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m14:17:05.211560 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_rewards"
[0m14:17:05.210055 [info ] [Thread-2 (]: 22 of 41 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m14:17:05.212565 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.fct_referral
[0m14:17:05.212565 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m14:17:05.212565 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m14:17:05.213564 [info ] [Thread-4 (]: 25 of 41 START sql table model main.fct_referral ............................... [RUN]
[0m14:17:05.213564 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m14:17:05.213564 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.dim_product
[0m14:17:05.214565 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now model.dbt_carton_caps.fct_referral)
[0m14:17:05.214565 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:17:05.214565 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.fct_rewards
[0m14:17:05.215564 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.fct_referral
[0m14:17:05.214565 [info ] [Thread-2 (]: 26 of 41 START sql table model main.dim_product ................................ [RUN]
[0m14:17:05.225950 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_rewards"
[0m14:17:05.225950 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_referral"
[0m14:17:05.225950 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m14:17:05.225950 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now model.dbt_carton_caps.dim_product)
[0m14:17:05.229753 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m14:17:05.229753 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.dim_product
[0m14:17:05.230793 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:17:05.230793 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.fct_referral
[0m14:17:05.233586 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_product"
[0m14:17:05.233586 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m14:17:05.235585 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_referral"
[0m14:17:05.235585 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.235585 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_rewards: BEGIN
[0m14:17:05.237184 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.dim_product
[0m14:17:05.237184 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m14:17:05.237184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:05.237184 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_product"
[0m14:17:05.237184 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m14:17:05.237184 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m14:17:05.237184 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_referral: BEGIN
[0m14:17:05.237184 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.237184 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m14:17:05.237184 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:17:05.237184 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m14:17:05.237184 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m14:17:05.237184 [info ] [Thread-3 (]: 23 of 41 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.04s]
[0m14:17:05.243654 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.237184 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

  
    
    

    create  table
      "carton_caps"."main"."fct_rewards__dbt_tmp"
  
    as (
      with e as (
  select *
  from "carton_caps"."main"."stg_events"
),

awards as (
  select
    referral_id,
    user_id,
    event_at as awarded_at,
    -- reward_type is inside metadata_json like {"reward_type":"referrer_bonus"}
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_awarded'
),

redeems as (
  select
    referral_id,
    user_id,
    event_at as redeemed_at,
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_redeemed'
)

select
  -- deterministic surrogate key
  md5(cast(a.referral_id as varchar) || '|' || cast(a.user_id as varchar) || '|' || coalesce(a.reward_type,'')) as reward_id,
  a.referral_id,
  a.user_id,
  a.reward_type,
  a.awarded_at,
  min(r.redeemed_at) as redeemed_at
from awards a
left join redeems r
  on a.referral_id = r.referral_id
  and a.user_id = r.user_id
  and coalesce(a.reward_type,'') = coalesce(r.reward_type,'')
group by 1,2,3,4,5
    );
  
  
[0m14:17:05.243654 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: BEGIN
[0m14:17:05.243654 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m14:17:05.243654 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m14:17:05.244716 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:17:05.244716 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.dim_school
[0m14:17:05.245716 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

  
    
    

    create  table
      "carton_caps"."main"."fct_referral__dbt_tmp"
  
    as (
      with r as (
  select *
  from "carton_caps"."main"."stg_referrals"
),

e as (
  select *
  from "carton_caps"."main"."stg_events"
),

-- Referral-related event timestamps for referred users
ref_events as (
  select
    referral_id,
    user_id,

    min(case when event_type = 'install' then event_at end) as install_at,
    min(case when event_type = 'referral_applied' then event_at end) as referral_applied_at,
    min(case when event_type = 'onboarding_complete' then event_at end) as onboarding_completed_at,
    min(case when event_type = 'school_linked' then event_at end) as school_linked_at

  from e
  where referral_id is not null
  group by 1,2
),

-- First scan/purchase time for referred users (proxy for qualifying action)
first_purchase as (
  select
    user_id,
    min(purchased_at) as first_purchase_at
  from "carton_caps"."main"."stg_purchases"
  group by 1
)

select
  r.referral_id,
  r.referrer_user_id,
  r.referred_email,
  r.referred_user_id,
  r.referral_code,
  r.sent_at,
  r.converted_at,
  r.status,

  re.install_at,
  re.referral_applied_at,
  re.onboarding_completed_at,
  re.school_linked_at,

  fp.first_purchase_at,

  -- qualifying action is: first_purchase OR school_linked (whichever happens first)
  least(fp.first_purchase_at, re.school_linked_at) as qualifying_action_at,

  -- window compliance (48 hours) using install -> referral_applied
  case
    when re.install_at is null or re.referral_applied_at is null then null
    when datediff('hour', re.install_at, re.referral_applied_at) <= 48 then true
    else false
  end as within_48h_window,

  -- simple eligibility (rules-compliant posture)
  case
    when r.status <> 'converted' then false
    when re.onboarding_completed_at is null then false
    when least(fp.first_purchase_at, re.school_linked_at) is null then false
    when re.install_at is null or re.referral_applied_at is null then false
    when datediff('hour', re.install_at, re.referral_applied_at) > 48 then false
    else true
  end as eligible_referral

from r
left join ref_events re
  on r.referral_id = re.referral_id
  and r.referred_user_id = re.user_id
left join first_purchase fp
  on r.referred_user_id = fp.user_id
    );
  
  
[0m14:17:05.245716 [info ] [Thread-3 (]: 27 of 41 START sql table model main.dim_school ................................. [RUN]
[0m14:17:05.246715 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.246715 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b, now model.dbt_carton_caps.dim_school)
[0m14:17:05.246715 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m14:17:05.246715 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.dim_school
[0m14:17:05.247717 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

  
    
    

    create  table
      "carton_caps"."main"."dim_product__dbt_tmp"
  
    as (
      select
  product_id,
  name,
  category,
  price,
  points_per_dollar,
  created_at
from "carton_caps"."main"."stg_products"
    );
  
  
[0m14:17:05.248715 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_school"
[0m14:17:05.251246 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.252284 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.dim_school
[0m14:17:05.252284 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:17:05.255282 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m14:17:05.257797 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_school"
[0m14:17:05.259556 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m14:17:05.259556 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m14:17:05.259556 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */
alter table "carton_caps"."main"."dim_product__dbt_tmp" rename to "dim_product"
[0m14:17:05.259556 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */
alter table "carton_caps"."main"."fct_rewards__dbt_tmp" rename to "fct_rewards"
[0m14:17:05.259556 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m14:17:05.259556 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */
alter table "carton_caps"."main"."fct_referral__dbt_tmp" rename to "fct_referral"
[0m14:17:05.259556 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.259556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.259556 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m14:17:05.264966 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.266764 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m14:17:05.267763 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m14:17:05.267763 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_school: BEGIN
[0m14:17:05.268763 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m14:17:05.269763 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m14:17:05.269763 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m14:17:05.269763 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:17:05.269763 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m14:17:05.269763 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m14:17:05.270763 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m14:17:05.271426 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m14:17:05.271426 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.271426 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m14:17:05.272431 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

  
    
    

    create  table
      "carton_caps"."main"."dim_school__dbt_tmp"
  
    as (
      select
  school_id,
  name,
  address,
  city,
  state,
  zip_code,
  created_at
from "carton_caps"."main"."stg_schools"
    );
  
  
[0m14:17:05.272431 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.273431 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m14:17:05.273431 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

      drop table if exists "carton_caps"."main"."dim_product__dbt_backup" cascade
    
[0m14:17:05.273431 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:17:05.273431 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.273431 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m14:17:05.278765 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m14:17:05.278765 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.278765 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m14:17:05.278765 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

      drop table if exists "carton_caps"."main"."fct_rewards__dbt_backup" cascade
    
[0m14:17:05.278765 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m14:17:05.278765 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: Close
[0m14:17:05.278765 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */
alter table "carton_caps"."main"."dim_school__dbt_tmp" rename to "dim_school"
[0m14:17:05.278765 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

      drop table if exists "carton_caps"."main"."fct_referral__dbt_backup" cascade
    
[0m14:17:05.278765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:17:05.278765 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279A09623F0>]}
[0m14:17:05.278765 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_rewards: Close
[0m14:17:05.278765 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.285309 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.285309 [info ] [Thread-2 (]: 26 of 41 OK created sql table model main.dim_product ........................... [[32mOK[0m in 0.05s]
[0m14:17:05.286314 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m14:17:05.286314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279A0954860>]}
[0m14:17:05.287314 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_referral: Close
[0m14:17:05.287314 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.dim_product
[0m14:17:05.287314 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m14:17:05.288314 [info ] [Thread-1 (]: 24 of 41 OK created sql table model main.fct_rewards ........................... [[32mOK[0m in 0.08s]
[0m14:17:05.288314 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.dim_user
[0m14:17:05.288314 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279A08E0770>]}
[0m14:17:05.289314 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m14:17:05.289314 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.fct_rewards
[0m14:17:05.289314 [info ] [Thread-2 (]: 28 of 41 START sql table model main.dim_user ................................... [RUN]
[0m14:17:05.290313 [info ] [Thread-4 (]: 25 of 41 OK created sql table model main.fct_referral .......................... [[32mOK[0m in 0.07s]
[0m14:17:05.290313 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.fct_purchase
[0m14:17:05.291314 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_product, now model.dbt_carton_caps.dim_user)
[0m14:17:05.291314 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.fct_referral
[0m14:17:05.292313 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.292313 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.dim_user
[0m14:17:05.291314 [info ] [Thread-1 (]: 29 of 41 START sql table model main.fct_purchase ............................... [RUN]
[0m14:17:05.292313 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m14:17:05.294332 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m14:17:05.295332 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_user"
[0m14:17:05.296331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_rewards, now model.dbt_carton_caps.fct_purchase)
[0m14:17:05.296331 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

      drop table if exists "carton_caps"."main"."dim_school__dbt_backup" cascade
    
[0m14:17:05.296331 [info ] [Thread-4 (]: 30 of 41 START test not_null_dim_product_product_id ............................ [RUN]
[0m14:17:05.297335 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.fct_purchase
[0m14:17:05.297335 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_referral, now test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816)
[0m14:17:05.297335 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.dim_user
[0m14:17:05.299335 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_purchase"
[0m14:17:05.299335 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.300464 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m14:17:05.302465 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_user"
[0m14:17:05.303466 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_school: Close
[0m14:17:05.305464 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m14:17:05.306465 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.fct_purchase
[0m14:17:05.306465 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279A08E1910>]}
[0m14:17:05.308463 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_purchase"
[0m14:17:05.309464 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m14:17:05.309464 [info ] [Thread-3 (]: 27 of 41 OK created sql table model main.dim_school ............................ [[32mOK[0m in 0.06s]
[0m14:17:05.309464 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: BEGIN
[0m14:17:05.310465 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.dim_school
[0m14:17:05.310465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:17:05.310465 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m14:17:05.311464 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m14:17:05.311464 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m14:17:05.312569 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m14:17:05.313572 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.313572 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: BEGIN
[0m14:17:05.313572 [info ] [Thread-3 (]: 31 of 41 START test unique_dim_product_product_id .............................. [RUN]
[0m14:17:05.314568 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m14:17:05.314568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:05.314568 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_school, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m14:17:05.314568 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

  
    
    

    create  table
      "carton_caps"."main"."dim_user__dbt_tmp"
  
    as (
      select
  u.user_id,
  u.first_name,
  u.last_name,
  u.email,
  u.school_id,
  s.name as school_name,
  s.state as school_state,
  u.created_at,
  u.user_type,
  u.is_verified,
  u.device_id,
  u.marketing_channel
from "carton_caps"."main"."stg_users" u
left join "carton_caps"."main"."stg_schools" s
  on u.school_id = s.school_id
    );
  
  
[0m14:17:05.315702 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m14:17:05.315702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.316702 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m14:17:05.318703 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m14:17:05.319701 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m14:17:05.319701 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:17:05.319701 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m14:17:05.319701 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

  
    
    

    create  table
      "carton_caps"."main"."fct_purchase__dbt_tmp"
  
    as (
      select
  p.purchase_id,
  p.user_id,
  u.school_id,
  p.product_id,
  pr.category as product_category,
  p.quantity,
  p.price_paid,
  p.points_earned,
  p.purchased_at,
  date_trunc('day', p.purchased_at) as purchase_date,
  p.day_of_week,
  p.hour_of_day
from "carton_caps"."main"."stg_purchases" p
left join "carton_caps"."main"."stg_users" u
  on p.user_id = u.user_id
left join "carton_caps"."main"."stg_products" pr
  on p.product_id = pr.product_id
    );
  
  
[0m14:17:05.322703 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m14:17:05.322703 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:17:05.323703 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m14:17:05.323703 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */
alter table "carton_caps"."main"."dim_user__dbt_tmp" rename to "dim_user"
[0m14:17:05.325701 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m14:17:05.325701 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.326701 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m14:17:05.326701 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.326701 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.328701 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m14:17:05.328701 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m14:17:05.328701 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.328701 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m14:17:05.329702 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:17:05.329702 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m14:17:05.330701 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m14:17:05.330701 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m14:17:05.333081 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m14:17:05.333513 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.333513 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m14:17:05.334518 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */
alter table "carton_caps"."main"."fct_purchase__dbt_tmp" rename to "fct_purchase"
[0m14:17:05.334518 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:17:05.335518 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m14:17:05.336519 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m14:17:05.336903 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

      drop table if exists "carton_caps"."main"."dim_user__dbt_backup" cascade
    
[0m14:17:05.337218 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.337218 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.337218 [info ] [Thread-4 (]: 30 of 41 PASS not_null_dim_product_product_id .................................. [[32mPASS[0m in 0.04s]
[0m14:17:05.338223 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m14:17:05.338223 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m14:17:05.338223 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.338223 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m14:17:05.338223 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m14:17:05.340404 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:17:05.341509 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: Close
[0m14:17:05.341509 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m14:17:05.341509 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m14:17:05.341509 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279A2B044A0>]}
[0m14:17:05.341509 [info ] [Thread-4 (]: 32 of 41 START test not_null_fct_rewards_reward_id ............................. [RUN]
[0m14:17:05.343563 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.343563 [info ] [Thread-2 (]: 28 of 41 OK created sql table model main.dim_user .............................. [[32mOK[0m in 0.05s]
[0m14:17:05.343563 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m14:17:05.344569 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m14:17:05.344569 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.dim_user
[0m14:17:05.345569 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m14:17:05.345569 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.345569 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m14:17:05.346568 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m14:17:05.348569 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m14:17:05.350528 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m14:17:05.350528 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m14:17:05.350528 [info ] [Thread-2 (]: 33 of 41 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m14:17:05.351533 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

      drop table if exists "carton_caps"."main"."fct_purchase__dbt_backup" cascade
    
[0m14:17:05.351533 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_user, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m14:17:05.351533 [info ] [Thread-3 (]: 31 of 41 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.04s]
[0m14:17:05.352532 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m14:17:05.352532 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m14:17:05.353533 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m14:17:05.353533 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.355533 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m14:17:05.357532 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m14:17:05.357532 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m14:17:05.358299 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: Close
[0m14:17:05.359304 [info ] [Thread-3 (]: 34 of 41 START test not_null_fct_referral_referral_id .......................... [RUN]
[0m14:17:05.359304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9101917d-38be-4520-8fa3-430bbe7dbac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279A2B204A0>]}
[0m14:17:05.359304 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m14:17:05.360304 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m14:17:05.360304 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m14:17:05.360304 [info ] [Thread-1 (]: 29 of 41 OK created sql table model main.fct_purchase .......................... [[32mOK[0m in 0.06s]
[0m14:17:05.362305 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m14:17:05.362305 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m14:17:05.365311 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m14:17:05.365311 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.fct_purchase
[0m14:17:05.365311 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m14:17:05.366317 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m14:17:05.366317 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:17:05.367315 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m14:17:05.366317 [info ] [Thread-1 (]: 35 of 41 START test unique_fct_referral_referral_id ............................ [RUN]
[0m14:17:05.367315 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m14:17:05.367315 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m14:17:05.368316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_purchase, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m14:17:05.368316 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.371027 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m14:17:05.371027 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:17:05.371027 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m14:17:05.371027 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m14:17:05.371027 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m14:17:05.371027 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.371027 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:17:05.375609 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m14:17:05.375609 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:17:05.376374 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m14:17:05.376374 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.376374 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m14:17:05.377588 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m14:17:05.378588 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m14:17:05.378588 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:17:05.378588 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.380589 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m14:17:05.380589 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m14:17:05.381588 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.382549 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m14:17:05.382549 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m14:17:05.383089 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m14:17:05.383089 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m14:17:05.384176 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.384176 [info ] [Thread-4 (]: 32 of 41 PASS not_null_fct_rewards_reward_id ................................... [[32mPASS[0m in 0.04s]
[0m14:17:05.384176 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m14:17:05.385176 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m14:17:05.385176 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m14:17:05.385176 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m14:17:05.386176 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.386176 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m14:17:05.386176 [info ] [Thread-2 (]: 33 of 41 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.03s]
[0m14:17:05.387176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:05.388176 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m14:17:05.387176 [info ] [Thread-4 (]: 36 of 41 START test not_null_dim_school_school_id .............................. [RUN]
[0m14:17:05.388176 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m14:17:05.389176 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m14:17:05.389176 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b)
[0m14:17:05.389176 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.390176 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m14:17:05.390176 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m14:17:05.390176 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m14:17:05.390176 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m14:17:05.391177 [info ] [Thread-2 (]: 37 of 41 START test unique_dim_school_school_id ................................ [RUN]
[0m14:17:05.394175 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m14:17:05.394175 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:17:05.391177 [info ] [Thread-3 (]: 34 of 41 PASS not_null_fct_referral_referral_id ................................ [[32mPASS[0m in 0.03s]
[0m14:17:05.395175 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m14:17:05.395175 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m14:17:05.395175 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m14:17:05.396176 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m14:17:05.396176 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.398182 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m14:17:05.399181 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m14:17:05.399181 [info ] [Thread-3 (]: 38 of 41 START test not_null_dim_user_user_id .................................. [RUN]
[0m14:17:05.400181 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m14:17:05.402180 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m14:17:05.402180 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3)
[0m14:17:05.403180 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m14:17:05.403180 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m14:17:05.403180 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m14:17:05.404180 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m14:17:05.405180 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m14:17:05.407181 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m14:17:05.408179 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m14:17:05.408179 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m14:17:05.408179 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:17:05.408179 [info ] [Thread-1 (]: 35 of 41 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.04s]
[0m14:17:05.409898 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m14:17:05.409898 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m14:17:05.409898 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m14:17:05.409898 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m14:17:05.409898 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.411402 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m14:17:05.412407 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m14:17:05.413484 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m14:17:05.413159 [info ] [Thread-1 (]: 39 of 41 START test unique_dim_user_user_id .................................... [RUN]
[0m14:17:05.413842 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:17:05.413842 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.414533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m14:17:05.414888 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m14:17:05.414888 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m14:17:05.414888 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.414888 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.414888 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m14:17:05.417864 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m14:17:05.417864 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m14:17:05.417864 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:17:05.417864 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m14:17:05.417864 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:17:05.417864 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m14:17:05.417864 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.417864 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m14:17:05.417864 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m14:17:05.417864 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m14:17:05.417864 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m14:17:05.417864 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.424213 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.424213 [info ] [Thread-4 (]: 36 of 41 PASS not_null_dim_school_school_id .................................... [[32mPASS[0m in 0.04s]
[0m14:17:05.425220 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m14:17:05.425220 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m14:17:05.426219 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m14:17:05.426219 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.426219 [info ] [Thread-4 (]: 40 of 41 START test not_null_fct_purchase_purchase_id .......................... [RUN]
[0m14:17:05.427218 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m14:17:05.428218 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m14:17:05.428218 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1)
[0m14:17:05.428218 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m14:17:05.429218 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m14:17:05.429218 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m14:17:05.429218 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m14:17:05.429218 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m14:17:05.430218 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m14:17:05.430218 [info ] [Thread-2 (]: 37 of 41 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.04s]
[0m14:17:05.433993 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m14:17:05.434656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:05.434656 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m14:17:05.434656 [info ] [Thread-3 (]: 38 of 41 PASS not_null_dim_user_user_id ........................................ [[32mPASS[0m in 0.03s]
[0m14:17:05.435660 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m14:17:05.435660 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m14:17:05.436661 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.436661 [info ] [Thread-2 (]: 41 of 41 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m14:17:05.436661 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m14:17:05.436661 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m14:17:05.437661 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m14:17:05.437661 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:17:05.438660 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m14:17:05.439661 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m14:17:05.442804 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m14:17:05.442804 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:17:05.443804 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m14:17:05.443804 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m14:17:05.444804 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m14:17:05.444804 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m14:17:05.444804 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m14:17:05.445804 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:17:05.446803 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m14:17:05.447647 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m14:17:05.447647 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.447647 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m14:17:05.447647 [info ] [Thread-1 (]: 39 of 41 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.03s]
[0m14:17:05.447647 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m14:17:05.447647 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m14:17:05.449527 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m14:17:05.449527 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m14:17:05.450532 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:17:05.450532 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.450532 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:17:05.450532 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m14:17:05.451532 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m14:17:05.451532 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:17:05.452533 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m14:17:05.452533 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m14:17:05.453533 [info ] [Thread-4 (]: 40 of 41 PASS not_null_fct_purchase_purchase_id ................................ [[32mPASS[0m in 0.03s]
[0m14:17:05.453533 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m14:17:05.455004 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:17:05.455004 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m14:17:05.455004 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m14:17:05.455004 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m14:17:05.455004 [info ] [Thread-2 (]: 41 of 41 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.02s]
[0m14:17:05.457612 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m14:17:05.457612 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:05.458943 [debug] [MainThread]: On master: BEGIN
[0m14:17:05.458943 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:05.459509 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:05.459509 [debug] [MainThread]: On master: COMMIT
[0m14:17:05.459509 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:05.460183 [debug] [MainThread]: On master: COMMIT
[0m14:17:05.460183 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:05.460183 [debug] [MainThread]: On master: Close
[0m14:17:05.460183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:05.460183 [debug] [MainThread]: Connection 'create_carton_caps_main' was properly closed.
[0m14:17:05.461187 [debug] [MainThread]: Connection 'list_carton_caps_main' was properly closed.
[0m14:17:05.461187 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278' was properly closed.
[0m14:17:05.461187 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a' was properly closed.
[0m14:17:05.461187 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3' was properly closed.
[0m14:17:05.461187 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1' was properly closed.
[0m14:17:05.462188 [info ] [MainThread]: 
[0m14:17:05.462188 [info ] [MainThread]: Finished running 6 table models, 29 data tests, 6 view models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m14:17:05.465187 [debug] [MainThread]: Command end result
[0m14:17:05.520439 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m14:17:05.522736 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m14:17:05.526656 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\run_results.json
[0m14:17:05.526656 [info ] [MainThread]: 
[0m14:17:05.527655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:05.527655 [info ] [MainThread]: 
[0m14:17:05.527655 [info ] [MainThread]: Done. PASS=41 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=41
[0m14:17:05.528399 [debug] [MainThread]: Command `dbt build` succeeded at 14:17:05.528399 after 1.70 seconds
[0m14:17:05.528399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002799ACF6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002799E71DA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002799E98BB60>]}
[0m14:17:05.528399 [debug] [MainThread]: Flushing usage events
[0m14:17:05.927317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:33:33.766667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221B38685C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221B33C6630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221B386AF60>]}


============================== 14:33:33.770773 | a726ef16-ab64-4869-9919-eeea8d3f224d ==============================
[0m14:33:33.770773 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:33:33.771285 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt parse --profiles-dir .', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m14:33:33.906034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a726ef16-ab64-4869-9919-eeea8d3f224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221B53E3020>]}
[0m14:33:33.951385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a726ef16-ab64-4869-9919-eeea8d3f224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221B345E120>]}
[0m14:33:33.953132 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:33:34.110290 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:33:34.190498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:33:34.190498 [debug] [MainThread]: Partial parsing: added file: dbt_carton_caps://models\exposures.yml
[0m14:33:34.270996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a726ef16-ab64-4869-9919-eeea8d3f224d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221B58703E0>]}
[0m14:33:34.273002 [info ] [MainThread]: Performance info: C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\perf_info.json
[0m14:33:34.320477 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m14:33:34.328455 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m14:33:34.328455 [debug] [MainThread]: Command `dbt parse` succeeded at 14:33:34.328455 after 0.73 seconds
[0m14:33:34.328455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221B58BF770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221B323C980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221B323CD10>]}
[0m14:33:34.328455 [debug] [MainThread]: Flushing usage events
[0m14:33:34.685481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:15.355408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C685F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C6477770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C6474920>]}


============================== 14:35:15.363032 | 4b8bbc0a-c3ea-4c3b-abff-54131010bf51 ==============================
[0m14:35:15.363032 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:35:15.363032 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m14:35:15.503661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b8bbc0a-c3ea-4c3b-abff-54131010bf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C83A5DC0>]}
[0m14:35:15.535420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b8bbc0a-c3ea-4c3b-abff-54131010bf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C6DEE150>]}
[0m14:35:15.535420 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:35:15.690212 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:35:15.804322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:35:15.806327 [debug] [MainThread]: Partial parsing: added file: dbt_carton_caps://tests\test_events_in_window.sql
[0m14:35:15.924482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b8bbc0a-c3ea-4c3b-abff-54131010bf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C8953FB0>]}
[0m14:35:15.972323 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m14:35:15.972323 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m14:35:16.002212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b8bbc0a-c3ea-4c3b-abff-54131010bf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C8A8DE20>]}
[0m14:35:16.002212 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m14:35:16.004196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b8bbc0a-c3ea-4c3b-abff-54131010bf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C830C170>]}
[0m14:35:16.004196 [info ] [MainThread]: 
[0m14:35:16.004196 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:35:16.004196 [info ] [MainThread]: 
[0m14:35:16.004196 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:35:16.004196 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_main'
[0m14:35:16.057528 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_main"
[0m14:35:16.057528 [debug] [ThreadPool]: On list_carton_caps_main: BEGIN
[0m14:35:16.057528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:16.067568 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m14:35:16.069573 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_main"
[0m14:35:16.069573 [debug] [ThreadPool]: On list_carton_caps_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_main"} */
select
      'carton_caps' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps'
  
[0m14:35:16.078588 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:35:16.078588 [debug] [ThreadPool]: On list_carton_caps_main: ROLLBACK
[0m14:35:16.078588 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_main'
[0m14:35:16.080594 [debug] [ThreadPool]: On list_carton_caps_main: Close
[0m14:35:16.080594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b8bbc0a-c3ea-4c3b-abff-54131010bf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C8738890>]}
[0m14:35:16.080594 [debug] [MainThread]: Using duckdb connection "master"
[0m14:35:16.080594 [debug] [MainThread]: On master: BEGIN
[0m14:35:16.080594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:16.080594 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:35:16.080594 [debug] [MainThread]: On master: COMMIT
[0m14:35:16.080594 [debug] [MainThread]: Using duckdb connection "master"
[0m14:35:16.080594 [debug] [MainThread]: On master: COMMIT
[0m14:35:16.080594 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:35:16.080594 [debug] [MainThread]: On master: Close
[0m14:35:16.080594 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m14:35:16.080594 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m14:35:16.080594 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m14:35:16.080594 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m14:35:16.080594 [info ] [Thread-1 (]: 1 of 30 START test not_null_dim_product_product_id ............................. [RUN]
[0m14:35:16.080594 [info ] [Thread-2 (]: 2 of 30 START test not_null_dim_school_school_id ............................... [RUN]
[0m14:35:16.080594 [info ] [Thread-3 (]: 3 of 30 START test not_null_dim_user_user_id ................................... [RUN]
[0m14:35:16.080594 [info ] [Thread-4 (]: 4 of 30 START test not_null_fct_purchase_purchase_id ........................... [RUN]
[0m14:35:16.080594 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m14:35:16.080594 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m14:35:16.080594 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m14:35:16.080594 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m14:35:16.080594 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m14:35:16.080594 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m14:35:16.080594 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m14:35:16.080594 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m14:35:16.135585 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m14:35:16.138584 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m14:35:16.140584 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m14:35:16.142586 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m14:35:16.142586 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m14:35:16.152769 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m14:35:16.154829 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m14:35:16.155831 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m14:35:16.155831 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m14:35:16.156829 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m14:35:16.157830 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m14:35:16.158831 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m14:35:16.159831 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m14:35:16.159831 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m14:35:16.159831 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m14:35:16.159831 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m14:35:16.159831 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:35:16.159831 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:35:16.159831 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m14:35:16.159831 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m14:35:16.159831 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m14:35:16.159831 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.159831 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m14:35:16.159831 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.159831 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:35:16.159831 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m14:35:16.159831 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:35:16.159831 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m14:35:16.159831 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.159831 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.159831 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.159831 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.159831 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m14:35:16.159831 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m14:35:16.159831 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.159831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.159831 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.159831 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.159831 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m14:35:16.159831 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m14:35:16.159831 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:35:16.159831 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m14:35:16.159831 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m14:35:16.159831 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.159831 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m14:35:16.159831 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m14:35:16.159831 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m14:35:16.159831 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m14:35:16.159831 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m14:35:16.159831 [info ] [Thread-1 (]: 1 of 30 PASS not_null_dim_product_product_id ................................... [[32mPASS[0m in 0.08s]
[0m14:35:16.175639 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m14:35:16.175639 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m14:35:16.159831 [info ] [Thread-2 (]: 2 of 30 PASS not_null_dim_school_school_id ..................................... [[32mPASS[0m in 0.08s]
[0m14:35:16.175639 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m14:35:16.175639 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m14:35:16.175639 [info ] [Thread-3 (]: 3 of 30 PASS not_null_dim_user_user_id ......................................... [[32mPASS[0m in 0.10s]
[0m14:35:16.175639 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m14:35:16.175639 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m14:35:16.175639 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m14:35:16.175639 [info ] [Thread-4 (]: 4 of 30 PASS not_null_fct_purchase_purchase_id ................................. [[32mPASS[0m in 0.10s]
[0m14:35:16.175639 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m14:35:16.175639 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m14:35:16.175639 [info ] [Thread-1 (]: 5 of 30 START test not_null_fct_referral_referral_id ........................... [RUN]
[0m14:35:16.175639 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m14:35:16.175639 [info ] [Thread-2 (]: 6 of 30 START test not_null_fct_rewards_reward_id .............................. [RUN]
[0m14:35:16.175639 [info ] [Thread-3 (]: 7 of 30 START test not_null_stg_events_event_id ................................ [RUN]
[0m14:35:16.175639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m14:35:16.175639 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m14:35:16.175639 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m14:35:16.175639 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m14:35:16.175639 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m14:35:16.175639 [info ] [Thread-4 (]: 8 of 30 START test not_null_stg_events_user_id ................................. [RUN]
[0m14:35:16.175639 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m14:35:16.175639 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m14:35:16.184007 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m14:35:16.184007 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m14:35:16.186645 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m14:35:16.186645 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m14:35:16.186645 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m14:35:16.191610 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m14:35:16.192800 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m14:35:16.194798 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m14:35:16.194798 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m14:35:16.194798 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m14:35:16.196798 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m14:35:16.197798 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m14:35:16.197798 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m14:35:16.199799 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m14:35:16.199799 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m14:35:16.199799 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m14:35:16.200798 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m14:35:16.200798 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m14:35:16.200798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:16.201798 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m14:35:16.201798 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m14:35:16.201798 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m14:35:16.202798 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:35:16.202798 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:35:16.202798 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.202798 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m14:35:16.203798 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m14:35:16.203798 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.203798 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:35:16.204797 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.204797 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.204797 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m14:35:16.204797 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m14:35:16.205798 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.205798 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.205798 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.205798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.206854 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m14:35:16.206854 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:35:16.207854 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.207854 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m14:35:16.208855 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.209856 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m14:35:16.209856 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m14:35:16.210855 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.211855 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m14:35:16.211855 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m14:35:16.211855 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m14:35:16.212854 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m14:35:16.212854 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m14:35:16.213854 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m14:35:16.214854 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m14:35:16.213854 [info ] [Thread-1 (]: 5 of 30 PASS not_null_fct_referral_referral_id ................................. [[32mPASS[0m in 0.04s]
[0m14:35:16.215855 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m14:35:16.214854 [info ] [Thread-2 (]: 6 of 30 PASS not_null_fct_rewards_reward_id .................................... [[32mPASS[0m in 0.04s]
[0m14:35:16.215855 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m14:35:16.215855 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m14:35:16.216854 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m14:35:16.216854 [info ] [Thread-3 (]: 7 of 30 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.04s]
[0m14:35:16.217854 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m14:35:16.216854 [info ] [Thread-4 (]: 8 of 30 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m14:35:16.217854 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m14:35:16.217854 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m14:35:16.218854 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m14:35:16.218854 [info ] [Thread-1 (]: 9 of 30 START test not_null_stg_products_product_id ............................ [RUN]
[0m14:35:16.218854 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m14:35:16.218854 [info ] [Thread-2 (]: 10 of 30 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m14:35:16.219855 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m14:35:16.219855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m14:35:16.219855 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m14:35:16.219855 [info ] [Thread-3 (]: 11 of 30 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m14:35:16.220856 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m14:35:16.220856 [info ] [Thread-4 (]: 12 of 30 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m14:35:16.220856 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m14:35:16.221856 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m14:35:16.224856 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m14:35:16.224856 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m14:35:16.230981 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m14:35:16.230350 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m14:35:16.230981 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m14:35:16.236253 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m14:35:16.239724 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m14:35:16.239724 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m14:35:16.239724 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m14:35:16.244104 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m14:35:16.244104 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m14:35:16.244104 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m14:35:16.249211 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m14:35:16.249211 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m14:35:16.250895 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m14:35:16.253012 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m14:35:16.253012 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m14:35:16.253012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:16.255020 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m14:35:16.255020 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m14:35:16.255020 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:35:16.255020 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.255020 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m14:35:16.256866 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m14:35:16.256866 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m14:35:16.256866 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m14:35:16.256866 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.256866 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.256866 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m14:35:16.256866 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:35:16.256866 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m14:35:16.256866 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:35:16.256866 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.256866 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.256866 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.256866 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.256866 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m14:35:16.256866 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m14:35:16.256866 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m14:35:16.256866 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.256866 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.256866 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.256866 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m14:35:16.263780 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m14:35:16.263780 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m14:35:16.263780 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.263780 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m14:35:16.263780 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.263780 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m14:35:16.263780 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m14:35:16.263780 [info ] [Thread-1 (]: 9 of 30 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.04s]
[0m14:35:16.263780 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m14:35:16.263780 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m14:35:16.263780 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m14:35:16.263780 [info ] [Thread-2 (]: 10 of 30 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.04s]
[0m14:35:16.263780 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m14:35:16.263780 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m14:35:16.263780 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m14:35:16.270736 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m14:35:16.270736 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m14:35:16.270736 [info ] [Thread-4 (]: 12 of 30 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.05s]
[0m14:35:16.270736 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m14:35:16.270736 [info ] [Thread-1 (]: 13 of 30 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m14:35:16.272512 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m14:35:16.272512 [info ] [Thread-3 (]: 11 of 30 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.05s]
[0m14:35:16.273517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m14:35:16.272512 [info ] [Thread-2 (]: 14 of 30 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m14:35:16.273517 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m14:35:16.273517 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m14:35:16.273517 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m14:35:16.274516 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m14:35:16.274516 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m14:35:16.274516 [info ] [Thread-4 (]: 15 of 30 START test not_null_stg_schools_school_id ............................. [RUN]
[0m14:35:16.277519 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m14:35:16.277519 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m14:35:16.278662 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m14:35:16.277519 [info ] [Thread-3 (]: 16 of 30 START test not_null_stg_users_school_id ............................... [RUN]
[0m14:35:16.280137 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m14:35:16.281137 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m14:35:16.281137 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m14:35:16.283136 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m14:35:16.284136 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m14:35:16.284136 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m14:35:16.286627 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m14:35:16.287129 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m14:35:16.288134 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m14:35:16.290134 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m14:35:16.290134 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m14:35:16.291135 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m14:35:16.292135 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m14:35:16.293946 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m14:35:16.293946 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m14:35:16.293946 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m14:35:16.293946 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m14:35:16.293946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:16.293946 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m14:35:16.293946 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m14:35:16.293946 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m14:35:16.293946 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m14:35:16.293946 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:35:16.293946 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.293946 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m14:35:16.293946 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:35:16.298511 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m14:35:16.298511 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:35:16.299019 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.299019 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.299019 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.299019 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m14:35:16.299019 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.299019 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m14:35:16.299019 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.299019 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m14:35:16.299019 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.299019 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.299019 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.299019 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m14:35:16.299019 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.299019 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m14:35:16.299019 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.299019 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m14:35:16.305437 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m14:35:16.305437 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:35:16.305437 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m14:35:16.305437 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m14:35:16.305437 [info ] [Thread-1 (]: 13 of 30 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.03s]
[0m14:35:16.305437 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m14:35:16.305437 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m14:35:16.305437 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m14:35:16.305437 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m14:35:16.305437 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m14:35:16.305437 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m14:35:16.305437 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m14:35:16.305437 [info ] [Thread-2 (]: 14 of 30 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.03s]
[0m14:35:16.305437 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m14:35:16.305437 [info ] [Thread-3 (]: 16 of 30 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.02s]
[0m14:35:16.305437 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m14:35:16.305437 [info ] [Thread-1 (]: 17 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m14:35:16.312379 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m14:35:16.312379 [info ] [Thread-4 (]: 15 of 30 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.03s]
[0m14:35:16.312379 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m14:35:16.313385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m14:35:16.313385 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m14:35:16.313385 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m14:35:16.314383 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m14:35:16.313385 [info ] [Thread-2 (]: 18 of 30 START test test_events_in_window ...................................... [RUN]
[0m14:35:16.314383 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m14:35:16.314383 [info ] [Thread-3 (]: 19 of 30 START test unique_dim_product_product_id .............................. [RUN]
[0m14:35:16.317421 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m14:35:16.317421 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.test_events_in_window)
[0m14:35:16.317421 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m14:35:16.317421 [info ] [Thread-4 (]: 20 of 30 START test unique_dim_school_school_id ................................ [RUN]
[0m14:35:16.317421 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m14:35:16.319088 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m14:35:16.319088 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m14:35:16.321464 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m14:35:16.321464 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m14:35:16.324489 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m14:35:16.324489 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m14:35:16.327416 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m14:35:16.329823 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m14:35:16.330333 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m14:35:16.331491 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m14:35:16.332008 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m14:35:16.332525 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m14:35:16.332525 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m14:35:16.333040 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m14:35:16.334370 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m14:35:16.335995 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m14:35:16.335995 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m14:35:16.335995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:16.337025 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m14:35:16.337540 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:35:16.337540 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m14:35:16.338057 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.338057 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m14:35:16.338573 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.338573 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m14:35:16.339091 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m14:35:16.339091 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:35:16.339606 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m14:35:16.339606 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:16.339606 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m14:35:16.340610 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:35:16.340610 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.340610 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:35:16.340610 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.341610 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m14:35:16.341610 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:35:16.342611 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m14:35:16.343611 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.343611 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.343611 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m14:35:16.344610 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m14:35:16.344913 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m14:35:16.344913 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.345914 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m14:35:16.345914 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fails if more than 0.5% of events are outside the analytics window (sanity check)
with bounds as (
  select
    timestamp '2024-01-01' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
out_of_window as (
  select count(*) as cnt
  from "carton_caps"."main"."stg_events", bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from "carton_caps"."main"."stg_events"
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.005
  
  
      
    ) dbt_internal_test
[0m14:35:16.347483 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m14:35:16.347483 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m14:35:16.346915 [info ] [Thread-1 (]: 17 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m14:35:16.349488 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m14:35:16.349488 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m14:35:16.349488 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m14:35:16.349488 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m14:35:16.349488 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.349488 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m14:35:16.349488 [info ] [Thread-3 (]: 19 of 30 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.03s]
[0m14:35:16.352481 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m14:35:16.349488 [info ] [Thread-4 (]: 20 of 30 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m14:35:16.352481 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m14:35:16.349488 [info ] [Thread-1 (]: 21 of 30 START test unique_dim_user_user_id .................................... [RUN]
[0m14:35:16.353486 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m14:35:16.353486 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m14:35:16.353486 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m14:35:16.354487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m14:35:16.354487 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m14:35:16.354487 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m14:35:16.355486 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m14:35:16.354487 [info ] [Thread-3 (]: 22 of 30 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m14:35:16.355486 [info ] [Thread-4 (]: 23 of 30 START test unique_fct_referral_referral_id ............................ [RUN]
[0m14:35:16.357274 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m14:35:16.357274 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m14:35:16.356194 [error] [Thread-2 (]: 18 of 30 FAIL 1 test_events_in_window .......................................... [[31mFAIL 1[0m in 0.04s]
[0m14:35:16.357274 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m14:35:16.359958 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m14:35:16.359958 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m14:35:16.359958 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m14:35:16.364362 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m14:35:16.364362 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m14:35:16.364362 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m14:35:16.365362 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m14:35:16.368310 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m14:35:16.368310 [info ] [Thread-2 (]: 24 of 30 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m14:35:16.368310 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m14:35:16.368310 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m14:35:16.368310 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m14:35:16.368310 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m14:35:16.368310 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m14:35:16.368310 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m14:35:16.368310 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m14:35:16.374900 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m14:35:16.374900 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m14:35:16.375904 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m14:35:16.375904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:16.375904 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m14:35:16.376904 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m14:35:16.376904 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:35:16.376904 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m14:35:16.376904 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.378992 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m14:35:16.378992 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m14:35:16.378992 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m14:35:16.379993 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:35:16.379993 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:35:16.379993 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:35:16.379993 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m14:35:16.380993 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m14:35:16.380993 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.381880 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:35:16.382305 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m14:35:16.382305 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m14:35:16.382305 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:35:16.382305 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.383326 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:35:16.385326 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m14:35:16.385326 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:35:16.385326 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m14:35:16.386326 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:35:16.386326 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:35:16.386326 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m14:35:16.387325 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m14:35:16.387325 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m14:35:16.388325 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m14:35:16.388788 [info ] [Thread-1 (]: 21 of 30 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.03s]
[0m14:35:16.389520 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m14:35:16.389520 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:35:16.390531 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m14:35:16.390531 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m14:35:16.391114 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m14:35:16.391114 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m14:35:16.391114 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m14:35:16.392161 [info ] [Thread-4 (]: 23 of 30 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.03s]
[0m14:35:16.393160 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m14:35:16.392161 [info ] [Thread-1 (]: 25 of 30 START test unique_stg_events_event_id ................................. [RUN]
[0m14:35:16.394160 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m14:35:16.394160 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:35:16.394160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m14:35:16.393160 [info ] [Thread-3 (]: 22 of 30 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.03s]
[0m14:35:16.395160 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m14:35:16.395160 [info ] [Thread-4 (]: 26 of 30 START test unique_stg_products_product_id ............................. [RUN]
[0m14:35:16.395506 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m14:35:16.396749 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m14:35:16.398451 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m14:35:16.398451 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m14:35:16.398451 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m14:35:16.398451 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m14:35:16.398451 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m14:35:16.398451 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m14:35:16.403066 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m14:35:16.398451 [info ] [Thread-3 (]: 27 of 30 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m14:35:16.403066 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m14:35:16.403066 [info ] [Thread-2 (]: 24 of 30 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.03s]
[0m14:35:16.403066 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m14:35:16.403066 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m14:35:16.403066 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m14:35:16.403066 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m14:35:16.403066 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m14:35:16.403066 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m14:35:16.409613 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m14:35:16.411696 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m14:35:16.412694 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m14:35:16.412694 [info ] [Thread-2 (]: 28 of 30 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m14:35:16.412694 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m14:35:16.413695 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m14:35:16.413695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:16.413695 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m14:35:16.414694 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m14:35:16.414694 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m14:35:16.416695 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m14:35:16.417696 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m14:35:16.417696 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:35:16.418695 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m14:35:16.419694 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:35:16.419694 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m14:35:16.419694 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m14:35:16.420694 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:35:16.421694 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m14:35:16.421694 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:35:16.422694 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m14:35:16.422694 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m14:35:16.422694 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m14:35:16.423694 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:35:16.423694 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:35:16.424695 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m14:35:16.425694 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:35:16.425694 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m14:35:16.425694 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.425694 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:35:16.426695 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:35:16.427696 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m14:35:16.427696 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m14:35:16.428584 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m14:35:16.429623 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m14:35:16.429623 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:35:16.429623 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:35:16.430623 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m14:35:16.430623 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m14:35:16.431250 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m14:35:16.431250 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m14:35:16.431975 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:35:16.431975 [info ] [Thread-1 (]: 25 of 30 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m14:35:16.432981 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.432981 [info ] [Thread-4 (]: 26 of 30 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m14:35:16.433980 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m14:35:16.433980 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m14:35:16.433980 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m14:35:16.434984 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m14:35:16.434984 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:35:16.435984 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m14:35:16.435984 [info ] [Thread-1 (]: 29 of 30 START test unique_stg_schools_school_id ............................... [RUN]
[0m14:35:16.436984 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m14:35:16.437390 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m14:35:16.438392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m14:35:16.437390 [info ] [Thread-4 (]: 30 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m14:35:16.438392 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m14:35:16.439250 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m14:35:16.439250 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m14:35:16.439250 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m14:35:16.439250 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m14:35:16.442549 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m14:35:16.440551 [info ] [Thread-3 (]: 27 of 30 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.04s]
[0m14:35:16.442549 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m14:35:16.443550 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m14:35:16.443550 [info ] [Thread-2 (]: 28 of 30 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m14:35:16.446656 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m14:35:16.446656 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m14:35:16.446656 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m14:35:16.448661 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m14:35:16.448661 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m14:35:16.450163 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m14:35:16.450163 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m14:35:16.451166 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m14:35:16.451166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:16.451166 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m14:35:16.452167 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m14:35:16.452167 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.452167 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:35:16.452167 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m14:35:16.453168 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:35:16.453168 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.453168 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m14:35:16.453168 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:35:16.453168 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.453168 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m14:35:16.453168 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:35:16.453168 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m14:35:16.453168 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m14:35:16.453168 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m14:35:16.453168 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m14:35:16.458619 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m14:35:16.458227 [info ] [Thread-1 (]: 29 of 30 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.02s]
[0m14:35:16.458619 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m14:35:16.459285 [info ] [Thread-4 (]: 30 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.02s]
[0m14:35:16.459285 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m14:35:16.460289 [debug] [MainThread]: Using duckdb connection "master"
[0m14:35:16.460289 [debug] [MainThread]: On master: BEGIN
[0m14:35:16.460289 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:35:16.461289 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:35:16.461289 [debug] [MainThread]: On master: COMMIT
[0m14:35:16.461289 [debug] [MainThread]: Using duckdb connection "master"
[0m14:35:16.461289 [debug] [MainThread]: On master: COMMIT
[0m14:35:16.462288 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:35:16.462288 [debug] [MainThread]: On master: Close
[0m14:35:16.462288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:16.462288 [debug] [MainThread]: Connection 'list_carton_caps_main' was properly closed.
[0m14:35:16.462288 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6' was properly closed.
[0m14:35:16.462288 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d' was properly closed.
[0m14:35:16.463290 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103' was properly closed.
[0m14:35:16.463290 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m14:35:16.463290 [info ] [MainThread]: 
[0m14:35:16.463290 [info ] [MainThread]: Finished running 30 data tests in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m14:35:16.466171 [debug] [MainThread]: Command end result
[0m14:35:16.480531 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m14:35:16.480531 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m14:35:16.486364 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\run_results.json
[0m14:35:16.486364 [info ] [MainThread]: 
[0m14:35:16.486364 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:35:16.486364 [info ] [MainThread]: 
[0m14:35:16.486364 [error] [MainThread]: [31mFailure in test test_events_in_window (tests\test_events_in_window.sql)[0m
[0m14:35:16.486364 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:35:16.486364 [info ] [MainThread]: 
[0m14:35:16.486364 [info ] [MainThread]:   compiled code at target\compiled\dbt_carton_caps\tests\test_events_in_window.sql
[0m14:35:16.486364 [info ] [MainThread]: 
[0m14:35:16.486364 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=30
[0m14:35:16.486364 [debug] [MainThread]: Command `dbt test` failed at 14:35:16.486364 after 1.31 seconds
[0m14:35:16.486364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C5CCF260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C5CCC0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C5CCC3E0>]}
[0m14:35:16.486364 [debug] [MainThread]: Flushing usage events
[0m14:35:16.829279 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:36.442684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC330F5C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC36061820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC3583B3B0>]}


============================== 14:37:36.442684 | c8256f58-38f1-45df-93df-5878339c8402 ==============================
[0m14:37:36.442684 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:37:36.442684 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --profiles-dir .', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m14:37:36.589472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8256f58-38f1-45df-93df-5878339c8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC377D1CA0>]}
[0m14:37:36.627099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8256f58-38f1-45df-93df-5878339c8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC3789C9E0>]}
[0m14:37:36.627099 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:37:36.789465 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:37:36.878506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:37:36.878506 [debug] [MainThread]: Partial parsing: updated file: dbt_carton_caps://tests\test_events_in_window.sql
[0m14:37:36.987650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8256f58-38f1-45df-93df-5878339c8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC3636CA10>]}
[0m14:37:37.053704 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m14:37:37.054664 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m14:37:37.071064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8256f58-38f1-45df-93df-5878339c8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC37FF1D30>]}
[0m14:37:37.071064 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m14:37:37.071064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8256f58-38f1-45df-93df-5878339c8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC37A33110>]}
[0m14:37:37.079001 [info ] [MainThread]: 
[0m14:37:37.079001 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:37:37.079001 [info ] [MainThread]: 
[0m14:37:37.079001 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:37:37.080741 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_main'
[0m14:37:37.128071 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_main"
[0m14:37:37.128071 [debug] [ThreadPool]: On list_carton_caps_main: BEGIN
[0m14:37:37.130077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:37.141675 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m14:37:37.141675 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_main"
[0m14:37:37.141675 [debug] [ThreadPool]: On list_carton_caps_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_main"} */
select
      'carton_caps' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps'
  
[0m14:37:37.146673 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:37:37.146673 [debug] [ThreadPool]: On list_carton_caps_main: ROLLBACK
[0m14:37:37.152501 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_main'
[0m14:37:37.152501 [debug] [ThreadPool]: On list_carton_caps_main: Close
[0m14:37:37.152501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8256f58-38f1-45df-93df-5878339c8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC37E0F110>]}
[0m14:37:37.152501 [debug] [MainThread]: Using duckdb connection "master"
[0m14:37:37.152501 [debug] [MainThread]: On master: BEGIN
[0m14:37:37.152501 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:37.152501 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:37:37.152501 [debug] [MainThread]: On master: COMMIT
[0m14:37:37.152501 [debug] [MainThread]: Using duckdb connection "master"
[0m14:37:37.152501 [debug] [MainThread]: On master: COMMIT
[0m14:37:37.152501 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:37:37.152501 [debug] [MainThread]: On master: Close
[0m14:37:37.152501 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m14:37:37.152501 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m14:37:37.152501 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m14:37:37.152501 [info ] [Thread-1 (]: 1 of 30 START test not_null_dim_product_product_id ............................. [RUN]
[0m14:37:37.152501 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m14:37:37.152501 [info ] [Thread-2 (]: 2 of 30 START test not_null_dim_school_school_id ............................... [RUN]
[0m14:37:37.152501 [info ] [Thread-3 (]: 3 of 30 START test not_null_dim_user_user_id ................................... [RUN]
[0m14:37:37.152501 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m14:37:37.152501 [info ] [Thread-4 (]: 4 of 30 START test not_null_fct_purchase_purchase_id ........................... [RUN]
[0m14:37:37.152501 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m14:37:37.152501 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m14:37:37.152501 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m14:37:37.162371 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m14:37:37.162371 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m14:37:37.162371 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m14:37:37.204130 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m14:37:37.204130 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m14:37:37.207072 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m14:37:37.209461 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m14:37:37.209461 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m14:37:37.209461 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m14:37:37.222009 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m14:37:37.222009 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m14:37:37.224059 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m14:37:37.224059 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m14:37:37.225060 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m14:37:37.226059 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m14:37:37.227059 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m14:37:37.227059 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m14:37:37.228060 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m14:37:37.228060 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m14:37:37.228060 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:37:37.228060 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m14:37:37.229060 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m14:37:37.229060 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m14:37:37.229060 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:37:37.230060 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m14:37:37.230060 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.230060 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m14:37:37.230060 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:37:37.230060 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m14:37:37.230060 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.230060 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:37:37.230060 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.230060 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m14:37:37.230060 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.230060 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.230060 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.230060 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m14:37:37.230060 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.230060 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m14:37:37.230060 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.230060 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.230060 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.230060 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m14:37:37.230060 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m14:37:37.230060 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m14:37:37.230060 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.230060 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.230060 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m14:37:37.230060 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m14:37:37.230060 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m14:37:37.230060 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m14:37:37.230060 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m14:37:37.230060 [info ] [Thread-1 (]: 1 of 30 PASS not_null_dim_product_product_id ................................... [[32mPASS[0m in 0.08s]
[0m14:37:37.230060 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m14:37:37.230060 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m14:37:37.230060 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m14:37:37.230060 [info ] [Thread-2 (]: 2 of 30 PASS not_null_dim_school_school_id ..................................... [[32mPASS[0m in 0.08s]
[0m14:37:37.230060 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m14:37:37.230060 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m14:37:37.230060 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m14:37:37.230060 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m14:37:37.230060 [info ] [Thread-3 (]: 3 of 30 PASS not_null_dim_user_user_id ......................................... [[32mPASS[0m in 0.08s]
[0m14:37:37.230060 [info ] [Thread-4 (]: 4 of 30 PASS not_null_fct_purchase_purchase_id ................................. [[32mPASS[0m in 0.08s]
[0m14:37:37.230060 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m14:37:37.230060 [info ] [Thread-1 (]: 5 of 30 START test not_null_fct_referral_referral_id ........................... [RUN]
[0m14:37:37.246178 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m14:37:37.246178 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m14:37:37.246178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m14:37:37.246178 [info ] [Thread-2 (]: 6 of 30 START test not_null_fct_rewards_reward_id .............................. [RUN]
[0m14:37:37.246178 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m14:37:37.246178 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m14:37:37.246178 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m14:37:37.246178 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m14:37:37.246178 [info ] [Thread-3 (]: 7 of 30 START test not_null_stg_events_event_id ................................ [RUN]
[0m14:37:37.246178 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m14:37:37.246178 [info ] [Thread-4 (]: 8 of 30 START test not_null_stg_events_user_id ................................. [RUN]
[0m14:37:37.246178 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m14:37:37.246178 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m14:37:37.246178 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m14:37:37.254383 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m14:37:37.254383 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m14:37:37.254383 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m14:37:37.254383 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m14:37:37.254383 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m14:37:37.254383 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m14:37:37.262138 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m14:37:37.254383 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m14:37:37.262138 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m14:37:37.264378 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m14:37:37.265376 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m14:37:37.266376 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m14:37:37.267377 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m14:37:37.267377 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m14:37:37.268378 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m14:37:37.268378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:37.268378 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m14:37:37.269457 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m14:37:37.269457 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:37:37.269457 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.269457 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m14:37:37.269457 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m14:37:37.270961 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m14:37:37.270961 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m14:37:37.271966 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.271966 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.271966 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m14:37:37.272966 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:37:37.272966 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m14:37:37.272966 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:37:37.273967 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.273967 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.273967 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.274965 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.274965 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m14:37:37.274965 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.274965 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m14:37:37.275966 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m14:37:37.276966 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.276966 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m14:37:37.277965 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.277965 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m14:37:37.278965 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m14:37:37.278965 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m14:37:37.278965 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.279966 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m14:37:37.279966 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.279966 [info ] [Thread-1 (]: 5 of 30 PASS not_null_fct_referral_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m14:37:37.280967 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m14:37:37.282966 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m14:37:37.282966 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m14:37:37.281967 [info ] [Thread-2 (]: 6 of 30 PASS not_null_fct_rewards_reward_id .................................... [[32mPASS[0m in 0.04s]
[0m14:37:37.283965 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m14:37:37.283965 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m14:37:37.283965 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m14:37:37.284965 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m14:37:37.284965 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m14:37:37.284965 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m14:37:37.285965 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m14:37:37.285965 [info ] [Thread-1 (]: 9 of 30 START test not_null_stg_products_product_id ............................ [RUN]
[0m14:37:37.286966 [info ] [Thread-3 (]: 7 of 30 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.04s]
[0m14:37:37.286966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m14:37:37.286966 [info ] [Thread-4 (]: 8 of 30 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.04s]
[0m14:37:37.287965 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m14:37:37.286966 [info ] [Thread-2 (]: 10 of 30 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m14:37:37.287965 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m14:37:37.287965 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m14:37:37.288965 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m14:37:37.288965 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m14:37:37.291967 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m14:37:37.291967 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m14:37:37.291967 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m14:37:37.291967 [info ] [Thread-3 (]: 11 of 30 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m14:37:37.294967 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m14:37:37.292966 [info ] [Thread-4 (]: 12 of 30 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m14:37:37.295967 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m14:37:37.295967 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m14:37:37.296966 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m14:37:37.296966 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m14:37:37.296966 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m14:37:37.299967 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m14:37:37.299967 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m14:37:37.300965 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m14:37:37.304965 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m14:37:37.305965 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m14:37:37.306965 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m14:37:37.307968 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m14:37:37.307968 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m14:37:37.309965 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m14:37:37.309965 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m14:37:37.310966 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m14:37:37.310966 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m14:37:37.310966 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m14:37:37.310966 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m14:37:37.311966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:37.311966 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:37:37.311966 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m14:37:37.311966 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m14:37:37.312966 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m14:37:37.312966 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.312966 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.313965 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:37:37.313965 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:37:37.313965 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m14:37:37.313965 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m14:37:37.314965 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.314965 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.314965 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.315965 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.315965 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m14:37:37.315965 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m14:37:37.315965 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.315965 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.315965 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.315965 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.315965 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m14:37:37.315965 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.315965 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m14:37:37.320668 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m14:37:37.320668 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m14:37:37.320668 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.320668 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m14:37:37.320668 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m14:37:37.320668 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m14:37:37.320668 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m14:37:37.320668 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m14:37:37.320668 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m14:37:37.320668 [info ] [Thread-1 (]: 9 of 30 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.03s]
[0m14:37:37.320668 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m14:37:37.320668 [info ] [Thread-2 (]: 10 of 30 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.03s]
[0m14:37:37.320668 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m14:37:37.320668 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m14:37:37.320668 [info ] [Thread-3 (]: 11 of 30 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.02s]
[0m14:37:37.327124 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m14:37:37.327124 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m14:37:37.327124 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m14:37:37.327124 [info ] [Thread-4 (]: 12 of 30 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.03s]
[0m14:37:37.327124 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m14:37:37.327124 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m14:37:37.327124 [info ] [Thread-1 (]: 13 of 30 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m14:37:37.327124 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m14:37:37.327124 [info ] [Thread-2 (]: 14 of 30 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m14:37:37.327124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m14:37:37.327124 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m14:37:37.327124 [info ] [Thread-3 (]: 15 of 30 START test not_null_stg_schools_school_id ............................. [RUN]
[0m14:37:37.331017 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m14:37:37.331017 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m14:37:37.332023 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m14:37:37.331017 [info ] [Thread-4 (]: 16 of 30 START test not_null_stg_users_school_id ............................... [RUN]
[0m14:37:37.332023 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m14:37:37.334021 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m14:37:37.335024 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m14:37:37.335024 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m14:37:37.337661 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m14:37:37.339660 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m14:37:37.339660 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m14:37:37.342661 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m14:37:37.342661 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m14:37:37.344667 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m14:37:37.344667 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m14:37:37.344667 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m14:37:37.344667 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m14:37:37.346668 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m14:37:37.347667 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m14:37:37.349668 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m14:37:37.349668 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m14:37:37.349668 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m14:37:37.349668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:37.349668 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m14:37:37.349668 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m14:37:37.349668 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m14:37:37.349668 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m14:37:37.349668 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:37:37.349668 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.349668 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m14:37:37.349668 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m14:37:37.349668 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m14:37:37.349668 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:37:37.349668 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.349668 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:37:37.354885 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.354885 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m14:37:37.355369 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.355369 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.355369 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.355369 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m14:37:37.355369 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.355369 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m14:37:37.355369 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.355369 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.355369 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.355369 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m14:37:37.359057 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.359626 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m14:37:37.360652 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m14:37:37.360652 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.361168 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m14:37:37.362117 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m14:37:37.362117 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m14:37:37.362628 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m14:37:37.363144 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m14:37:37.363667 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m14:37:37.364190 [info ] [Thread-1 (]: 13 of 30 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.04s]
[0m14:37:37.365232 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m14:37:37.365232 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m14:37:37.364712 [info ] [Thread-4 (]: 16 of 30 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m14:37:37.365755 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m14:37:37.366280 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m14:37:37.366803 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m14:37:37.366280 [info ] [Thread-3 (]: 15 of 30 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.04s]
[0m14:37:37.366803 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m14:37:37.367323 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m14:37:37.367323 [info ] [Thread-2 (]: 14 of 30 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.04s]
[0m14:37:37.367847 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m14:37:37.368373 [info ] [Thread-1 (]: 17 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m14:37:37.368777 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m14:37:37.368373 [info ] [Thread-4 (]: 18 of 30 START test test_events_in_window ...................................... [RUN]
[0m14:37:37.369521 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m14:37:37.369521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m14:37:37.370040 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m14:37:37.370040 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now test.dbt_carton_caps.test_events_in_window)
[0m14:37:37.370551 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m14:37:37.370551 [info ] [Thread-3 (]: 19 of 30 START test unique_dim_product_product_id .............................. [RUN]
[0m14:37:37.371438 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m14:37:37.371072 [info ] [Thread-2 (]: 20 of 30 START test unique_dim_school_school_id ................................ [RUN]
[0m14:37:37.373607 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m14:37:37.373607 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m14:37:37.375607 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m14:37:37.375607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m14:37:37.375607 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m14:37:37.376610 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m14:37:37.380515 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m14:37:37.382515 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m14:37:37.382515 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m14:37:37.382515 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m14:37:37.384467 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m14:37:37.386192 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m14:37:37.386192 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m14:37:37.388191 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m14:37:37.388191 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m14:37:37.388191 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m14:37:37.390190 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m14:37:37.390190 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m14:37:37.390190 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m14:37:37.390190 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m14:37:37.391191 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m14:37:37.391632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:37.391632 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m14:37:37.391632 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:37:37.391632 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m14:37:37.391632 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:37:37.391632 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.391632 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m14:37:37.391632 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.391632 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m14:37:37.391632 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:37:37.391632 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.391632 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m14:37:37.391632 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:37:37.391632 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m14:37:37.391632 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m14:37:37.391632 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.396550 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:37:37.396550 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m14:37:37.396550 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.397556 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:37:37.397950 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m14:37:37.397950 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.397950 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m14:37:37.397950 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:37:37.397950 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m14:37:37.397950 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:37:37.397950 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m14:37:37.397950 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m14:37:37.397950 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m14:37:37.403501 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m14:37:37.404506 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m14:37:37.403501 [info ] [Thread-1 (]: 17 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m14:37:37.404506 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m14:37:37.405505 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m14:37:37.405505 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m14:37:37.405505 [info ] [Thread-2 (]: 20 of 30 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m14:37:37.406505 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m14:37:37.406505 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m14:37:37.406505 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m14:37:37.406505 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m14:37:37.407505 [error] [Thread-4 (]: 18 of 30 FAIL 1 test_events_in_window .......................................... [[31mFAIL 1[0m in 0.04s]
[0m14:37:37.407505 [info ] [Thread-3 (]: 19 of 30 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.03s]
[0m14:37:37.408505 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m14:37:37.408505 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m14:37:37.407505 [info ] [Thread-1 (]: 21 of 30 START test unique_dim_user_user_id .................................... [RUN]
[0m14:37:37.408505 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m14:37:37.409505 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m14:37:37.409505 [info ] [Thread-2 (]: 22 of 30 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m14:37:37.409505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m14:37:37.409505 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m14:37:37.410505 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m14:37:37.410505 [info ] [Thread-4 (]: 23 of 30 START test unique_fct_referral_referral_id ............................ [RUN]
[0m14:37:37.410505 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m14:37:37.411505 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m14:37:37.411505 [info ] [Thread-3 (]: 24 of 30 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m14:37:37.411505 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m14:37:37.413709 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m14:37:37.417697 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m14:37:37.417697 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m14:37:37.418299 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m14:37:37.418299 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m14:37:37.420306 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m14:37:37.422302 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m14:37:37.423302 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m14:37:37.423302 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m14:37:37.424323 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m14:37:37.426046 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m14:37:37.426046 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m14:37:37.426046 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m14:37:37.426046 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m14:37:37.426046 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m14:37:37.426046 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m14:37:37.426046 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m14:37:37.426046 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m14:37:37.426046 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m14:37:37.431318 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:37:37.431318 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m14:37:37.431716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:37.431716 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m14:37:37.431716 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m14:37:37.431716 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.431716 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m14:37:37.431716 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:37:37.431716 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.431716 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m14:37:37.431716 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:37:37.431716 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m14:37:37.431716 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:37:37.431716 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.431716 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:37:37.431716 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.431716 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m14:37:37.431716 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m14:37:37.431716 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:37:37.431716 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:37:37.431716 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.438239 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:37:37.439244 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m14:37:37.439244 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.440243 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m14:37:37.440243 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:37:37.441244 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m14:37:37.441244 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m14:37:37.442244 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m14:37:37.443244 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m14:37:37.443244 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m14:37:37.444245 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m14:37:37.444245 [info ] [Thread-1 (]: 21 of 30 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.03s]
[0m14:37:37.445227 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m14:37:37.445227 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m14:37:37.445227 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m14:37:37.446293 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m14:37:37.446293 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m14:37:37.446293 [info ] [Thread-2 (]: 22 of 30 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.04s]
[0m14:37:37.447293 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m14:37:37.447293 [info ] [Thread-4 (]: 23 of 30 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.03s]
[0m14:37:37.448293 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m14:37:37.447293 [info ] [Thread-3 (]: 24 of 30 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.03s]
[0m14:37:37.448293 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m14:37:37.448293 [info ] [Thread-1 (]: 25 of 30 START test unique_stg_events_event_id ................................. [RUN]
[0m14:37:37.448293 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m14:37:37.449293 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m14:37:37.449293 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m14:37:37.449293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m14:37:37.450293 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m14:37:37.450293 [info ] [Thread-2 (]: 26 of 30 START test unique_stg_products_product_id ............................. [RUN]
[0m14:37:37.450899 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m14:37:37.450293 [info ] [Thread-4 (]: 27 of 30 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m14:37:37.450899 [info ] [Thread-3 (]: 28 of 30 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m14:37:37.450899 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m14:37:37.453816 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m14:37:37.454337 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m14:37:37.454337 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m14:37:37.454337 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m14:37:37.455361 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m14:37:37.455361 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m14:37:37.456366 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m14:37:37.460077 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m14:37:37.462080 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m14:37:37.462080 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m14:37:37.465082 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m14:37:37.465082 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m14:37:37.465996 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m14:37:37.467001 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m14:37:37.467811 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m14:37:37.467811 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m14:37:37.467811 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m14:37:37.467811 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m14:37:37.467811 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m14:37:37.470967 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m14:37:37.470967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:37.470967 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m14:37:37.470967 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m14:37:37.470967 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m14:37:37.470967 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:37:37.472984 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m14:37:37.472984 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.473414 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:37:37.473414 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m14:37:37.473414 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m14:37:37.473414 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.473414 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:37:37.473414 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:37:37.473414 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.473414 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m14:37:37.473414 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m14:37:37.473414 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.473414 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:37:37.473414 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:37:37.473414 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m14:37:37.473414 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:37:37.473414 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:37:37.473414 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.479907 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m14:37:37.480913 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m14:37:37.480913 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:37:37.480913 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m14:37:37.481912 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:37:37.481912 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m14:37:37.481912 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m14:37:37.482912 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m14:37:37.482912 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m14:37:37.483911 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m14:37:37.484911 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m14:37:37.484911 [info ] [Thread-2 (]: 26 of 30 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m14:37:37.485912 [info ] [Thread-1 (]: 25 of 30 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m14:37:37.485912 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m14:37:37.485912 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m14:37:37.486870 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m14:37:37.486870 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m14:37:37.486870 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m14:37:37.487919 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m14:37:37.487919 [info ] [Thread-3 (]: 28 of 30 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m14:37:37.487919 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m14:37:37.488918 [info ] [Thread-4 (]: 27 of 30 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.03s]
[0m14:37:37.488918 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m14:37:37.488918 [info ] [Thread-2 (]: 29 of 30 START test unique_stg_schools_school_id ............................... [RUN]
[0m14:37:37.489918 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m14:37:37.488918 [info ] [Thread-1 (]: 30 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m14:37:37.489918 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m14:37:37.489918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m14:37:37.491080 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m14:37:37.491080 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m14:37:37.493082 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m14:37:37.496081 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m14:37:37.496081 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m14:37:37.497081 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m14:37:37.498081 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m14:37:37.499081 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m14:37:37.500082 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m14:37:37.500082 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m14:37:37.501081 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m14:37:37.501081 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:37:37.501081 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m14:37:37.502081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:37.502081 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.502081 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m14:37:37.502081 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.502081 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:37:37.502081 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m14:37:37.502081 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:37:37.502081 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:37:37.502081 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m14:37:37.502081 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:37:37.502081 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m14:37:37.502081 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m14:37:37.502081 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m14:37:37.507683 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m14:37:37.507683 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m14:37:37.507683 [info ] [Thread-2 (]: 29 of 30 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.02s]
[0m14:37:37.508690 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m14:37:37.508690 [info ] [Thread-1 (]: 30 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.02s]
[0m14:37:37.509690 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m14:37:37.510688 [debug] [MainThread]: Using duckdb connection "master"
[0m14:37:37.510688 [debug] [MainThread]: On master: BEGIN
[0m14:37:37.510688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:37.510688 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:37:37.510688 [debug] [MainThread]: On master: COMMIT
[0m14:37:37.511818 [debug] [MainThread]: Using duckdb connection "master"
[0m14:37:37.511818 [debug] [MainThread]: On master: COMMIT
[0m14:37:37.511818 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:37:37.511818 [debug] [MainThread]: On master: Close
[0m14:37:37.511818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:37.512820 [debug] [MainThread]: Connection 'list_carton_caps_main' was properly closed.
[0m14:37:37.512820 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m14:37:37.512820 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6' was properly closed.
[0m14:37:37.512820 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d' was properly closed.
[0m14:37:37.512820 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103' was properly closed.
[0m14:37:37.512820 [info ] [MainThread]: 
[0m14:37:37.513820 [info ] [MainThread]: Finished running 30 data tests in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m14:37:37.515615 [debug] [MainThread]: Command end result
[0m14:37:37.530177 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m14:37:37.530177 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m14:37:37.535904 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\run_results.json
[0m14:37:37.535904 [info ] [MainThread]: 
[0m14:37:37.535904 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:37:37.535904 [info ] [MainThread]: 
[0m14:37:37.535904 [error] [MainThread]: [31mFailure in test test_events_in_window (tests\test_events_in_window.sql)[0m
[0m14:37:37.535904 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:37:37.535904 [info ] [MainThread]: 
[0m14:37:37.535904 [info ] [MainThread]:   compiled code at target\compiled\dbt_carton_caps\tests\test_events_in_window.sql
[0m14:37:37.535904 [info ] [MainThread]: 
[0m14:37:37.535904 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=30
[0m14:37:37.535904 [debug] [MainThread]: Command `dbt test` failed at 14:37:37.535904 after 1.26 seconds
[0m14:37:37.541188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC361514C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC36150BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC37E77FB0>]}
[0m14:37:37.541188 [debug] [MainThread]: Flushing usage events
[0m14:37:37.848712 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:54.625898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021898497410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189582E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021898495130>]}


============================== 15:04:54.641711 | e9dc5c99-e408-4844-99c0-dd85fb074fba ==============================
[0m15:04:54.641711 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:04:54.641711 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt build --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m15:04:54.788634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021899AA5F40>]}
[0m15:04:54.828565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021898176B40>]}
[0m15:04:54.829245 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:04:54.985556 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:04:55.084003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:55.084003 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:04:55.084003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:55.111659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021899701FD0>]}
[0m15:04:55.172899 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m15:04:55.173850 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m15:04:55.199012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021899F79610>]}
[0m15:04:55.199012 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m15:04:55.201011 [info ] [MainThread]: 
[0m15:04:55.202013 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:04:55.202013 [info ] [MainThread]: 
[0m15:04:55.202013 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:04:55.205014 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps'
[0m15:04:55.254387 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps"
[0m15:04:55.255386 [debug] [ThreadPool]: On list_carton_caps: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps"'
    
  
  
[0m15:04:55.255386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:55.274215 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m15:04:55.275135 [debug] [ThreadPool]: On list_carton_caps: Close
[0m15:04:55.275135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_carton_caps, now create_carton_caps_main)
[0m15:04:55.276185 [debug] [ThreadPool]: Creating schema "database: "carton_caps"
schema: "main"
"
[0m15:04:55.280183 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_main"
[0m15:04:55.280183 [debug] [ThreadPool]: On create_carton_caps_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='carton_caps'
        and type='sqlite'
    
  
[0m15:04:55.280635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:55.280635 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:04:55.281888 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_main"
[0m15:04:55.281888 [debug] [ThreadPool]: On create_carton_caps_main: BEGIN
[0m15:04:55.281888 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:04:55.281888 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_main"
[0m15:04:55.281888 [debug] [ThreadPool]: On create_carton_caps_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_main"} */

    
    
        create schema if not exists "carton_caps"."main"
    
[0m15:04:55.282887 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:04:55.282887 [debug] [ThreadPool]: On create_carton_caps_main: COMMIT
[0m15:04:55.282887 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_main"
[0m15:04:55.283887 [debug] [ThreadPool]: On create_carton_caps_main: COMMIT
[0m15:04:55.283887 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:04:55.283887 [debug] [ThreadPool]: On create_carton_caps_main: Close
[0m15:04:55.284888 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_main'
[0m15:04:55.288659 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_main"
[0m15:04:55.288659 [debug] [ThreadPool]: On list_carton_caps_main: BEGIN
[0m15:04:55.288659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:55.288659 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:04:55.288659 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_main"
[0m15:04:55.289657 [debug] [ThreadPool]: On list_carton_caps_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_main"} */
select
      'carton_caps' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps'
  
[0m15:04:55.297765 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m15:04:55.298765 [debug] [ThreadPool]: On list_carton_caps_main: ROLLBACK
[0m15:04:55.299763 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_main'
[0m15:04:55.299763 [debug] [ThreadPool]: On list_carton_caps_main: Close
[0m15:04:55.301437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218984FCB00>]}
[0m15:04:55.301437 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:55.301437 [debug] [MainThread]: On master: BEGIN
[0m15:04:55.301437 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:55.302539 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:04:55.302539 [debug] [MainThread]: On master: COMMIT
[0m15:04:55.302539 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:55.302539 [debug] [MainThread]: On master: COMMIT
[0m15:04:55.302539 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:04:55.303540 [debug] [MainThread]: On master: Close
[0m15:04:55.305539 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_events
[0m15:04:55.305539 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.stg_products
[0m15:04:55.305539 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.stg_purchases
[0m15:04:55.306538 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.stg_referrals
[0m15:04:55.306538 [info ] [Thread-1 (]: 1 of 44 START sql view model main.stg_events ................................... [RUN]
[0m15:04:55.306538 [info ] [Thread-2 (]: 2 of 44 START sql view model main.stg_products ................................. [RUN]
[0m15:04:55.307539 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_events'
[0m15:04:55.306538 [info ] [Thread-3 (]: 3 of 44 START sql view model main.stg_purchases ................................ [RUN]
[0m15:04:55.307539 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_products'
[0m15:04:55.307539 [info ] [Thread-4 (]: 4 of 44 START sql view model main.stg_referrals ................................ [RUN]
[0m15:04:55.308538 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_events
[0m15:04:55.308538 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_purchases'
[0m15:04:55.308538 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.stg_products
[0m15:04:55.308538 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_referrals'
[0m15:04:55.313540 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_events"
[0m15:04:55.313540 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.stg_purchases
[0m15:04:55.314539 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_products"
[0m15:04:55.314539 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.stg_referrals
[0m15:04:55.317555 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_purchases"
[0m15:04:55.319241 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_referrals"
[0m15:04:55.319241 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_events
[0m15:04:55.319241 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.stg_products
[0m15:04:55.336179 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_events"
[0m15:04:55.336179 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_products"
[0m15:04:55.336179 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.stg_referrals
[0m15:04:55.336179 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.stg_purchases
[0m15:04:55.343177 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_referrals"
[0m15:04:55.343177 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m15:04:55.343177 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_purchases"
[0m15:04:55.343177 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m15:04:55.343177 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: BEGIN
[0m15:04:55.343177 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: BEGIN
[0m15:04:55.343177 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:04:55.343177 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:04:55.343177 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m15:04:55.343177 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m15:04:55.343177 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.343177 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: BEGIN
[0m15:04:55.343177 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.343177 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: BEGIN
[0m15:04:55.350109 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m15:04:55.350109 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:04:55.350109 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m15:04:55.350109 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:04:55.351114 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

  
  create view "carton_caps"."main"."stg_events__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."events"
)
select
  cast(event_id as integer) as event_id,
  cast(user_id as integer) as user_id,
  cast(event_type as varchar) as event_type,
  cast(event_at as timestamp) as event_at,
  cast(referral_id as integer) as referral_id,
  cast(metadata_json as varchar) as metadata_json
from src
  );

[0m15:04:55.351114 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

  
  create view "carton_caps"."main"."stg_products__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."products"
)
select
  cast(product_id as integer) as product_id,
  cast(name as varchar) as name,
  cast(category as varchar) as category,
  cast(price as double) as price,
  cast(points_per_dollar as integer) as points_per_dollar,
  cast(created_at as timestamp) as created_at
from src
  );

[0m15:04:55.351114 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.352114 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.352114 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m15:04:55.352114 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.352114 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m15:04:55.353115 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.353115 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

  
  create view "carton_caps"."main"."stg_referrals__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."referrals"
)
select
  cast(referral_id as integer) as referral_id,
  cast(referrer_user_id as integer) as referrer_user_id,
  lower(cast(referred_email as varchar)) as referred_email,
  cast(referred_user_id as integer) as referred_user_id,
  cast(referral_code as varchar) as referral_code,
  cast(sent_at as timestamp) as sent_at,
  cast(converted_at as timestamp) as converted_at,
  cast(status as varchar) as status
from src
  );

[0m15:04:55.356112 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m15:04:55.357113 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

  
  create view "carton_caps"."main"."stg_purchases__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."purchases"
)
select
  cast(purchase_id as integer) as purchase_id,
  cast(user_id as integer) as user_id,
  cast(product_id as integer) as product_id,
  cast(quantity as integer) as quantity,
  cast(price_paid as double) as price_paid,
  cast(points_earned as integer) as points_earned,
  cast(purchased_at as timestamp) as purchased_at,
  cast(day_of_week as varchar) as day_of_week,
  cast(hour_of_day as integer) as hour_of_day
from src
  );

[0m15:04:55.359112 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m15:04:55.359112 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */
alter view "carton_caps"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m15:04:55.360115 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:04:55.360115 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */
alter view "carton_caps"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m15:04:55.360115 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.391771 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m15:04:55.391771 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m15:04:55.391771 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m15:04:55.391771 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */
alter view "carton_caps"."main"."stg_referrals" rename to "stg_referrals__dbt_backup"
[0m15:04:55.391771 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.391771 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m15:04:55.391771 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */
alter view "carton_caps"."main"."stg_purchases" rename to "stg_purchases__dbt_backup"
[0m15:04:55.398709 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m15:04:55.398709 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */
alter view "carton_caps"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m15:04:55.398709 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.398709 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */
alter view "carton_caps"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m15:04:55.399962 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m15:04:55.400961 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m15:04:55.401960 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.402966 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m15:04:55.403964 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */
alter view "carton_caps"."main"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m15:04:55.403964 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.410965 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m15:04:55.410965 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */
alter view "carton_caps"."main"."stg_purchases__dbt_tmp" rename to "stg_purchases"
[0m15:04:55.411964 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m15:04:55.411964 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m15:04:55.411964 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.412964 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m15:04:55.412964 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m15:04:55.412964 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.413964 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m15:04:55.413964 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m15:04:55.414964 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m15:04:55.415965 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m15:04:55.415965 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m15:04:55.415965 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m15:04:55.415965 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m15:04:55.420111 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:04:55.423106 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m15:04:55.423106 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

      drop view if exists "carton_caps"."main"."stg_events__dbt_backup" cascade
    
[0m15:04:55.423106 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m15:04:55.424105 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m15:04:55.424105 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m15:04:55.425138 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m15:04:55.426058 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.426447 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m15:04:55.428684 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m15:04:55.429032 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

      drop view if exists "carton_caps"."main"."stg_purchases__dbt_backup" cascade
    
[0m15:04:55.431048 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: Close
[0m15:04:55.431048 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

      drop view if exists "carton_caps"."main"."stg_products__dbt_backup" cascade
    
[0m15:04:55.431048 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

      drop view if exists "carton_caps"."main"."stg_referrals__dbt_backup" cascade
    
[0m15:04:55.433432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189A55C170>]}
[0m15:04:55.433432 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.433432 [info ] [Thread-1 (]: 1 of 44 OK created sql view model main.stg_events .............................. [[32mOK[0m in 0.12s]
[0m15:04:55.435097 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: Close
[0m15:04:55.435097 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.435097 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.435097 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_events
[0m15:04:55.436148 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189A54E090>]}
[0m15:04:55.436148 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: Close
[0m15:04:55.437043 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: Close
[0m15:04:55.437043 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_schools
[0m15:04:55.438064 [info ] [Thread-3 (]: 3 of 44 OK created sql view model main.stg_purchases ........................... [[32mOK[0m in 0.13s]
[0m15:04:55.438064 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189A54D550>]}
[0m15:04:55.439058 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189A54E120>]}
[0m15:04:55.439058 [info ] [Thread-1 (]: 5 of 44 START sql view model main.stg_schools .................................. [RUN]
[0m15:04:55.439058 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.stg_purchases
[0m15:04:55.440092 [info ] [Thread-4 (]: 4 of 44 OK created sql view model main.stg_referrals ........................... [[32mOK[0m in 0.13s]
[0m15:04:55.440901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_events, now model.dbt_carton_caps.stg_schools)
[0m15:04:55.440901 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.stg_users
[0m15:04:55.440598 [info ] [Thread-2 (]: 2 of 44 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.13s]
[0m15:04:55.441399 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.stg_referrals
[0m15:04:55.441399 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_schools
[0m15:04:55.442412 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.stg_products
[0m15:04:55.441399 [info ] [Thread-3 (]: 6 of 44 START sql view model main.stg_users .................................... [RUN]
[0m15:04:55.442412 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m15:04:55.444422 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_schools"
[0m15:04:55.444422 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m15:04:55.444422 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_purchases, now model.dbt_carton_caps.stg_users)
[0m15:04:55.444422 [info ] [Thread-4 (]: 7 of 44 START test not_null_stg_events_event_id ................................ [RUN]
[0m15:04:55.444422 [info ] [Thread-2 (]: 8 of 44 START test not_null_stg_events_user_id ................................. [RUN]
[0m15:04:55.444422 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.stg_users
[0m15:04:55.446686 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_referrals, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m15:04:55.446686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_products, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m15:04:55.448181 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_users"
[0m15:04:55.449185 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_schools
[0m15:04:55.449185 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m15:04:55.449185 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m15:04:55.452158 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_schools"
[0m15:04:55.456813 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m15:04:55.461797 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m15:04:55.461797 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.stg_users
[0m15:04:55.464318 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_users"
[0m15:04:55.464318 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m15:04:55.464318 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m15:04:55.474293 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m15:04:55.475141 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: BEGIN
[0m15:04:55.475141 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m15:04:55.475141 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m15:04:55.476185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:55.476185 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_users: BEGIN
[0m15:04:55.477187 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m15:04:55.478185 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m15:04:55.478185 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:55.478185 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.478185 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m15:04:55.479186 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m15:04:55.479186 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:55.479186 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m15:04:55.480185 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.480185 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

  
  create view "carton_caps"."main"."stg_schools__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."schools"
)
select
  cast(school_id as integer) as school_id,
  cast(name as varchar) as name,
  cast(address as varchar) as address,
  cast(city as varchar) as city,
  cast(state as varchar) as state,
  cast(zip_code as varchar) as zip_code,
  cast(created_at as timestamp) as created_at
from src
  );

[0m15:04:55.480185 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m15:04:55.480185 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m15:04:55.481186 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.481186 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:55.481186 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

  
  create view "carton_caps"."main"."stg_users__dbt_tmp" as (
    with src as (
  select * from "carton_caps"."raw"."users"
)
select
  cast(user_id as integer) as user_id,
  cast(first_name as varchar) as first_name,
  cast(last_name as varchar) as last_name,
  lower(cast(email as varchar)) as email,
  cast(school_id as integer) as school_id,
  cast(created_at as timestamp) as created_at,
  cast(user_type as varchar) as user_type,
  cast(is_verified as integer) as is_verified,
  cast(device_id as varchar) as device_id,
  cast(marketing_channel as varchar) as marketing_channel
from src
  );

[0m15:04:55.481186 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m15:04:55.482186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.482186 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.482186 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.482186 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m15:04:55.482186 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.482186 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m15:04:55.482186 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */
alter view "carton_caps"."main"."stg_schools" rename to "stg_schools__dbt_backup"
[0m15:04:55.482186 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m15:04:55.482186 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.482186 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.482186 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */
alter view "carton_caps"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m15:04:55.482186 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:04:55.482186 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m15:04:55.482186 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m15:04:55.482186 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.482186 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:04:55.482186 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m15:04:55.482186 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */
alter view "carton_caps"."main"."stg_schools__dbt_tmp" rename to "stg_schools"
[0m15:04:55.482186 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m15:04:55.482186 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m15:04:55.482186 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m15:04:55.482186 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */
alter view "carton_caps"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m15:04:55.482186 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:04:55.482186 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m15:04:55.482186 [info ] [Thread-4 (]: 7 of 44 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.04s]
[0m15:04:55.498193 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m15:04:55.498193 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m15:04:55.498193 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.498193 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m15:04:55.498193 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m15:04:55.498193 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m15:04:55.498193 [info ] [Thread-2 (]: 8 of 44 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.05s]
[0m15:04:55.498193 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m15:04:55.498193 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m15:04:55.498193 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m15:04:55.498193 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m15:04:55.498193 [info ] [Thread-4 (]: 9 of 44 START test test_events_in_window ....................................... [RUN]
[0m15:04:55.498193 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m15:04:55.503390 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m15:04:55.503390 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.test_events_in_window)
[0m15:04:55.504530 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m15:04:55.504025 [info ] [Thread-2 (]: 10 of 44 START test unique_stg_events_event_id ................................. [RUN]
[0m15:04:55.506361 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m15:04:55.506361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m15:04:55.506361 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:04:55.506361 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.507384 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m15:04:55.508385 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m15:04:55.510407 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m15:04:55.511311 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m15:04:55.514318 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m15:04:55.515318 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

      drop view if exists "carton_caps"."main"."stg_schools__dbt_backup" cascade
    
[0m15:04:55.515318 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

      drop view if exists "carton_caps"."main"."stg_users__dbt_backup" cascade
    
[0m15:04:55.516822 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m15:04:55.517827 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m15:04:55.519348 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m15:04:55.519348 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m15:04:55.520561 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.521560 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:04:55.521560 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m15:04:55.522561 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m15:04:55.523561 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: Close
[0m15:04:55.524559 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_users: Close
[0m15:04:55.526561 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021897E13BF0>]}
[0m15:04:55.525561 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m15:04:55.525561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189A4261E0>]}
[0m15:04:55.524559 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:55.527560 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:55.526561 [info ] [Thread-3 (]: 6 of 44 OK created sql view model main.stg_users ............................... [[32mOK[0m in 0.08s]
[0m15:04:55.529560 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.stg_users
[0m15:04:55.529560 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m15:04:55.529560 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m15:04:55.530559 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m15:04:55.530559 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m15:04:55.527560 [info ] [Thread-1 (]: 5 of 44 OK created sql view model main.stg_schools ............................. [[32mOK[0m in 0.08s]
[0m15:04:55.531560 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:04:55.529560 [info ] [Thread-3 (]: 11 of 44 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m15:04:55.532561 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_schools
[0m15:04:55.532561 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m15:04:55.533562 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_users, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m15:04:55.533562 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m15:04:55.534562 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:55.534562 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m15:04:55.534562 [info ] [Thread-1 (]: 12 of 44 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m15:04:55.540125 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m15:04:55.540125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_schools, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m15:04:55.541126 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:04:55.541126 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m15:04:55.541126 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m15:04:55.543124 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m15:04:55.546773 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m15:04:55.548475 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m15:04:55.549492 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m15:04:55.550094 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m15:04:55.550576 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m15:04:55.550576 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m15:04:55.551965 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m15:04:55.551965 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m15:04:55.551965 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m15:04:55.551965 [info ] [Thread-2 (]: 10 of 44 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.05s]
[0m15:04:55.551965 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m15:04:55.551965 [info ] [Thread-4 (]: 9 of 44 PASS test_events_in_window ............................................. [[32mPASS[0m in 0.05s]
[0m15:04:55.551965 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m15:04:55.551965 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m15:04:55.551965 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m15:04:55.551965 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m15:04:55.558465 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m15:04:55.558465 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m15:04:55.558465 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m15:04:55.559583 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:55.559583 [info ] [Thread-2 (]: 13 of 44 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m15:04:55.560190 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m15:04:55.560190 [info ] [Thread-4 (]: 14 of 44 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m15:04:55.560792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m15:04:55.561248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:55.561248 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.561248 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m15:04:55.561248 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m15:04:55.562263 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m15:04:55.562737 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m15:04:55.562737 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.564752 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m15:04:55.565494 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.567243 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m15:04:55.568243 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m15:04:55.568243 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.569243 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m15:04:55.569243 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.569243 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m15:04:55.570244 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m15:04:55.572338 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m15:04:55.572702 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:04:55.573154 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m15:04:55.574918 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m15:04:55.574918 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m15:04:55.575922 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m15:04:55.575922 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m15:04:55.575922 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m15:04:55.575922 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m15:04:55.576923 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m15:04:55.576923 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m15:04:55.576923 [info ] [Thread-3 (]: 11 of 44 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.04s]
[0m15:04:55.577922 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m15:04:55.577922 [info ] [Thread-1 (]: 12 of 44 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.04s]
[0m15:04:55.577922 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:55.578922 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m15:04:55.579303 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:55.579303 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m15:04:55.579975 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m15:04:55.579975 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.579975 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m15:04:55.581032 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.581032 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m15:04:55.581032 [info ] [Thread-3 (]: 15 of 44 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m15:04:55.581032 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m15:04:55.581032 [info ] [Thread-1 (]: 16 of 44 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m15:04:55.581032 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:55.581032 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m15:04:55.581032 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.581032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m15:04:55.581032 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m15:04:55.581032 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m15:04:55.588157 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m15:04:55.589159 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m15:04:55.589159 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:04:55.589159 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m15:04:55.590157 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m15:04:55.591157 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m15:04:55.592156 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m15:04:55.592156 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m15:04:55.592156 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m15:04:55.593466 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m15:04:55.593466 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m15:04:55.594927 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m15:04:55.594927 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m15:04:55.594927 [info ] [Thread-2 (]: 13 of 44 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.03s]
[0m15:04:55.597024 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m15:04:55.597024 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m15:04:55.598023 [info ] [Thread-4 (]: 14 of 44 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.04s]
[0m15:04:55.598023 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m15:04:55.599023 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m15:04:55.599023 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m15:04:55.599023 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m15:04:55.600021 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m15:04:55.599023 [info ] [Thread-2 (]: 17 of 44 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m15:04:55.600334 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m15:04:55.600787 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:55.600787 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m15:04:55.600787 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m15:04:55.600787 [info ] [Thread-4 (]: 18 of 44 START test not_null_stg_products_product_id ........................... [RUN]
[0m15:04:55.601803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:55.601803 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m15:04:55.601803 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.602829 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m15:04:55.605832 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m15:04:55.605832 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m15:04:55.606834 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:04:55.607149 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m15:04:55.607149 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.607723 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m15:04:55.610391 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m15:04:55.610769 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.610769 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m15:04:55.611273 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.611273 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m15:04:55.611273 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m15:04:55.611273 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.613998 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m15:04:55.615776 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m15:04:55.616776 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m15:04:55.617281 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m15:04:55.617281 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m15:04:55.618287 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m15:04:55.618287 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m15:04:55.618287 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m15:04:55.619286 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m15:04:55.619286 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m15:04:55.619286 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:55.619286 [info ] [Thread-3 (]: 15 of 44 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.04s]
[0m15:04:55.620288 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m15:04:55.620288 [info ] [Thread-1 (]: 16 of 44 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.04s]
[0m15:04:55.620934 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m15:04:55.621647 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:55.621647 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.621647 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m15:04:55.622665 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m15:04:55.622665 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m15:04:55.622665 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m15:04:55.622665 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.622665 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:55.622665 [info ] [Thread-3 (]: 19 of 44 START test unique_stg_products_product_id ............................. [RUN]
[0m15:04:55.622665 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m15:04:55.622665 [info ] [Thread-1 (]: 20 of 44 START test not_null_stg_users_school_id ............................... [RUN]
[0m15:04:55.622665 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m15:04:55.622665 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.622665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m15:04:55.622665 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m15:04:55.622665 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.622665 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m15:04:55.629029 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m15:04:55.629029 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.631030 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m15:04:55.632030 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m15:04:55.633029 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m15:04:55.634028 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m15:04:55.635029 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m15:04:55.635029 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m15:04:55.635029 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m15:04:55.635029 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m15:04:55.636029 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m15:04:55.637030 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m15:04:55.639028 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m15:04:55.638029 [info ] [Thread-2 (]: 17 of 44 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.04s]
[0m15:04:55.638029 [info ] [Thread-4 (]: 18 of 44 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.04s]
[0m15:04:55.640028 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m15:04:55.640028 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m15:04:55.641030 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m15:04:55.641030 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m15:04:55.641030 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m15:04:55.642082 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m15:04:55.642082 [info ] [Thread-2 (]: 21 of 44 START test not_null_stg_users_user_id ................................. [RUN]
[0m15:04:55.643087 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m15:04:55.642082 [info ] [Thread-4 (]: 22 of 44 START test unique_stg_users_user_id ................................... [RUN]
[0m15:04:55.643087 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m15:04:55.644704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m15:04:55.644704 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:55.644704 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m15:04:55.645707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:55.645707 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m15:04:55.645707 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m15:04:55.646708 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.649565 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m15:04:55.649565 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:04:55.651837 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m15:04:55.651837 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m15:04:55.652894 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m15:04:55.652894 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:55.652894 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.653894 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m15:04:55.653894 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m15:04:55.656027 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m15:04:55.656432 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m15:04:55.656432 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:04:55.656432 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:04:55.656432 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m15:04:55.656432 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m15:04:55.656432 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m15:04:55.656432 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m15:04:55.656432 [info ] [Thread-1 (]: 20 of 44 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m15:04:55.662608 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m15:04:55.663292 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m15:04:55.656432 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m15:04:55.663966 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m15:04:55.663966 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m15:04:55.663966 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m15:04:55.663966 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m15:04:55.664970 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m15:04:55.664970 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:55.664970 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:55.665970 [info ] [Thread-3 (]: 19 of 44 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.04s]
[0m15:04:55.665970 [info ] [Thread-1 (]: 23 of 44 START test not_null_stg_schools_school_id ............................. [RUN]
[0m15:04:55.665970 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m15:04:55.666970 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.666970 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.666970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m15:04:55.666970 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m15:04:55.667971 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m15:04:55.667971 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m15:04:55.667971 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m15:04:55.668970 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:55.667971 [info ] [Thread-3 (]: 24 of 44 START test unique_stg_schools_school_id ............................... [RUN]
[0m15:04:55.669545 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.672063 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m15:04:55.672435 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m15:04:55.672435 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m15:04:55.675552 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m15:04:55.675552 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.676067 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m15:04:55.676516 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:04:55.678019 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m15:04:55.679051 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m15:04:55.679051 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m15:04:55.680082 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m15:04:55.680598 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m15:04:55.682147 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m15:04:55.682661 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m15:04:55.682661 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m15:04:55.683539 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m15:04:55.683840 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m15:04:55.684690 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m15:04:55.684690 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m15:04:55.684154 [info ] [Thread-4 (]: 22 of 44 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.04s]
[0m15:04:55.685211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:55.685211 [info ] [Thread-2 (]: 21 of 44 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.04s]
[0m15:04:55.685727 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m15:04:55.685727 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m15:04:55.686732 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m15:04:55.686732 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:55.686732 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.686732 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.fct_rewards
[0m15:04:55.687731 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.fct_referral
[0m15:04:55.687731 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m15:04:55.687731 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.688731 [info ] [Thread-4 (]: 25 of 44 START sql table model main.fct_rewards ................................ [RUN]
[0m15:04:55.688731 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.688731 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m15:04:55.688731 [info ] [Thread-2 (]: 26 of 44 START sql table model main.fct_referral ............................... [RUN]
[0m15:04:55.689732 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b, now model.dbt_carton_caps.fct_rewards)
[0m15:04:55.690054 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:55.690054 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now model.dbt_carton_caps.fct_referral)
[0m15:04:55.691085 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.691085 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.fct_rewards
[0m15:04:55.691085 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.fct_referral
[0m15:04:55.693440 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_rewards"
[0m15:04:55.695444 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_referral"
[0m15:04:55.695444 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m15:04:55.695444 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:04:55.697311 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m15:04:55.698012 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m15:04:55.698012 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.fct_rewards
[0m15:04:55.698752 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.fct_referral
[0m15:04:55.698752 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m15:04:55.699758 [info ] [Thread-1 (]: 23 of 44 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.03s]
[0m15:04:55.711130 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_rewards"
[0m15:04:55.712072 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_referral"
[0m15:04:55.712072 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m15:04:55.712072 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m15:04:55.712072 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m15:04:55.712072 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.dim_product
[0m15:04:55.712072 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m15:04:55.712072 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: BEGIN
[0m15:04:55.712072 [info ] [Thread-1 (]: 27 of 44 START sql table model main.dim_product ................................ [RUN]
[0m15:04:55.712072 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m15:04:55.716552 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:55.716552 [info ] [Thread-3 (]: 24 of 44 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.04s]
[0m15:04:55.717056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now model.dbt_carton_caps.dim_product)
[0m15:04:55.717056 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: BEGIN
[0m15:04:55.717056 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m15:04:55.718063 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.dim_product
[0m15:04:55.718063 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.718063 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:55.718063 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.fct_purchase
[0m15:04:55.720061 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_product"
[0m15:04:55.720802 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m15:04:55.721186 [info ] [Thread-3 (]: 28 of 44 START sql table model main.fct_purchase ............................... [RUN]
[0m15:04:55.721947 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.721947 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

  
    
    

    create  table
      "carton_caps"."main"."fct_referral__dbt_tmp"
  
    as (
      with r as (
  select *
  from "carton_caps"."main"."stg_referrals"
),

e as (
  select *
  from "carton_caps"."main"."stg_events"
),

-- Referral-related event timestamps for referred users
ref_events as (
  select
    referral_id,
    user_id,

    min(case when event_type = 'install' then event_at end) as install_at,
    min(case when event_type = 'referral_applied' then event_at end) as referral_applied_at,
    min(case when event_type = 'onboarding_complete' then event_at end) as onboarding_completed_at,
    min(case when event_type = 'school_linked' then event_at end) as school_linked_at

  from e
  where referral_id is not null
  group by 1,2
),

-- First scan/purchase time for referred users (proxy for qualifying action)
first_purchase as (
  select
    user_id,
    min(purchased_at) as first_purchase_at
  from "carton_caps"."main"."stg_purchases"
  group by 1
)

select
  r.referral_id,
  r.referrer_user_id,
  r.referred_email,
  r.referred_user_id,
  r.referral_code,
  r.sent_at,
  r.converted_at,
  r.status,

  re.install_at,
  re.referral_applied_at,
  re.onboarding_completed_at,
  re.school_linked_at,

  fp.first_purchase_at,

  -- qualifying action is: first_purchase OR school_linked (whichever happens first)
  least(fp.first_purchase_at, re.school_linked_at) as qualifying_action_at,

  -- window compliance (48 hours) using install -> referral_applied
  case
    when re.install_at is null or re.referral_applied_at is null then null
    when datediff('hour', re.install_at, re.referral_applied_at) <= 48 then true
    else false
  end as within_48h_window,

  -- simple eligibility (rules-compliant posture)
  case
    when r.status <> 'converted' then false
    when re.onboarding_completed_at is null then false
    when least(fp.first_purchase_at, re.school_linked_at) is null then false
    when re.install_at is null or re.referral_applied_at is null then false
    when datediff('hour', re.install_at, re.referral_applied_at) > 48 then false
    else true
  end as eligible_referral

from r
left join ref_events re
  on r.referral_id = re.referral_id
  and r.referred_user_id = re.user_id
left join first_purchase fp
  on r.referred_user_id = fp.user_id
    );
  
  
[0m15:04:55.722626 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6, now model.dbt_carton_caps.fct_purchase)
[0m15:04:55.722626 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m15:04:55.722626 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.dim_product
[0m15:04:55.723631 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.fct_purchase
[0m15:04:55.723631 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

  
    
    

    create  table
      "carton_caps"."main"."fct_rewards__dbt_tmp"
  
    as (
      with e as (
  select *
  from "carton_caps"."main"."stg_events"
),

awards as (
  select
    referral_id,
    user_id,
    event_at as awarded_at,
    -- reward_type is inside metadata_json like {"reward_type":"referrer_bonus"}
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_awarded'
),

redeems as (
  select
    referral_id,
    user_id,
    event_at as redeemed_at,
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_redeemed'
)

select
  -- deterministic surrogate key
  md5(cast(a.referral_id as varchar) || '|' || cast(a.user_id as varchar) || '|' || coalesce(a.reward_type,'')) as reward_id,
  a.referral_id,
  a.user_id,
  a.reward_type,
  a.awarded_at,
  min(r.redeemed_at) as redeemed_at
from awards a
left join redeems r
  on a.referral_id = r.referral_id
  and a.user_id = r.user_id
  and coalesce(a.reward_type,'') = coalesce(r.reward_type,'')
group by 1,2,3,4,5
    );
  
  
[0m15:04:55.726631 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_product"
[0m15:04:55.728133 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_purchase"
[0m15:04:55.728133 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m15:04:55.728133 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_product: BEGIN
[0m15:04:55.728133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:55.732098 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.fct_purchase
[0m15:04:55.732894 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_purchase"
[0m15:04:55.732894 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:04:55.732894 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m15:04:55.732894 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m15:04:55.732894 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

  
    
    

    create  table
      "carton_caps"."main"."dim_product__dbt_tmp"
  
    as (
      select
  product_id,
  name,
  category,
  price,
  points_per_dollar,
  created_at
from "carton_caps"."main"."stg_products"
    );
  
  
[0m15:04:55.739985 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m15:04:55.739985 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_referral'
  
[0m15:04:55.739985 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m15:04:55.740986 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m15:04:55.740986 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m15:04:55.741985 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: BEGIN
[0m15:04:55.741985 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.741985 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.741985 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_rewards'
  
[0m15:04:55.742986 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:55.742986 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m15:04:55.743986 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m15:04:55.743986 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_product'
  
[0m15:04:55.744985 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_referral'
  
[0m15:04:55.744985 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.744985 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.745985 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m15:04:55.745985 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:04:55.745985 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.746986 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m15:04:55.746986 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

  
    
    

    create  table
      "carton_caps"."main"."fct_purchase__dbt_tmp"
  
    as (
      select
  p.purchase_id,
  p.user_id,
  u.school_id,
  p.product_id,
  pr.category as product_category,
  p.quantity,
  p.price_paid,
  p.points_earned,
  p.purchased_at,
  date_trunc('day', p.purchased_at) as purchase_date,
  p.day_of_week,
  p.hour_of_day
from "carton_caps"."main"."stg_purchases" p
left join "carton_caps"."main"."stg_users" u
  on p.user_id = u.user_id
left join "carton_caps"."main"."stg_products" pr
  on p.product_id = pr.product_id
    );
  
  
[0m15:04:55.747986 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m15:04:55.747986 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_rewards'
  
[0m15:04:55.749988 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m15:04:55.750986 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_product'
  
[0m15:04:55.750986 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */
alter table "carton_caps"."main"."fct_referral" rename to "fct_referral__dbt_backup"
[0m15:04:55.750986 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.751986 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:04:55.751986 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.754095 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m15:04:55.755205 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m15:04:55.755205 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m15:04:55.755205 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */
alter table "carton_caps"."main"."fct_rewards" rename to "fct_rewards__dbt_backup"
[0m15:04:55.755205 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m15:04:55.755205 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */
alter table "carton_caps"."main"."dim_product" rename to "dim_product__dbt_backup"
[0m15:04:55.755205 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */
alter table "carton_caps"."main"."fct_referral__dbt_tmp" rename to "fct_referral"
[0m15:04:55.755205 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m15:04:55.759804 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.760429 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.760429 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_purchase'
  
[0m15:04:55.760429 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m15:04:55.762790 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.762790 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m15:04:55.762790 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */
alter table "carton_caps"."main"."fct_rewards__dbt_tmp" rename to "fct_rewards"
[0m15:04:55.767753 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m15:04:55.767753 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.767753 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */
alter table "carton_caps"."main"."dim_product__dbt_tmp" rename to "dim_product"
[0m15:04:55.768752 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m15:04:55.768752 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:04:55.768752 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m15:04:55.769752 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m15:04:55.770751 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m15:04:55.770751 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.770751 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_purchase'
  
[0m15:04:55.771751 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m15:04:55.772752 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m15:04:55.772752 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m15:04:55.772752 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m15:04:55.773751 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.773751 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m15:04:55.775752 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m15:04:55.776752 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:04:55.776752 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:04:55.777751 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */
alter table "carton_caps"."main"."fct_purchase" rename to "fct_purchase__dbt_backup"
[0m15:04:55.778750 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m15:04:55.778750 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.780650 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m15:04:55.780650 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

      drop table if exists "carton_caps"."main"."fct_referral__dbt_backup" cascade
    
[0m15:04:55.781701 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m15:04:55.782700 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.782700 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

      drop table if exists "carton_caps"."main"."fct_rewards__dbt_backup" cascade
    
[0m15:04:55.782700 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

      drop table if exists "carton_caps"."main"."dim_product__dbt_backup" cascade
    
[0m15:04:55.784559 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m15:04:55.784559 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.784559 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */
alter table "carton_caps"."main"."fct_purchase__dbt_tmp" rename to "fct_purchase"
[0m15:04:55.785615 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: Close
[0m15:04:55.786615 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.787571 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_product: Close
[0m15:04:55.787571 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.787571 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189B58B8C0>]}
[0m15:04:55.788655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189A54F7A0>]}
[0m15:04:55.788655 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.788655 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: Close
[0m15:04:55.789654 [info ] [Thread-2 (]: 26 of 44 OK created sql table model main.fct_referral .......................... [[32mOK[0m in 0.10s]
[0m15:04:55.790655 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m15:04:55.789654 [info ] [Thread-1 (]: 27 of 44 OK created sql table model main.dim_product ........................... [[32mOK[0m in 0.07s]
[0m15:04:55.791655 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189B5F7770>]}
[0m15:04:55.791655 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.fct_referral
[0m15:04:55.791655 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m15:04:55.792655 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.dim_product
[0m15:04:55.792655 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.dim_school
[0m15:04:55.792655 [info ] [Thread-4 (]: 25 of 44 OK created sql table model main.fct_rewards ........................... [[32mOK[0m in 0.10s]
[0m15:04:55.792655 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m15:04:55.793655 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.dim_user
[0m15:04:55.794499 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.fct_rewards
[0m15:04:55.793655 [info ] [Thread-2 (]: 29 of 44 START sql table model main.dim_school ................................. [RUN]
[0m15:04:55.795112 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m15:04:55.795112 [info ] [Thread-1 (]: 30 of 44 START sql table model main.dim_user ................................... [RUN]
[0m15:04:55.795112 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_referral, now model.dbt_carton_caps.dim_school)
[0m15:04:55.796116 [info ] [Thread-4 (]: 31 of 44 START test not_null_fct_referral_referral_id .......................... [RUN]
[0m15:04:55.796116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_product, now model.dbt_carton_caps.dim_user)
[0m15:04:55.796116 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.dim_school
[0m15:04:55.797116 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_rewards, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m15:04:55.797116 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.dim_user
[0m15:04:55.798118 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_school"
[0m15:04:55.799119 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m15:04:55.799119 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:04:55.800117 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_user"
[0m15:04:55.802698 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m15:04:55.804701 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m15:04:55.804701 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.dim_school
[0m15:04:55.805704 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

      drop table if exists "carton_caps"."main"."fct_purchase__dbt_backup" cascade
    
[0m15:04:55.807732 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_school"
[0m15:04:55.807732 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.dim_user
[0m15:04:55.807732 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m15:04:55.809736 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_user"
[0m15:04:55.810736 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.811527 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m15:04:55.811527 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: Close
[0m15:04:55.811527 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m15:04:55.811527 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189C648CE0>]}
[0m15:04:55.815356 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: BEGIN
[0m15:04:55.815356 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m15:04:55.815943 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:55.816361 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m15:04:55.815943 [info ] [Thread-3 (]: 28 of 44 OK created sql table model main.fct_purchase .......................... [[32mOK[0m in 0.09s]
[0m15:04:55.816361 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_user: BEGIN
[0m15:04:55.817360 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m15:04:55.817360 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.fct_purchase
[0m15:04:55.817360 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.817360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:55.817360 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:55.817360 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m15:04:55.817360 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m15:04:55.817360 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.817360 [info ] [Thread-3 (]: 32 of 44 START test unique_fct_referral_referral_id ............................ [RUN]
[0m15:04:55.817360 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.817360 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

  
    
    

    create  table
      "carton_caps"."main"."dim_school__dbt_tmp"
  
    as (
      select
  school_id,
  name,
  address,
  city,
  state,
  zip_code,
  created_at
from "carton_caps"."main"."stg_schools"
    );
  
  
[0m15:04:55.817360 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m15:04:55.817360 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_purchase, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m15:04:55.817360 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m15:04:55.817360 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

  
    
    

    create  table
      "carton_caps"."main"."dim_user__dbt_tmp"
  
    as (
      select
  u.user_id,
  u.first_name,
  u.last_name,
  u.email,
  u.school_id,
  s.name as school_name,
  s.state as school_state,
  u.created_at,
  u.user_type,
  u.is_verified,
  u.device_id,
  u.marketing_channel
from "carton_caps"."main"."stg_users" u
left join "carton_caps"."main"."stg_schools" s
  on u.school_id = s.school_id
    );
  
  
[0m15:04:55.817360 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m15:04:55.817360 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.822301 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.824308 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m15:04:55.825306 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.825306 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m15:04:55.826306 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.826306 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m15:04:55.827306 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_school'
  
[0m15:04:55.827306 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_user'
  
[0m15:04:55.828306 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m15:04:55.828306 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m15:04:55.830306 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m15:04:55.830306 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m15:04:55.831307 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m15:04:55.831307 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.831307 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.832306 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m15:04:55.833307 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m15:04:55.832306 [info ] [Thread-4 (]: 31 of 44 PASS not_null_fct_referral_referral_id ................................ [[32mPASS[0m in 0.04s]
[0m15:04:55.833307 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m15:04:55.834307 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m15:04:55.834307 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_user'
  
[0m15:04:55.834307 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m15:04:55.835306 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_school'
  
[0m15:04:55.835306 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:55.835306 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m15:04:55.836307 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.836307 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.836307 [info ] [Thread-4 (]: 33 of 44 START test not_null_dim_product_product_id ............................ [RUN]
[0m15:04:55.837307 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.837307 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816)
[0m15:04:55.839307 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m15:04:55.841306 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m15:04:55.841306 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m15:04:55.841306 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m15:04:55.841306 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */
alter table "carton_caps"."main"."dim_user" rename to "dim_user__dbt_backup"
[0m15:04:55.842306 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */
alter table "carton_caps"."main"."dim_school" rename to "dim_school__dbt_backup"
[0m15:04:55.842306 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:55.844307 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m15:04:55.845306 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:04:55.845306 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.847306 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m15:04:55.847306 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.849389 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m15:04:55.849389 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m15:04:55.850389 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */
alter table "carton_caps"."main"."dim_user__dbt_tmp" rename to "dim_user"
[0m15:04:55.850389 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */
alter table "carton_caps"."main"."dim_school__dbt_tmp" rename to "dim_school"
[0m15:04:55.851389 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m15:04:55.852389 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m15:04:55.853389 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m15:04:55.853389 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m15:04:55.854389 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.854389 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.855389 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m15:04:55.855389 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m15:04:55.854389 [info ] [Thread-3 (]: 32 of 44 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.04s]
[0m15:04:55.857389 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m15:04:55.857389 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m15:04:55.857389 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m15:04:55.858391 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m15:04:55.858391 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m15:04:55.858391 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m15:04:55.858391 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:55.859389 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m15:04:55.859389 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m15:04:55.859389 [info ] [Thread-3 (]: 34 of 44 START test unique_dim_product_product_id .............................. [RUN]
[0m15:04:55.860390 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.860390 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m15:04:55.861389 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m15:04:55.861389 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m15:04:55.861389 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.863971 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m15:04:55.864648 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:04:55.864648 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:04:55.864648 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m15:04:55.864648 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m15:04:55.864648 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:04:55.864648 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

      drop table if exists "carton_caps"."main"."dim_school__dbt_backup" cascade
    
[0m15:04:55.864648 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

      drop table if exists "carton_caps"."main"."dim_user__dbt_backup" cascade
    
[0m15:04:55.864648 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m15:04:55.870988 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m15:04:55.871993 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m15:04:55.871993 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.872994 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m15:04:55.873994 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: Close
[0m15:04:55.873994 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m15:04:55.873994 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:04:55.874993 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189B597260>]}
[0m15:04:55.874993 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m15:04:55.875993 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_user: Close
[0m15:04:55.874993 [info ] [Thread-4 (]: 33 of 44 PASS not_null_dim_product_product_id .................................. [[32mPASS[0m in 0.04s]
[0m15:04:55.876995 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m15:04:55.875993 [info ] [Thread-2 (]: 29 of 44 OK created sql table model main.dim_school ............................ [[32mOK[0m in 0.08s]
[0m15:04:55.876995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc5c99-e408-4844-99c0-dd85fb074fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189C677290>]}
[0m15:04:55.877994 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m15:04:55.877994 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:55.877994 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.dim_school
[0m15:04:55.878994 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m15:04:55.878994 [info ] [Thread-1 (]: 30 of 44 OK created sql table model main.dim_user .............................. [[32mOK[0m in 0.08s]
[0m15:04:55.878994 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m15:04:55.880585 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.dim_user
[0m15:04:55.879993 [info ] [Thread-4 (]: 35 of 44 START test not_null_fct_rewards_reward_id ............................. [RUN]
[0m15:04:55.880585 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.880585 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m15:04:55.880585 [info ] [Thread-2 (]: 36 of 44 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m15:04:55.881669 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m15:04:55.881669 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m15:04:55.882363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_school, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m15:04:55.882363 [info ] [Thread-1 (]: 37 of 44 START test not_null_fct_purchase_purchase_id .......................... [RUN]
[0m15:04:55.882363 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m15:04:55.883367 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:55.883367 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m15:04:55.883367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_user, now test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1)
[0m15:04:55.886368 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m15:04:55.887367 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m15:04:55.887367 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m15:04:55.887367 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.891749 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m15:04:55.892753 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m15:04:55.892753 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m15:04:55.893967 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m15:04:55.893967 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m15:04:55.893967 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m15:04:55.895275 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m15:04:55.897276 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m15:04:55.896277 [info ] [Thread-3 (]: 34 of 44 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.03s]
[0m15:04:55.897276 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m15:04:55.898277 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m15:04:55.899737 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m15:04:55.899737 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m15:04:55.900742 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m15:04:55.900742 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m15:04:55.900742 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m15:04:55.901548 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m15:04:55.901548 [info ] [Thread-3 (]: 38 of 44 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m15:04:55.902505 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m15:04:55.902505 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:55.902505 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:55.902505 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m15:04:55.903510 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m15:04:55.903510 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m15:04:55.903510 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.904510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:55.904510 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.906509 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m15:04:55.906509 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m15:04:55.907508 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m15:04:55.907508 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:04:55.907508 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.907508 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:55.907508 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m15:04:55.907508 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m15:04:55.907508 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.907508 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.907508 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m15:04:55.907508 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.912581 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m15:04:55.913702 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m15:04:55.913702 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.914702 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m15:04:55.914702 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m15:04:55.915701 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m15:04:55.915701 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m15:04:55.915701 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m15:04:55.917205 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m15:04:55.917205 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m15:04:55.917205 [info ] [Thread-2 (]: 36 of 44 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.03s]
[0m15:04:55.918210 [info ] [Thread-4 (]: 35 of 44 PASS not_null_fct_rewards_reward_id ................................... [[32mPASS[0m in 0.04s]
[0m15:04:55.918210 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m15:04:55.918210 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:55.919210 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m15:04:55.919210 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m15:04:55.919210 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m15:04:55.920209 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m15:04:55.920209 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m15:04:55.920209 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.921209 [info ] [Thread-1 (]: 37 of 44 PASS not_null_fct_purchase_purchase_id ................................ [[32mPASS[0m in 0.04s]
[0m15:04:55.921209 [info ] [Thread-2 (]: 39 of 44 START test not_null_dim_school_school_id .............................. [RUN]
[0m15:04:55.921209 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m15:04:55.921209 [info ] [Thread-4 (]: 40 of 44 START test unique_dim_school_school_id ................................ [RUN]
[0m15:04:55.922209 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m15:04:55.922209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b)
[0m15:04:55.922209 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:55.923210 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m15:04:55.923210 [debug] [Thread-1 (]: Began running node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m15:04:55.923210 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m15:04:55.924209 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m15:04:55.924209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1, now exposure.dbt_carton_caps.streamlit_product_dashboard)
[0m15:04:55.928458 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m15:04:55.930458 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m15:04:55.930458 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m15:04:55.930458 [debug] [Thread-1 (]: Began compiling node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m15:04:55.931458 [debug] [Thread-1 (]: Began executing node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m15:04:55.931458 [info ] [Thread-1 (]: 41 of 44 NO-OP exposure streamlit_product_dashboard ............................ [[33mNO-OP[0m in 0.00s]
[0m15:04:55.932460 [debug] [Thread-1 (]: Finished running node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m15:04:55.932460 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m15:04:55.933460 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m15:04:55.933460 [debug] [Thread-1 (]: Began running node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m15:04:55.933460 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m15:04:55.935474 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m15:04:55.935474 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m15:04:55.936473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly exposure.dbt_carton_caps.streamlit_product_dashboard, now exposure.dbt_carton_caps.streamlit_referral_finance_dashboard)
[0m15:04:55.937472 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m15:04:55.937472 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m15:04:55.938473 [debug] [Thread-1 (]: Began compiling node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m15:04:55.938473 [debug] [Thread-1 (]: Began executing node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m15:04:55.939474 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m15:04:55.938473 [info ] [Thread-3 (]: 38 of 44 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.04s]
[0m15:04:55.939474 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m15:04:55.939474 [info ] [Thread-1 (]: 42 of 44 NO-OP exposure streamlit_referral_finance_dashboard ................... [[33mNO-OP[0m in 0.00s]
[0m15:04:55.940473 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m15:04:55.940473 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m15:04:55.940473 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:55.941473 [debug] [Thread-1 (]: Finished running node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m15:04:55.941473 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m15:04:55.941473 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m15:04:55.942473 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m15:04:55.942473 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:55.942473 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.943473 [info ] [Thread-3 (]: 43 of 44 START test not_null_dim_user_user_id .................................. [RUN]
[0m15:04:55.943473 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m15:04:55.944473 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a, now test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3)
[0m15:04:55.944473 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:04:55.943473 [info ] [Thread-1 (]: 44 of 44 START test unique_dim_user_user_id .................................... [RUN]
[0m15:04:55.944473 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.945473 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m15:04:55.945473 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m15:04:55.945473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly exposure.dbt_carton_caps.streamlit_referral_finance_dashboard, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m15:04:55.948473 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m15:04:55.948473 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.948473 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:55.949473 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m15:04:55.950473 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m15:04:55.952474 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m15:04:55.952474 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:04:55.953473 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m15:04:55.953473 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m15:04:55.953473 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m15:04:55.955474 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m15:04:55.955474 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m15:04:55.956472 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m15:04:55.956472 [info ] [Thread-2 (]: 39 of 44 PASS not_null_dim_school_school_id .................................... [[32mPASS[0m in 0.03s]
[0m15:04:55.957473 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m15:04:55.958474 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m15:04:55.958474 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m15:04:55.959474 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m15:04:55.959474 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m15:04:55.960474 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m15:04:55.961472 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:55.960474 [info ] [Thread-4 (]: 40 of 44 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.04s]
[0m15:04:55.961472 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m15:04:55.961472 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m15:04:55.962472 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.962472 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m15:04:55.962472 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m15:04:55.963473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:55.963473 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:55.963473 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.964474 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m15:04:55.964474 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:55.964474 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.965473 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m15:04:55.965473 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:55.966472 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m15:04:55.966472 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m15:04:55.967473 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m15:04:55.968473 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m15:04:55.967473 [info ] [Thread-3 (]: 43 of 44 PASS not_null_dim_user_user_id ........................................ [[32mPASS[0m in 0.02s]
[0m15:04:55.968473 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m15:04:55.969475 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m15:04:55.969475 [info ] [Thread-1 (]: 44 of 44 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.02s]
[0m15:04:55.969475 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m15:04:55.970474 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:55.970474 [debug] [MainThread]: On master: BEGIN
[0m15:04:55.971474 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:04:55.971474 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:04:55.971474 [debug] [MainThread]: On master: COMMIT
[0m15:04:55.971474 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:55.971474 [debug] [MainThread]: On master: COMMIT
[0m15:04:55.972649 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:04:55.972649 [debug] [MainThread]: On master: Close
[0m15:04:55.972649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:55.972649 [debug] [MainThread]: Connection 'create_carton_caps_main' was properly closed.
[0m15:04:55.972649 [debug] [MainThread]: Connection 'list_carton_caps_main' was properly closed.
[0m15:04:55.973647 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278' was properly closed.
[0m15:04:55.973647 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b' was properly closed.
[0m15:04:55.973647 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3' was properly closed.
[0m15:04:55.973647 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76' was properly closed.
[0m15:04:55.973647 [info ] [MainThread]: 
[0m15:04:55.974647 [info ] [MainThread]: Finished running 2 exposures, 6 table models, 30 data tests, 6 view models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m15:04:55.977983 [debug] [MainThread]: Command end result
[0m15:04:55.993511 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m15:04:55.993511 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m15:04:55.996463 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\run_results.json
[0m15:04:55.996463 [info ] [MainThread]: 
[0m15:04:55.996463 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:04:55.996463 [info ] [MainThread]: 
[0m15:04:56.000851 [info ] [MainThread]: Done. PASS=42 WARN=0 ERROR=0 SKIP=0 NO-OP=2 TOTAL=44
[0m15:04:56.000851 [debug] [MainThread]: Command `dbt build` succeeded at 15:04:56.000851 after 1.52 seconds
[0m15:04:56.000851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189582E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021898495460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021898495550>]}
[0m15:04:56.001856 [debug] [MainThread]: Flushing usage events
[0m15:04:56.396132 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:57.869043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F4532F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F45325A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F4530E60>]}


============================== 15:04:57.869043 | 1380fa11-322b-4b44-bef9-2d9a94bd990a ==============================
[0m15:04:57.869043 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:04:57.869043 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --profiles-dir .', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m15:04:58.002401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1380fa11-322b-4b44-bef9-2d9a94bd990a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F3EFB2C0>]}
[0m15:04:58.049375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1380fa11-322b-4b44-bef9-2d9a94bd990a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F4A2CB60>]}
[0m15:04:58.049375 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:04:58.188839 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:04:58.284259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:58.284259 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:04:58.284259 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:58.316035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1380fa11-322b-4b44-bef9-2d9a94bd990a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F5CFCF50>]}
[0m15:04:58.374914 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m15:04:58.376914 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m15:04:58.392587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1380fa11-322b-4b44-bef9-2d9a94bd990a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F65C28A0>]}
[0m15:04:58.392587 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m15:04:58.392587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1380fa11-322b-4b44-bef9-2d9a94bd990a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F64CC3B0>]}
[0m15:04:58.392587 [info ] [MainThread]: 
[0m15:04:58.392587 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:04:58.392587 [info ] [MainThread]: 
[0m15:04:58.392587 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:04:58.392587 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_main'
[0m15:04:58.449418 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_main"
[0m15:04:58.449418 [debug] [ThreadPool]: On list_carton_caps_main: BEGIN
[0m15:04:58.450418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:58.470144 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m15:04:58.471145 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_main"
[0m15:04:58.471145 [debug] [ThreadPool]: On list_carton_caps_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_main"} */
select
      'carton_caps' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps'
  
[0m15:04:58.480142 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m15:04:58.480142 [debug] [ThreadPool]: On list_carton_caps_main: ROLLBACK
[0m15:04:58.481142 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_main'
[0m15:04:58.482142 [debug] [ThreadPool]: On list_carton_caps_main: Close
[0m15:04:58.483144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1380fa11-322b-4b44-bef9-2d9a94bd990a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F60B4CB0>]}
[0m15:04:58.483144 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:58.483144 [debug] [MainThread]: On master: BEGIN
[0m15:04:58.483144 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:58.484145 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:04:58.484145 [debug] [MainThread]: On master: COMMIT
[0m15:04:58.484145 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:58.484145 [debug] [MainThread]: On master: COMMIT
[0m15:04:58.485144 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:04:58.485144 [debug] [MainThread]: On master: Close
[0m15:04:58.487144 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m15:04:58.487144 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m15:04:58.487144 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m15:04:58.487144 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m15:04:58.487144 [info ] [Thread-1 (]: 1 of 30 START test not_null_dim_product_product_id ............................. [RUN]
[0m15:04:58.487144 [info ] [Thread-2 (]: 2 of 30 START test not_null_dim_school_school_id ............................... [RUN]
[0m15:04:58.487144 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m15:04:58.487144 [info ] [Thread-3 (]: 3 of 30 START test not_null_dim_user_user_id ................................... [RUN]
[0m15:04:58.487144 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m15:04:58.487144 [info ] [Thread-4 (]: 4 of 30 START test not_null_fct_purchase_purchase_id ........................... [RUN]
[0m15:04:58.487144 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m15:04:58.487144 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m15:04:58.487144 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m15:04:58.487144 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m15:04:58.493775 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m15:04:58.493775 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m15:04:58.502794 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m15:04:58.503291 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m15:04:58.506089 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m15:04:58.508282 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m15:04:58.508282 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m15:04:58.519423 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m15:04:58.519423 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m15:04:58.519423 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m15:04:58.519423 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m15:04:58.519423 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m15:04:58.519423 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m15:04:58.524228 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m15:04:58.524228 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m15:04:58.524228 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m15:04:58.524228 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m15:04:58.524228 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:04:58.524228 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m15:04:58.524228 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m15:04:58.524228 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m15:04:58.524228 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:04:58.524228 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.524228 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m15:04:58.524228 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m15:04:58.524228 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m15:04:58.524228 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:04:58.524228 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.524228 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:04:58.524228 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.524228 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m15:04:58.524228 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.524228 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.524228 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.524228 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m15:04:58.530677 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.530677 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m15:04:58.530677 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.533757 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m15:04:58.533757 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.533757 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:04:58.534759 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m15:04:58.534759 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.534759 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m15:04:58.535758 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m15:04:58.535758 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.536758 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m15:04:58.537620 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m15:04:58.537620 [info ] [Thread-1 (]: 1 of 30 PASS not_null_dim_product_product_id ................................... [[32mPASS[0m in 0.05s]
[0m15:04:58.538643 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m15:04:58.538643 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m15:04:58.539642 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m15:04:58.539642 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m15:04:58.540643 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m15:04:58.540643 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m15:04:58.540643 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m15:04:58.540643 [info ] [Thread-3 (]: 3 of 30 PASS not_null_dim_user_user_id ......................................... [[32mPASS[0m in 0.05s]
[0m15:04:58.541643 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m15:04:58.541643 [info ] [Thread-2 (]: 2 of 30 PASS not_null_dim_school_school_id ..................................... [[32mPASS[0m in 0.05s]
[0m15:04:58.541643 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m15:04:58.541643 [info ] [Thread-1 (]: 5 of 30 START test not_null_fct_referral_referral_id ........................... [RUN]
[0m15:04:58.543159 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m15:04:58.542643 [info ] [Thread-4 (]: 4 of 30 PASS not_null_fct_purchase_purchase_id ................................. [[32mPASS[0m in 0.06s]
[0m15:04:58.544223 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m15:04:58.544533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m15:04:58.544533 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m15:04:58.545243 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m15:04:58.545243 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m15:04:58.545243 [info ] [Thread-3 (]: 6 of 30 START test not_null_fct_rewards_reward_id .............................. [RUN]
[0m15:04:58.546259 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m15:04:58.545243 [info ] [Thread-2 (]: 7 of 30 START test not_null_stg_events_event_id ................................ [RUN]
[0m15:04:58.548985 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m15:04:58.548985 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m15:04:58.548985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m15:04:58.548985 [info ] [Thread-4 (]: 8 of 30 START test not_null_stg_events_user_id ................................. [RUN]
[0m15:04:58.548985 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m15:04:58.550512 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m15:04:58.550512 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m15:04:58.552518 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m15:04:58.555817 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m15:04:58.555817 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m15:04:58.555817 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m15:04:58.555817 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m15:04:58.558844 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m15:04:58.558844 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m15:04:58.558844 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m15:04:58.558844 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m15:04:58.558844 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m15:04:58.563538 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m15:04:58.593449 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m15:04:58.593449 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m15:04:58.593449 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m15:04:58.593449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:58.593449 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m15:04:58.593449 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m15:04:58.593449 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m15:04:58.593449 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m15:04:58.593449 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:58.593449 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.593449 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m15:04:58.593449 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m15:04:58.593449 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m15:04:58.593449 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:58.593449 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.593449 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:58.593449 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.593449 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m15:04:58.593449 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.593449 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.593449 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.593449 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.593449 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m15:04:58.593449 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m15:04:58.593449 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.593449 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.593449 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m15:04:58.593449 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.593449 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m15:04:58.593449 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m15:04:58.593449 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.593449 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m15:04:58.593449 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.593449 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m15:04:58.609505 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m15:04:58.609505 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m15:04:58.609505 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m15:04:58.609505 [info ] [Thread-1 (]: 5 of 30 PASS not_null_fct_referral_referral_id ................................. [[32mPASS[0m in 0.06s]
[0m15:04:58.609505 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m15:04:58.609505 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m15:04:58.609505 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m15:04:58.609505 [info ] [Thread-2 (]: 7 of 30 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.06s]
[0m15:04:58.609505 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m15:04:58.609505 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m15:04:58.609505 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m15:04:58.609505 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m15:04:58.609505 [info ] [Thread-4 (]: 8 of 30 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.06s]
[0m15:04:58.609505 [info ] [Thread-3 (]: 6 of 30 PASS not_null_fct_rewards_reward_id .................................... [[32mPASS[0m in 0.06s]
[0m15:04:58.609505 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m15:04:58.609505 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m15:04:58.609505 [info ] [Thread-1 (]: 9 of 30 START test not_null_stg_products_product_id ............................ [RUN]
[0m15:04:58.615925 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m15:04:58.615925 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m15:04:58.615925 [info ] [Thread-2 (]: 10 of 30 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m15:04:58.616570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m15:04:58.617094 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m15:04:58.617094 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m15:04:58.617094 [info ] [Thread-4 (]: 11 of 30 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m15:04:58.617094 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m15:04:58.618441 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m15:04:58.618109 [info ] [Thread-3 (]: 12 of 30 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m15:04:58.618894 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m15:04:58.621341 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m15:04:58.623736 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m15:04:58.623736 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m15:04:58.623736 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m15:04:58.623736 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m15:04:58.623736 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m15:04:58.628873 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m15:04:58.629872 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m15:04:58.630925 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m15:04:58.630925 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m15:04:58.630925 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m15:04:58.632931 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m15:04:58.633932 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m15:04:58.634920 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m15:04:58.634920 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m15:04:58.636530 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m15:04:58.636530 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m15:04:58.636530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:58.636530 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m15:04:58.637531 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m15:04:58.637531 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m15:04:58.637531 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m15:04:58.638531 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m15:04:58.638531 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:58.638531 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.638531 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:58.639530 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m15:04:58.639530 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m15:04:58.639530 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.639530 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:58.640530 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.640530 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.640530 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m15:04:58.640530 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m15:04:58.641531 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.642085 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.642085 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.642542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.642542 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m15:04:58.642542 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.643559 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m15:04:58.643559 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:04:58.643559 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.643559 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m15:04:58.643559 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m15:04:58.643559 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:04:58.643559 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m15:04:58.643559 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m15:04:58.648700 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m15:04:58.649158 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m15:04:58.649158 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m15:04:58.649158 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m15:04:58.649158 [info ] [Thread-1 (]: 9 of 30 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.03s]
[0m15:04:58.649158 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m15:04:58.649158 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m15:04:58.649158 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m15:04:58.649158 [info ] [Thread-2 (]: 10 of 30 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.03s]
[0m15:04:58.649158 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m15:04:58.649158 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m15:04:58.649158 [info ] [Thread-4 (]: 11 of 30 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.03s]
[0m15:04:58.649158 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m15:04:58.649158 [info ] [Thread-3 (]: 12 of 30 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.03s]
[0m15:04:58.649158 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m15:04:58.649158 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m15:04:58.649158 [info ] [Thread-1 (]: 13 of 30 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m15:04:58.655639 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m15:04:58.655639 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m15:04:58.655639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m15:04:58.655639 [info ] [Thread-2 (]: 14 of 30 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m15:04:58.656644 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m15:04:58.656644 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m15:04:58.656644 [info ] [Thread-4 (]: 15 of 30 START test not_null_stg_schools_school_id ............................. [RUN]
[0m15:04:58.657645 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m15:04:58.659391 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m15:04:58.657645 [info ] [Thread-3 (]: 16 of 30 START test not_null_stg_users_school_id ............................... [RUN]
[0m15:04:58.660521 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m15:04:58.660521 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m15:04:58.660521 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m15:04:58.661522 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m15:04:58.663034 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m15:04:58.663034 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m15:04:58.663034 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m15:04:58.663034 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m15:04:58.663034 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m15:04:58.669543 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m15:04:58.670689 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m15:04:58.672603 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m15:04:58.672603 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m15:04:58.674383 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m15:04:58.674383 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m15:04:58.675623 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m15:04:58.676525 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m15:04:58.676525 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m15:04:58.677184 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m15:04:58.677791 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m15:04:58.677791 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m15:04:58.678358 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m15:04:58.678358 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:58.678915 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m15:04:58.678915 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m15:04:58.679504 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:58.679504 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:58.680093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:58.680093 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.680685 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.680685 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m15:04:58.681283 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.681283 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.681802 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m15:04:58.681802 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.681802 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m15:04:58.682321 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m15:04:58.682321 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.682838 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.683354 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.683354 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.685070 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m15:04:58.685070 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.685588 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m15:04:58.686103 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.686103 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.687133 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m15:04:58.687133 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m15:04:58.688164 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m15:04:58.688164 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m15:04:58.689170 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m15:04:58.690563 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m15:04:58.689170 [info ] [Thread-2 (]: 14 of 30 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.03s]
[0m15:04:58.690563 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m15:04:58.690563 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m15:04:58.691578 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m15:04:58.691578 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m15:04:58.692576 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m15:04:58.691578 [info ] [Thread-4 (]: 15 of 30 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.03s]
[0m15:04:58.692576 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m15:04:58.692576 [info ] [Thread-3 (]: 16 of 30 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m15:04:58.693577 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m15:04:58.693577 [info ] [Thread-1 (]: 13 of 30 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.04s]
[0m15:04:58.693577 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m15:04:58.693577 [info ] [Thread-2 (]: 17 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m15:04:58.694577 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m15:04:58.694577 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m15:04:58.694577 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m15:04:58.695576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m15:04:58.695576 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m15:04:58.695576 [info ] [Thread-4 (]: 18 of 30 START test test_events_in_window ...................................... [RUN]
[0m15:04:58.696434 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m15:04:58.696434 [info ] [Thread-3 (]: 19 of 30 START test unique_dim_product_product_id .............................. [RUN]
[0m15:04:58.697319 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.test_events_in_window)
[0m15:04:58.696434 [info ] [Thread-1 (]: 20 of 30 START test unique_dim_school_school_id ................................ [RUN]
[0m15:04:58.699550 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m15:04:58.699550 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m15:04:58.699550 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m15:04:58.700794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m15:04:58.700794 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m15:04:58.701795 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m15:04:58.701795 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m15:04:58.707575 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m15:04:58.709575 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m15:04:58.709575 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m15:04:58.711207 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m15:04:58.711207 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m15:04:58.712212 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m15:04:58.713213 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m15:04:58.713213 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m15:04:58.713213 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m15:04:58.713213 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m15:04:58.713213 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m15:04:58.713213 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m15:04:58.713213 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m15:04:58.713213 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m15:04:58.718144 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:58.718144 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m15:04:58.718674 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m15:04:58.718674 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:58.718674 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m15:04:58.719679 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m15:04:58.719679 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.719679 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:58.719679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:58.719679 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.719679 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m15:04:58.719679 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m15:04:58.719679 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m15:04:58.719679 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.719679 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.719679 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m15:04:58.719679 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m15:04:58.719679 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m15:04:58.719679 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:58.719679 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:58.719679 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.725120 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m15:04:58.725120 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.726125 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m15:04:58.726125 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:04:58.726125 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.727124 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m15:04:58.727124 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m15:04:58.728124 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m15:04:58.729125 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m15:04:58.730124 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m15:04:58.729125 [info ] [Thread-2 (]: 17 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m15:04:58.730124 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m15:04:58.731125 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m15:04:58.731125 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m15:04:58.732077 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m15:04:58.732077 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m15:04:58.733138 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m15:04:58.733138 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m15:04:58.733138 [info ] [Thread-3 (]: 19 of 30 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.03s]
[0m15:04:58.734138 [info ] [Thread-4 (]: 18 of 30 PASS test_events_in_window ............................................ [[32mPASS[0m in 0.04s]
[0m15:04:58.734753 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m15:04:58.734138 [info ] [Thread-1 (]: 20 of 30 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m15:04:58.734753 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m15:04:58.735777 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m15:04:58.734138 [info ] [Thread-2 (]: 21 of 30 START test unique_dim_user_user_id .................................... [RUN]
[0m15:04:58.735777 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m15:04:58.735777 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m15:04:58.736777 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m15:04:58.735777 [info ] [Thread-3 (]: 22 of 30 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m15:04:58.736777 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m15:04:58.736777 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m15:04:58.736777 [info ] [Thread-4 (]: 23 of 30 START test unique_fct_referral_referral_id ............................ [RUN]
[0m15:04:58.737777 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m15:04:58.740448 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m15:04:58.737777 [info ] [Thread-1 (]: 24 of 30 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m15:04:58.740448 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m15:04:58.741462 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m15:04:58.741462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m15:04:58.741462 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m15:04:58.744750 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m15:04:58.744750 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m15:04:58.744750 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m15:04:58.747753 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m15:04:58.748752 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m15:04:58.748752 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m15:04:58.748752 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m15:04:58.753573 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m15:04:58.753573 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m15:04:58.753573 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m15:04:58.753573 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m15:04:58.753573 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m15:04:58.753573 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m15:04:58.753573 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:58.753573 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m15:04:58.753573 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m15:04:58.753573 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m15:04:58.753573 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:58.759814 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:04:58.759814 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m15:04:58.759814 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m15:04:58.760820 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m15:04:58.760820 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:58.760820 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.760820 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m15:04:58.760820 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:58.761819 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m15:04:58.761819 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m15:04:58.761819 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:58.762819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:58.762819 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.762819 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.763819 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m15:04:58.763819 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.764820 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m15:04:58.764820 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:58.765821 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m15:04:58.766820 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m15:04:58.766820 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:04:58.766820 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:58.767819 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m15:04:58.767819 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.768819 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m15:04:58.769819 [info ] [Thread-2 (]: 21 of 30 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.03s]
[0m15:04:58.769819 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.770819 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m15:04:58.770819 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m15:04:58.771818 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m15:04:58.771818 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m15:04:58.772819 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m15:04:58.773711 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m15:04:58.773711 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m15:04:58.774759 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m15:04:58.773711 [info ] [Thread-3 (]: 22 of 30 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.04s]
[0m15:04:58.775180 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m15:04:58.775846 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m15:04:58.775180 [info ] [Thread-2 (]: 25 of 30 START test unique_stg_events_event_id ................................. [RUN]
[0m15:04:58.776306 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m15:04:58.776306 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m15:04:58.776306 [info ] [Thread-4 (]: 23 of 30 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.04s]
[0m15:04:58.777582 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m15:04:58.776306 [info ] [Thread-1 (]: 24 of 30 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.03s]
[0m15:04:58.777582 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m15:04:58.778604 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m15:04:58.778604 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m15:04:58.778604 [info ] [Thread-3 (]: 26 of 30 START test unique_stg_products_product_id ............................. [RUN]
[0m15:04:58.782109 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m15:04:58.782868 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m15:04:58.782868 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m15:04:58.782868 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m15:04:58.782868 [info ] [Thread-4 (]: 27 of 30 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m15:04:58.784363 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m15:04:58.782868 [info ] [Thread-1 (]: 28 of 30 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m15:04:58.784363 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m15:04:58.784363 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m15:04:58.786370 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m15:04:58.786370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m15:04:58.789377 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m15:04:58.789921 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m15:04:58.789921 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m15:04:58.792672 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m15:04:58.792672 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m15:04:58.795064 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m15:04:58.795579 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m15:04:58.795949 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m15:04:58.795949 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:58.797521 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m15:04:58.798075 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m15:04:58.798522 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m15:04:58.799034 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:04:58.800054 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m15:04:58.801482 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m15:04:58.802004 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m15:04:58.802518 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m15:04:58.804061 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:58.804061 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m15:04:58.804574 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m15:04:58.804574 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m15:04:58.805319 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:58.805319 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m15:04:58.805834 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m15:04:58.806369 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:58.806369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:58.806892 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.807945 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m15:04:58.808453 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:58.808453 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.808968 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:04:58.808968 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:04:58.808968 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m15:04:58.808968 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m15:04:58.808968 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:58.808968 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.808968 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m15:04:58.808968 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:58.808968 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m15:04:58.808968 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m15:04:58.808968 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.808968 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m15:04:58.808968 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m15:04:58.815383 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m15:04:58.816388 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m15:04:58.816388 [info ] [Thread-2 (]: 25 of 30 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m15:04:58.816388 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:04:58.817387 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m15:04:58.817387 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m15:04:58.817387 [info ] [Thread-3 (]: 26 of 30 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m15:04:58.818387 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m15:04:58.818387 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m15:04:58.818387 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m15:04:58.818387 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m15:04:58.819890 [info ] [Thread-1 (]: 28 of 30 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m15:04:58.819890 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m15:04:58.820898 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m15:04:58.820898 [info ] [Thread-2 (]: 29 of 30 START test unique_stg_schools_school_id ............................... [RUN]
[0m15:04:58.820898 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m15:04:58.821897 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m15:04:58.821897 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m15:04:58.821897 [info ] [Thread-3 (]: 30 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m15:04:58.822898 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m15:04:58.822898 [info ] [Thread-4 (]: 27 of 30 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.04s]
[0m15:04:58.822898 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m15:04:58.825895 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m15:04:58.825895 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m15:04:58.826898 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m15:04:58.828896 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m15:04:58.829899 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m15:04:58.830900 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m15:04:58.830900 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m15:04:58.832899 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m15:04:58.832899 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m15:04:58.833900 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m15:04:58.833900 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:58.833900 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m15:04:58.834898 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m15:04:58.834898 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.834898 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:58.834898 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m15:04:58.835897 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:58.835897 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.835897 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m15:04:58.835897 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:58.836898 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:04:58.837899 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m15:04:58.837899 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:04:58.838898 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m15:04:58.839896 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m15:04:58.839896 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m15:04:58.840896 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m15:04:58.840896 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m15:04:58.840896 [info ] [Thread-2 (]: 29 of 30 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.02s]
[0m15:04:58.841896 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m15:04:58.841896 [info ] [Thread-3 (]: 30 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.02s]
[0m15:04:58.842903 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m15:04:58.842903 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:58.843905 [debug] [MainThread]: On master: BEGIN
[0m15:04:58.843905 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:04:58.843905 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:04:58.843905 [debug] [MainThread]: On master: COMMIT
[0m15:04:58.844904 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:58.844904 [debug] [MainThread]: On master: COMMIT
[0m15:04:58.844904 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:04:58.844904 [debug] [MainThread]: On master: Close
[0m15:04:58.845902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:58.845902 [debug] [MainThread]: Connection 'list_carton_caps_main' was properly closed.
[0m15:04:58.845902 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d' was properly closed.
[0m15:04:58.845902 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6' was properly closed.
[0m15:04:58.845902 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m15:04:58.845902 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103' was properly closed.
[0m15:04:58.846899 [info ] [MainThread]: 
[0m15:04:58.846899 [info ] [MainThread]: Finished running 30 data tests in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m15:04:58.846899 [debug] [MainThread]: Command end result
[0m15:04:58.864187 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m15:04:58.866187 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m15:04:58.870921 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\run_results.json
[0m15:04:58.871471 [info ] [MainThread]: 
[0m15:04:58.871471 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:04:58.871471 [info ] [MainThread]: 
[0m15:04:58.871471 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=30
[0m15:04:58.871471 [debug] [MainThread]: Command `dbt test` succeeded at 15:04:58.871471 after 1.08 seconds
[0m15:04:58.871471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F3947410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F3946420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F5C65010>]}
[0m15:04:58.871471 [debug] [MainThread]: Flushing usage events
[0m15:04:59.156641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:26.849666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CBC65EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CED31C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CED339B0>]}


============================== 16:47:26.857214 | 562da7cf-dd7a-411b-b222-5469666da76f ==============================
[0m16:47:26.857214 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:47:26.857214 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'dbt_carton_caps', 'use_colors': 'True', 'invocation_command': 'dbt build --profiles-dir dbt_carton_caps --project-dir dbt_carton_caps', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'dbt_carton_caps\\logs'}
[0m16:47:27.009735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '562da7cf-dd7a-411b-b222-5469666da76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CE8D1400>]}
[0m16:47:27.046817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '562da7cf-dd7a-411b-b222-5469666da76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CEEB5970>]}
[0m16:47:27.047825 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:47:27.259769 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:47:27.593712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:47:27.593712 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:47:27.593712 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:47:27.625547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '562da7cf-dd7a-411b-b222-5469666da76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227D0539490>]}
[0m16:47:27.682971 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_carton_caps\target\manifest.json
[0m16:47:27.684975 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_carton_caps\target\semantic_manifest.json
[0m16:47:27.710084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '562da7cf-dd7a-411b-b222-5469666da76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227D09FE8D0>]}
[0m16:47:27.710084 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m16:47:27.712087 [info ] [MainThread]: 
[0m16:47:27.713087 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:47:27.713087 [info ] [MainThread]: 
[0m16:47:27.713087 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:47:27.716372 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps'
[0m16:47:28.288303 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps"
[0m16:47:28.288303 [debug] [ThreadPool]: On list_carton_caps: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps"'
    
  
  
[0m16:47:28.288303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:28.300083 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps"'
    
  
  
[0m16:47:28.300083 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m16:47:28.300083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:28.300083 [debug] [MainThread]: Connection 'list_carton_caps' was properly closed.
[0m16:47:28.300083 [info ] [MainThread]: 
[0m16:47:28.300083 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m16:47:28.300083 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\repos\livefront\carton_caps_analytics\..\duckdb\carton_caps.duckdb": The system cannot find the path specified.
  
[0m16:47:28.300083 [debug] [MainThread]: Command `dbt build` failed at 16:47:28.300083 after 1.57 seconds
[0m16:47:28.300083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CE2C16A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227D09DF6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227D0510E90>]}
[0m16:47:28.303708 [debug] [MainThread]: Flushing usage events
[0m16:47:28.683228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:35.695238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4D963EE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4D963D7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4D99DDD60>]}


============================== 16:48:35.695238 | 8cda781f-12c0-43a4-8a12-f7c06b2e784c ==============================
[0m16:48:35.695238 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:48:35.695238 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'dbt_carton_caps', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt build --profiles-dir dbt_carton_caps --project-dir dbt_carton_caps', 'use_experimental_parser': 'False', 'log_path': 'dbt_carton_caps\\logs'}
[0m16:48:35.830543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cda781f-12c0-43a4-8a12-f7c06b2e784c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4DA0ABAA0>]}
[0m16:48:35.874244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cda781f-12c0-43a4-8a12-f7c06b2e784c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4D71E4680>]}
[0m16:48:35.876245 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:48:36.025382 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:48:36.114317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:36.114317 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:48:36.114317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:36.146252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cda781f-12c0-43a4-8a12-f7c06b2e784c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4DB985C40>]}
[0m16:48:36.202066 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_carton_caps\target\manifest.json
[0m16:48:36.202066 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_carton_caps\target\semantic_manifest.json
[0m16:48:36.228988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cda781f-12c0-43a4-8a12-f7c06b2e784c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4D7B62660>]}
[0m16:48:36.229989 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m16:48:36.231987 [info ] [MainThread]: 
[0m16:48:36.231987 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:36.231987 [info ] [MainThread]: 
[0m16:48:36.232987 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:48:36.235988 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps'
[0m16:48:36.280659 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps"
[0m16:48:36.280659 [debug] [ThreadPool]: On list_carton_caps: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps"'
    
  
  
[0m16:48:36.280659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:36.287631 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps"'
    
  
  
[0m16:48:36.288639 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m16:48:36.288639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:36.289638 [debug] [MainThread]: Connection 'list_carton_caps' was properly closed.
[0m16:48:36.289638 [info ] [MainThread]: 
[0m16:48:36.289638 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m16:48:36.289638 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\repos\livefront\carton_caps_analytics\..\duckdb\carton_caps.duckdb": The system cannot find the path specified.
  
[0m16:48:36.290639 [debug] [MainThread]: Command `dbt build` failed at 16:48:36.290639 after 0.69 seconds
[0m16:48:36.290639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4D9B51340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4DBAC6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4DC0B0050>]}
[0m16:48:36.290639 [debug] [MainThread]: Flushing usage events
[0m16:48:36.635361 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:54.015924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197D2FC61B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197D3BD3EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197D3BD1190>]}


============================== 16:50:54.029528 | 455f9f34-47bd-4a9f-a9a2-004199246ebe ==============================
[0m16:50:54.029528 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:50:54.029528 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'dbt_carton_caps', 'use_colors': 'True', 'invocation_command': 'dbt build --profiles-dir dbt_carton_caps --project-dir dbt_carton_caps', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'dbt_carton_caps\\logs'}
[0m16:50:54.171868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '455f9f34-47bd-4a9f-a9a2-004199246ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197D63E3B90>]}
[0m16:50:54.212059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '455f9f34-47bd-4a9f-a9a2-004199246ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197D5BC1820>]}
[0m16:50:54.214065 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:50:54.367582 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:50:54.440620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:54.456325 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:50:54.456325 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:54.488450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '455f9f34-47bd-4a9f-a9a2-004199246ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197D7C27E60>]}
[0m16:50:54.534281 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_carton_caps\target\manifest.json
[0m16:50:54.534281 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_carton_caps\target\semantic_manifest.json
[0m16:50:54.571209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '455f9f34-47bd-4a9f-a9a2-004199246ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197D5D41610>]}
[0m16:50:54.572209 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m16:50:54.574208 [info ] [MainThread]: 
[0m16:50:54.574208 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:50:54.574208 [info ] [MainThread]: 
[0m16:50:54.575208 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:50:54.578207 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps'
[0m16:50:54.620995 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps"
[0m16:50:54.620995 [debug] [ThreadPool]: On list_carton_caps: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps"'
    
  
  
[0m16:50:54.620995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:54.628728 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps"'
    
  
  
[0m16:50:54.628728 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m16:50:54.628728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:54.628728 [debug] [MainThread]: Connection 'list_carton_caps' was properly closed.
[0m16:50:54.628728 [info ] [MainThread]: 
[0m16:50:54.628728 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m16:50:54.628728 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\repos\livefront\carton_caps_analytics\..\duckdb\carton_caps.duckdb": The system cannot find the path specified.
  
[0m16:50:54.628728 [debug] [MainThread]: Command `dbt build` failed at 16:50:54.628728 after 0.82 seconds
[0m16:50:54.631152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197D6214F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197D78B0E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197D8100350>]}
[0m16:50:54.631152 [debug] [MainThread]: Flushing usage events
[0m16:50:55.049567 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:31.555371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D91345CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D91702300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D939AFE00>]}


============================== 16:58:31.559420 | e9628f47-f08f-4cd6-aa17-d5f5c9e6904a ==============================
[0m16:58:31.559420 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:58:31.559420 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'dbt_carton_caps', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt build --profiles-dir dbt_carton_caps --project-dir dbt_carton_caps', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'dbt_carton_caps\\logs'}
[0m16:58:31.702492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9628f47-f08f-4cd6-aa17-d5f5c9e6904a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D946E2BA0>]}
[0m16:58:31.735980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9628f47-f08f-4cd6-aa17-d5f5c9e6904a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D94077140>]}
[0m16:58:31.735980 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:58:31.892630 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:58:31.984646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:58:31.984646 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:58:31.984646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:58:32.018071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9628f47-f08f-4cd6-aa17-d5f5c9e6904a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D95BD7EF0>]}
[0m16:58:32.080062 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_carton_caps\target\manifest.json
[0m16:58:32.082181 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_carton_caps\target\semantic_manifest.json
[0m16:58:32.110169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9628f47-f08f-4cd6-aa17-d5f5c9e6904a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D95DAA0C0>]}
[0m16:58:32.110881 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m16:58:32.113159 [info ] [MainThread]: 
[0m16:58:32.113159 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:58:32.114161 [info ] [MainThread]: 
[0m16:58:32.114161 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:58:32.117830 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps'
[0m16:58:32.165577 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps"
[0m16:58:32.166578 [debug] [ThreadPool]: On list_carton_caps: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps"'
    
  
  
[0m16:58:32.166578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:32.166578 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps"'
    
  
  
[0m16:58:32.166578 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m16:58:32.166578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:32.166578 [debug] [MainThread]: Connection 'list_carton_caps' was properly closed.
[0m16:58:32.166578 [info ] [MainThread]: 
[0m16:58:32.166578 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m16:58:32.166578 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\repos\livefront\carton_caps_analytics\..\duckdb\carton_caps.duckdb": The system cannot find the path specified.
  
[0m16:58:32.166578 [debug] [MainThread]: Command `dbt build` failed at 16:58:32.166578 after 0.77 seconds
[0m16:58:32.166578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D94007D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D944BE180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D96470110>]}
[0m16:58:32.166578 [debug] [MainThread]: Flushing usage events
[0m16:58:32.562735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:34.085463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179887C1BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179887C3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179887C1B50>]}


============================== 16:58:34.085463 | 79b5221a-53be-4f82-aa2a-83abc40fc9f1 ==============================
[0m16:58:34.085463 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:58:34.085463 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'dbt_carton_caps', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --profiles-dir dbt_carton_caps --project-dir dbt_carton_caps', 'use_experimental_parser': 'False', 'log_path': 'dbt_carton_caps\\logs'}
[0m16:58:34.228611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79b5221a-53be-4f82-aa2a-83abc40fc9f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017988E63C80>]}
[0m16:58:34.263696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79b5221a-53be-4f82-aa2a-83abc40fc9f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798857D5B0>]}
[0m16:58:34.263696 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:58:34.426203 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:58:34.513841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:58:34.513841 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:58:34.513841 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:58:34.545758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79b5221a-53be-4f82-aa2a-83abc40fc9f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798A438F50>]}
[0m16:58:34.604450 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_carton_caps\target\manifest.json
[0m16:58:34.607678 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_carton_caps\target\semantic_manifest.json
[0m16:58:34.629782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79b5221a-53be-4f82-aa2a-83abc40fc9f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798A7E1940>]}
[0m16:58:34.629782 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m16:58:34.629782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79b5221a-53be-4f82-aa2a-83abc40fc9f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798A493AA0>]}
[0m16:58:34.632169 [info ] [MainThread]: 
[0m16:58:34.632169 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:58:34.632169 [info ] [MainThread]: 
[0m16:58:34.632169 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:58:34.634817 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_main'
[0m16:58:34.685640 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_main"
[0m16:58:34.685640 [debug] [ThreadPool]: On list_carton_caps_main: BEGIN
[0m16:58:34.685640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:34.692639 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m16:58:34.692639 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m16:58:34.693638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:34.693638 [debug] [MainThread]: Connection 'list_carton_caps_main' was properly closed.
[0m16:58:34.693638 [info ] [MainThread]: 
[0m16:58:34.694639 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m16:58:34.694639 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\repos\livefront\carton_caps_analytics\..\duckdb\carton_caps.duckdb": The system cannot find the path specified.
  
[0m16:58:34.694639 [debug] [MainThread]: Command `dbt test` failed at 16:58:34.694639 after 0.68 seconds
[0m16:58:34.695641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017988CBCAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798A2BD160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798AB24B60>]}
[0m16:58:34.695641 [debug] [MainThread]: Flushing usage events
[0m16:58:34.981870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:38.632676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330EDB9B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330FA4F440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023311AF53D0>]}


============================== 17:00:38.637340 | ae8c7290-c3b3-4177-ad97-1780356f8c57 ==============================
[0m17:00:38.637340 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:00:38.637340 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'dbt_carton_caps', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt build --profiles-dir dbt_carton_caps --project-dir dbt_carton_caps', 'use_experimental_parser': 'False', 'log_path': 'dbt_carton_caps\\logs'}
[0m17:00:38.765387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002331353E8A0>]}
[0m17:00:38.826020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023312004BC0>]}
[0m17:00:38.827186 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:00:38.989970 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:00:39.057117 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:00:39.057117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023311B31820>]}
[0m17:00:39.925160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023313B7AC30>]}
[0m17:00:39.981035 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_carton_caps\target\manifest.json
[0m17:00:39.982387 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_carton_caps\target\semantic_manifest.json
[0m17:00:40.009251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023313DED580>]}
[0m17:00:40.009251 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:00:40.011250 [info ] [MainThread]: 
[0m17:00:40.012250 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:00:40.012250 [info ] [MainThread]: 
[0m17:00:40.012250 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:00:40.015251 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T214833Z'
[0m17:00:40.101120 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T214833Z"
[0m17:00:40.102120 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T214833Z"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps_20260203t214833z"'
    
  
  
[0m17:00:40.102120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:40.113685 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:00:40.113685 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z: Close
[0m17:00:40.114687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_carton_caps_20260203T214833Z, now create_carton_caps_20260203T214833Z_main)
[0m17:00:40.114687 [debug] [ThreadPool]: Creating schema "database: "carton_caps_20260203T214833Z"
schema: "main"
"
[0m17:00:40.118685 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T214833Z_main"
[0m17:00:40.118685 [debug] [ThreadPool]: On create_carton_caps_20260203T214833Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_20260203T214833Z_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='carton_caps_20260203t214833z'
        and type='sqlite'
    
  
[0m17:00:40.119684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:40.119684 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:00:40.120685 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T214833Z_main"
[0m17:00:40.120685 [debug] [ThreadPool]: On create_carton_caps_20260203T214833Z_main: BEGIN
[0m17:00:40.121686 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:00:40.121686 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T214833Z_main"
[0m17:00:40.121686 [debug] [ThreadPool]: On create_carton_caps_20260203T214833Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_20260203T214833Z_main"} */

    
    
        create schema if not exists "carton_caps_20260203T214833Z"."main"
    
[0m17:00:40.121686 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:00:40.122687 [debug] [ThreadPool]: On create_carton_caps_20260203T214833Z_main: COMMIT
[0m17:00:40.122687 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T214833Z_main"
[0m17:00:40.122687 [debug] [ThreadPool]: On create_carton_caps_20260203T214833Z_main: COMMIT
[0m17:00:40.122687 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:00:40.123686 [debug] [ThreadPool]: On create_carton_caps_20260203T214833Z_main: Close
[0m17:00:40.124685 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T214833Z_main'
[0m17:00:40.127685 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T214833Z_main"
[0m17:00:40.128124 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z_main: BEGIN
[0m17:00:40.128124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:40.128124 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:00:40.128124 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T214833Z_main"
[0m17:00:40.129200 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T214833Z_main"} */
select
      'carton_caps_20260203T214833Z' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps_20260203t214833z'
  
[0m17:00:40.137061 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:00:40.138034 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z_main: ROLLBACK
[0m17:00:40.154543 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_20260203T214833Z_main'
[0m17:00:40.155545 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z_main: Close
[0m17:00:40.155545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023313DDF110>]}
[0m17:00:40.155545 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:40.156544 [debug] [MainThread]: On master: BEGIN
[0m17:00:40.156544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:00:40.156544 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:00:40.156544 [debug] [MainThread]: On master: COMMIT
[0m17:00:40.157542 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:40.157542 [debug] [MainThread]: On master: COMMIT
[0m17:00:40.158101 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:00:40.158101 [debug] [MainThread]: On master: Close
[0m17:00:40.160254 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_events
[0m17:00:40.160254 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.stg_products
[0m17:00:40.161539 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.stg_purchases
[0m17:00:40.161539 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.stg_referrals
[0m17:00:40.161539 [info ] [Thread-1 (]: 1 of 44 START sql view model main.stg_events ................................... [RUN]
[0m17:00:40.162538 [info ] [Thread-2 (]: 2 of 44 START sql view model main.stg_products ................................. [RUN]
[0m17:00:40.162538 [info ] [Thread-3 (]: 3 of 44 START sql view model main.stg_purchases ................................ [RUN]
[0m17:00:40.163176 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_events'
[0m17:00:40.163176 [info ] [Thread-4 (]: 4 of 44 START sql view model main.stg_referrals ................................ [RUN]
[0m17:00:40.163176 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_products'
[0m17:00:40.164301 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_purchases'
[0m17:00:40.164301 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_events
[0m17:00:40.164301 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_referrals'
[0m17:00:40.164301 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.stg_products
[0m17:00:40.165302 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.stg_purchases
[0m17:00:40.169188 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_events"
[0m17:00:40.169188 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.stg_referrals
[0m17:00:40.171187 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_products"
[0m17:00:40.173186 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_purchases"
[0m17:00:40.174905 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_referrals"
[0m17:00:40.175683 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_events
[0m17:00:40.195334 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_events"
[0m17:00:40.195334 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.stg_purchases
[0m17:00:40.195334 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.stg_products
[0m17:00:40.197838 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_purchases"
[0m17:00:40.197838 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.stg_referrals
[0m17:00:40.199844 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_products"
[0m17:00:40.199844 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:00:40.202888 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_referrals"
[0m17:00:40.203888 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: BEGIN
[0m17:00:40.203888 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:00:40.203888 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:00:40.204888 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:00:40.204888 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: BEGIN
[0m17:00:40.204888 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:00:40.205888 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: BEGIN
[0m17:00:40.205888 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.205888 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:00:40.205888 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: BEGIN
[0m17:00:40.206888 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:00:40.206888 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:00:40.206888 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:00:40.206888 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.207888 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

  
  create view "carton_caps_20260203T214833Z"."main"."stg_events__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T214833Z"."raw"."events"
)
select
  cast(event_id as integer) as event_id,
  cast(user_id as integer) as user_id,
  cast(event_type as varchar) as event_type,
  cast(event_at as timestamp) as event_at,
  cast(referral_id as integer) as referral_id,
  cast(metadata_json as varchar) as metadata_json
from src
  );

[0m17:00:40.207888 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.207888 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:00:40.208888 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.208888 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:00:40.208888 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.208888 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

  
  create view "carton_caps_20260203T214833Z"."main"."stg_purchases__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T214833Z"."raw"."purchases"
)
select
  cast(purchase_id as integer) as purchase_id,
  cast(user_id as integer) as user_id,
  cast(product_id as integer) as product_id,
  cast(quantity as integer) as quantity,
  cast(price_paid as double) as price_paid,
  cast(points_earned as integer) as points_earned,
  cast(purchased_at as timestamp) as purchased_at,
  cast(day_of_week as varchar) as day_of_week,
  cast(hour_of_day as integer) as hour_of_day
from src
  );

[0m17:00:40.209888 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:00:40.209888 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

  
  create view "carton_caps_20260203T214833Z"."main"."stg_products__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T214833Z"."raw"."products"
)
select
  cast(product_id as integer) as product_id,
  cast(name as varchar) as name,
  cast(category as varchar) as category,
  cast(price as double) as price,
  cast(points_per_dollar as integer) as points_per_dollar,
  cast(created_at as timestamp) as created_at
from src
  );

[0m17:00:40.212887 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:00:40.213888 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

  
  create view "carton_caps_20260203T214833Z"."main"."stg_referrals__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T214833Z"."raw"."referrals"
)
select
  cast(referral_id as integer) as referral_id,
  cast(referrer_user_id as integer) as referrer_user_id,
  lower(cast(referred_email as varchar)) as referred_email,
  cast(referred_user_id as integer) as referred_user_id,
  cast(referral_code as varchar) as referral_code,
  cast(sent_at as timestamp) as sent_at,
  cast(converted_at as timestamp) as converted_at,
  cast(status as varchar) as status
from src
  );

[0m17:00:40.213888 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.213888 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m17:00:40.214888 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.216833 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:00:40.216833 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.218834 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:00:40.218834 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.218834 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_purchases__dbt_tmp" rename to "stg_purchases"
[0m17:00:40.220834 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:00:40.220834 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m17:00:40.226187 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m17:00:40.227187 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m17:00:40.227187 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:00:40.227187 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:00:40.228188 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.228188 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m17:00:40.229190 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m17:00:40.229190 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.230189 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m17:00:40.230189 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:00:40.231189 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m17:00:40.231189 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:00:40.231189 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m17:00:40.232189 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:00:40.232189 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m17:00:40.232189 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m17:00:40.238617 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:00:40.241616 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:00:40.242616 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

      drop view if exists "carton_caps_20260203T214833Z"."main"."stg_events__dbt_backup" cascade
    
[0m17:00:40.242616 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m17:00:40.242616 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m17:00:40.242616 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m17:00:40.243532 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:00:40.243532 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.243532 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:00:40.243532 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:00:40.243532 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

      drop view if exists "carton_caps_20260203T214833Z"."main"."stg_referrals__dbt_backup" cascade
    
[0m17:00:40.243532 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: Close
[0m17:00:40.243532 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

      drop view if exists "carton_caps_20260203T214833Z"."main"."stg_purchases__dbt_backup" cascade
    
[0m17:00:40.243532 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

      drop view if exists "carton_caps_20260203T214833Z"."main"."stg_products__dbt_backup" cascade
    
[0m17:00:40.250874 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.251911 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: Close
[0m17:00:40.251911 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.252912 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: Close
[0m17:00:40.252912 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:00:40.253909 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: Close
[0m17:00:40.254910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023311460110>]}
[0m17:00:40.254910 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233139569C0>]}
[0m17:00:40.254910 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023313DDF320>]}
[0m17:00:40.255910 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002331393E3C0>]}
[0m17:00:40.255910 [info ] [Thread-1 (]: 1 of 44 OK created sql view model main.stg_events .............................. [[32mOK[0m in 0.09s]
[0m17:00:40.255910 [info ] [Thread-4 (]: 4 of 44 OK created sql view model main.stg_referrals ........................... [[32mOK[0m in 0.09s]
[0m17:00:40.255910 [info ] [Thread-2 (]: 2 of 44 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.09s]
[0m17:00:40.257575 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_events
[0m17:00:40.257575 [info ] [Thread-3 (]: 3 of 44 OK created sql view model main.stg_purchases ........................... [[32mOK[0m in 0.09s]
[0m17:00:40.257575 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.stg_referrals
[0m17:00:40.258736 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.stg_products
[0m17:00:40.258736 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_schools
[0m17:00:40.258736 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.stg_purchases
[0m17:00:40.258736 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.stg_users
[0m17:00:40.259736 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:00:40.259736 [info ] [Thread-1 (]: 5 of 44 START sql view model main.stg_schools .................................. [RUN]
[0m17:00:40.259736 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:00:40.260736 [info ] [Thread-4 (]: 6 of 44 START sql view model main.stg_users .................................... [RUN]
[0m17:00:40.260736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_events, now model.dbt_carton_caps.stg_schools)
[0m17:00:40.260736 [info ] [Thread-2 (]: 7 of 44 START test not_null_stg_events_event_id ................................ [RUN]
[0m17:00:40.261737 [info ] [Thread-3 (]: 8 of 44 START test not_null_stg_events_user_id ................................. [RUN]
[0m17:00:40.261737 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_referrals, now model.dbt_carton_caps.stg_users)
[0m17:00:40.261737 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_schools
[0m17:00:40.261737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_products, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m17:00:40.262736 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_purchases, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m17:00:40.262736 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.stg_users
[0m17:00:40.264758 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_schools"
[0m17:00:40.264758 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:00:40.265210 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:00:40.266554 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_users"
[0m17:00:40.273203 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:00:40.276315 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:00:40.276315 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_schools
[0m17:00:40.278259 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_schools"
[0m17:00:40.279264 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.stg_users
[0m17:00:40.279264 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:00:40.280264 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_users"
[0m17:00:40.289596 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:00:40.291602 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:00:40.291602 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:00:40.294285 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:00:40.294285 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: BEGIN
[0m17:00:40.295285 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:00:40.295285 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:00:40.295285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:40.295285 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m17:00:40.296285 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: BEGIN
[0m17:00:40.296285 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:00:40.296285 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:40.296285 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.296285 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:40.296285 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m17:00:40.297789 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:00:40.297789 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.297789 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:40.298793 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

  
  create view "carton_caps_20260203T214833Z"."main"."stg_schools__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T214833Z"."raw"."schools"
)
select
  cast(school_id as integer) as school_id,
  cast(name as varchar) as name,
  cast(address as varchar) as address,
  cast(city as varchar) as city,
  cast(state as varchar) as state,
  cast(zip_code as varchar) as zip_code,
  cast(created_at as timestamp) as created_at
from src
  );

[0m17:00:40.299158 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.299158 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:00:40.299158 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:00:40.300180 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps_20260203T214833Z"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.300180 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.300180 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

  
  create view "carton_caps_20260203T214833Z"."main"."stg_users__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T214833Z"."raw"."users"
)
select
  cast(user_id as integer) as user_id,
  cast(first_name as varchar) as first_name,
  cast(last_name as varchar) as last_name,
  lower(cast(email as varchar)) as email,
  cast(school_id as integer) as school_id,
  cast(created_at as timestamp) as created_at,
  cast(user_type as varchar) as user_type,
  cast(is_verified as integer) as is_verified,
  cast(device_id as varchar) as device_id,
  cast(marketing_channel as varchar) as marketing_channel
from src
  );

[0m17:00:40.300180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.301180 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:00:40.302182 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:00:40.303182 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T214833Z"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.303182 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.303182 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:00:40.303182 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_schools__dbt_tmp" rename to "stg_schools"
[0m17:00:40.305181 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:00:40.305181 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:00:40.306180 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m17:00:40.308041 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:00:40.308041 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.308041 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:00:40.308041 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m17:00:40.308041 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m17:00:40.308041 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m17:00:40.308041 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m17:00:40.308041 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m17:00:40.308041 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m17:00:40.308041 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:00:40.308041 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:00:40.308041 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m17:00:40.308041 [info ] [Thread-2 (]: 7 of 44 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.05s]
[0m17:00:40.308041 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m17:00:40.308041 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m17:00:40.308041 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:00:40.308041 [info ] [Thread-3 (]: 8 of 44 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.05s]
[0m17:00:40.308041 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m17:00:40.308041 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:00:40.308041 [info ] [Thread-2 (]: 9 of 44 START test test_events_in_window ....................................... [RUN]
[0m17:00:40.308041 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:00:40.308041 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.test_events_in_window)
[0m17:00:40.308041 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m17:00:40.308041 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m17:00:40.308041 [info ] [Thread-3 (]: 10 of 44 START test unique_stg_events_event_id ................................. [RUN]
[0m17:00:40.308041 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m17:00:40.308041 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:00:40.322757 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:00:40.322757 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m17:00:40.324761 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m17:00:40.324761 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m17:00:40.325761 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m17:00:40.326763 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:00:40.326763 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:00:40.328798 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:00:40.329102 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

      drop view if exists "carton_caps_20260203T214833Z"."main"."stg_schools__dbt_backup" cascade
    
[0m17:00:40.330122 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:00:40.331121 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:00:40.331121 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

      drop view if exists "carton_caps_20260203T214833Z"."main"."stg_users__dbt_backup" cascade
    
[0m17:00:40.331121 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m17:00:40.332122 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:40.332122 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:00:40.332122 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.333122 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.333122 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m17:00:40.333122 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.334122 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: Close
[0m17:00:40.335122 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: Close
[0m17:00:40.335489 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:40.335489 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:00:40.336491 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023313C35BE0>]}
[0m17:00:40.336491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023313AB4EF0>]}
[0m17:00:40.336491 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps_20260203T214833Z"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m17:00:40.337490 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.337490 [info ] [Thread-4 (]: 6 of 44 OK created sql view model main.stg_users ............................... [[32mOK[0m in 0.07s]
[0m17:00:40.337490 [info ] [Thread-1 (]: 5 of 44 OK created sql view model main.stg_schools ............................. [[32mOK[0m in 0.08s]
[0m17:00:40.338490 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:00:40.338490 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.stg_users
[0m17:00:40.339490 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_schools
[0m17:00:40.339490 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:40.339490 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:00:40.339490 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:00:40.340490 [info ] [Thread-4 (]: 11 of 44 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m17:00:40.341490 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_users, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m17:00:40.341490 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:00:40.341490 [info ] [Thread-1 (]: 12 of 44 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m17:00:40.342490 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:00:40.345492 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:00:40.345492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_schools, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m17:00:40.345492 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:00:40.345492 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:00:40.345492 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m17:00:40.349748 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:00:40.350751 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m17:00:40.350751 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m17:00:40.350751 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:00:40.351751 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m17:00:40.351751 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m17:00:40.354999 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:00:40.354999 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m17:00:40.354999 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:00:40.357045 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:00:40.356186 [info ] [Thread-2 (]: 9 of 44 PASS test_events_in_window ............................................. [[32mPASS[0m in 0.05s]
[0m17:00:40.358049 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m17:00:40.358049 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:00:40.358049 [info ] [Thread-3 (]: 10 of 44 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.05s]
[0m17:00:40.359051 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:00:40.359051 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m17:00:40.359051 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:00:40.360049 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:00:40.360049 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:40.360049 [info ] [Thread-2 (]: 13 of 44 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m17:00:40.360049 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:00:40.361050 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m17:00:40.361050 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m17:00:40.362051 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.362051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:40.362051 [info ] [Thread-3 (]: 14 of 44 START test not_null_stg_products_product_id ........................... [RUN]
[0m17:00:40.362051 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:00:40.363051 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:00:40.363051 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m17:00:40.365750 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:00:40.365750 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:00:40.365750 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T214833Z"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.366749 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:00:40.366749 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:00:40.369751 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:00:40.369751 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps_20260203T214833Z"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.369751 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:00:40.370590 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:00:40.371992 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:00:40.371992 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.372992 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:00:40.372992 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m17:00:40.373993 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m17:00:40.375539 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:00:40.376585 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:00:40.376585 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m17:00:40.377356 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m17:00:40.377356 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m17:00:40.377356 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m17:00:40.377356 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m17:00:40.377356 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:40.377356 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:00:40.377356 [info ] [Thread-4 (]: 11 of 44 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.04s]
[0m17:00:40.377356 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m17:00:40.377356 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.377356 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:00:40.377356 [info ] [Thread-1 (]: 12 of 44 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.03s]
[0m17:00:40.377356 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:40.377356 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:00:40.377356 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:00:40.377356 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:00:40.382436 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:40.382852 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.382436 [info ] [Thread-4 (]: 15 of 44 START test unique_stg_products_product_id ............................. [RUN]
[0m17:00:40.382852 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:00:40.382852 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:00:40.382852 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m17:00:40.382852 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T214833Z"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.382852 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.382852 [info ] [Thread-1 (]: 16 of 44 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m17:00:40.385040 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:00:40.385040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m17:00:40.386045 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m17:00:40.389043 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:00:40.389043 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:00:40.389043 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:00:40.390044 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m17:00:40.391417 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:00:40.391417 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m17:00:40.391417 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m17:00:40.391417 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:00:40.391417 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m17:00:40.391417 [info ] [Thread-2 (]: 13 of 44 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m17:00:40.396314 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:00:40.396720 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:00:40.397163 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m17:00:40.397667 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:00:40.398673 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:00:40.399672 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:00:40.399672 [info ] [Thread-3 (]: 14 of 44 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.04s]
[0m17:00:40.399672 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:00:40.400672 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:00:40.400672 [info ] [Thread-2 (]: 17 of 44 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m17:00:40.400672 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m17:00:40.400672 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:00:40.401673 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:00:40.401673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m17:00:40.401673 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:40.402672 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m17:00:40.401673 [info ] [Thread-3 (]: 18 of 44 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m17:00:40.402672 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:00:40.403267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:40.403267 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m17:00:40.403267 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.406638 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:00:40.406638 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:00:40.406638 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:00:40.407638 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:00:40.410640 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:00:40.410640 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:40.410640 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:00:40.411638 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:00:40.412271 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T214833Z"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.413731 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:00:40.413731 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:00:40.414733 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:00:40.415731 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:00:40.416730 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m17:00:40.417731 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:00:40.417731 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:00:40.417731 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m17:00:40.418731 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m17:00:40.419643 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m17:00:40.419643 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m17:00:40.419643 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m17:00:40.419643 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:40.419643 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:00:40.419643 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m17:00:40.419643 [info ] [Thread-4 (]: 15 of 44 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.04s]
[0m17:00:40.419643 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m17:00:40.419643 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.419643 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:00:40.419643 [info ] [Thread-1 (]: 16 of 44 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.03s]
[0m17:00:40.419643 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:40.419643 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:00:40.419643 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:00:40.424096 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:00:40.424513 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T214833Z"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.424513 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.424513 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:00:40.424513 [info ] [Thread-4 (]: 19 of 44 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m17:00:40.425566 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:00:40.425566 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m17:00:40.425566 [info ] [Thread-1 (]: 20 of 44 START test not_null_stg_schools_school_id ............................. [RUN]
[0m17:00:40.426566 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T214833Z"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.426566 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.426566 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:00:40.426566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m17:00:40.429564 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:00:40.430566 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m17:00:40.430566 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:00:40.431565 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:00:40.431565 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m17:00:40.434567 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:00:40.434567 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m17:00:40.435567 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m17:00:40.435567 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:00:40.436566 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m17:00:40.437566 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:00:40.436566 [info ] [Thread-2 (]: 17 of 44 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.03s]
[0m17:00:40.438566 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m17:00:40.438566 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:00:40.438566 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:00:40.440567 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:00:40.439567 [info ] [Thread-3 (]: 18 of 44 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.04s]
[0m17:00:40.441566 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:00:40.441566 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:00:40.441566 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:00:40.442566 [info ] [Thread-2 (]: 21 of 44 START test not_null_stg_users_school_id ............................... [RUN]
[0m17:00:40.442566 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m17:00:40.442566 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:00:40.443565 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:00:40.443565 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m17:00:40.443565 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:40.444566 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m17:00:40.443565 [info ] [Thread-3 (]: 22 of 44 START test not_null_stg_users_user_id ................................. [RUN]
[0m17:00:40.444566 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:00:40.444566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:40.445567 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m17:00:40.445567 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.447566 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:00:40.448567 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:00:40.448567 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:00:40.448567 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:00:40.451566 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:00:40.451566 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:40.451566 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:00:40.452566 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:00:40.452566 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T214833Z"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.454566 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:00:40.454566 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:00:40.455566 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:00:40.455566 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:00:40.455566 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:00:40.459406 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m17:00:40.459406 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:00:40.459406 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m17:00:40.459406 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m17:00:40.459406 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m17:00:40.459406 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:00:40.459406 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m17:00:40.459406 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m17:00:40.459406 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:40.459406 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m17:00:40.459406 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m17:00:40.459406 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:40.459406 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.459406 [info ] [Thread-4 (]: 19 of 44 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.03s]
[0m17:00:40.464387 [info ] [Thread-1 (]: 20 of 44 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.04s]
[0m17:00:40.464387 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:00:40.464387 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.465392 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:00:40.465392 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:00:40.465392 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T214833Z"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.466393 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:00:40.466393 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:00:40.466393 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:00:40.467392 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T214833Z"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.467392 [info ] [Thread-4 (]: 23 of 44 START test unique_stg_schools_school_id ............................... [RUN]
[0m17:00:40.467392 [info ] [Thread-1 (]: 24 of 44 START test unique_stg_users_user_id ................................... [RUN]
[0m17:00:40.468575 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.468575 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m17:00:40.468575 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.469577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m17:00:40.469577 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m17:00:40.469577 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:00:40.469577 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m17:00:40.469577 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:00:40.474673 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:00:40.474673 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m17:00:40.475673 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m17:00:40.477672 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:00:40.477672 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m17:00:40.477672 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m17:00:40.478674 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:00:40.480696 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:00:40.478674 [info ] [Thread-2 (]: 21 of 44 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:00:40.481695 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:00:40.481695 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:00:40.480696 [info ] [Thread-3 (]: 22 of 44 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.04s]
[0m17:00:40.481695 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.fct_rewards
[0m17:00:40.482458 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:00:40.482458 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:00:40.482458 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:00:40.482458 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m17:00:40.482458 [info ] [Thread-2 (]: 25 of 44 START sql table model main.fct_rewards ................................ [RUN]
[0m17:00:40.485454 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.dim_product
[0m17:00:40.485454 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:40.485454 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now model.dbt_carton_caps.fct_rewards)
[0m17:00:40.485454 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:00:40.486459 [info ] [Thread-3 (]: 26 of 44 START sql table model main.dim_product ................................ [RUN]
[0m17:00:40.486459 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.fct_rewards
[0m17:00:40.487460 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m17:00:40.487460 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.487460 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now model.dbt_carton_caps.dim_product)
[0m17:00:40.489204 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_rewards"
[0m17:00:40.490228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:40.490228 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:00:40.490228 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.dim_product
[0m17:00:40.491153 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:40.492652 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_product"
[0m17:00:40.492652 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:00:40.492652 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.fct_rewards
[0m17:00:40.493652 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:00:40.504529 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_rewards"
[0m17:00:40.504529 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m17:00:40.504529 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:40.504529 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.dim_product
[0m17:00:40.504529 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m17:00:40.509437 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_product"
[0m17:00:40.509437 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:00:40.509437 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m17:00:40.510437 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:00:40.510437 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m17:00:40.511437 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m17:00:40.511437 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_rewards: BEGIN
[0m17:00:40.512437 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:00:40.512437 [info ] [Thread-4 (]: 23 of 44 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:00:40.513437 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m17:00:40.513437 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:40.513437 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_product: BEGIN
[0m17:00:40.513437 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:00:40.514438 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m17:00:40.514438 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:40.514438 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.fct_referral
[0m17:00:40.515438 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.516438 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.516438 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:00:40.515438 [info ] [Thread-1 (]: 24 of 44 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.05s]
[0m17:00:40.516438 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:00:40.515438 [info ] [Thread-4 (]: 27 of 44 START sql table model main.fct_referral ............................... [RUN]
[0m17:00:40.517437 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

  
    
    

    create  table
      "carton_caps_20260203T214833Z"."main"."fct_rewards__dbt_tmp"
  
    as (
      with e as (
  select *
  from "carton_caps_20260203T214833Z"."main"."stg_events"
),

awards as (
  select
    referral_id,
    user_id,
    event_at as awarded_at,
    -- reward_type is inside metadata_json like {"reward_type":"referrer_bonus"}
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_awarded'
),

redeems as (
  select
    referral_id,
    user_id,
    event_at as redeemed_at,
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_redeemed'
)

select
  -- deterministic surrogate key
  md5(cast(a.referral_id as varchar) || '|' || cast(a.user_id as varchar) || '|' || coalesce(a.reward_type,'')) as reward_id,
  a.referral_id,
  a.user_id,
  a.reward_type,
  a.awarded_at,
  min(r.redeemed_at) as redeemed_at
from awards a
left join redeems r
  on a.referral_id = r.referral_id
  and a.user_id = r.user_id
  and coalesce(a.reward_type,'') = coalesce(r.reward_type,'')
group by 1,2,3,4,5
    );
  
  
[0m17:00:40.517437 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:00:40.517437 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

  
    
    

    create  table
      "carton_caps_20260203T214833Z"."main"."dim_product__dbt_tmp"
  
    as (
      select
  product_id,
  name,
  category,
  price,
  points_per_dollar,
  created_at
from "carton_caps_20260203T214833Z"."main"."stg_products"
    );
  
  
[0m17:00:40.517437 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6, now model.dbt_carton_caps.fct_referral)
[0m17:00:40.518438 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.dim_school
[0m17:00:40.518438 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.fct_referral
[0m17:00:40.521438 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_referral"
[0m17:00:40.519437 [info ] [Thread-1 (]: 28 of 44 START sql table model main.dim_school ................................. [RUN]
[0m17:00:40.521868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b, now model.dbt_carton_caps.dim_school)
[0m17:00:40.522421 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.dim_school
[0m17:00:40.523948 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_school"
[0m17:00:40.523948 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:00:40.523948 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:00:40.528271 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:00:40.530429 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:00:40.530429 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.fct_referral
[0m17:00:40.530429 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */
alter table "carton_caps_20260203T214833Z"."main"."dim_product__dbt_tmp" rename to "dim_product"
[0m17:00:40.530429 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.dim_school
[0m17:00:40.531429 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */
alter table "carton_caps_20260203T214833Z"."main"."fct_rewards__dbt_tmp" rename to "fct_rewards"
[0m17:00:40.533427 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_referral"
[0m17:00:40.535211 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_school"
[0m17:00:40.535211 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.537216 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m17:00:40.537216 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:00:40.537216 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m17:00:40.537216 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:00:40.537216 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m17:00:40.537216 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:00:40.537216 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:00:40.537216 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:00:40.537216 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_referral: BEGIN
[0m17:00:40.542193 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_school: BEGIN
[0m17:00:40.542193 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m17:00:40.542193 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:40.542193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:40.543188 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.543188 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:00:40.543188 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

  
    
    

    create  table
      "carton_caps_20260203T214833Z"."main"."fct_referral__dbt_tmp"
  
    as (
      with r as (
  select *
  from "carton_caps_20260203T214833Z"."main"."stg_referrals"
),

e as (
  select *
  from "carton_caps_20260203T214833Z"."main"."stg_events"
),

-- Referral-related event timestamps for referred users
ref_events as (
  select
    referral_id,
    user_id,

    min(case when event_type = 'install' then event_at end) as install_at,
    min(case when event_type = 'referral_applied' then event_at end) as referral_applied_at,
    min(case when event_type = 'onboarding_complete' then event_at end) as onboarding_completed_at,
    min(case when event_type = 'school_linked' then event_at end) as school_linked_at

  from e
  where referral_id is not null
  group by 1,2
),

-- First scan/purchase time for referred users (proxy for qualifying action)
first_purchase as (
  select
    user_id,
    min(purchased_at) as first_purchase_at
  from "carton_caps_20260203T214833Z"."main"."stg_purchases"
  group by 1
)

select
  r.referral_id,
  r.referrer_user_id,
  r.referred_email,
  r.referred_user_id,
  r.referral_code,
  r.sent_at,
  r.converted_at,
  r.status,

  re.install_at,
  re.referral_applied_at,
  re.onboarding_completed_at,
  re.school_linked_at,

  fp.first_purchase_at,

  -- qualifying action is: first_purchase OR school_linked (whichever happens first)
  least(fp.first_purchase_at, re.school_linked_at) as qualifying_action_at,

  -- window compliance (48 hours) using install -> referral_applied
  case
    when re.install_at is null or re.referral_applied_at is null then null
    when datediff('hour', re.install_at, re.referral_applied_at) <= 48 then true
    else false
  end as within_48h_window,

  -- simple eligibility (rules-compliant posture)
  case
    when r.status <> 'converted' then false
    when re.onboarding_completed_at is null then false
    when least(fp.first_purchase_at, re.school_linked_at) is null then false
    when re.install_at is null or re.referral_applied_at is null then false
    when datediff('hour', re.install_at, re.referral_applied_at) > 48 then false
    else true
  end as eligible_referral

from r
left join ref_events re
  on r.referral_id = re.referral_id
  and r.referred_user_id = re.user_id
left join first_purchase fp
  on r.referred_user_id = fp.user_id
    );
  
  
[0m17:00:40.543188 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.543188 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:00:40.543188 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

  
    
    

    create  table
      "carton_caps_20260203T214833Z"."main"."dim_school__dbt_tmp"
  
    as (
      select
  school_id,
  name,
  address,
  city,
  state,
  zip_code,
  created_at
from "carton_caps_20260203T214833Z"."main"."stg_schools"
    );
  
  
[0m17:00:40.564143 [debug] [Thread-3 (]: SQL status: OK in 0.025 seconds
[0m17:00:40.565145 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:00:40.565145 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

      drop table if exists "carton_caps_20260203T214833Z"."main"."dim_product__dbt_backup" cascade
    
[0m17:00:40.565145 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m17:00:40.565145 [debug] [Thread-2 (]: SQL status: OK in 0.024 seconds
[0m17:00:40.565145 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:00:40.565145 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:00:40.565145 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:00:40.565145 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */
alter table "carton_caps_20260203T214833Z"."main"."dim_school__dbt_tmp" rename to "dim_school"
[0m17:00:40.565145 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

      drop table if exists "carton_caps_20260203T214833Z"."main"."fct_rewards__dbt_backup" cascade
    
[0m17:00:40.565145 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_product: Close
[0m17:00:40.565145 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023313A39340>]}
[0m17:00:40.565145 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.565145 [info ] [Thread-3 (]: 26 of 44 OK created sql table model main.dim_product ........................... [[32mOK[0m in 0.08s]
[0m17:00:40.565145 [debug] [Thread-4 (]: SQL status: OK in 0.031 seconds
[0m17:00:40.565145 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_rewards: Close
[0m17:00:40.565145 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.565145 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.dim_product
[0m17:00:40.577781 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:00:40.577781 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023316381280>]}
[0m17:00:40.578865 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m17:00:40.578865 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.dim_user
[0m17:00:40.579865 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */
alter table "carton_caps_20260203T214833Z"."main"."fct_referral__dbt_tmp" rename to "fct_referral"
[0m17:00:40.579865 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:00:40.579865 [info ] [Thread-2 (]: 25 of 44 OK created sql table model main.fct_rewards ........................... [[32mOK[0m in 0.09s]
[0m17:00:40.581169 [info ] [Thread-3 (]: 29 of 44 START sql table model main.dim_user ................................... [RUN]
[0m17:00:40.581169 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m17:00:40.581169 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.fct_rewards
[0m17:00:40.582171 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.582171 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_product, now model.dbt_carton_caps.dim_user)
[0m17:00:40.582171 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.fct_purchase
[0m17:00:40.583176 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m17:00:40.583176 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.584176 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.dim_user
[0m17:00:40.584724 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:00:40.584724 [info ] [Thread-2 (]: 30 of 44 START sql table model main.fct_purchase ............................... [RUN]
[0m17:00:40.585976 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:00:40.586993 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_user"
[0m17:00:40.586993 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m17:00:40.586993 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_rewards, now model.dbt_carton_caps.fct_purchase)
[0m17:00:40.586993 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

      drop table if exists "carton_caps_20260203T214833Z"."main"."dim_school__dbt_backup" cascade
    
[0m17:00:40.586993 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.fct_purchase
[0m17:00:40.592730 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_purchase"
[0m17:00:40.592730 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.dim_user
[0m17:00:40.592730 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:00:40.592730 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:00:40.594729 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_user"
[0m17:00:40.595729 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_school: Close
[0m17:00:40.597708 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:00:40.597708 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.fct_purchase
[0m17:00:40.598212 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

      drop table if exists "carton_caps_20260203T214833Z"."main"."fct_referral__dbt_backup" cascade
    
[0m17:00:40.599218 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_purchase"
[0m17:00:40.599218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233163A7F20>]}
[0m17:00:40.599218 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:00:40.599218 [info ] [Thread-1 (]: 28 of 44 OK created sql table model main.dim_school ............................ [[32mOK[0m in 0.08s]
[0m17:00:40.599218 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.599218 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: BEGIN
[0m17:00:40.599218 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.dim_school
[0m17:00:40.599218 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_referral: Close
[0m17:00:40.599218 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:00:40.599218 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:40.599218 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:00:40.599218 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233136B32F0>]}
[0m17:00:40.604652 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_purchase: BEGIN
[0m17:00:40.605415 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.604999 [info ] [Thread-1 (]: 31 of 44 START test not_null_dim_product_product_id ............................ [RUN]
[0m17:00:40.605415 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:40.606419 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:00:40.605415 [info ] [Thread-4 (]: 27 of 44 OK created sql table model main.fct_referral .......................... [[32mOK[0m in 0.08s]
[0m17:00:40.606419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_school, now test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816)
[0m17:00:40.606419 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

  
    
    

    create  table
      "carton_caps_20260203T214833Z"."main"."dim_user__dbt_tmp"
  
    as (
      select
  u.user_id,
  u.first_name,
  u.last_name,
  u.email,
  u.school_id,
  s.name as school_name,
  s.state as school_state,
  u.created_at,
  u.user_type,
  u.is_verified,
  u.device_id,
  u.marketing_channel
from "carton_caps_20260203T214833Z"."main"."stg_users" u
left join "carton_caps_20260203T214833Z"."main"."stg_schools" s
  on u.school_id = s.school_id
    );
  
  
[0m17:00:40.607419 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.fct_referral
[0m17:00:40.607419 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.607419 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:00:40.608419 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:00:40.608419 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:00:40.610418 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:00:40.611601 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:00:40.611601 [info ] [Thread-4 (]: 32 of 44 START test unique_dim_product_product_id .............................. [RUN]
[0m17:00:40.611601 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

  
    
    

    create  table
      "carton_caps_20260203T214833Z"."main"."fct_purchase__dbt_tmp"
  
    as (
      select
  p.purchase_id,
  p.user_id,
  u.school_id,
  p.product_id,
  pr.category as product_category,
  p.quantity,
  p.price_paid,
  p.points_earned,
  p.purchased_at,
  date_trunc('day', p.purchased_at) as purchase_date,
  p.day_of_week,
  p.hour_of_day
from "carton_caps_20260203T214833Z"."main"."stg_purchases" p
left join "carton_caps_20260203T214833Z"."main"."stg_users" u
  on p.user_id = u.user_id
left join "carton_caps_20260203T214833Z"."main"."stg_products" pr
  on p.product_id = pr.product_id
    );
  
  
[0m17:00:40.613395 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:00:40.613395 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_referral, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m17:00:40.614627 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */
alter table "carton_caps_20260203T214833Z"."main"."dim_user__dbt_tmp" rename to "dim_user"
[0m17:00:40.614627 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:00:40.614627 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:00:40.616625 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:00:40.618625 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:00:40.618625 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:00:40.620373 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m17:00:40.620373 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:00:40.621148 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m17:00:40.621148 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:00:40.621148 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m17:00:40.621148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:40.622152 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:00:40.622152 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:00:40.624154 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:00:40.626154 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:00:40.626154 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:00:40.627154 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */
alter table "carton_caps_20260203T214833Z"."main"."fct_purchase__dbt_tmp" rename to "fct_purchase"
[0m17:00:40.627472 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:00:40.627472 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T214833Z"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.627472 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.627472 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:00:40.627472 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m17:00:40.627472 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m17:00:40.627472 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:00:40.627472 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:40.627472 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m17:00:40.627472 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.627472 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:00:40.627472 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:40.632794 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m17:00:40.632794 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:00:40.632794 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

      drop table if exists "carton_caps_20260203T214833Z"."main"."dim_user__dbt_backup" cascade
    
[0m17:00:40.632794 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:00:40.632794 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:00:40.632794 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:00:40.632794 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m17:00:40.632794 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m17:00:40.632794 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.639383 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:00:40.639383 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:00:40.640446 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m17:00:40.640446 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: Close
[0m17:00:40.641447 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

      drop table if exists "carton_caps_20260203T214833Z"."main"."fct_purchase__dbt_backup" cascade
    
[0m17:00:40.641447 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m17:00:40.641447 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m17:00:40.642446 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233163FCE00>]}
[0m17:00:40.643446 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.642446 [info ] [Thread-1 (]: 31 of 44 PASS not_null_dim_product_product_id .................................. [[32mPASS[0m in 0.04s]
[0m17:00:40.644446 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_purchase: Close
[0m17:00:40.644446 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:00:40.642446 [info ] [Thread-3 (]: 29 of 44 OK created sql table model main.dim_user .............................. [[32mOK[0m in 0.06s]
[0m17:00:40.643446 [info ] [Thread-4 (]: 32 of 44 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.03s]
[0m17:00:40.644446 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:00:40.645445 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8c7290-c3b3-4177-ad97-1780356f8c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023313C086E0>]}
[0m17:00:40.645445 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.dim_user
[0m17:00:40.646352 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:00:40.646352 [info ] [Thread-1 (]: 33 of 44 START test not_null_fct_rewards_reward_id ............................. [RUN]
[0m17:00:40.646352 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:00:40.646352 [info ] [Thread-2 (]: 30 of 44 OK created sql table model main.fct_purchase .......................... [[32mOK[0m in 0.06s]
[0m17:00:40.647396 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:00:40.647396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m17:00:40.648395 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.fct_purchase
[0m17:00:40.647396 [info ] [Thread-3 (]: 34 of 44 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m17:00:40.648395 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:00:40.648395 [info ] [Thread-4 (]: 35 of 44 START test not_null_dim_school_school_id .............................. [RUN]
[0m17:00:40.648395 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:00:40.649395 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_user, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m17:00:40.651397 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:00:40.651397 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b)
[0m17:00:40.652396 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:00:40.652396 [info ] [Thread-2 (]: 36 of 44 START test unique_dim_school_school_id ................................ [RUN]
[0m17:00:40.652396 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:00:40.654395 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:00:40.655395 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_purchase, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m17:00:40.657396 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:00:40.657396 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:00:40.658395 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:00:40.660396 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:00:40.661396 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:00:40.662395 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:00:40.662395 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:00:40.663395 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:00:40.664396 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:00:40.665394 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:00:40.665394 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:00:40.667396 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:00:40.667396 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m17:00:40.667396 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:00:40.668395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:40.668395 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m17:00:40.668395 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:00:40.669395 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:40.669395 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m17:00:40.669395 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.670396 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:00:40.670396 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:40.670396 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.671396 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:00:40.671396 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m17:00:40.671396 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:00:40.671396 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps_20260203T214833Z"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.672396 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.672396 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:40.672396 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T214833Z"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.672396 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:00:40.673395 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:40.673395 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.673395 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.674396 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.674396 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:00:40.674396 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:40.674396 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m17:00:40.674396 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m17:00:40.674396 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:00:40.674396 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:00:40.674396 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:00:40.674396 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m17:00:40.674396 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m17:00:40.674396 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m17:00:40.674396 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m17:00:40.681040 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m17:00:40.681040 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m17:00:40.682045 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m17:00:40.682045 [info ] [Thread-4 (]: 35 of 44 PASS not_null_dim_school_school_id .................................... [[32mPASS[0m in 0.03s]
[0m17:00:40.683431 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m17:00:40.683044 [info ] [Thread-1 (]: 33 of 44 PASS not_null_fct_rewards_reward_id ................................... [[32mPASS[0m in 0.04s]
[0m17:00:40.683431 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m17:00:40.683431 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:00:40.684669 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:00:40.684669 [info ] [Thread-3 (]: 34 of 44 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:00:40.684669 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:00:40.685669 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:00:40.685669 [info ] [Thread-2 (]: 36 of 44 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m17:00:40.685669 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:00:40.685669 [info ] [Thread-4 (]: 37 of 44 START test not_null_fct_referral_referral_id .......................... [RUN]
[0m17:00:40.686669 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:00:40.686669 [info ] [Thread-1 (]: 38 of 44 START test unique_fct_referral_referral_id ............................ [RUN]
[0m17:00:40.686669 [debug] [Thread-3 (]: Began running node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:00:40.687669 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m17:00:40.687977 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:00:40.688299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m17:00:40.688299 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now exposure.dbt_carton_caps.streamlit_referral_finance_dashboard)
[0m17:00:40.688299 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:00:40.688299 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:00:40.688299 [info ] [Thread-2 (]: 40 of 44 START test not_null_dim_user_user_id .................................. [RUN]
[0m17:00:40.688299 [debug] [Thread-3 (]: Began compiling node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:00:40.692858 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:00:40.694855 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:00:40.694855 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76, now test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3)
[0m17:00:40.695957 [debug] [Thread-3 (]: Began executing node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:00:40.695957 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:00:40.696671 [info ] [Thread-3 (]: 39 of 44 NO-OP exposure streamlit_referral_finance_dashboard ................... [[33mNO-OP[0m in 0.00s]
[0m17:00:40.698176 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:00:40.698176 [debug] [Thread-3 (]: Finished running node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:00:40.698176 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:00:40.698176 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:00:40.698176 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:00:40.701873 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:00:40.702825 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:00:40.704834 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:00:40.701873 [info ] [Thread-3 (]: 41 of 44 START test unique_dim_user_user_id .................................... [RUN]
[0m17:00:40.704834 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:00:40.707160 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:00:40.707160 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly exposure.dbt_carton_caps.streamlit_referral_finance_dashboard, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m17:00:40.708965 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m17:00:40.708965 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:00:40.708965 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:00:40.709972 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:40.709972 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:00:40.709972 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m17:00:40.714063 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:00:40.715861 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:00:40.716652 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m17:00:40.716652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:40.716652 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:00:40.719517 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T214833Z"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.716652 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:40.719517 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.716652 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:00:40.719517 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:00:40.719517 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.722877 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:00:40.722877 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:00:40.724041 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:40.724041 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:00:40.725040 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m17:00:40.725040 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T214833Z"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.726040 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m17:00:40.726040 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:00:40.726040 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:00:40.726040 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m17:00:40.726040 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.726040 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m17:00:40.726040 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m17:00:40.730721 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m17:00:40.730721 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:40.729714 [info ] [Thread-4 (]: 37 of 44 PASS not_null_fct_referral_referral_id ................................ [[32mPASS[0m in 0.04s]
[0m17:00:40.731719 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m17:00:40.731719 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:00:40.732719 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:00:40.732719 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m17:00:40.732719 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:00:40.732719 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m17:00:40.732719 [debug] [Thread-4 (]: Began running node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:00:40.735457 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:00:40.736774 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now exposure.dbt_carton_caps.streamlit_product_dashboard)
[0m17:00:40.735457 [info ] [Thread-1 (]: 38 of 44 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.05s]
[0m17:00:40.737876 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:40.737876 [info ] [Thread-2 (]: 40 of 44 PASS not_null_dim_user_user_id ........................................ [[32mPASS[0m in 0.04s]
[0m17:00:40.737876 [debug] [Thread-4 (]: Began compiling node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:00:40.738875 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:00:40.738875 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:00:40.739876 [debug] [Thread-4 (]: Began executing node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:00:40.739876 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:00:40.740492 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:00:40.740492 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.740492 [info ] [Thread-4 (]: 42 of 44 NO-OP exposure streamlit_product_dashboard ............................ [[33mNO-OP[0m in 0.00s]
[0m17:00:40.741515 [info ] [Thread-1 (]: 43 of 44 START test not_null_fct_purchase_purchase_id .......................... [RUN]
[0m17:00:40.742371 [debug] [Thread-4 (]: Finished running node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:00:40.743107 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m17:00:40.743637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1)
[0m17:00:40.741515 [info ] [Thread-2 (]: 44 of 44 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m17:00:40.744162 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:00:40.744685 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m17:00:40.744685 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m17:00:40.747580 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:00:40.747580 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m17:00:40.748124 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:00:40.750299 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:00:40.750809 [info ] [Thread-3 (]: 41 of 44 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.04s]
[0m17:00:40.751195 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:00:40.751746 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:00:40.751746 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:00:40.753388 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:00:40.756014 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:00:40.756014 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:00:40.756014 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m17:00:40.757016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:40.757430 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:00:40.757430 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m17:00:40.757430 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.757430 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:40.758431 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:00:40.758431 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T214833Z"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:40.759282 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.759646 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:00:40.759646 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:40.759646 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:40.760652 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m17:00:40.761650 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:00:40.761650 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m17:00:40.761650 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:00:40.762651 [info ] [Thread-1 (]: 43 of 44 PASS not_null_fct_purchase_purchase_id ................................ [[32mPASS[0m in 0.02s]
[0m17:00:40.763651 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m17:00:40.763651 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:00:40.764652 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m17:00:40.764652 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m17:00:40.764652 [info ] [Thread-2 (]: 44 of 44 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.02s]
[0m17:00:40.765652 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:00:40.766162 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:40.766162 [debug] [MainThread]: On master: BEGIN
[0m17:00:40.766162 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:00:40.767452 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:00:40.767452 [debug] [MainThread]: On master: COMMIT
[0m17:00:40.767452 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:40.767452 [debug] [MainThread]: On master: COMMIT
[0m17:00:40.768451 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:00:40.768451 [debug] [MainThread]: On master: Close
[0m17:00:40.768451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:40.768451 [debug] [MainThread]: Connection 'create_carton_caps_20260203T214833Z_main' was properly closed.
[0m17:00:40.769453 [debug] [MainThread]: Connection 'list_carton_caps_20260203T214833Z_main' was properly closed.
[0m17:00:40.769453 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1' was properly closed.
[0m17:00:40.769453 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a' was properly closed.
[0m17:00:40.769453 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278' was properly closed.
[0m17:00:40.769453 [debug] [MainThread]: Connection 'exposure.dbt_carton_caps.streamlit_product_dashboard' was properly closed.
[0m17:00:40.769453 [info ] [MainThread]: 
[0m17:00:40.770454 [info ] [MainThread]: Finished running 2 exposures, 6 table models, 30 data tests, 6 view models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m17:00:40.773158 [debug] [MainThread]: Command end result
[0m17:00:40.788192 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_carton_caps\target\manifest.json
[0m17:00:40.790193 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_carton_caps\target\semantic_manifest.json
[0m17:00:40.794549 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt_carton_caps\target\run_results.json
[0m17:00:40.794549 [info ] [MainThread]: 
[0m17:00:40.795549 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:00:40.795549 [info ] [MainThread]: 
[0m17:00:40.795549 [info ] [MainThread]: Done. PASS=42 WARN=0 ERROR=0 SKIP=0 NO-OP=2 TOTAL=44
[0m17:00:40.795549 [debug] [MainThread]: Command `dbt build` succeeded at 17:00:40.795549 after 2.34 seconds
[0m17:00:40.795549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023311AF5D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023311E16B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233137008C0>]}
[0m17:00:40.795549 [debug] [MainThread]: Flushing usage events
[0m17:00:41.137926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:42.661581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B18D20C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B2C8DB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B13257C0>]}


============================== 17:00:42.661581 | 9e9ffc18-a30e-4763-a75b-0d64ec2bbce4 ==============================
[0m17:00:42.661581 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:00:42.661581 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'dbt_carton_caps', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt test --profiles-dir dbt_carton_caps --project-dir dbt_carton_caps', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'dbt_carton_caps\\logs'}
[0m17:00:42.799538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e9ffc18-a30e-4763-a75b-0d64ec2bbce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B2272C90>]}
[0m17:00:42.845713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e9ffc18-a30e-4763-a75b-0d64ec2bbce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B68A5640>]}
[0m17:00:42.845713 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:00:42.999696 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:00:43.106814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:00:43.106814 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:00:43.106814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:00:43.141847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e9ffc18-a30e-4763-a75b-0d64ec2bbce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B69F6000>]}
[0m17:00:43.199696 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_carton_caps\target\manifest.json
[0m17:00:43.201701 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_carton_caps\target\semantic_manifest.json
[0m17:00:43.221655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e9ffc18-a30e-4763-a75b-0d64ec2bbce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B6FA17F0>]}
[0m17:00:43.221655 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:00:43.221655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e9ffc18-a30e-4763-a75b-0d64ec2bbce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B6EBE900>]}
[0m17:00:43.221655 [info ] [MainThread]: 
[0m17:00:43.221655 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:00:43.221655 [info ] [MainThread]: 
[0m17:00:43.221655 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:00:43.229310 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T214833Z_main'
[0m17:00:43.277338 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T214833Z_main"
[0m17:00:43.277338 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z_main: BEGIN
[0m17:00:43.277338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:43.285525 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m17:00:43.285525 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T214833Z_main"
[0m17:00:43.285525 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T214833Z_main"} */
select
      'carton_caps_20260203T214833Z' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps_20260203t214833z'
  
[0m17:00:43.301384 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:00:43.301384 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z_main: ROLLBACK
[0m17:00:43.301384 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_20260203T214833Z_main'
[0m17:00:43.301384 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z_main: Close
[0m17:00:43.301384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e9ffc18-a30e-4763-a75b-0d64ec2bbce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B6F49310>]}
[0m17:00:43.301384 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:43.301384 [debug] [MainThread]: On master: BEGIN
[0m17:00:43.301384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:00:43.301384 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:00:43.301384 [debug] [MainThread]: On master: COMMIT
[0m17:00:43.301384 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:43.301384 [debug] [MainThread]: On master: COMMIT
[0m17:00:43.308711 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:00:43.308711 [debug] [MainThread]: On master: Close
[0m17:00:43.310421 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:00:43.310421 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:00:43.310421 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:00:43.310421 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:00:43.310421 [info ] [Thread-1 (]: 1 of 30 START test not_null_dim_product_product_id ............................. [RUN]
[0m17:00:43.310421 [info ] [Thread-2 (]: 2 of 30 START test not_null_dim_school_school_id ............................... [RUN]
[0m17:00:43.310421 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:00:43.310421 [info ] [Thread-3 (]: 3 of 30 START test not_null_dim_user_user_id ................................... [RUN]
[0m17:00:43.310421 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:00:43.310421 [info ] [Thread-4 (]: 4 of 30 START test not_null_fct_purchase_purchase_id ........................... [RUN]
[0m17:00:43.310421 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:00:43.310421 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:00:43.310421 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:00:43.310421 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:00:43.323504 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:00:43.325368 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:00:43.327925 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:00:43.327925 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:00:43.330927 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:00:43.332924 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:00:43.332924 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:00:43.333972 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:00:43.341040 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:00:43.341040 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:00:43.341040 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:00:43.341040 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:00:43.341040 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:00:43.341040 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:00:43.341040 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:00:43.341040 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m17:00:43.341040 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:00:43.341040 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:00:43.341040 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:00:43.341040 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m17:00:43.341040 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m17:00:43.341040 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:00:43.341040 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:00:43.341040 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:00:43.341040 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.341040 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m17:00:43.341040 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:00:43.341040 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:00:43.341040 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.341040 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.341040 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T214833Z"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.341040 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:00:43.341040 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:00:43.341040 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.341040 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T214833Z"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.341040 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T214833Z"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.341040 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:00:43.341040 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.341040 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T214833Z"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.341040 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:00:43.356903 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.356903 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m17:00:43.358040 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.359042 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m17:00:43.359042 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m17:00:43.360039 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:00:43.361040 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m17:00:43.362040 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:00:43.362040 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:00:43.362040 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m17:00:43.363040 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:00:43.363040 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m17:00:43.363040 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m17:00:43.364040 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m17:00:43.364040 [info ] [Thread-1 (]: 1 of 30 PASS not_null_dim_product_product_id ................................... [[32mPASS[0m in 0.05s]
[0m17:00:43.365040 [info ] [Thread-3 (]: 3 of 30 PASS not_null_dim_user_user_id ......................................... [[32mPASS[0m in 0.05s]
[0m17:00:43.366040 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:00:43.365040 [info ] [Thread-2 (]: 2 of 30 PASS not_null_dim_school_school_id ..................................... [[32mPASS[0m in 0.05s]
[0m17:00:43.366040 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:00:43.365040 [info ] [Thread-4 (]: 4 of 30 PASS not_null_fct_purchase_purchase_id ................................. [[32mPASS[0m in 0.05s]
[0m17:00:43.366040 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:00:43.367040 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:00:43.367040 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:00:43.367040 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:00:43.367040 [info ] [Thread-1 (]: 5 of 30 START test not_null_fct_referral_referral_id ........................... [RUN]
[0m17:00:43.368039 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:00:43.368039 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:00:43.368039 [info ] [Thread-3 (]: 6 of 30 START test not_null_fct_rewards_reward_id .............................. [RUN]
[0m17:00:43.369039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m17:00:43.369039 [info ] [Thread-2 (]: 7 of 30 START test not_null_stg_events_event_id ................................ [RUN]
[0m17:00:43.370040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m17:00:43.370040 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:00:43.369039 [info ] [Thread-4 (]: 8 of 30 START test not_null_stg_events_user_id ................................. [RUN]
[0m17:00:43.370040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m17:00:43.370040 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:00:43.373040 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:00:43.373040 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m17:00:43.374039 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:00:43.376040 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:00:43.377040 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:00:43.377040 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:00:43.377040 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:00:43.377040 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:00:43.383335 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:00:43.383335 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:00:43.386430 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:00:43.386430 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:00:43.386430 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:00:43.422240 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:00:43.424169 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:00:43.424877 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:00:43.424877 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:00:43.424877 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m17:00:43.425955 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m17:00:43.425955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:43.425955 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:00:43.425955 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:00:43.426956 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:43.426956 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m17:00:43.426956 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m17:00:43.426956 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.428104 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:43.428104 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:43.428104 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.428104 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:00:43.429041 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:00:43.429041 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T214833Z"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.429041 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.430073 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.430073 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps_20260203T214833Z"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.430073 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:00:43.430073 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:00:43.431355 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps_20260203T214833Z"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.431355 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.431355 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T214833Z"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.432026 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.433072 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m17:00:43.433072 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.433072 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.434130 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m17:00:43.434130 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m17:00:43.435129 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m17:00:43.436130 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m17:00:43.437011 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m17:00:43.437011 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m17:00:43.437986 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m17:00:43.437986 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m17:00:43.437986 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m17:00:43.439002 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m17:00:43.439002 [info ] [Thread-1 (]: 5 of 30 PASS not_null_fct_referral_referral_id ................................. [[32mPASS[0m in 0.07s]
[0m17:00:43.439002 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m17:00:43.439002 [info ] [Thread-3 (]: 6 of 30 PASS not_null_fct_rewards_reward_id .................................... [[32mPASS[0m in 0.07s]
[0m17:00:43.440051 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:00:43.440051 [info ] [Thread-4 (]: 8 of 30 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.07s]
[0m17:00:43.441050 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:00:43.441050 [info ] [Thread-2 (]: 7 of 30 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.07s]
[0m17:00:43.441050 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:00:43.442017 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:00:43.442017 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:00:43.442017 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:00:43.443097 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:00:43.442017 [info ] [Thread-1 (]: 9 of 30 START test not_null_stg_products_product_id ............................ [RUN]
[0m17:00:43.443097 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:00:43.443097 [info ] [Thread-3 (]: 10 of 30 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m17:00:43.444097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m17:00:43.443097 [info ] [Thread-4 (]: 11 of 30 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m17:00:43.444097 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m17:00:43.444097 [info ] [Thread-2 (]: 12 of 30 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m17:00:43.445151 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:00:43.445151 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m17:00:43.445151 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:00:43.445795 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m17:00:43.448617 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:00:43.448617 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:00:43.450618 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:00:43.450618 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:00:43.454129 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:00:43.456128 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:00:43.457129 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:00:43.458128 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:00:43.458128 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:00:43.459848 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:00:43.459848 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:00:43.461665 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:00:43.461665 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:00:43.461665 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:00:43.461665 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:00:43.461665 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m17:00:43.461665 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:00:43.461665 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:43.461665 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:00:43.461665 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m17:00:43.465778 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m17:00:43.466346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:43.466346 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:00:43.466346 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.466346 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:43.466346 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m17:00:43.466346 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:00:43.466346 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.466346 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:43.466346 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T214833Z"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.466346 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.466346 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:00:43.466346 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:00:43.466346 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.466346 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T214833Z"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.466346 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.466346 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T214833Z"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.466346 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:00:43.466346 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T214833Z"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.472749 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m17:00:43.472749 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.473753 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.473753 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m17:00:43.474754 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m17:00:43.474754 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.474754 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m17:00:43.475753 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m17:00:43.476753 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m17:00:43.477753 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m17:00:43.476753 [info ] [Thread-3 (]: 10 of 30 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.03s]
[0m17:00:43.478753 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m17:00:43.478753 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m17:00:43.478753 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m17:00:43.479753 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:00:43.479753 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m17:00:43.479753 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m17:00:43.479753 [info ] [Thread-1 (]: 9 of 30 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.04s]
[0m17:00:43.481014 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:00:43.481014 [info ] [Thread-2 (]: 12 of 30 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.04s]
[0m17:00:43.482014 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:00:43.482014 [info ] [Thread-4 (]: 11 of 30 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.04s]
[0m17:00:43.483014 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:00:43.482014 [info ] [Thread-3 (]: 13 of 30 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m17:00:43.483014 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:00:43.483014 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:00:43.484013 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:00:43.484013 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m17:00:43.484013 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:00:43.484013 [info ] [Thread-1 (]: 14 of 30 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m17:00:43.485018 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:00:43.485018 [info ] [Thread-2 (]: 15 of 30 START test not_null_stg_schools_school_id ............................. [RUN]
[0m17:00:43.485018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m17:00:43.485018 [info ] [Thread-4 (]: 16 of 30 START test not_null_stg_users_school_id ............................... [RUN]
[0m17:00:43.488119 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:00:43.488917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m17:00:43.488917 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:00:43.489502 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m17:00:43.489502 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:00:43.491504 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:00:43.492504 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:00:43.494506 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:00:43.495907 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:00:43.495907 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:00:43.495907 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:00:43.499502 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:00:43.500534 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:00:43.501147 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:00:43.501147 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:00:43.501147 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:00:43.501147 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:00:43.501147 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:00:43.501147 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m17:00:43.501147 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:00:43.501147 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:43.501147 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:00:43.501147 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m17:00:43.501147 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m17:00:43.501147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:43.501147 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:00:43.507461 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.507461 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:43.507891 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m17:00:43.507891 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:00:43.507891 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.508936 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:43.508936 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T214833Z"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.508936 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.508936 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:00:43.509936 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:00:43.509936 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.509936 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps_20260203T214833Z"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.509936 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.510937 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T214833Z"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.510937 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:00:43.511936 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m17:00:43.511936 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T214833Z"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.512936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.512936 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.512936 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m17:00:43.514358 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m17:00:43.515394 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m17:00:43.515394 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m17:00:43.515394 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.516394 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m17:00:43.516394 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m17:00:43.517393 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m17:00:43.518395 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m17:00:43.517393 [info ] [Thread-3 (]: 13 of 30 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.03s]
[0m17:00:43.518395 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m17:00:43.519394 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m17:00:43.519394 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:00:43.519394 [info ] [Thread-1 (]: 14 of 30 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.03s]
[0m17:00:43.520393 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m17:00:43.520393 [info ] [Thread-2 (]: 15 of 30 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.03s]
[0m17:00:43.520393 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:00:43.521333 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:00:43.522051 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:00:43.522051 [info ] [Thread-4 (]: 16 of 30 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:00:43.523100 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m17:00:43.522051 [info ] [Thread-3 (]: 17 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m17:00:43.523100 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:00:43.523100 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:00:43.524100 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m17:00:43.523100 [info ] [Thread-1 (]: 18 of 30 START test test_events_in_window ...................................... [RUN]
[0m17:00:43.524100 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:00:43.524100 [info ] [Thread-2 (]: 19 of 30 START test unique_dim_product_product_id .............................. [RUN]
[0m17:00:43.525100 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:00:43.525100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.test_events_in_window)
[0m17:00:43.525100 [info ] [Thread-4 (]: 20 of 30 START test unique_dim_school_school_id ................................ [RUN]
[0m17:00:43.525100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m17:00:43.528102 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:00:43.528686 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m17:00:43.528686 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m17:00:43.529014 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:00:43.530887 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m17:00:43.530887 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:00:43.535521 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:00:43.535521 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:00:43.537520 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:00:43.537520 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:00:43.537520 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m17:00:43.537520 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m17:00:43.542195 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:00:43.542791 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:00:43.542791 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:00:43.543455 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m17:00:43.543455 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:00:43.543455 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:00:43.543455 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:00:43.543455 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:43.543455 [debug] [Thread-1 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m17:00:43.543455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:43.543455 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.543455 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:00:43.543455 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:00:43.543455 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.548936 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:00:43.548936 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m17:00:43.548936 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T214833Z"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:00:43.548936 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:00:43.548936 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m17:00:43.550150 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:43.550150 [debug] [Thread-1 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps_20260203T214833Z"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m17:00:43.550150 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:43.551150 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.551150 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.551150 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.552151 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:00:43.553150 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m17:00:43.553150 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:00:43.553150 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:43.554149 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m17:00:43.554149 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:43.554149 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:00:43.555149 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m17:00:43.556149 [debug] [Thread-1 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m17:00:43.556149 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.557150 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.556149 [info ] [Thread-3 (]: 17 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m17:00:43.557150 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m17:00:43.558150 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m17:00:43.559150 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m17:00:43.559150 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:00:43.559150 [debug] [Thread-1 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m17:00:43.560149 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m17:00:43.561149 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m17:00:43.561149 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:00:43.561149 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m17:00:43.562149 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m17:00:43.561149 [info ] [Thread-1 (]: 18 of 30 PASS test_events_in_window ............................................ [[32mPASS[0m in 0.04s]
[0m17:00:43.562149 [info ] [Thread-3 (]: 21 of 30 START test unique_dim_user_user_id .................................... [RUN]
[0m17:00:43.562149 [info ] [Thread-4 (]: 20 of 30 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m17:00:43.563718 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m17:00:43.564032 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m17:00:43.563150 [info ] [Thread-2 (]: 19 of 30 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.04s]
[0m17:00:43.564032 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:00:43.564643 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:00:43.564643 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:00:43.564643 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:00:43.564643 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:00:43.567768 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:00:43.565768 [info ] [Thread-1 (]: 22 of 30 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m17:00:43.567768 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:00:43.567768 [info ] [Thread-4 (]: 23 of 30 START test unique_fct_referral_referral_id ............................ [RUN]
[0m17:00:43.567768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m17:00:43.569704 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m17:00:43.569704 [info ] [Thread-2 (]: 24 of 30 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m17:00:43.569704 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:00:43.570708 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:00:43.570708 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:00:43.570708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m17:00:43.572711 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:00:43.574861 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:00:43.576858 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:00:43.577859 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:00:43.579859 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:00:43.579859 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:00:43.580963 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:00:43.580963 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:00:43.580963 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m17:00:43.582964 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:00:43.584968 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:00:43.584968 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:00:43.584968 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:43.586967 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:00:43.586967 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:00:43.587968 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.587968 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m17:00:43.587968 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:00:43.588968 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:00:43.588968 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:00:43.588968 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:43.588968 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m17:00:43.589968 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:43.589968 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m17:00:43.589968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:43.590968 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:43.590968 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.591969 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.591969 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:00:43.591969 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:00:43.591969 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.592969 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.592969 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:43.592969 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:43.593967 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:00:43.593967 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m17:00:43.594969 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:43.595968 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m17:00:43.595968 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.595968 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m17:00:43.595968 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m17:00:43.598505 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:00:43.598505 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:00:43.598505 [info ] [Thread-3 (]: 21 of 30 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.03s]
[0m17:00:43.599737 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m17:00:43.599737 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m17:00:43.599737 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:00:43.599737 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m17:00:43.599737 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m17:00:43.599737 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m17:00:43.599737 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:00:43.599737 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m17:00:43.599737 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m17:00:43.599737 [info ] [Thread-4 (]: 23 of 30 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.03s]
[0m17:00:43.604668 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m17:00:43.599737 [info ] [Thread-3 (]: 25 of 30 START test unique_stg_events_event_id ................................. [RUN]
[0m17:00:43.605673 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:00:43.604668 [info ] [Thread-1 (]: 22 of 30 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.04s]
[0m17:00:43.605673 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m17:00:43.605673 [info ] [Thread-2 (]: 24 of 30 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:00:43.606673 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:00:43.606673 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:00:43.606673 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:00:43.607673 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:00:43.607673 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:00:43.607673 [info ] [Thread-4 (]: 26 of 30 START test unique_stg_products_product_id ............................. [RUN]
[0m17:00:43.610761 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:00:43.610761 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:00:43.610761 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m17:00:43.610761 [info ] [Thread-1 (]: 27 of 30 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m17:00:43.611767 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:00:43.611767 [info ] [Thread-2 (]: 28 of 30 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m17:00:43.611767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m17:00:43.612768 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:00:43.614787 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:00:43.615789 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m17:00:43.615789 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:00:43.616788 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:00:43.617789 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:00:43.619788 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:00:43.621656 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:00:43.622660 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:00:43.623660 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:00:43.624659 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:00:43.624659 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m17:00:43.624659 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:43.624659 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:00:43.626662 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:00:43.627240 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.627240 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:00:43.627240 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:00:43.627240 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m17:00:43.627240 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:00:43.627240 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:43.627240 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:00:43.627240 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:43.627240 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:00:43.627240 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m17:00:43.627240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:43.632447 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:00:43.632848 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.632848 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:00:43.632848 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:00:43.632848 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:00:43.632848 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:43.632848 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:00:43.632848 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m17:00:43.632848 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:43.632848 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:43.632848 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m17:00:43.632848 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.632848 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m17:00:43.632848 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m17:00:43.632848 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:00:43.639425 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m17:00:43.632848 [info ] [Thread-3 (]: 25 of 30 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.03s]
[0m17:00:43.639425 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:00:43.639425 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:00:43.640430 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m17:00:43.640430 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:00:43.640430 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:43.641430 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m17:00:43.641430 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:00:43.642431 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m17:00:43.642431 [info ] [Thread-4 (]: 26 of 30 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m17:00:43.643432 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m17:00:43.643432 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:00:43.642431 [info ] [Thread-3 (]: 29 of 30 START test unique_stg_schools_school_id ............................... [RUN]
[0m17:00:43.644430 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:00:43.644770 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m17:00:43.644770 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:00:43.644770 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m17:00:43.645816 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m17:00:43.645816 [info ] [Thread-1 (]: 27 of 30 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.03s]
[0m17:00:43.646786 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:00:43.646786 [info ] [Thread-4 (]: 30 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m17:00:43.646786 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:00:43.647824 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m17:00:43.648824 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:00:43.648824 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m17:00:43.648824 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m17:00:43.648824 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:00:43.653664 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:00:43.648824 [info ] [Thread-2 (]: 28 of 30 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m17:00:43.654664 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:00:43.654664 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:00:43.656285 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:00:43.656285 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:00:43.658283 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:00:43.658283 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:00:43.658283 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m17:00:43.658283 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:43.658283 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:00:43.658283 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m17:00:43.658283 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.660225 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:43.660225 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:00:43.660848 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:43.661211 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.661211 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:00:43.661211 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:00:43.662216 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.662216 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m17:00:43.663215 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.663215 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m17:00:43.664215 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m17:00:43.664215 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m17:00:43.665215 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m17:00:43.665215 [info ] [Thread-3 (]: 29 of 30 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.02s]
[0m17:00:43.665215 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m17:00:43.666215 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:00:43.666215 [info ] [Thread-4 (]: 30 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.02s]
[0m17:00:43.667167 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:00:43.667985 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:43.667985 [debug] [MainThread]: On master: BEGIN
[0m17:00:43.667985 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:00:43.667985 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:00:43.667985 [debug] [MainThread]: On master: COMMIT
[0m17:00:43.667985 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:43.667985 [debug] [MainThread]: On master: COMMIT
[0m17:00:43.667985 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:00:43.667985 [debug] [MainThread]: On master: Close
[0m17:00:43.667985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:43.667985 [debug] [MainThread]: Connection 'list_carton_caps_20260203T214833Z_main' was properly closed.
[0m17:00:43.667985 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103' was properly closed.
[0m17:00:43.667985 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d' was properly closed.
[0m17:00:43.667985 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6' was properly closed.
[0m17:00:43.667985 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m17:00:43.667985 [info ] [MainThread]: 
[0m17:00:43.667985 [info ] [MainThread]: Finished running 30 data tests in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m17:00:43.673841 [debug] [MainThread]: Command end result
[0m17:00:43.687916 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_carton_caps\target\manifest.json
[0m17:00:43.689918 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_carton_caps\target\semantic_manifest.json
[0m17:00:43.693918 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt_carton_caps\target\run_results.json
[0m17:00:43.693918 [info ] [MainThread]: 
[0m17:00:43.694917 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:00:43.694917 [info ] [MainThread]: 
[0m17:00:43.694917 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=30
[0m17:00:43.695917 [debug] [MainThread]: Command `dbt test` succeeded at 17:00:43.695917 after 1.10 seconds
[0m17:00:43.695917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B18D20C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B485EF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B485FE30>]}
[0m17:00:43.695917 [debug] [MainThread]: Flushing usage events
[0m17:00:43.973235 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:01:19.754563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD050FB3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD050FB440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD050FB020>]}


============================== 17:01:19.758164 | 64f151ae-b3bc-429e-aaeb-a35b17626472 ==============================
[0m17:01:19.758164 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:01:19.758675 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'dbt_carton_caps', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --profiles-dir dbt_carton_caps --project-dir dbt_carton_caps', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'dbt_carton_caps\\logs'}
[0m17:01:19.898951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64f151ae-b3bc-429e-aaeb-a35b17626472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD05771C70>]}
[0m17:01:19.934791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64f151ae-b3bc-429e-aaeb-a35b17626472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD06A74230>]}
[0m17:01:19.936796 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:01:20.089289 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:01:20.180376 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:01:20.180376 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:01:20.181376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:01:20.213146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64f151ae-b3bc-429e-aaeb-a35b17626472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD06A42AB0>]}
[0m17:01:20.271560 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_carton_caps\target\manifest.json
[0m17:01:20.273393 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_carton_caps\target\semantic_manifest.json
[0m17:01:20.298002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64f151ae-b3bc-429e-aaeb-a35b17626472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD07044860>]}
[0m17:01:20.298002 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:01:20.301000 [info ] [MainThread]: 
[0m17:01:20.301000 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:01:20.301000 [info ] [MainThread]: 
[0m17:01:20.302000 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:01:20.305001 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T214833Z'
[0m17:01:20.350015 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T214833Z"
[0m17:01:20.350015 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T214833Z"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps_20260203t214833z"'
    
  
  
[0m17:01:20.351016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:20.414547 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T214833Z"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps_20260203t214833z"'
    
  
  
[0m17:01:20.414547 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:01:20.414547 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:20.415657 [debug] [MainThread]: Connection 'list_carton_caps_20260203T214833Z' was properly closed.
[0m17:01:20.415657 [info ] [MainThread]: 
[0m17:01:20.415657 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m17:01:20.415657 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\repos\livefront\carton_caps_analytics\duckdb\carton_caps_20260203t214833z.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Users\Gage\AppData\Local\Programs\Python\Python312\python.exe (PID 28692)
[0m17:01:20.416666 [debug] [MainThread]: Command `dbt build` failed at 17:01:20.416666 after 0.74 seconds
[0m17:01:20.416666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD057036B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD06C65880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD07066F00>]}
[0m17:01:20.417415 [debug] [MainThread]: Flushing usage events
[0m17:01:20.847906 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:03:38.182751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C414D81400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C414D44920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C414AB17C0>]}


============================== 17:03:38.190904 | e7f84deb-830c-4ef4-ab72-8c90bf976b57 ==============================
[0m17:03:38.190904 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:03:38.190904 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'dbt_carton_caps', 'invocation_command': 'dbt build --profiles-dir dbt_carton_caps --project-dir dbt_carton_caps', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'dbt_carton_caps\\logs'}
[0m17:03:38.328016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7f84deb-830c-4ef4-ab72-8c90bf976b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C416B6D190>]}
[0m17:03:38.368230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7f84deb-830c-4ef4-ab72-8c90bf976b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C416AEC8C0>]}
[0m17:03:38.369605 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:03:38.518331 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:03:38.605725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:03:38.606762 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:03:38.606762 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:03:38.628548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7f84deb-830c-4ef4-ab72-8c90bf976b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C41554EDB0>]}
[0m17:03:38.690120 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_carton_caps\target\manifest.json
[0m17:03:38.690120 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_carton_caps\target\semantic_manifest.json
[0m17:03:38.717696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7f84deb-830c-4ef4-ab72-8c90bf976b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C416D32990>]}
[0m17:03:38.720586 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:03:38.722325 [info ] [MainThread]: 
[0m17:03:38.722325 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:03:38.722325 [info ] [MainThread]: 
[0m17:03:38.722325 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:03:38.726338 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T214833Z'
[0m17:03:38.767501 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T214833Z"
[0m17:03:38.767501 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T214833Z"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps_20260203t214833z"'
    
  
  
[0m17:03:38.767501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:38.831766 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T214833Z"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps_20260203t214833z"'
    
  
  
[0m17:03:38.831766 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:03:38.831766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:38.831766 [debug] [MainThread]: Connection 'list_carton_caps_20260203T214833Z' was properly closed.
[0m17:03:38.831766 [info ] [MainThread]: 
[0m17:03:38.831766 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m17:03:38.831766 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\repos\livefront\carton_caps_analytics\duckdb\carton_caps_20260203t214833z.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Users\Gage\AppData\Local\Programs\Python\Python312\python.exe (PID 29268)
[0m17:03:38.831766 [debug] [MainThread]: Command `dbt build` failed at 17:03:38.831766 after 0.73 seconds
[0m17:03:38.831766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C415260CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C416AEC320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4170D7260>]}
[0m17:03:38.831766 [debug] [MainThread]: Flushing usage events
[0m17:03:39.196418 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:31.530987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436AE15EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436D7C1B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436BBA19A0>]}


============================== 17:08:31.537947 | d6784d00-6139-41b8-a91a-21a4bd4ad1bc ==============================
[0m17:08:31.537947 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:08:31.537947 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'dbt_carton_caps', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --profiles-dir dbt_carton_caps --project-dir dbt_carton_caps', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'dbt_carton_caps\\logs'}
[0m17:08:31.677831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436F2ED1C0>]}
[0m17:08:31.721578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436BA35E20>]}
[0m17:08:31.722585 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:08:31.861562 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:08:31.960038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:08:31.960038 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:08:31.960038 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:08:31.992060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436F722510>]}
[0m17:08:32.053979 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_carton_caps\target\manifest.json
[0m17:08:32.053979 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_carton_caps\target\semantic_manifest.json
[0m17:08:32.080869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436F721D60>]}
[0m17:08:32.080869 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:08:32.080869 [info ] [MainThread]: 
[0m17:08:32.080869 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:08:32.080869 [info ] [MainThread]: 
[0m17:08:32.080869 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:08:32.087503 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T214833Z'
[0m17:08:32.115337 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T214833Z"
[0m17:08:32.131170 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T214833Z"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps_20260203t214833z"'
    
  
  
[0m17:08:32.131170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:32.143738 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m17:08:32.143738 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z: Close
[0m17:08:32.143738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_carton_caps_20260203T214833Z, now create_carton_caps_20260203T214833Z_main)
[0m17:08:32.143738 [debug] [ThreadPool]: Creating schema "database: "carton_caps_20260203T214833Z"
schema: "main"
"
[0m17:08:32.146856 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T214833Z_main"
[0m17:08:32.146856 [debug] [ThreadPool]: On create_carton_caps_20260203T214833Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_20260203T214833Z_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='carton_caps_20260203t214833z'
        and type='sqlite'
    
  
[0m17:08:32.146856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:08:32.146856 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:08:32.146856 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T214833Z_main"
[0m17:08:32.146856 [debug] [ThreadPool]: On create_carton_caps_20260203T214833Z_main: BEGIN
[0m17:08:32.146856 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:08:32.146856 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T214833Z_main"
[0m17:08:32.146856 [debug] [ThreadPool]: On create_carton_caps_20260203T214833Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_20260203T214833Z_main"} */

    
    
        create schema if not exists "carton_caps_20260203T214833Z"."main"
    
[0m17:08:32.152063 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:08:32.152063 [debug] [ThreadPool]: On create_carton_caps_20260203T214833Z_main: COMMIT
[0m17:08:32.152063 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T214833Z_main"
[0m17:08:32.152063 [debug] [ThreadPool]: On create_carton_caps_20260203T214833Z_main: COMMIT
[0m17:08:32.152063 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:08:32.152063 [debug] [ThreadPool]: On create_carton_caps_20260203T214833Z_main: Close
[0m17:08:32.152063 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T214833Z_main'
[0m17:08:32.152063 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T214833Z_main"
[0m17:08:32.152063 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z_main: BEGIN
[0m17:08:32.152063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:32.152063 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:08:32.152063 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T214833Z_main"
[0m17:08:32.152063 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T214833Z_main"} */
select
      'carton_caps_20260203T214833Z' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps_20260203t214833z'
  
[0m17:08:32.165999 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:08:32.167002 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z_main: ROLLBACK
[0m17:08:32.168002 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_20260203T214833Z_main'
[0m17:08:32.168002 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z_main: Close
[0m17:08:32.170000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436FF82540>]}
[0m17:08:32.170000 [debug] [MainThread]: Using duckdb connection "master"
[0m17:08:32.170000 [debug] [MainThread]: On master: BEGIN
[0m17:08:32.170000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:32.170000 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:08:32.170999 [debug] [MainThread]: On master: COMMIT
[0m17:08:32.170999 [debug] [MainThread]: Using duckdb connection "master"
[0m17:08:32.170999 [debug] [MainThread]: On master: COMMIT
[0m17:08:32.170999 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:08:32.170999 [debug] [MainThread]: On master: Close
[0m17:08:32.173501 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_events
[0m17:08:32.173501 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.stg_products
[0m17:08:32.174502 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.stg_purchases
[0m17:08:32.174502 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.stg_referrals
[0m17:08:32.174502 [info ] [Thread-1 (]: 1 of 44 START sql view model main.stg_events ................................... [RUN]
[0m17:08:32.174502 [info ] [Thread-2 (]: 2 of 44 START sql view model main.stg_products ................................. [RUN]
[0m17:08:32.175543 [info ] [Thread-3 (]: 3 of 44 START sql view model main.stg_purchases ................................ [RUN]
[0m17:08:32.175543 [info ] [Thread-4 (]: 4 of 44 START sql view model main.stg_referrals ................................ [RUN]
[0m17:08:32.175543 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_events'
[0m17:08:32.176543 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_products'
[0m17:08:32.176543 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_purchases'
[0m17:08:32.176543 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_referrals'
[0m17:08:32.176543 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_events
[0m17:08:32.177542 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.stg_products
[0m17:08:32.177542 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.stg_purchases
[0m17:08:32.177542 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.stg_referrals
[0m17:08:32.182541 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_events"
[0m17:08:32.184542 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_products"
[0m17:08:32.185543 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_purchases"
[0m17:08:32.187541 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_referrals"
[0m17:08:32.187541 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_events
[0m17:08:32.190543 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_events"
[0m17:08:32.190543 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.stg_referrals
[0m17:08:32.190543 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.stg_purchases
[0m17:08:32.190543 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.stg_products
[0m17:08:32.206591 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_referrals"
[0m17:08:32.206591 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_purchases"
[0m17:08:32.209891 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_products"
[0m17:08:32.209891 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:08:32.209891 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: BEGIN
[0m17:08:32.209891 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:08:32.209891 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:08:32.209891 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:08:32.209891 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.209891 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: BEGIN
[0m17:08:32.214002 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:08:32.214002 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: BEGIN
[0m17:08:32.214002 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:08:32.214002 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:08:32.214002 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: BEGIN
[0m17:08:32.214002 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:08:32.214002 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

  
  create view "carton_caps_20260203T214833Z"."main"."stg_events__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T214833Z"."raw"."events"
)
select
  cast(event_id as integer) as event_id,
  cast(user_id as integer) as user_id,
  cast(event_type as varchar) as event_type,
  cast(event_at as timestamp) as event_at,
  cast(referral_id as integer) as referral_id,
  cast(metadata_json as varchar) as metadata_json
from src
  );

[0m17:08:32.214002 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:08:32.214002 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.214002 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.214002 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:08:32.214002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.214002 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:08:32.214002 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.214002 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

  
  create view "carton_caps_20260203T214833Z"."main"."stg_purchases__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T214833Z"."raw"."purchases"
)
select
  cast(purchase_id as integer) as purchase_id,
  cast(user_id as integer) as user_id,
  cast(product_id as integer) as product_id,
  cast(quantity as integer) as quantity,
  cast(price_paid as double) as price_paid,
  cast(points_earned as integer) as points_earned,
  cast(purchased_at as timestamp) as purchased_at,
  cast(day_of_week as varchar) as day_of_week,
  cast(hour_of_day as integer) as hour_of_day
from src
  );

[0m17:08:32.219743 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:08:32.219743 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

  
  create view "carton_caps_20260203T214833Z"."main"."stg_products__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T214833Z"."raw"."products"
)
select
  cast(product_id as integer) as product_id,
  cast(name as varchar) as name,
  cast(category as varchar) as category,
  cast(price as double) as price,
  cast(points_per_dollar as integer) as points_per_dollar,
  cast(created_at as timestamp) as created_at
from src
  );

[0m17:08:32.219743 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:08:32.219743 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m17:08:32.222446 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:08:32.222446 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

  
  create view "carton_caps_20260203T214833Z"."main"."stg_referrals__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T214833Z"."raw"."referrals"
)
select
  cast(referral_id as integer) as referral_id,
  cast(referrer_user_id as integer) as referrer_user_id,
  lower(cast(referred_email as varchar)) as referred_email,
  cast(referred_user_id as integer) as referred_user_id,
  cast(referral_code as varchar) as referral_code,
  cast(sent_at as timestamp) as sent_at,
  cast(converted_at as timestamp) as converted_at,
  cast(status as varchar) as status
from src
  );

[0m17:08:32.222446 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.222446 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:08:32.222446 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.262192 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:08:32.262192 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m17:08:32.262192 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_purchases" rename to "stg_purchases__dbt_backup"
[0m17:08:32.262192 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:08:32.262192 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m17:08:32.262192 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:08:32.262192 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m17:08:32.262192 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:08:32.262192 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_referrals" rename to "stg_referrals__dbt_backup"
[0m17:08:32.262192 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.262192 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:08:32.262192 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.262192 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:08:32.262192 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_purchases__dbt_tmp" rename to "stg_purchases"
[0m17:08:32.262192 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.275017 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m17:08:32.280015 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m17:08:32.282018 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:08:32.282018 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.282018 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:08:32.282018 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m17:08:32.283137 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.283137 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m17:08:32.284136 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m17:08:32.285138 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m17:08:32.285138 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:08:32.285138 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.285138 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:08:32.286138 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m17:08:32.287138 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m17:08:32.287138 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m17:08:32.287138 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:08:32.287948 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m17:08:32.290054 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:08:32.294053 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:08:32.294053 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

      drop view if exists "carton_caps_20260203T214833Z"."main"."stg_events__dbt_backup" cascade
    
[0m17:08:32.294053 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:08:32.296056 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:08:32.296056 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:08:32.296056 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:08:32.296056 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

      drop view if exists "carton_caps_20260203T214833Z"."main"."stg_purchases__dbt_backup" cascade
    
[0m17:08:32.298055 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:08:32.298055 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.299056 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:08:32.300058 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

      drop view if exists "carton_caps_20260203T214833Z"."main"."stg_products__dbt_backup" cascade
    
[0m17:08:32.301055 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: Close
[0m17:08:32.301801 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.301801 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

      drop view if exists "carton_caps_20260203T214833Z"."main"."stg_referrals__dbt_backup" cascade
    
[0m17:08:32.302916 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: Close
[0m17:08:32.303915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024370067BF0>]}
[0m17:08:32.304917 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243700B38C0>]}
[0m17:08:32.304917 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.304917 [info ] [Thread-1 (]: 1 of 44 OK created sql view model main.stg_events .............................. [[32mOK[0m in 0.13s]
[0m17:08:32.305917 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.305917 [info ] [Thread-3 (]: 3 of 44 OK created sql view model main.stg_purchases ........................... [[32mOK[0m in 0.13s]
[0m17:08:32.306916 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: Close
[0m17:08:32.306916 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_events
[0m17:08:32.307916 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: Close
[0m17:08:32.308823 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.stg_purchases
[0m17:08:32.308823 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024370056030>]}
[0m17:08:32.308823 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_schools
[0m17:08:32.308823 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.stg_users
[0m17:08:32.308823 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436FED7650>]}
[0m17:08:32.308823 [info ] [Thread-2 (]: 2 of 44 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.13s]
[0m17:08:32.308823 [info ] [Thread-1 (]: 5 of 44 START sql view model main.stg_schools .................................. [RUN]
[0m17:08:32.308823 [info ] [Thread-3 (]: 6 of 44 START sql view model main.stg_users .................................... [RUN]
[0m17:08:32.308823 [info ] [Thread-4 (]: 4 of 44 OK created sql view model main.stg_referrals ........................... [[32mOK[0m in 0.13s]
[0m17:08:32.308823 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.stg_products
[0m17:08:32.308823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_events, now model.dbt_carton_caps.stg_schools)
[0m17:08:32.308823 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_purchases, now model.dbt_carton_caps.stg_users)
[0m17:08:32.308823 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.stg_referrals
[0m17:08:32.308823 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:08:32.308823 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_schools
[0m17:08:32.308823 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.stg_users
[0m17:08:32.308823 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:08:32.308823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_schools"
[0m17:08:32.308823 [info ] [Thread-2 (]: 7 of 44 START test not_null_stg_events_event_id ................................ [RUN]
[0m17:08:32.308823 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_users"
[0m17:08:32.308823 [info ] [Thread-4 (]: 8 of 44 START test not_null_stg_events_user_id ................................. [RUN]
[0m17:08:32.308823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_products, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m17:08:32.308823 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_referrals, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m17:08:32.308823 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:08:32.308823 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:08:32.321392 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_schools
[0m17:08:32.321392 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.stg_users
[0m17:08:32.329608 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:08:32.330657 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:08:32.332654 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_schools"
[0m17:08:32.333657 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_users"
[0m17:08:32.334656 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:08:32.343886 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:08:32.344971 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:08:32.346846 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:08:32.346846 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:08:32.346846 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:08:32.347845 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_users: BEGIN
[0m17:08:32.347845 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: BEGIN
[0m17:08:32.347845 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:08:32.348844 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:08:32.348844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:32.348844 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:08:32.349845 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m17:08:32.349845 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.350453 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m17:08:32.350453 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:08:32.350802 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.350802 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:08:32.350802 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:32.351890 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:08:32.351890 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

  
  create view "carton_caps_20260203T214833Z"."main"."stg_users__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T214833Z"."raw"."users"
)
select
  cast(user_id as integer) as user_id,
  cast(first_name as varchar) as first_name,
  cast(last_name as varchar) as last_name,
  lower(cast(email as varchar)) as email,
  cast(school_id as integer) as school_id,
  cast(created_at as timestamp) as created_at,
  cast(user_type as varchar) as user_type,
  cast(is_verified as integer) as is_verified,
  cast(device_id as varchar) as device_id,
  cast(marketing_channel as varchar) as marketing_channel
from src
  );

[0m17:08:32.351890 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.351890 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

  
  create view "carton_caps_20260203T214833Z"."main"."stg_schools__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T214833Z"."raw"."schools"
)
select
  cast(school_id as integer) as school_id,
  cast(name as varchar) as name,
  cast(address as varchar) as address,
  cast(city as varchar) as city,
  cast(state as varchar) as state,
  cast(zip_code as varchar) as zip_code,
  cast(created_at as timestamp) as created_at
from src
  );

[0m17:08:32.352894 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.352894 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:08:32.352894 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:08:32.353895 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.353895 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps_20260203T214833Z"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.353895 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.353895 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T214833Z"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.355896 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:08:32.358456 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:08:32.359456 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.359456 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m17:08:32.359456 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_schools" rename to "stg_schools__dbt_backup"
[0m17:08:32.359456 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.361455 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m17:08:32.362455 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.363457 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m17:08:32.363803 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m17:08:32.364157 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.365338 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:08:32.366338 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m17:08:32.366338 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m17:08:32.368335 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:08:32.368335 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:08:32.368335 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m17:08:32.369337 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */
alter view "carton_caps_20260203T214833Z"."main"."stg_schools__dbt_tmp" rename to "stg_schools"
[0m17:08:32.369337 [info ] [Thread-2 (]: 7 of 44 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.06s]
[0m17:08:32.369337 [info ] [Thread-4 (]: 8 of 44 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.06s]
[0m17:08:32.370336 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.370336 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:08:32.370336 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.371243 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:08:32.371243 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m17:08:32.371243 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m17:08:32.371243 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m17:08:32.371243 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:08:32.371243 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:08:32.371243 [info ] [Thread-2 (]: 9 of 44 START test test_events_in_window ....................................... [RUN]
[0m17:08:32.371243 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:08:32.371243 [info ] [Thread-4 (]: 10 of 44 START test unique_stg_events_event_id ................................. [RUN]
[0m17:08:32.371243 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m17:08:32.371243 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.test_events_in_window)
[0m17:08:32.371243 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m17:08:32.371243 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m17:08:32.371243 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m17:08:32.371243 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:08:32.371243 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m17:08:32.371243 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.381339 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:08:32.381339 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:08:32.383339 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:08:32.384732 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:08:32.385124 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

      drop view if exists "carton_caps_20260203T214833Z"."main"."stg_users__dbt_backup" cascade
    
[0m17:08:32.385794 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m17:08:32.385794 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

      drop view if exists "carton_caps_20260203T214833Z"."main"."stg_schools__dbt_backup" cascade
    
[0m17:08:32.385794 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:08:32.386846 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m17:08:32.388847 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:08:32.388847 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.389846 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_users: Close
[0m17:08:32.389846 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.390848 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436D515970>]}
[0m17:08:32.391846 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: Close
[0m17:08:32.392161 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:08:32.392486 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:08:32.392486 [info ] [Thread-3 (]: 6 of 44 OK created sql view model main.stg_users ............................... [[32mOK[0m in 0.08s]
[0m17:08:32.392486 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m17:08:32.393507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436F6D5280>]}
[0m17:08:32.393507 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m17:08:32.393507 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.stg_users
[0m17:08:32.394507 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:08:32.394507 [info ] [Thread-1 (]: 5 of 44 OK created sql view model main.stg_schools ............................. [[32mOK[0m in 0.08s]
[0m17:08:32.394507 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:32.394507 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:08:32.395508 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_schools
[0m17:08:32.395508 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.396508 [info ] [Thread-3 (]: 11 of 44 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m17:08:32.396508 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:08:32.396508 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.396508 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:08:32.397508 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_users, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m17:08:32.397508 [info ] [Thread-1 (]: 12 of 44 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m17:08:32.397508 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:08:32.397508 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps_20260203T214833Z"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m17:08:32.398507 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:08:32.398507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_schools, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m17:08:32.399033 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:32.401090 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:08:32.402088 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:08:32.402088 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.405088 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:08:32.406088 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.407089 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m17:08:32.407089 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:08:32.408088 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m17:08:32.408088 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m17:08:32.408088 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:08:32.408088 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:08:32.408088 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m17:08:32.408088 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m17:08:32.413289 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:08:32.413289 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m17:08:32.414458 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:08:32.414458 [info ] [Thread-4 (]: 10 of 44 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m17:08:32.414458 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m17:08:32.415459 [info ] [Thread-2 (]: 9 of 44 PASS test_events_in_window ............................................. [[32mPASS[0m in 0.04s]
[0m17:08:32.415459 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:08:32.415459 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:08:32.416459 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m17:08:32.416459 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:08:32.416459 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:08:32.417459 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:08:32.417459 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m17:08:32.417459 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.417459 [info ] [Thread-4 (]: 13 of 44 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m17:08:32.418459 [info ] [Thread-2 (]: 14 of 44 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m17:08:32.418459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:32.418459 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:08:32.418459 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m17:08:32.419459 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m17:08:32.419853 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T214833Z"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.419853 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:08:32.419853 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.419853 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:08:32.422892 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:08:32.422892 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:08:32.422892 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.424892 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:08:32.425891 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T214833Z"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.426798 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m17:08:32.426798 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:08:32.426798 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m17:08:32.426798 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:08:32.426798 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.426798 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m17:08:32.426798 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:08:32.426798 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m17:08:32.426798 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:08:32.426798 [info ] [Thread-3 (]: 11 of 44 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.03s]
[0m17:08:32.426798 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m17:08:32.426798 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:08:32.426798 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:08:32.426798 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m17:08:32.426798 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m17:08:32.426798 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:08:32.426798 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:08:32.426798 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:32.426798 [info ] [Thread-1 (]: 12 of 44 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.03s]
[0m17:08:32.426798 [info ] [Thread-3 (]: 15 of 44 START test not_null_stg_products_product_id ........................... [RUN]
[0m17:08:32.426798 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m17:08:32.426798 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:08:32.426798 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m17:08:32.426798 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.426798 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:08:32.426798 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:08:32.437915 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:08:32.438257 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:08:32.438257 [info ] [Thread-1 (]: 16 of 44 START test unique_stg_products_product_id ............................. [RUN]
[0m17:08:32.440719 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:08:32.440719 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.440719 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T214833Z"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.441760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m17:08:32.441760 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:08:32.441760 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:08:32.442761 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:08:32.442761 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:32.442761 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.444762 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:08:32.446760 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:08:32.447640 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m17:08:32.447640 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m17:08:32.447640 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m17:08:32.447640 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.447640 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:08:32.447640 [info ] [Thread-4 (]: 13 of 44 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.03s]
[0m17:08:32.447640 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:08:32.452083 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:08:32.452083 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m17:08:32.452083 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:08:32.452083 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m17:08:32.452083 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m17:08:32.452083 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:08:32.452083 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:08:32.452083 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m17:08:32.452083 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:08:32.452083 [info ] [Thread-4 (]: 17 of 44 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m17:08:32.452083 [info ] [Thread-2 (]: 14 of 44 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.03s]
[0m17:08:32.452083 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m17:08:32.452083 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.452083 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m17:08:32.452083 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:08:32.452083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:32.452083 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:08:32.452083 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:08:32.452083 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:08:32.452083 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T214833Z"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.452083 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:08:32.452083 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.452083 [info ] [Thread-2 (]: 18 of 44 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m17:08:32.452083 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:08:32.452083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m17:08:32.452083 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:32.452083 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:08:32.462629 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:08:32.462629 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.462629 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:08:32.462629 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:08:32.462629 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:08:32.462629 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m17:08:32.462629 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m17:08:32.462629 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m17:08:32.462629 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m17:08:32.462629 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m17:08:32.462629 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:08:32.462629 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:08:32.462629 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m17:08:32.462629 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m17:08:32.462629 [info ] [Thread-3 (]: 15 of 44 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.04s]
[0m17:08:32.462629 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:08:32.462629 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:32.462629 [info ] [Thread-1 (]: 16 of 44 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.02s]
[0m17:08:32.462629 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:08:32.462629 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:08:32.462629 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:08:32.462629 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.462629 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:08:32.462629 [info ] [Thread-3 (]: 19 of 44 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m17:08:32.462629 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:08:32.462629 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:08:32.462629 [info ] [Thread-1 (]: 20 of 44 START test not_null_stg_users_school_id ............................... [RUN]
[0m17:08:32.462629 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m17:08:32.462629 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m17:08:32.462629 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T214833Z"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.462629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m17:08:32.478396 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:08:32.478396 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:08:32.478396 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:08:32.478396 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:08:32.478396 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.478396 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:08:32.478396 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:08:32.478396 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m17:08:32.478396 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:08:32.478396 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps_20260203T214833Z"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.478396 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m17:08:32.478396 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:08:32.478396 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m17:08:32.478396 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:08:32.478396 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.478396 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:08:32.478396 [info ] [Thread-4 (]: 17 of 44 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.03s]
[0m17:08:32.489986 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:08:32.489986 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:08:32.491219 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m17:08:32.491219 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:08:32.492219 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:08:32.492219 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m17:08:32.493218 [info ] [Thread-4 (]: 21 of 44 START test not_null_stg_users_user_id ................................. [RUN]
[0m17:08:32.493218 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:08:32.493218 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m17:08:32.493218 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m17:08:32.494218 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m17:08:32.494218 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m17:08:32.494218 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:08:32.494218 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:08:32.495218 [info ] [Thread-2 (]: 18 of 44 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.04s]
[0m17:08:32.495218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:32.497219 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:08:32.498218 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:08:32.498218 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.498218 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:08:32.499218 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:08:32.499218 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.499218 [info ] [Thread-2 (]: 22 of 44 START test unique_stg_users_user_id ................................... [RUN]
[0m17:08:32.499218 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:32.500218 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:08:32.500218 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:08:32.500218 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m17:08:32.501220 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T214833Z"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.502218 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:08:32.502218 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:08:32.502218 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.505217 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:08:32.505217 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.506218 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m17:08:32.506218 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:08:32.507219 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m17:08:32.508218 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m17:08:32.508218 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m17:08:32.508218 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m17:08:32.509219 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:08:32.509219 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m17:08:32.509219 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:32.510218 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m17:08:32.512218 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:08:32.512218 [info ] [Thread-3 (]: 19 of 44 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.05s]
[0m17:08:32.513218 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.513218 [info ] [Thread-1 (]: 20 of 44 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.05s]
[0m17:08:32.513218 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:08:32.514219 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:08:32.514219 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:08:32.514219 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:08:32.514219 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:08:32.515218 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T214833Z"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.515218 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:08:32.515218 [info ] [Thread-3 (]: 23 of 44 START test not_null_stg_schools_school_id ............................. [RUN]
[0m17:08:32.516219 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m17:08:32.516219 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m17:08:32.516219 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:08:32.516219 [info ] [Thread-1 (]: 24 of 44 START test unique_stg_schools_school_id ............................... [RUN]
[0m17:08:32.517218 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.517218 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:08:32.517218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m17:08:32.518219 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.520219 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:08:32.521220 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m17:08:32.521220 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:08:32.521220 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:08:32.522218 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m17:08:32.524059 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:08:32.525115 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:32.525115 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m17:08:32.525115 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:08:32.526116 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:08:32.527184 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:08:32.526116 [info ] [Thread-4 (]: 21 of 44 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m17:08:32.529282 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:08:32.529282 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.529282 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:08:32.530284 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.fct_rewards
[0m17:08:32.530987 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:08:32.530987 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m17:08:32.532047 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m17:08:32.530987 [info ] [Thread-4 (]: 25 of 44 START sql table model main.fct_rewards ................................ [RUN]
[0m17:08:32.532047 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:08:32.532047 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:08:32.533047 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m17:08:32.533047 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now model.dbt_carton_caps.fct_rewards)
[0m17:08:32.534047 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m17:08:32.534047 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m17:08:32.534047 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.534047 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.fct_rewards
[0m17:08:32.535046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:32.535046 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:08:32.535046 [info ] [Thread-2 (]: 22 of 44 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m17:08:32.537048 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_rewards"
[0m17:08:32.537048 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T214833Z"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.537904 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:08:32.537904 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.537904 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.dim_product
[0m17:08:32.537904 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:08:32.537904 [info ] [Thread-2 (]: 26 of 44 START sql table model main.dim_product ................................ [RUN]
[0m17:08:32.537904 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.537904 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:32.537904 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.fct_rewards
[0m17:08:32.537904 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b, now model.dbt_carton_caps.dim_product)
[0m17:08:32.550423 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_rewards"
[0m17:08:32.550423 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m17:08:32.551928 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.dim_product
[0m17:08:32.551928 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m17:08:32.552932 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_product"
[0m17:08:32.552932 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m17:08:32.552932 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m17:08:32.552932 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:08:32.552932 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m17:08:32.552932 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: BEGIN
[0m17:08:32.552932 [info ] [Thread-3 (]: 23 of 44 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.04s]
[0m17:08:32.552932 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m17:08:32.552932 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:32.552932 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.dim_product
[0m17:08:32.552932 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:08:32.552932 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m17:08:32.552932 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_product"
[0m17:08:32.552932 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.fct_referral
[0m17:08:32.552932 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.552932 [info ] [Thread-1 (]: 24 of 44 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:08:32.552932 [info ] [Thread-3 (]: 27 of 44 START sql table model main.fct_referral ............................... [RUN]
[0m17:08:32.552932 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:08:32.552932 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:08:32.552932 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now model.dbt_carton_caps.fct_referral)
[0m17:08:32.552932 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

  
    
    

    create  table
      "carton_caps_20260203T214833Z"."main"."fct_rewards__dbt_tmp"
  
    as (
      with e as (
  select *
  from "carton_caps_20260203T214833Z"."main"."stg_events"
),

awards as (
  select
    referral_id,
    user_id,
    event_at as awarded_at,
    -- reward_type is inside metadata_json like {"reward_type":"referrer_bonus"}
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_awarded'
),

redeems as (
  select
    referral_id,
    user_id,
    event_at as redeemed_at,
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_redeemed'
)

select
  -- deterministic surrogate key
  md5(cast(a.referral_id as varchar) || '|' || cast(a.user_id as varchar) || '|' || coalesce(a.reward_type,'')) as reward_id,
  a.referral_id,
  a.user_id,
  a.reward_type,
  a.awarded_at,
  min(r.redeemed_at) as redeemed_at
from awards a
left join redeems r
  on a.referral_id = r.referral_id
  and a.user_id = r.user_id
  and coalesce(a.reward_type,'') = coalesce(r.reward_type,'')
group by 1,2,3,4,5
    );
  
  
[0m17:08:32.552932 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:08:32.552932 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.fct_purchase
[0m17:08:32.552932 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.fct_referral
[0m17:08:32.552932 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: BEGIN
[0m17:08:32.552932 [info ] [Thread-1 (]: 28 of 44 START sql table model main.fct_purchase ............................... [RUN]
[0m17:08:32.552932 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_referral"
[0m17:08:32.552932 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:08:32.552932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6, now model.dbt_carton_caps.fct_purchase)
[0m17:08:32.552932 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.fct_purchase
[0m17:08:32.568638 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_purchase"
[0m17:08:32.568638 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:08:32.568638 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:08:32.568638 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:08:32.568638 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

  
    
    

    create  table
      "carton_caps_20260203T214833Z"."main"."dim_product__dbt_tmp"
  
    as (
      select
  product_id,
  name,
  category,
  price,
  points_per_dollar,
  created_at
from "carton_caps_20260203T214833Z"."main"."stg_products"
    );
  
  
[0m17:08:32.568638 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.fct_referral
[0m17:08:32.573793 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:08:32.573793 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.fct_purchase
[0m17:08:32.573793 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_referral"
[0m17:08:32.573793 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_rewards'
  
[0m17:08:32.573793 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.573793 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_purchase"
[0m17:08:32.573793 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:08:32.573793 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.573793 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_product'
  
[0m17:08:32.573793 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:08:32.573793 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:08:32.573793 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_rewards'
  
[0m17:08:32.573793 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_referral: BEGIN
[0m17:08:32.573793 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:08:32.573793 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.573793 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:08:32.573793 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: BEGIN
[0m17:08:32.573793 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.584473 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:08:32.584473 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.584473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:32.584473 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:08:32.584473 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_product'
  
[0m17:08:32.584473 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:08:32.584473 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */
alter table "carton_caps_20260203T214833Z"."main"."fct_rewards" rename to "fct_rewards__dbt_backup"
[0m17:08:32.584473 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.584473 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

  
    
    

    create  table
      "carton_caps_20260203T214833Z"."main"."fct_referral__dbt_tmp"
  
    as (
      with r as (
  select *
  from "carton_caps_20260203T214833Z"."main"."stg_referrals"
),

e as (
  select *
  from "carton_caps_20260203T214833Z"."main"."stg_events"
),

-- Referral-related event timestamps for referred users
ref_events as (
  select
    referral_id,
    user_id,

    min(case when event_type = 'install' then event_at end) as install_at,
    min(case when event_type = 'referral_applied' then event_at end) as referral_applied_at,
    min(case when event_type = 'onboarding_complete' then event_at end) as onboarding_completed_at,
    min(case when event_type = 'school_linked' then event_at end) as school_linked_at

  from e
  where referral_id is not null
  group by 1,2
),

-- First scan/purchase time for referred users (proxy for qualifying action)
first_purchase as (
  select
    user_id,
    min(purchased_at) as first_purchase_at
  from "carton_caps_20260203T214833Z"."main"."stg_purchases"
  group by 1
)

select
  r.referral_id,
  r.referrer_user_id,
  r.referred_email,
  r.referred_user_id,
  r.referral_code,
  r.sent_at,
  r.converted_at,
  r.status,

  re.install_at,
  re.referral_applied_at,
  re.onboarding_completed_at,
  re.school_linked_at,

  fp.first_purchase_at,

  -- qualifying action is: first_purchase OR school_linked (whichever happens first)
  least(fp.first_purchase_at, re.school_linked_at) as qualifying_action_at,

  -- window compliance (48 hours) using install -> referral_applied
  case
    when re.install_at is null or re.referral_applied_at is null then null
    when datediff('hour', re.install_at, re.referral_applied_at) <= 48 then true
    else false
  end as within_48h_window,

  -- simple eligibility (rules-compliant posture)
  case
    when r.status <> 'converted' then false
    when re.onboarding_completed_at is null then false
    when least(fp.first_purchase_at, re.school_linked_at) is null then false
    when re.install_at is null or re.referral_applied_at is null then false
    when datediff('hour', re.install_at, re.referral_applied_at) > 48 then false
    else true
  end as eligible_referral

from r
left join ref_events re
  on r.referral_id = re.referral_id
  and r.referred_user_id = re.user_id
left join first_purchase fp
  on r.referred_user_id = fp.user_id
    );
  
  
[0m17:08:32.584473 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.584473 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:08:32.584473 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.584473 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:08:32.584473 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

  
    
    

    create  table
      "carton_caps_20260203T214833Z"."main"."fct_purchase__dbt_tmp"
  
    as (
      select
  p.purchase_id,
  p.user_id,
  u.school_id,
  p.product_id,
  pr.category as product_category,
  p.quantity,
  p.price_paid,
  p.points_earned,
  p.purchased_at,
  date_trunc('day', p.purchased_at) as purchase_date,
  p.day_of_week,
  p.hour_of_day
from "carton_caps_20260203T214833Z"."main"."stg_purchases" p
left join "carton_caps_20260203T214833Z"."main"."stg_users" u
  on p.user_id = u.user_id
left join "carton_caps_20260203T214833Z"."main"."stg_products" pr
  on p.product_id = pr.product_id
    );
  
  
[0m17:08:32.584473 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:08:32.584473 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */
alter table "carton_caps_20260203T214833Z"."main"."dim_product" rename to "dim_product__dbt_backup"
[0m17:08:32.584473 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */
alter table "carton_caps_20260203T214833Z"."main"."fct_rewards__dbt_tmp" rename to "fct_rewards"
[0m17:08:32.584473 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.597583 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m17:08:32.597583 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:08:32.597583 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:08:32.597583 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m17:08:32.601058 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:08:32.602058 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m17:08:32.602058 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:08:32.602058 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:08:32.603058 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */
alter table "carton_caps_20260203T214833Z"."main"."dim_product__dbt_tmp" rename to "dim_product"
[0m17:08:32.603058 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:08:32.604059 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_referral'
  
[0m17:08:32.604059 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_purchase'
  
[0m17:08:32.604059 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:08:32.606059 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m17:08:32.606059 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:08:32.606059 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.606059 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.606059 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m17:08:32.607059 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:08:32.608058 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:08:32.608058 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_referral'
  
[0m17:08:32.609058 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_purchase'
  
[0m17:08:32.609058 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:08:32.610060 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:08:32.611060 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.611060 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

      drop table if exists "carton_caps_20260203T214833Z"."main"."fct_rewards__dbt_backup" cascade
    
[0m17:08:32.611060 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.611060 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.613119 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:08:32.615118 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:08:32.615118 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */
alter table "carton_caps_20260203T214833Z"."main"."fct_referral" rename to "fct_referral__dbt_backup"
[0m17:08:32.617118 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:08:32.618117 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.618117 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

      drop table if exists "carton_caps_20260203T214833Z"."main"."dim_product__dbt_backup" cascade
    
[0m17:08:32.618117 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */
alter table "carton_caps_20260203T214833Z"."main"."fct_purchase" rename to "fct_purchase__dbt_backup"
[0m17:08:32.619117 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: Close
[0m17:08:32.619117 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.621117 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:08:32.621117 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436FF32C60>]}
[0m17:08:32.622117 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.622117 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */
alter table "carton_caps_20260203T214833Z"."main"."fct_referral__dbt_tmp" rename to "fct_referral"
[0m17:08:32.622117 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.622117 [info ] [Thread-4 (]: 25 of 44 OK created sql table model main.fct_rewards ........................... [[32mOK[0m in 0.09s]
[0m17:08:32.623118 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: Close
[0m17:08:32.625116 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:08:32.625116 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.fct_rewards
[0m17:08:32.625116 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.626117 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */
alter table "carton_caps_20260203T214833Z"."main"."fct_purchase__dbt_tmp" rename to "fct_purchase"
[0m17:08:32.626117 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243710E6750>]}
[0m17:08:32.626117 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.dim_school
[0m17:08:32.627117 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m17:08:32.627117 [info ] [Thread-2 (]: 26 of 44 OK created sql table model main.dim_product ........................... [[32mOK[0m in 0.09s]
[0m17:08:32.627117 [info ] [Thread-4 (]: 29 of 44 START sql table model main.dim_school ................................. [RUN]
[0m17:08:32.627117 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.627117 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:08:32.627117 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.dim_product
[0m17:08:32.627117 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_rewards, now model.dbt_carton_caps.dim_school)
[0m17:08:32.627117 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m17:08:32.627117 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m17:08:32.627117 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.dim_user
[0m17:08:32.627117 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.dim_school
[0m17:08:32.627117 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:08:32.627117 [info ] [Thread-2 (]: 30 of 44 START sql table model main.dim_user ................................... [RUN]
[0m17:08:32.627117 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_school"
[0m17:08:32.627117 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m17:08:32.627117 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.627117 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_product, now model.dbt_carton_caps.dim_user)
[0m17:08:32.635889 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:08:32.635889 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.dim_user
[0m17:08:32.636910 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

      drop table if exists "carton_caps_20260203T214833Z"."main"."fct_referral__dbt_backup" cascade
    
[0m17:08:32.637915 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_user"
[0m17:08:32.638915 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.dim_school
[0m17:08:32.638915 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.640915 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_school"
[0m17:08:32.641915 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:08:32.641915 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.641915 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

      drop table if exists "carton_caps_20260203T214833Z"."main"."fct_purchase__dbt_backup" cascade
    
[0m17:08:32.643211 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.dim_user
[0m17:08:32.643211 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_referral: Close
[0m17:08:32.645212 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_user"
[0m17:08:32.646212 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:08:32.646212 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436FED4B90>]}
[0m17:08:32.646212 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: BEGIN
[0m17:08:32.647211 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.647211 [info ] [Thread-3 (]: 27 of 44 OK created sql table model main.fct_referral .......................... [[32mOK[0m in 0.09s]
[0m17:08:32.647818 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:32.648137 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:08:32.649020 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: Close
[0m17:08:32.649020 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.fct_referral
[0m17:08:32.649020 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: BEGIN
[0m17:08:32.650083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243700A91C0>]}
[0m17:08:32.650083 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.650083 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:08:32.650083 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:08:32.651082 [info ] [Thread-1 (]: 28 of 44 OK created sql table model main.fct_purchase .......................... [[32mOK[0m in 0.10s]
[0m17:08:32.651082 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:08:32.651082 [info ] [Thread-3 (]: 31 of 44 START test not_null_fct_rewards_reward_id ............................. [RUN]
[0m17:08:32.652083 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.fct_purchase
[0m17:08:32.652083 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

  
    
    

    create  table
      "carton_caps_20260203T214833Z"."main"."dim_school__dbt_tmp"
  
    as (
      select
  school_id,
  name,
  address,
  city,
  state,
  zip_code,
  created_at
from "carton_caps_20260203T214833Z"."main"."stg_schools"
    );
  
  
[0m17:08:32.652083 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.653121 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_referral, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m17:08:32.653121 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:08:32.653121 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:08:32.653121 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:08:32.654122 [info ] [Thread-1 (]: 32 of 44 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m17:08:32.654122 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.654122 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

  
    
    

    create  table
      "carton_caps_20260203T214833Z"."main"."dim_user__dbt_tmp"
  
    as (
      select
  u.user_id,
  u.first_name,
  u.last_name,
  u.email,
  u.school_id,
  s.name as school_name,
  s.state as school_state,
  u.created_at,
  u.user_type,
  u.is_verified,
  u.device_id,
  u.marketing_channel
from "carton_caps_20260203T214833Z"."main"."stg_users" u
left join "carton_caps_20260203T214833Z"."main"."stg_schools" s
  on u.school_id = s.school_id
    );
  
  
[0m17:08:32.656000 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:08:32.656000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_purchase, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m17:08:32.656000 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:08:32.656000 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:08:32.656000 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_school'
  
[0m17:08:32.656000 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:08:32.656000 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.656000 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:08:32.656000 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:08:32.656000 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:08:32.656000 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:08:32.656000 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_user'
  
[0m17:08:32.656000 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:08:32.656000 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:08:32.656000 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_school'
  
[0m17:08:32.656000 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:08:32.656000 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.656000 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:08:32.656000 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.656000 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:08:32.656000 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m17:08:32.656000 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_user'
  
[0m17:08:32.656000 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:08:32.670806 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:08:32.670806 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:08:32.670806 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m17:08:32.670806 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */
alter table "carton_caps_20260203T214833Z"."main"."dim_school" rename to "dim_school__dbt_backup"
[0m17:08:32.670806 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.670806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:32.670806 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.670806 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:08:32.670806 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:08:32.670806 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:08:32.670806 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:08:32.670806 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.670806 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps_20260203T214833Z"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.670806 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */
alter table "carton_caps_20260203T214833Z"."main"."dim_user" rename to "dim_user__dbt_backup"
[0m17:08:32.670806 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */
alter table "carton_caps_20260203T214833Z"."main"."dim_school__dbt_tmp" rename to "dim_school"
[0m17:08:32.670806 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:08:32.670806 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:32.670806 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.670806 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.670806 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.670806 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m17:08:32.670806 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m17:08:32.670806 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:08:32.670806 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:08:32.670806 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:08:32.670806 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m17:08:32.670806 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */
alter table "carton_caps_20260203T214833Z"."main"."dim_user__dbt_tmp" rename to "dim_user"
[0m17:08:32.670806 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m17:08:32.686440 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m17:08:32.670806 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m17:08:32.686440 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.686440 [info ] [Thread-3 (]: 31 of 44 PASS not_null_fct_rewards_reward_id ................................... [[32mPASS[0m in 0.03s]
[0m17:08:32.686440 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m17:08:32.686440 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m17:08:32.686440 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:08:32.686440 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.686440 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m17:08:32.686440 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:08:32.686440 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:08:32.686440 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:08:32.686440 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m17:08:32.686440 [info ] [Thread-1 (]: 32 of 44 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:08:32.686440 [info ] [Thread-3 (]: 33 of 44 START test not_null_dim_product_product_id ............................ [RUN]
[0m17:08:32.686440 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

      drop table if exists "carton_caps_20260203T214833Z"."main"."dim_school__dbt_backup" cascade
    
[0m17:08:32.686440 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:08:32.686440 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816)
[0m17:08:32.686440 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:08:32.686440 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:08:32.686440 [info ] [Thread-1 (]: 34 of 44 START test unique_dim_product_product_id .............................. [RUN]
[0m17:08:32.686440 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:08:32.686440 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.686440 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.686440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m17:08:32.686440 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:08:32.686440 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: Close
[0m17:08:32.686440 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:08:32.686440 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

      drop table if exists "carton_caps_20260203T214833Z"."main"."dim_user__dbt_backup" cascade
    
[0m17:08:32.686440 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:08:32.702165 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:08:32.702165 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436FED4FB0>]}
[0m17:08:32.702165 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:08:32.702165 [info ] [Thread-4 (]: 29 of 44 OK created sql table model main.dim_school ............................ [[32mOK[0m in 0.08s]
[0m17:08:32.702165 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.dim_school
[0m17:08:32.702165 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:08:32.702165 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.702165 [info ] [Thread-4 (]: 35 of 44 START test not_null_fct_referral_referral_id .......................... [RUN]
[0m17:08:32.702165 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: Close
[0m17:08:32.702165 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:08:32.702165 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:08:32.702165 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_school, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m17:08:32.702165 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6784d00-6139-41b8-a91a-21a4bd4ad1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024375123BF0>]}
[0m17:08:32.702165 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:08:32.702165 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m17:08:32.702165 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:08:32.702165 [info ] [Thread-2 (]: 30 of 44 OK created sql table model main.dim_user .............................. [[32mOK[0m in 0.08s]
[0m17:08:32.702165 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:08:32.702165 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:08:32.702165 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.dim_user
[0m17:08:32.702165 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:08:32.702165 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.702165 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:08:32.702165 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m17:08:32.702165 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:08:32.702165 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:08:32.702165 [info ] [Thread-2 (]: 36 of 44 START test unique_fct_referral_referral_id ............................ [RUN]
[0m17:08:32.702165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:32.702165 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T214833Z"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.702165 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:08:32.717899 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_user, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m17:08:32.718266 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.718266 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:08:32.718266 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:08:32.719443 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.721444 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:08:32.721444 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:32.721444 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:08:32.722443 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m17:08:32.723442 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m17:08:32.723442 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:08:32.723442 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:08:32.724444 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:32.724444 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.725442 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:08:32.726442 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m17:08:32.727553 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m17:08:32.727553 [info ] [Thread-3 (]: 33 of 44 PASS not_null_dim_product_product_id .................................. [[32mPASS[0m in 0.04s]
[0m17:08:32.727553 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:08:32.728553 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m17:08:32.728553 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.728553 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:08:32.728553 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:08:32.729553 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m17:08:32.729553 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:08:32.729553 [info ] [Thread-3 (]: 37 of 44 START test not_null_fct_purchase_purchase_id .......................... [RUN]
[0m17:08:32.730552 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m17:08:32.730552 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T214833Z"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.730552 [info ] [Thread-1 (]: 34 of 44 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.04s]
[0m17:08:32.730552 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1)
[0m17:08:32.731553 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:08:32.731553 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:08:32.731553 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:08:32.732385 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.732385 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:08:32.733428 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:08:32.733428 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.733428 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m17:08:32.733428 [info ] [Thread-1 (]: 38 of 44 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m17:08:32.733428 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:08:32.733428 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m17:08:32.733428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m17:08:32.733428 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:32.733428 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m17:08:32.733428 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:08:32.733428 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:08:32.733428 [info ] [Thread-4 (]: 35 of 44 PASS not_null_fct_referral_referral_id ................................ [[32mPASS[0m in 0.03s]
[0m17:08:32.740925 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:08:32.740925 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.740925 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:08:32.740925 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:08:32.740925 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m17:08:32.740925 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:08:32.740925 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:08:32.740925 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m17:08:32.740925 [info ] [Thread-4 (]: 39 of 44 START test not_null_dim_school_school_id .............................. [RUN]
[0m17:08:32.740925 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:08:32.740925 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:08:32.740925 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m17:08:32.740925 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b)
[0m17:08:32.740925 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m17:08:32.740925 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:08:32.740925 [info ] [Thread-2 (]: 36 of 44 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.02s]
[0m17:08:32.740925 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:08:32.749102 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:08:32.749102 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:08:32.752306 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:08:32.752306 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m17:08:32.752306 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:08:32.752306 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:08:32.752306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:32.752306 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:08:32.752306 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:08:32.752306 [info ] [Thread-2 (]: 40 of 44 START test unique_dim_school_school_id ................................ [RUN]
[0m17:08:32.752306 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T214833Z"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.752306 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:08:32.752306 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.752306 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m17:08:32.752306 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:08:32.752306 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:08:32.752306 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:08:32.752306 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.752306 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:32.759865 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:08:32.759865 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m17:08:32.759865 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m17:08:32.759865 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:32.759865 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.759865 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:08:32.759865 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:08:32.759865 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m17:08:32.759865 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:08:32.759865 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m17:08:32.764853 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:08:32.764853 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m17:08:32.764853 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:08:32.764853 [info ] [Thread-3 (]: 37 of 44 PASS not_null_fct_purchase_purchase_id ................................ [[32mPASS[0m in 0.03s]
[0m17:08:32.764853 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m17:08:32.764853 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T214833Z"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.764853 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:08:32.764853 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:08:32.764853 [debug] [Thread-3 (]: Began running node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:08:32.764853 [info ] [Thread-1 (]: 38 of 44 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.03s]
[0m17:08:32.764853 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m17:08:32.764853 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.764853 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1, now exposure.dbt_carton_caps.streamlit_product_dashboard)
[0m17:08:32.764853 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:08:32.764853 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:08:32.771145 [debug] [Thread-3 (]: Began compiling node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:08:32.771473 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m17:08:32.771473 [debug] [Thread-1 (]: Began running node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:08:32.771473 [debug] [Thread-3 (]: Began executing node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:08:32.772570 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:08:32.772570 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:08:32.772570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a, now exposure.dbt_carton_caps.streamlit_referral_finance_dashboard)
[0m17:08:32.773569 [info ] [Thread-3 (]: 41 of 44 NO-OP exposure streamlit_product_dashboard ............................ [[33mNO-OP[0m in 0.00s]
[0m17:08:32.773569 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:08:32.774070 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m17:08:32.774070 [debug] [Thread-1 (]: Began compiling node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:08:32.774070 [debug] [Thread-3 (]: Finished running node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:08:32.774070 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:32.775116 [debug] [Thread-1 (]: Began executing node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:08:32.775116 [info ] [Thread-4 (]: 39 of 44 PASS not_null_dim_school_school_id .................................... [[32mPASS[0m in 0.03s]
[0m17:08:32.775116 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:08:32.776117 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:08:32.776117 [info ] [Thread-1 (]: 42 of 44 NO-OP exposure streamlit_referral_finance_dashboard ................... [[33mNO-OP[0m in 0.00s]
[0m17:08:32.776117 [info ] [Thread-3 (]: 43 of 44 START test not_null_dim_user_user_id .................................. [RUN]
[0m17:08:32.777117 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.777117 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:08:32.777117 [debug] [Thread-1 (]: Finished running node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:08:32.777117 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly exposure.dbt_carton_caps.streamlit_product_dashboard, now test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3)
[0m17:08:32.778118 [info ] [Thread-4 (]: 44 of 44 START test unique_dim_user_user_id .................................... [RUN]
[0m17:08:32.778118 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m17:08:32.779116 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:08:32.779116 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m17:08:32.779116 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m17:08:32.780958 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:08:32.780958 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:08:32.780958 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m17:08:32.785056 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:08:32.785056 [info ] [Thread-2 (]: 40 of 44 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m17:08:32.785056 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:08:32.785056 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:08:32.785056 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:08:32.785056 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:08:32.785056 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:08:32.785056 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:08:32.785056 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m17:08:32.785056 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:08:32.785056 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:08:32.785056 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m17:08:32.785056 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.785056 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:32.785056 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:08:32.785056 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T214833Z"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:32.785056 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.785056 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:08:32.785056 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:32.785056 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.785056 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m17:08:32.785056 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:32.785056 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:08:32.785056 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m17:08:32.785056 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m17:08:32.796023 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m17:08:32.796023 [info ] [Thread-3 (]: 43 of 44 PASS not_null_dim_user_user_id ........................................ [[32mPASS[0m in 0.02s]
[0m17:08:32.796023 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m17:08:32.796023 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:08:32.796023 [info ] [Thread-4 (]: 44 of 44 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.02s]
[0m17:08:32.796023 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:08:32.796023 [debug] [MainThread]: Using duckdb connection "master"
[0m17:08:32.796023 [debug] [MainThread]: On master: BEGIN
[0m17:08:32.796023 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:08:32.796023 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:08:32.796023 [debug] [MainThread]: On master: COMMIT
[0m17:08:32.796023 [debug] [MainThread]: Using duckdb connection "master"
[0m17:08:32.796023 [debug] [MainThread]: On master: COMMIT
[0m17:08:32.796023 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:08:32.796023 [debug] [MainThread]: On master: Close
[0m17:08:32.796023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:32.796023 [debug] [MainThread]: Connection 'create_carton_caps_20260203T214833Z_main' was properly closed.
[0m17:08:32.796023 [debug] [MainThread]: Connection 'list_carton_caps_20260203T214833Z_main' was properly closed.
[0m17:08:32.796023 [debug] [MainThread]: Connection 'exposure.dbt_carton_caps.streamlit_referral_finance_dashboard' was properly closed.
[0m17:08:32.796023 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76' was properly closed.
[0m17:08:32.796023 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3' was properly closed.
[0m17:08:32.796023 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278' was properly closed.
[0m17:08:32.796023 [info ] [MainThread]: 
[0m17:08:32.801844 [info ] [MainThread]: Finished running 2 exposures, 6 table models, 30 data tests, 6 view models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m17:08:32.803849 [debug] [MainThread]: Command end result
[0m17:08:32.817880 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_carton_caps\target\manifest.json
[0m17:08:32.819885 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_carton_caps\target\semantic_manifest.json
[0m17:08:32.824239 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt_carton_caps\target\run_results.json
[0m17:08:32.824239 [info ] [MainThread]: 
[0m17:08:32.825238 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:08:32.825238 [info ] [MainThread]: 
[0m17:08:32.825238 [info ] [MainThread]: Done. PASS=42 WARN=0 ERROR=0 SKIP=0 NO-OP=2 TOTAL=44
[0m17:08:32.825238 [debug] [MainThread]: Command `dbt build` succeeded at 17:08:32.825238 after 1.43 seconds
[0m17:08:32.826238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436AE15EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436D58CC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436DFFA1B0>]}
[0m17:08:32.826238 [debug] [MainThread]: Flushing usage events
[0m17:08:33.241341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:34.675216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002571D440A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002571D231CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002571AB5A3C0>]}


============================== 17:08:34.675216 | 6c460bdd-f874-4c76-9223-338ab28f3610 ==============================
[0m17:08:34.675216 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:08:34.675216 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'dbt_carton_caps', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt test --profiles-dir dbt_carton_caps --project-dir dbt_carton_caps', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'dbt_carton_caps\\logs'}
[0m17:08:34.820040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c460bdd-f874-4c76-9223-338ab28f3610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002571D8DA2D0>]}
[0m17:08:34.860009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c460bdd-f874-4c76-9223-338ab28f3610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002571A71EEA0>]}
[0m17:08:34.860009 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:08:35.003000 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:08:35.102578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:08:35.102578 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:08:35.102578 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:08:35.135657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c460bdd-f874-4c76-9223-338ab28f3610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002571D8DA330>]}
[0m17:08:35.184806 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_carton_caps\target\manifest.json
[0m17:08:35.184806 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_carton_caps\target\semantic_manifest.json
[0m17:08:35.216629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c460bdd-f874-4c76-9223-338ab28f3610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002571F431E20>]}
[0m17:08:35.216629 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:08:35.216629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c460bdd-f874-4c76-9223-338ab28f3610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002571F3FF770>]}
[0m17:08:35.220091 [info ] [MainThread]: 
[0m17:08:35.220091 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:08:35.220091 [info ] [MainThread]: 
[0m17:08:35.220091 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:08:35.224103 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T214833Z_main'
[0m17:08:35.264170 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T214833Z_main"
[0m17:08:35.264170 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z_main: BEGIN
[0m17:08:35.264170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:35.280109 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:08:35.280109 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T214833Z_main"
[0m17:08:35.280109 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T214833Z_main"} */
select
      'carton_caps_20260203T214833Z' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps_20260203t214833z'
  
[0m17:08:35.296060 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:08:35.296060 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z_main: ROLLBACK
[0m17:08:35.296060 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_20260203T214833Z_main'
[0m17:08:35.296060 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z_main: Close
[0m17:08:35.296060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c460bdd-f874-4c76-9223-338ab28f3610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002571F34D5B0>]}
[0m17:08:35.296060 [debug] [MainThread]: Using duckdb connection "master"
[0m17:08:35.296060 [debug] [MainThread]: On master: BEGIN
[0m17:08:35.296060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:35.296060 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:08:35.296060 [debug] [MainThread]: On master: COMMIT
[0m17:08:35.296060 [debug] [MainThread]: Using duckdb connection "master"
[0m17:08:35.296060 [debug] [MainThread]: On master: COMMIT
[0m17:08:35.301265 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:08:35.301265 [debug] [MainThread]: On master: Close
[0m17:08:35.301265 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:08:35.301265 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:08:35.301265 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:08:35.301265 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:08:35.301265 [info ] [Thread-1 (]: 1 of 30 START test not_null_dim_product_product_id ............................. [RUN]
[0m17:08:35.301265 [info ] [Thread-2 (]: 2 of 30 START test not_null_dim_school_school_id ............................... [RUN]
[0m17:08:35.301265 [info ] [Thread-3 (]: 3 of 30 START test not_null_dim_user_user_id ................................... [RUN]
[0m17:08:35.301265 [info ] [Thread-4 (]: 4 of 30 START test not_null_fct_purchase_purchase_id ........................... [RUN]
[0m17:08:35.301265 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:08:35.301265 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:08:35.301265 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:08:35.301265 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:08:35.301265 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:08:35.301265 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:08:35.301265 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:08:35.301265 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:08:35.315796 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:08:35.315796 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:08:35.320783 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:08:35.320783 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:08:35.320783 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:08:35.327720 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:08:35.327720 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:08:35.327720 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:08:35.327720 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:08:35.327720 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:08:35.327720 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:08:35.327720 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:08:35.327720 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:08:35.327720 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m17:08:35.327720 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:08:35.327720 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:08:35.327720 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:08:35.327720 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m17:08:35.327720 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:08:35.327720 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m17:08:35.327720 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:08:35.327720 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.327720 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m17:08:35.327720 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:08:35.327720 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:08:35.327720 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:08:35.327720 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.327720 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T214833Z"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.327720 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.343412 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:08:35.343412 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.343412 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:08:35.343412 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T214833Z"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.343412 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:08:35.344490 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.344490 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T214833Z"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.344490 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T214833Z"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.347533 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m17:08:35.347533 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:08:35.347533 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:08:35.348535 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:08:35.349533 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m17:08:35.349533 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.350536 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m17:08:35.350536 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m17:08:35.350536 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:08:35.351534 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m17:08:35.352534 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:08:35.352534 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m17:08:35.352534 [info ] [Thread-1 (]: 1 of 30 PASS not_null_dim_product_product_id ................................... [[32mPASS[0m in 0.05s]
[0m17:08:35.353534 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:08:35.353534 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m17:08:35.354535 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:08:35.353534 [info ] [Thread-3 (]: 3 of 30 PASS not_null_dim_user_user_id ......................................... [[32mPASS[0m in 0.05s]
[0m17:08:35.354535 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m17:08:35.354535 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:08:35.354535 [info ] [Thread-2 (]: 2 of 30 PASS not_null_dim_school_school_id ..................................... [[32mPASS[0m in 0.05s]
[0m17:08:35.355534 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:08:35.355534 [info ] [Thread-4 (]: 4 of 30 PASS not_null_fct_purchase_purchase_id ................................. [[32mPASS[0m in 0.05s]
[0m17:08:35.355534 [info ] [Thread-1 (]: 5 of 30 START test not_null_fct_referral_referral_id ........................... [RUN]
[0m17:08:35.356534 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:08:35.356534 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:08:35.356534 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:08:35.356534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m17:08:35.357534 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:08:35.357534 [info ] [Thread-3 (]: 6 of 30 START test not_null_fct_rewards_reward_id .............................. [RUN]
[0m17:08:35.357534 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:08:35.357534 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:08:35.358535 [info ] [Thread-2 (]: 7 of 30 START test not_null_stg_events_event_id ................................ [RUN]
[0m17:08:35.358535 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m17:08:35.358535 [info ] [Thread-4 (]: 8 of 30 START test not_null_stg_events_user_id ................................. [RUN]
[0m17:08:35.361038 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:08:35.362044 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m17:08:35.362044 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:08:35.362044 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m17:08:35.362044 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:08:35.364415 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:08:35.365418 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:08:35.367421 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:08:35.367421 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:08:35.369420 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:08:35.371255 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:08:35.371255 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:08:35.371255 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:08:35.371255 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:08:35.402125 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:08:35.402125 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:08:35.402125 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:08:35.402125 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:08:35.402125 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m17:08:35.402125 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:08:35.402125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:35.402125 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:08:35.402125 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m17:08:35.402125 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m17:08:35.402125 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:08:35.402125 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:35.402125 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.402125 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:08:35.402125 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m17:08:35.402125 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:08:35.402125 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.402125 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:08:35.402125 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.402125 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T214833Z"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.402125 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:08:35.402125 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:08:35.402125 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.402125 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T214833Z"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.402125 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps_20260203T214833Z"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.402125 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.402125 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:08:35.402125 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m17:08:35.402125 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.402125 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps_20260203T214833Z"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.402125 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.402125 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m17:08:35.402125 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m17:08:35.402125 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m17:08:35.402125 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m17:08:35.402125 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.402125 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m17:08:35.418107 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m17:08:35.418107 [info ] [Thread-1 (]: 5 of 30 PASS not_null_fct_referral_referral_id ................................. [[32mPASS[0m in 0.06s]
[0m17:08:35.418107 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m17:08:35.418107 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m17:08:35.418107 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m17:08:35.418107 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:08:35.418107 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m17:08:35.418107 [info ] [Thread-3 (]: 6 of 30 PASS not_null_fct_rewards_reward_id .................................... [[32mPASS[0m in 0.06s]
[0m17:08:35.418107 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:08:35.418107 [info ] [Thread-4 (]: 8 of 30 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.06s]
[0m17:08:35.418107 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m17:08:35.418107 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:08:35.418107 [info ] [Thread-1 (]: 9 of 30 START test not_null_stg_products_product_id ............................ [RUN]
[0m17:08:35.418107 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:08:35.418107 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:08:35.418107 [info ] [Thread-2 (]: 7 of 30 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.06s]
[0m17:08:35.418107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m17:08:35.418107 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:08:35.418107 [info ] [Thread-3 (]: 10 of 30 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m17:08:35.418107 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:08:35.418107 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:08:35.418107 [info ] [Thread-4 (]: 11 of 30 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m17:08:35.418107 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m17:08:35.418107 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:08:35.418107 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:08:35.418107 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m17:08:35.418107 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:08:35.418107 [info ] [Thread-2 (]: 12 of 30 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m17:08:35.418107 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:08:35.418107 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:08:35.418107 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m17:08:35.418107 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:08:35.418107 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:08:35.418107 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:08:35.433937 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:08:35.436927 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:08:35.436927 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:08:35.436927 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:08:35.436927 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:08:35.436927 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:08:35.436927 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:08:35.436927 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:08:35.436927 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m17:08:35.436927 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:08:35.436927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:35.436927 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:08:35.436927 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:08:35.436927 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:08:35.436927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.436927 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m17:08:35.436927 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m17:08:35.436927 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m17:08:35.436927 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:08:35.436927 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:35.436927 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:08:35.436927 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:08:35.436927 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T214833Z"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.436927 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.436927 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.436927 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:08:35.436927 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.436927 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:08:35.436927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.436927 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T214833Z"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.436927 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:08:35.436927 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T214833Z"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.436927 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T214833Z"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.436927 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m17:08:35.449775 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m17:08:35.449775 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m17:08:35.451028 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.451028 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:08:35.451028 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.452028 [info ] [Thread-1 (]: 9 of 30 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.03s]
[0m17:08:35.452028 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m17:08:35.453029 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m17:08:35.454028 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m17:08:35.454028 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:08:35.455028 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m17:08:35.455028 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m17:08:35.456066 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m17:08:35.456066 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:08:35.456066 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m17:08:35.456066 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m17:08:35.457067 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m17:08:35.457067 [info ] [Thread-1 (]: 13 of 30 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m17:08:35.457067 [info ] [Thread-2 (]: 12 of 30 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.04s]
[0m17:08:35.458067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m17:08:35.458067 [info ] [Thread-4 (]: 11 of 30 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.04s]
[0m17:08:35.458067 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:08:35.458067 [info ] [Thread-3 (]: 10 of 30 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.04s]
[0m17:08:35.459067 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:08:35.459067 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:08:35.459067 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:08:35.459067 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:08:35.462573 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:08:35.462573 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:08:35.463573 [info ] [Thread-2 (]: 14 of 30 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m17:08:35.463573 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:08:35.463573 [info ] [Thread-4 (]: 15 of 30 START test not_null_stg_schools_school_id ............................. [RUN]
[0m17:08:35.463573 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m17:08:35.464574 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m17:08:35.464574 [info ] [Thread-3 (]: 16 of 30 START test not_null_stg_users_school_id ............................... [RUN]
[0m17:08:35.464574 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:08:35.464574 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:08:35.465574 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:08:35.465574 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m17:08:35.466574 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:08:35.468576 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:08:35.470573 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:08:35.471572 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:08:35.471572 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:08:35.471572 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:08:35.471572 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m17:08:35.471572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:35.471572 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:08:35.471572 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:08:35.471572 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:08:35.471572 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:08:35.471572 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:08:35.471572 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:08:35.471572 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:08:35.471572 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T214833Z"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.471572 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:08:35.471572 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:08:35.471572 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m17:08:35.471572 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:08:35.471572 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:08:35.471572 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:08:35.471572 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.471572 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m17:08:35.471572 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m17:08:35.471572 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:08:35.471572 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m17:08:35.471572 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:35.471572 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.471572 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m17:08:35.471572 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:08:35.471572 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.471572 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m17:08:35.471572 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.471572 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps_20260203T214833Z"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.471572 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:08:35.471572 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:08:35.471572 [info ] [Thread-1 (]: 13 of 30 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.01s]
[0m17:08:35.471572 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T214833Z"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.471572 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T214833Z"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.487379 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:08:35.487379 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.487379 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:08:35.487379 [info ] [Thread-1 (]: 17 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m17:08:35.487379 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m17:08:35.487379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m17:08:35.487379 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.487379 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.487379 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m17:08:35.487379 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:08:35.487379 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m17:08:35.487379 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m17:08:35.487379 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m17:08:35.487379 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:08:35.487379 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m17:08:35.487379 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m17:08:35.487379 [info ] [Thread-2 (]: 14 of 30 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.02s]
[0m17:08:35.487379 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m17:08:35.487379 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m17:08:35.487379 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:08:35.487379 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:08:35.487379 [info ] [Thread-4 (]: 15 of 30 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.02s]
[0m17:08:35.487379 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m17:08:35.487379 [info ] [Thread-3 (]: 16 of 30 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.02s]
[0m17:08:35.487379 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:08:35.487379 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:08:35.487379 [info ] [Thread-2 (]: 18 of 30 START test test_events_in_window ...................................... [RUN]
[0m17:08:35.487379 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:08:35.487379 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:08:35.487379 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.test_events_in_window)
[0m17:08:35.487379 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:08:35.487379 [info ] [Thread-4 (]: 19 of 30 START test unique_dim_product_product_id .............................. [RUN]
[0m17:08:35.487379 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:08:35.487379 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m17:08:35.487379 [info ] [Thread-3 (]: 20 of 30 START test unique_dim_school_school_id ................................ [RUN]
[0m17:08:35.487379 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m17:08:35.487379 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m17:08:35.503025 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m17:08:35.503025 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m17:08:35.503025 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:08:35.503025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:35.503025 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:08:35.503025 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:08:35.503025 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:08:35.503025 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m17:08:35.503025 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m17:08:35.503025 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:08:35.503025 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:08:35.503025 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:08:35.503025 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:08:35.503025 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:08:35.503025 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:08:35.503025 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T214833Z"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:08:35.503025 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:08:35.503025 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m17:08:35.503025 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:08:35.503025 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:08:35.503025 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m17:08:35.503025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.518685 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:35.518685 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:08:35.518685 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.518685 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m17:08:35.518685 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m17:08:35.518685 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.518685 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:08:35.518685 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:08:35.518685 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m17:08:35.518685 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:08:35.518685 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps_20260203T214833Z"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m17:08:35.518685 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m17:08:35.518685 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:35.523164 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.523497 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:08:35.523497 [info ] [Thread-1 (]: 17 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.04s]
[0m17:08:35.523497 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:35.524599 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:08:35.524599 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.525598 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:08:35.526599 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m17:08:35.526599 [info ] [Thread-1 (]: 21 of 30 START test unique_dim_user_user_id .................................... [RUN]
[0m17:08:35.526599 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:08:35.527599 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.527599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m17:08:35.527599 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m17:08:35.528598 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m17:08:35.529599 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m17:08:35.529599 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:08:35.530598 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m17:08:35.530598 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m17:08:35.531599 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m17:08:35.533597 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:08:35.534676 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m17:08:35.533597 [info ] [Thread-4 (]: 19 of 30 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.05s]
[0m17:08:35.534676 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m17:08:35.535675 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:08:35.534676 [info ] [Thread-2 (]: 18 of 30 PASS test_events_in_window ............................................ [[32mPASS[0m in 0.05s]
[0m17:08:35.535675 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:08:35.535675 [info ] [Thread-3 (]: 20 of 30 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m17:08:35.536675 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:08:35.536675 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m17:08:35.536675 [info ] [Thread-4 (]: 22 of 30 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m17:08:35.537675 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:08:35.538674 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:08:35.538674 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:08:35.539674 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m17:08:35.539674 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:08:35.539674 [info ] [Thread-2 (]: 23 of 30 START test unique_fct_referral_referral_id ............................ [RUN]
[0m17:08:35.539674 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:08:35.540675 [info ] [Thread-3 (]: 24 of 30 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m17:08:35.540675 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m17:08:35.540675 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:08:35.542674 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:08:35.543676 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m17:08:35.543676 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:08:35.543676 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m17:08:35.544675 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:08:35.546681 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:08:35.546681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:35.548679 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:08:35.549679 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:08:35.551681 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:08:35.552679 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:08:35.552679 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:08:35.552679 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:08:35.552679 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:08:35.553681 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:35.554679 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:08:35.555680 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:08:35.555680 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:08:35.556680 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m17:08:35.556680 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:35.557680 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.557680 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.557680 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:08:35.558680 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:08:35.558680 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:08:35.559681 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m17:08:35.559681 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m17:08:35.559681 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m17:08:35.559681 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:35.560679 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m17:08:35.560679 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:08:35.560679 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:08:35.561867 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m17:08:35.561867 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.561867 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.562867 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:08:35.562867 [info ] [Thread-1 (]: 21 of 30 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.04s]
[0m17:08:35.562867 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:08:35.563867 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:35.563867 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:08:35.564869 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:08:35.564869 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:35.564869 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:08:35.566868 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m17:08:35.566868 [info ] [Thread-1 (]: 25 of 30 START test unique_stg_events_event_id ................................. [RUN]
[0m17:08:35.567868 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.567868 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m17:08:35.567868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m17:08:35.568868 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:08:35.568868 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m17:08:35.569868 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m17:08:35.569868 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:08:35.570867 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m17:08:35.570867 [info ] [Thread-4 (]: 22 of 30 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.03s]
[0m17:08:35.571867 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m17:08:35.573867 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:08:35.574867 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m17:08:35.574867 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:08:35.574867 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m17:08:35.575867 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m17:08:35.575867 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:08:35.576869 [info ] [Thread-3 (]: 24 of 30 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:08:35.576869 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:08:35.576869 [info ] [Thread-2 (]: 23 of 30 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.04s]
[0m17:08:35.577867 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:08:35.576869 [info ] [Thread-4 (]: 26 of 30 START test unique_stg_products_product_id ............................. [RUN]
[0m17:08:35.578869 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:08:35.579868 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:08:35.579868 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:08:35.579868 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m17:08:35.580868 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:08:35.580868 [info ] [Thread-3 (]: 27 of 30 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m17:08:35.580868 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:08:35.581874 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:08:35.581874 [info ] [Thread-2 (]: 28 of 30 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m17:08:35.581874 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m17:08:35.584653 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:08:35.585688 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m17:08:35.585688 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m17:08:35.586587 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:08:35.586946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:35.587276 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:08:35.589638 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:08:35.591654 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:08:35.592734 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:08:35.592734 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:08:35.593923 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:08:35.595212 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:08:35.595212 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:08:35.595212 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:35.596217 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:08:35.597972 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:08:35.599847 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:08:35.600565 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:08:35.601754 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m17:08:35.602112 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:35.602689 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:08:35.602689 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m17:08:35.602689 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.602689 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:08:35.604657 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:08:35.604657 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:08:35.604657 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:08:35.606298 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m17:08:35.606643 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:35.606643 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.607183 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m17:08:35.607673 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m17:08:35.608406 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:08:35.608406 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:08:35.608738 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m17:08:35.609256 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:35.609256 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.609668 [info ] [Thread-1 (]: 25 of 30 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m17:08:35.610205 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.610675 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:08:35.611213 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:08:35.611667 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m17:08:35.612205 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.612680 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:08:35.612680 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:35.613667 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m17:08:35.614205 [info ] [Thread-1 (]: 29 of 30 START test unique_stg_schools_school_id ............................... [RUN]
[0m17:08:35.614656 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m17:08:35.615417 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m17:08:35.615722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m17:08:35.616241 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m17:08:35.616759 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:08:35.617272 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m17:08:35.617804 [info ] [Thread-4 (]: 26 of 30 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.04s]
[0m17:08:35.617804 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:08:35.620720 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:08:35.621229 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:08:35.621229 [info ] [Thread-2 (]: 28 of 30 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.04s]
[0m17:08:35.622322 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:08:35.623369 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m17:08:35.623691 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:08:35.624232 [info ] [Thread-4 (]: 30 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m17:08:35.624701 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m17:08:35.624701 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:08:35.625243 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m17:08:35.625624 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m17:08:35.626632 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:08:35.627678 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:08:35.630656 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:08:35.628262 [info ] [Thread-3 (]: 27 of 30 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.05s]
[0m17:08:35.630656 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:08:35.631688 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:08:35.631688 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m17:08:35.632680 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:08:35.632680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:35.633718 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:08:35.635220 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:08:35.635551 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:08:35.635990 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:08:35.635990 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m17:08:35.636677 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:35.636677 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:08:35.636677 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.637711 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:08:35.637711 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T214833Z"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:08:35.637711 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.638749 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m17:08:35.639668 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:08:35.639668 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m17:08:35.640668 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m17:08:35.640668 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m17:08:35.642149 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m17:08:35.642458 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m17:08:35.642785 [info ] [Thread-1 (]: 29 of 30 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:08:35.643767 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:08:35.642785 [info ] [Thread-4 (]: 30 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.02s]
[0m17:08:35.643767 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:08:35.644704 [debug] [MainThread]: Using duckdb connection "master"
[0m17:08:35.644704 [debug] [MainThread]: On master: BEGIN
[0m17:08:35.644704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:08:35.645740 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:08:35.645740 [debug] [MainThread]: On master: COMMIT
[0m17:08:35.645740 [debug] [MainThread]: Using duckdb connection "master"
[0m17:08:35.645740 [debug] [MainThread]: On master: COMMIT
[0m17:08:35.646704 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:08:35.646704 [debug] [MainThread]: On master: Close
[0m17:08:35.646704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:35.647703 [debug] [MainThread]: Connection 'list_carton_caps_20260203T214833Z_main' was properly closed.
[0m17:08:35.647703 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6' was properly closed.
[0m17:08:35.647703 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d' was properly closed.
[0m17:08:35.647703 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103' was properly closed.
[0m17:08:35.647703 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m17:08:35.647703 [info ] [MainThread]: 
[0m17:08:35.648667 [info ] [MainThread]: Finished running 30 data tests in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m17:08:35.650658 [debug] [MainThread]: Command end result
[0m17:08:35.665667 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_carton_caps\target\manifest.json
[0m17:08:35.667738 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_carton_caps\target\semantic_manifest.json
[0m17:08:35.672692 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt_carton_caps\target\run_results.json
[0m17:08:35.672692 [info ] [MainThread]: 
[0m17:08:35.672692 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:08:35.673669 [info ] [MainThread]: 
[0m17:08:35.673669 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=30
[0m17:08:35.673669 [debug] [MainThread]: Command `dbt test` succeeded at 17:08:35.673669 after 1.07 seconds
[0m17:08:35.674657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002571D78AF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002571CC91520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025719CBD7F0>]}
[0m17:08:35.674657 [debug] [MainThread]: Flushing usage events
[0m17:08:35.961306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:10.197853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AED4B7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AED4B7440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AED4B4FB0>]}


============================== 17:09:10.197853 | dd2592d2-bb16-40bd-8340-dcf2c7acc307 ==============================
[0m17:09:10.197853 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:09:10.197853 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'dbt_carton_caps', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --profiles-dir dbt_carton_caps --project-dir dbt_carton_caps', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'dbt_carton_caps\\logs'}
[0m17:09:10.347300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd2592d2-bb16-40bd-8340-dcf2c7acc307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AECE5B290>]}
[0m17:09:10.386406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd2592d2-bb16-40bd-8340-dcf2c7acc307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AECE5B290>]}
[0m17:09:10.386406 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:09:10.540974 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:09:10.632441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:10.632441 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:09:10.633459 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:10.666602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd2592d2-bb16-40bd-8340-dcf2c7acc307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AEF047980>]}
[0m17:09:10.730927 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_carton_caps\target\manifest.json
[0m17:09:10.732979 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_carton_caps\target\semantic_manifest.json
[0m17:09:10.761110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd2592d2-bb16-40bd-8340-dcf2c7acc307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AEF426570>]}
[0m17:09:10.761110 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:09:10.763373 [info ] [MainThread]: 
[0m17:09:10.763373 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:09:10.763373 [info ] [MainThread]: 
[0m17:09:10.763373 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:09:10.767708 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T214833Z'
[0m17:09:10.816294 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T214833Z"
[0m17:09:10.816294 [debug] [ThreadPool]: On list_carton_caps_20260203T214833Z: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T214833Z"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps_20260203t214833z"'
    
  
  
[0m17:09:10.816294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:10.884620 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T214833Z"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps_20260203t214833z"'
    
  
  
[0m17:09:10.884620 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:09:10.885423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:10.885423 [debug] [MainThread]: Connection 'list_carton_caps_20260203T214833Z' was properly closed.
[0m17:09:10.885423 [info ] [MainThread]: 
[0m17:09:10.885423 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m17:09:10.886483 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\repos\livefront\carton_caps_analytics\duckdb\carton_caps_20260203t214833z.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Users\Gage\AppData\Local\Programs\Python\Python312\python.exe (PID 30316)
[0m17:09:10.886483 [debug] [MainThread]: Command `dbt build` failed at 17:09:10.886483 after 0.76 seconds
[0m17:09:10.886483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AED925370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AEF061AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AEF8B0500>]}
[0m17:09:10.887484 [debug] [MainThread]: Flushing usage events
[0m17:09:11.216318 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:52.936424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191BFF91040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C0467710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C0467920>]}


============================== 17:11:52.940839 | f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5 ==============================
[0m17:11:52.940839 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:11:52.941375 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'invocation_command': 'dbt build --profiles-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps --project-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m17:11:53.089378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C0633FE0>]}
[0m17:11:53.130897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C02E0EC0>]}
[0m17:11:53.132899 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:11:53.289089 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:11:53.355873 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:11:53.355873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C1E545F0>]}
[0m17:11:54.227610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C1AA6E70>]}
[0m17:11:54.282589 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:11:54.282589 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:11:54.314587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C1BD0AA0>]}
[0m17:11:54.314587 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:11:54.317645 [info ] [MainThread]: 
[0m17:11:54.317645 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:11:54.317645 [info ] [MainThread]: 
[0m17:11:54.317645 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:11:54.321148 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T221150Z'
[0m17:11:54.400261 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T221150Z"
[0m17:11:54.400261 [debug] [ThreadPool]: On list_carton_caps_20260203T221150Z: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T221150Z"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps_20260203t221150z"'
    
  
  
[0m17:11:54.400261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:54.421783 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m17:11:54.421783 [debug] [ThreadPool]: On list_carton_caps_20260203T221150Z: Close
[0m17:11:54.421783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_carton_caps_20260203T221150Z, now create_carton_caps_20260203T221150Z_main)
[0m17:11:54.421783 [debug] [ThreadPool]: Creating schema "database: "carton_caps_20260203T221150Z"
schema: "main"
"
[0m17:11:54.427977 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T221150Z_main"
[0m17:11:54.427977 [debug] [ThreadPool]: On create_carton_caps_20260203T221150Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_20260203T221150Z_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='carton_caps_20260203t221150z'
        and type='sqlite'
    
  
[0m17:11:54.427977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:54.429041 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:11:54.430040 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T221150Z_main"
[0m17:11:54.430040 [debug] [ThreadPool]: On create_carton_caps_20260203T221150Z_main: BEGIN
[0m17:11:54.430040 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:54.431041 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T221150Z_main"
[0m17:11:54.431041 [debug] [ThreadPool]: On create_carton_caps_20260203T221150Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_20260203T221150Z_main"} */

    
    
        create schema if not exists "carton_caps_20260203T221150Z"."main"
    
[0m17:11:54.431041 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:54.432040 [debug] [ThreadPool]: On create_carton_caps_20260203T221150Z_main: COMMIT
[0m17:11:54.432040 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T221150Z_main"
[0m17:11:54.432040 [debug] [ThreadPool]: On create_carton_caps_20260203T221150Z_main: COMMIT
[0m17:11:54.432040 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:54.432040 [debug] [ThreadPool]: On create_carton_caps_20260203T221150Z_main: Close
[0m17:11:54.433041 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T221150Z_main'
[0m17:11:54.437040 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T221150Z_main"
[0m17:11:54.437040 [debug] [ThreadPool]: On list_carton_caps_20260203T221150Z_main: BEGIN
[0m17:11:54.437040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:54.438039 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:54.438039 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T221150Z_main"
[0m17:11:54.438039 [debug] [ThreadPool]: On list_carton_caps_20260203T221150Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T221150Z_main"} */
select
      'carton_caps_20260203T221150Z' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps_20260203t221150z'
  
[0m17:11:54.444464 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:11:54.444464 [debug] [ThreadPool]: On list_carton_caps_20260203T221150Z_main: ROLLBACK
[0m17:11:54.448810 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_20260203T221150Z_main'
[0m17:11:54.448810 [debug] [ThreadPool]: On list_carton_caps_20260203T221150Z_main: Close
[0m17:11:54.449304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C233CD40>]}
[0m17:11:54.449304 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:54.449304 [debug] [MainThread]: On master: BEGIN
[0m17:11:54.449304 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:54.449304 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:54.449304 [debug] [MainThread]: On master: COMMIT
[0m17:11:54.449304 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:54.449304 [debug] [MainThread]: On master: COMMIT
[0m17:11:54.451419 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:54.451419 [debug] [MainThread]: On master: Close
[0m17:11:54.451419 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_events
[0m17:11:54.451419 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.stg_products
[0m17:11:54.451419 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.stg_purchases
[0m17:11:54.451419 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.stg_referrals
[0m17:11:54.451419 [info ] [Thread-1 (]: 1 of 44 START sql view model main.stg_events ................................... [RUN]
[0m17:11:54.451419 [info ] [Thread-2 (]: 2 of 44 START sql view model main.stg_products ................................. [RUN]
[0m17:11:54.455765 [info ] [Thread-3 (]: 3 of 44 START sql view model main.stg_purchases ................................ [RUN]
[0m17:11:54.456336 [info ] [Thread-4 (]: 4 of 44 START sql view model main.stg_referrals ................................ [RUN]
[0m17:11:54.456336 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_events'
[0m17:11:54.456336 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_products'
[0m17:11:54.456336 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_purchases'
[0m17:11:54.456336 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_referrals'
[0m17:11:54.456336 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_events
[0m17:11:54.456336 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.stg_products
[0m17:11:54.456336 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.stg_purchases
[0m17:11:54.456336 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.stg_referrals
[0m17:11:54.462705 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_events"
[0m17:11:54.463402 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_products"
[0m17:11:54.463402 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_purchases"
[0m17:11:54.463402 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_referrals"
[0m17:11:54.463402 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_events
[0m17:11:54.476600 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.stg_products
[0m17:11:54.484066 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_events"
[0m17:11:54.484066 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_products"
[0m17:11:54.484066 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.stg_referrals
[0m17:11:54.484066 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.stg_purchases
[0m17:11:54.490500 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:11:54.491066 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_referrals"
[0m17:11:54.491066 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_purchases"
[0m17:11:54.491066 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: BEGIN
[0m17:11:54.491066 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:11:54.491066 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:11:54.491066 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: BEGIN
[0m17:11:54.491066 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:11:54.491066 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.491066 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:11:54.491066 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.491066 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:11:54.491066 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:11:54.491066 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

  
  create view "carton_caps_20260203T221150Z"."main"."stg_events__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T221150Z"."raw"."events"
)
select
  cast(event_id as integer) as event_id,
  cast(user_id as integer) as user_id,
  cast(event_type as varchar) as event_type,
  cast(event_at as timestamp) as event_at,
  cast(referral_id as integer) as referral_id,
  cast(metadata_json as varchar) as metadata_json
from src
  );

[0m17:11:54.491066 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:11:54.497452 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: BEGIN
[0m17:11:54.497452 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: BEGIN
[0m17:11:54.497963 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

  
  create view "carton_caps_20260203T221150Z"."main"."stg_products__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T221150Z"."raw"."products"
)
select
  cast(product_id as integer) as product_id,
  cast(name as varchar) as name,
  cast(category as varchar) as category,
  cast(price as double) as price,
  cast(points_per_dollar as integer) as points_per_dollar,
  cast(created_at as timestamp) as created_at
from src
  );

[0m17:11:54.497963 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:11:54.497963 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.497963 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:11:54.497963 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:11:54.497963 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:11:54.497963 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:11:54.497963 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */
alter view "carton_caps_20260203T221150Z"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m17:11:54.497963 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:11:54.505029 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:11:54.505029 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:11:54.505029 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:11:54.505029 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */
alter view "carton_caps_20260203T221150Z"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m17:11:54.505029 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.505029 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

  
  create view "carton_caps_20260203T221150Z"."main"."stg_referrals__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T221150Z"."raw"."referrals"
)
select
  cast(referral_id as integer) as referral_id,
  cast(referrer_user_id as integer) as referrer_user_id,
  lower(cast(referred_email as varchar)) as referred_email,
  cast(referred_user_id as integer) as referred_user_id,
  cast(referral_code as varchar) as referral_code,
  cast(sent_at as timestamp) as sent_at,
  cast(converted_at as timestamp) as converted_at,
  cast(status as varchar) as status
from src
  );

[0m17:11:54.505029 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

  
  create view "carton_caps_20260203T221150Z"."main"."stg_purchases__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T221150Z"."raw"."purchases"
)
select
  cast(purchase_id as integer) as purchase_id,
  cast(user_id as integer) as user_id,
  cast(product_id as integer) as product_id,
  cast(quantity as integer) as quantity,
  cast(price_paid as double) as price_paid,
  cast(points_earned as integer) as points_earned,
  cast(purchased_at as timestamp) as purchased_at,
  cast(day_of_week as varchar) as day_of_week,
  cast(hour_of_day as integer) as hour_of_day
from src
  );

[0m17:11:54.513014 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m17:11:54.513014 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m17:11:54.513014 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:11:54.513014 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m17:11:54.513014 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.513014 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.513014 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m17:11:54.513014 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:11:54.513014 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:11:54.519274 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:11:54.519274 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m17:11:54.519274 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */
alter view "carton_caps_20260203T221150Z"."main"."stg_purchases__dbt_tmp" rename to "stg_purchases"
[0m17:11:54.519274 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */
alter view "carton_caps_20260203T221150Z"."main"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m17:11:54.520778 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:11:54.521785 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m17:11:54.521785 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:11:54.521785 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.521785 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m17:11:54.522783 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m17:11:54.522783 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:11:54.523784 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m17:11:54.524783 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:11:54.527927 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:11:54.528931 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

      drop view if exists "carton_caps_20260203T221150Z"."main"."stg_events__dbt_backup" cascade
    
[0m17:11:54.528931 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m17:11:54.528931 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:11:54.529931 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:11:54.530930 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:11:54.530930 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.533594 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:11:54.534469 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:11:54.534469 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

      drop view if exists "carton_caps_20260203T221150Z"."main"."stg_products__dbt_backup" cascade
    
[0m17:11:54.536513 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: Close
[0m17:11:54.536513 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

      drop view if exists "carton_caps_20260203T221150Z"."main"."stg_referrals__dbt_backup" cascade
    
[0m17:11:54.536513 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

      drop view if exists "carton_caps_20260203T221150Z"."main"."stg_purchases__dbt_backup" cascade
    
[0m17:11:54.537516 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.538514 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: Close
[0m17:11:54.539515 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.539515 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: Close
[0m17:11:54.540515 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.541516 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: Close
[0m17:11:54.541516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C1E0C260>]}
[0m17:11:54.541516 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C05DC740>]}
[0m17:11:54.542515 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C1DF8EF0>]}
[0m17:11:54.542515 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C1E0EF60>]}
[0m17:11:54.541516 [info ] [Thread-1 (]: 1 of 44 OK created sql view model main.stg_events .............................. [[32mOK[0m in 0.08s]
[0m17:11:54.542515 [info ] [Thread-2 (]: 2 of 44 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.08s]
[0m17:11:54.543515 [info ] [Thread-4 (]: 4 of 44 OK created sql view model main.stg_referrals ........................... [[32mOK[0m in 0.08s]
[0m17:11:54.543515 [info ] [Thread-3 (]: 3 of 44 OK created sql view model main.stg_purchases ........................... [[32mOK[0m in 0.09s]
[0m17:11:54.543515 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_events
[0m17:11:54.544516 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.stg_products
[0m17:11:54.544516 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.stg_referrals
[0m17:11:54.544516 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.stg_purchases
[0m17:11:54.545514 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_schools
[0m17:11:54.545514 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.stg_users
[0m17:11:54.545514 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:11:54.546515 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:11:54.546515 [info ] [Thread-1 (]: 5 of 44 START sql view model main.stg_schools .................................. [RUN]
[0m17:11:54.546515 [info ] [Thread-2 (]: 6 of 44 START sql view model main.stg_users .................................... [RUN]
[0m17:11:54.547515 [info ] [Thread-4 (]: 7 of 44 START test not_null_stg_events_event_id ................................ [RUN]
[0m17:11:54.547515 [info ] [Thread-3 (]: 8 of 44 START test not_null_stg_events_user_id ................................. [RUN]
[0m17:11:54.547515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_events, now model.dbt_carton_caps.stg_schools)
[0m17:11:54.548515 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_products, now model.dbt_carton_caps.stg_users)
[0m17:11:54.548515 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_referrals, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m17:11:54.548515 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_purchases, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m17:11:54.548515 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_schools
[0m17:11:54.549515 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.stg_users
[0m17:11:54.549515 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:11:54.549515 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:11:54.549515 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_schools"
[0m17:11:54.552984 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_users"
[0m17:11:54.559429 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:11:54.561147 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:11:54.562488 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_schools
[0m17:11:54.562488 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.stg_users
[0m17:11:54.564465 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_schools"
[0m17:11:54.566536 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_users"
[0m17:11:54.566854 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:11:54.566854 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:11:54.576476 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:11:54.578559 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:11:54.578559 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:11:54.579456 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:11:54.579456 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: BEGIN
[0m17:11:54.579456 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: BEGIN
[0m17:11:54.579456 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:11:54.580710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:54.581123 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:54.581123 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:11:54.581123 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m17:11:54.582124 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m17:11:54.582124 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.582475 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:54.582475 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.582475 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:54.582475 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:11:54.583526 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:11:54.583526 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.583526 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

  
  create view "carton_caps_20260203T221150Z"."main"."stg_schools__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T221150Z"."raw"."schools"
)
select
  cast(school_id as integer) as school_id,
  cast(name as varchar) as name,
  cast(address as varchar) as address,
  cast(city as varchar) as city,
  cast(state as varchar) as state,
  cast(zip_code as varchar) as zip_code,
  cast(created_at as timestamp) as created_at
from src
  );

[0m17:11:54.583526 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

  
  create view "carton_caps_20260203T221150Z"."main"."stg_users__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T221150Z"."raw"."users"
)
select
  cast(user_id as integer) as user_id,
  cast(first_name as varchar) as first_name,
  cast(last_name as varchar) as last_name,
  lower(cast(email as varchar)) as email,
  cast(school_id as integer) as school_id,
  cast(created_at as timestamp) as created_at,
  cast(user_type as varchar) as user_type,
  cast(is_verified as integer) as is_verified,
  cast(device_id as varchar) as device_id,
  cast(marketing_channel as varchar) as marketing_channel
from src
  );

[0m17:11:54.584525 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.584525 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:11:54.584525 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:11:54.585525 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T221150Z"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:54.585525 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.585525 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.585525 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps_20260203T221150Z"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:54.587865 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:11:54.589510 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:11:54.589510 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:11:54.589510 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */
alter view "carton_caps_20260203T221150Z"."main"."stg_schools__dbt_tmp" rename to "stg_schools"
[0m17:11:54.590558 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */
alter view "carton_caps_20260203T221150Z"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:11:54.590558 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.592487 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m17:11:54.593444 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m17:11:54.593444 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.593444 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.594795 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m17:11:54.594795 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m17:11:54.595931 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m17:11:54.596929 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m17:11:54.596929 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m17:11:54.597447 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m17:11:54.597447 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:11:54.597447 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:11:54.598493 [info ] [Thread-3 (]: 8 of 44 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.05s]
[0m17:11:54.598493 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m17:11:54.598493 [info ] [Thread-4 (]: 7 of 44 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.05s]
[0m17:11:54.598493 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m17:11:54.599453 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:11:54.599453 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:11:54.600521 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m17:11:54.600521 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:11:54.600521 [info ] [Thread-3 (]: 9 of 44 START test test_events_in_window ....................................... [RUN]
[0m17:11:54.600521 [info ] [Thread-4 (]: 10 of 44 START test unique_stg_events_event_id ................................. [RUN]
[0m17:11:54.601554 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.test_events_in_window)
[0m17:11:54.601870 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m17:11:54.601870 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m17:11:54.601870 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.602873 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:11:54.602873 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.603872 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m17:11:54.605465 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:11:54.609455 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:11:54.610434 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:11:54.610434 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

      drop view if exists "carton_caps_20260203T221150Z"."main"."stg_users__dbt_backup" cascade
    
[0m17:11:54.611467 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

      drop view if exists "carton_caps_20260203T221150Z"."main"."stg_schools__dbt_backup" cascade
    
[0m17:11:54.611467 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m17:11:54.613497 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m17:11:54.613497 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.613497 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:11:54.614450 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: Close
[0m17:11:54.614450 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.616489 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:11:54.616489 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: Close
[0m17:11:54.617463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C204D9A0>]}
[0m17:11:54.617463 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:11:54.618495 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C2105340>]}
[0m17:11:54.618495 [info ] [Thread-1 (]: 5 of 44 OK created sql view model main.stg_schools ............................. [[32mOK[0m in 0.07s]
[0m17:11:54.618495 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m17:11:54.618495 [info ] [Thread-2 (]: 6 of 44 OK created sql view model main.stg_users ............................... [[32mOK[0m in 0.07s]
[0m17:11:54.619496 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_schools
[0m17:11:54.619496 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:54.619496 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:11:54.619496 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.stg_users
[0m17:11:54.620662 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:11:54.620662 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m17:11:54.620662 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:11:54.621744 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.621744 [info ] [Thread-1 (]: 11 of 44 START test not_null_stg_products_product_id ........................... [RUN]
[0m17:11:54.622423 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:54.622725 [info ] [Thread-2 (]: 12 of 44 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m17:11:54.622725 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:11:54.622725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_schools, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m17:11:54.622725 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_users, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m17:11:54.623837 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps_20260203T221150Z"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m17:11:54.623837 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.624474 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:11:54.624474 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:11:54.624474 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:11:54.627485 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:11:54.629687 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:11:54.629687 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:54.630706 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:11:54.630706 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:11:54.634492 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:11:54.634492 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:11:54.635528 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m17:11:54.635528 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:11:54.636663 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:11:54.637455 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m17:11:54.637455 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:11:54.638500 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m17:11:54.639473 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m17:11:54.639473 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m17:11:54.639473 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m17:11:54.640515 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:11:54.640515 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:54.640515 [info ] [Thread-3 (]: 9 of 44 PASS test_events_in_window ............................................. [[32mPASS[0m in 0.04s]
[0m17:11:54.641472 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m17:11:54.641472 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m17:11:54.641472 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m17:11:54.642505 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.642505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:54.642505 [info ] [Thread-4 (]: 10 of 44 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m17:11:54.643271 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:11:54.643271 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:11:54.643271 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:11:54.644352 [info ] [Thread-3 (]: 13 of 44 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m17:11:54.644352 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.644352 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T221150Z"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:54.645351 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:11:54.645351 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m17:11:54.645351 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:11:54.646352 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:11:54.645351 [info ] [Thread-4 (]: 14 of 44 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m17:11:54.646352 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T221150Z"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:54.646352 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.649351 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:11:54.649351 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m17:11:54.649351 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:11:54.652350 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:11:54.652350 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.653353 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m17:11:54.653353 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:11:54.654352 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m17:11:54.655352 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m17:11:54.655352 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:11:54.656352 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:11:54.657351 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m17:11:54.657351 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m17:11:54.659351 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:11:54.659351 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m17:11:54.659351 [info ] [Thread-2 (]: 12 of 44 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.04s]
[0m17:11:54.660351 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:11:54.660351 [info ] [Thread-1 (]: 11 of 44 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.04s]
[0m17:11:54.661352 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:11:54.661352 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:11:54.661352 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:11:54.662351 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:11:54.662351 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m17:11:54.662351 [info ] [Thread-2 (]: 15 of 44 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m17:11:54.662351 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:11:54.663352 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m17:11:54.663352 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:54.663352 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m17:11:54.663352 [info ] [Thread-1 (]: 16 of 44 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m17:11:54.664351 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:54.664351 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:11:54.664351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m17:11:54.665352 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.667351 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:11:54.667351 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:11:54.668351 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:11:54.668351 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:11:54.670351 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:11:54.670351 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:11:54.671351 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T221150Z"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:54.671351 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T221150Z"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:54.671351 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:11:54.672351 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:11:54.673351 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:11:54.674351 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:11:54.675350 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.675350 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:11:54.676352 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m17:11:54.677351 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m17:11:54.678351 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m17:11:54.678351 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m17:11:54.678351 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:11:54.679352 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m17:11:54.679352 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:11:54.679352 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m17:11:54.679352 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m17:11:54.680351 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m17:11:54.680351 [info ] [Thread-4 (]: 14 of 44 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.03s]
[0m17:11:54.680351 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:54.681351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:54.681351 [info ] [Thread-3 (]: 13 of 44 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.04s]
[0m17:11:54.681351 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:11:54.682352 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:11:54.682352 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.682352 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:11:54.683351 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.683351 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:11:54.683351 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:11:54.683351 [info ] [Thread-4 (]: 17 of 44 START test unique_stg_products_product_id ............................. [RUN]
[0m17:11:54.684351 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:11:54.684351 [info ] [Thread-3 (]: 18 of 44 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m17:11:54.684351 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T221150Z"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:54.685351 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m17:11:54.685351 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps_20260203T221150Z"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:54.685351 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m17:11:54.686352 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:11:54.686352 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:11:54.688350 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:11:54.689351 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.692351 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:11:54.692351 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:11:54.693351 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m17:11:54.694351 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m17:11:54.695351 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m17:11:54.695351 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m17:11:54.695351 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m17:11:54.696352 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:11:54.696352 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:11:54.696352 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m17:11:54.698351 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:11:54.697352 [info ] [Thread-2 (]: 15 of 44 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.03s]
[0m17:11:54.699351 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:11:54.700351 [info ] [Thread-1 (]: 16 of 44 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.04s]
[0m17:11:54.700351 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:11:54.701352 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:11:54.701352 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:11:54.701352 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:11:54.702352 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:11:54.702352 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:11:54.702352 [info ] [Thread-2 (]: 19 of 44 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m17:11:54.702352 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m17:11:54.703351 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m17:11:54.703351 [info ] [Thread-1 (]: 20 of 44 START test not_null_stg_schools_school_id ............................. [RUN]
[0m17:11:54.703351 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m17:11:54.704352 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:54.704352 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:54.704352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m17:11:54.704352 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:11:54.705351 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:11:54.705351 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.708354 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:11:54.708354 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:11:54.710356 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:11:54.710356 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:11:54.711355 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:11:54.711355 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:54.711355 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:54.712355 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:11:54.713444 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:11:54.714448 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:11:54.714448 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.714448 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.716448 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:11:54.717448 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m17:11:54.717448 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:11:54.718448 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m17:11:54.719448 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m17:11:54.719448 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m17:11:54.719448 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m17:11:54.719448 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m17:11:54.720952 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:11:54.720952 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:54.720952 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m17:11:54.720952 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m17:11:54.721958 [info ] [Thread-4 (]: 17 of 44 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.04s]
[0m17:11:54.722957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:54.722957 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.721958 [info ] [Thread-3 (]: 18 of 44 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.04s]
[0m17:11:54.722957 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:11:54.723957 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:11:54.723957 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:11:54.723957 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.723957 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:11:54.724958 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:54.724958 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:11:54.724958 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:11:54.724958 [info ] [Thread-4 (]: 21 of 44 START test unique_stg_schools_school_id ............................... [RUN]
[0m17:11:54.725957 [info ] [Thread-3 (]: 22 of 44 START test not_null_stg_users_school_id ............................... [RUN]
[0m17:11:54.725957 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T221150Z"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:54.725957 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m17:11:54.726957 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m17:11:54.726957 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.726957 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:11:54.727957 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:11:54.727957 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.729958 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:11:54.730959 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m17:11:54.733956 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:11:54.733956 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m17:11:54.734958 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m17:11:54.735957 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m17:11:54.735957 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m17:11:54.735957 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m17:11:54.736957 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:11:54.736957 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:11:54.736957 [info ] [Thread-2 (]: 19 of 44 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m17:11:54.738957 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:11:54.736957 [info ] [Thread-1 (]: 20 of 44 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.03s]
[0m17:11:54.740957 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:11:54.741956 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:11:54.741956 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:11:54.742957 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:11:54.742957 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:11:54.742957 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:11:54.743957 [info ] [Thread-2 (]: 23 of 44 START test not_null_stg_users_user_id ................................. [RUN]
[0m17:11:54.743957 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m17:11:54.743957 [info ] [Thread-1 (]: 24 of 44 START test unique_stg_users_user_id ................................... [RUN]
[0m17:11:54.743957 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:11:54.744958 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m17:11:54.744958 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:54.744958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m17:11:54.744958 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m17:11:54.745957 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:11:54.745957 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:11:54.745957 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:54.746957 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.748956 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:11:54.750958 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:11:54.751957 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:11:54.751957 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:11:54.751957 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:54.751957 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:11:54.752957 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:11:54.752957 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T221150Z"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:54.754958 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:11:54.754958 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:11:54.754958 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.756957 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:11:54.756957 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.757957 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m17:11:54.758957 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:11:54.758957 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m17:11:54.759959 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m17:11:54.759959 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m17:11:54.760957 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m17:11:54.760957 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m17:11:54.760957 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:54.761957 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:11:54.761957 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m17:11:54.762957 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m17:11:54.762957 [info ] [Thread-4 (]: 21 of 44 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:11:54.762957 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.763957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:54.762957 [info ] [Thread-3 (]: 22 of 44 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:11:54.763957 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:11:54.763957 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:11:54.764958 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:11:54.764958 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.fct_rewards
[0m17:11:54.764958 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.765957 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T221150Z"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:54.765957 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.dim_product
[0m17:11:54.765957 [info ] [Thread-4 (]: 25 of 44 START sql table model main.fct_rewards ................................ [RUN]
[0m17:11:54.766956 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:11:54.766956 [info ] [Thread-3 (]: 26 of 44 START sql table model main.dim_product ................................ [RUN]
[0m17:11:54.766956 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6, now model.dbt_carton_caps.fct_rewards)
[0m17:11:54.767957 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:54.767957 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.767957 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now model.dbt_carton_caps.dim_product)
[0m17:11:54.768957 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.fct_rewards
[0m17:11:54.769470 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m17:11:54.769470 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.dim_product
[0m17:11:54.770461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.771450 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_rewards"
[0m17:11:54.772420 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m17:11:54.773451 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_product"
[0m17:11:54.775216 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m17:11:54.775534 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m17:11:54.775534 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m17:11:54.776470 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.fct_rewards
[0m17:11:54.776470 [info ] [Thread-2 (]: 23 of 44 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m17:11:54.776470 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m17:11:54.777464 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.dim_product
[0m17:11:54.788397 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_rewards"
[0m17:11:54.788397 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:11:54.790462 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_product"
[0m17:11:54.790462 [info ] [Thread-1 (]: 24 of 44 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.05s]
[0m17:11:54.791439 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.fct_referral
[0m17:11:54.791439 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:11:54.792462 [info ] [Thread-2 (]: 27 of 44 START sql table model main.fct_referral ............................... [RUN]
[0m17:11:54.792462 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:11:54.792462 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.dim_school
[0m17:11:54.792462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now model.dbt_carton_caps.fct_referral)
[0m17:11:54.793480 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:11:54.793480 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: BEGIN
[0m17:11:54.793480 [info ] [Thread-1 (]: 28 of 44 START sql table model main.dim_school ................................. [RUN]
[0m17:11:54.794467 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.fct_referral
[0m17:11:54.794467 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_product: BEGIN
[0m17:11:54.794467 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:54.794467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b, now model.dbt_carton_caps.dim_school)
[0m17:11:54.796457 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_referral"
[0m17:11:54.797443 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:54.797443 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.dim_school
[0m17:11:54.797443 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.799436 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_school"
[0m17:11:54.799436 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:11:54.799436 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.800459 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

  
    
    

    create  table
      "carton_caps_20260203T221150Z"."main"."fct_rewards__dbt_tmp"
  
    as (
      with e as (
  select *
  from "carton_caps_20260203T221150Z"."main"."stg_events"
),

awards as (
  select
    referral_id,
    user_id,
    event_at as awarded_at,
    -- reward_type is inside metadata_json like {"reward_type":"referrer_bonus"}
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_awarded'
),

redeems as (
  select
    referral_id,
    user_id,
    event_at as redeemed_at,
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_redeemed'
)

select
  -- deterministic surrogate key
  md5(cast(a.referral_id as varchar) || '|' || cast(a.user_id as varchar) || '|' || coalesce(a.reward_type,'')) as reward_id,
  a.referral_id,
  a.user_id,
  a.reward_type,
  a.awarded_at,
  min(r.redeemed_at) as redeemed_at
from awards a
left join redeems r
  on a.referral_id = r.referral_id
  and a.user_id = r.user_id
  and coalesce(a.reward_type,'') = coalesce(r.reward_type,'')
group by 1,2,3,4,5
    );
  
  
[0m17:11:54.800459 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:11:54.800459 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.fct_referral
[0m17:11:54.801462 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

  
    
    

    create  table
      "carton_caps_20260203T221150Z"."main"."dim_product__dbt_tmp"
  
    as (
      select
  product_id,
  name,
  category,
  price,
  points_per_dollar,
  created_at
from "carton_caps_20260203T221150Z"."main"."stg_products"
    );
  
  
[0m17:11:54.801462 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.dim_school
[0m17:11:54.804531 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_referral"
[0m17:11:54.807457 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_school"
[0m17:11:54.807457 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.809438 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:11:54.809919 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */
alter table "carton_caps_20260203T221150Z"."main"."dim_product__dbt_tmp" rename to "dim_product"
[0m17:11:54.810374 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m17:11:54.811465 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:11:54.812453 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:11:54.812453 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */
alter table "carton_caps_20260203T221150Z"."main"."fct_rewards__dbt_tmp" rename to "fct_rewards"
[0m17:11:54.812453 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.812453 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:11:54.813457 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_school: BEGIN
[0m17:11:54.816411 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m17:11:54.816859 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: BEGIN
[0m17:11:54.817266 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.817266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:54.817266 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:11:54.817266 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:54.818446 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m17:11:54.819429 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m17:11:54.819429 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.819429 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:11:54.819429 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.820462 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:11:54.820462 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m17:11:54.820996 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:11:54.820996 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

  
    
    

    create  table
      "carton_caps_20260203T221150Z"."main"."dim_school__dbt_tmp"
  
    as (
      select
  school_id,
  name,
  address,
  city,
  state,
  zip_code,
  created_at
from "carton_caps_20260203T221150Z"."main"."stg_schools"
    );
  
  
[0m17:11:54.821457 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

  
    
    

    create  table
      "carton_caps_20260203T221150Z"."main"."fct_referral__dbt_tmp"
  
    as (
      with r as (
  select *
  from "carton_caps_20260203T221150Z"."main"."stg_referrals"
),

e as (
  select *
  from "carton_caps_20260203T221150Z"."main"."stg_events"
),

-- Referral-related event timestamps for referred users
ref_events as (
  select
    referral_id,
    user_id,

    min(case when event_type = 'install' then event_at end) as install_at,
    min(case when event_type = 'referral_applied' then event_at end) as referral_applied_at,
    min(case when event_type = 'onboarding_complete' then event_at end) as onboarding_completed_at,
    min(case when event_type = 'school_linked' then event_at end) as school_linked_at

  from e
  where referral_id is not null
  group by 1,2
),

-- First scan/purchase time for referred users (proxy for qualifying action)
first_purchase as (
  select
    user_id,
    min(purchased_at) as first_purchase_at
  from "carton_caps_20260203T221150Z"."main"."stg_purchases"
  group by 1
)

select
  r.referral_id,
  r.referrer_user_id,
  r.referred_email,
  r.referred_user_id,
  r.referral_code,
  r.sent_at,
  r.converted_at,
  r.status,

  re.install_at,
  re.referral_applied_at,
  re.onboarding_completed_at,
  re.school_linked_at,

  fp.first_purchase_at,

  -- qualifying action is: first_purchase OR school_linked (whichever happens first)
  least(fp.first_purchase_at, re.school_linked_at) as qualifying_action_at,

  -- window compliance (48 hours) using install -> referral_applied
  case
    when re.install_at is null or re.referral_applied_at is null then null
    when datediff('hour', re.install_at, re.referral_applied_at) <= 48 then true
    else false
  end as within_48h_window,

  -- simple eligibility (rules-compliant posture)
  case
    when r.status <> 'converted' then false
    when re.onboarding_completed_at is null then false
    when least(fp.first_purchase_at, re.school_linked_at) is null then false
    when re.install_at is null or re.referral_applied_at is null then false
    when datediff('hour', re.install_at, re.referral_applied_at) > 48 then false
    else true
  end as eligible_referral

from r
left join ref_events re
  on r.referral_id = re.referral_id
  and r.referred_user_id = re.user_id
left join first_purchase fp
  on r.referred_user_id = fp.user_id
    );
  
  
[0m17:11:54.825467 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:11:54.827453 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:11:54.827453 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

      drop table if exists "carton_caps_20260203T221150Z"."main"."dim_product__dbt_backup" cascade
    
[0m17:11:54.827453 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:11:54.829598 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:11:54.829598 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m17:11:54.830630 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */
alter table "carton_caps_20260203T221150Z"."main"."dim_school__dbt_tmp" rename to "dim_school"
[0m17:11:54.831559 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:11:54.832482 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:11:54.832482 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

      drop table if exists "carton_caps_20260203T221150Z"."main"."fct_rewards__dbt_backup" cascade
    
[0m17:11:54.834505 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_product: Close
[0m17:11:54.834505 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.835480 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m17:11:54.836464 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C388B530>]}
[0m17:11:54.836464 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:11:54.836464 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.836464 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m17:11:54.837464 [info ] [Thread-3 (]: 26 of 44 OK created sql table model main.dim_product ........................... [[32mOK[0m in 0.07s]
[0m17:11:54.837879 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m17:11:54.838511 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_rewards: Close
[0m17:11:54.840420 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:11:54.840420 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.dim_product
[0m17:11:54.841451 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */
alter table "carton_caps_20260203T221150Z"."main"."fct_referral__dbt_tmp" rename to "fct_referral"
[0m17:11:54.841451 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C204D790>]}
[0m17:11:54.841451 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.dim_user
[0m17:11:54.842504 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.842504 [info ] [Thread-4 (]: 25 of 44 OK created sql table model main.fct_rewards ........................... [[32mOK[0m in 0.07s]
[0m17:11:54.842504 [info ] [Thread-3 (]: 29 of 44 START sql table model main.dim_user ................................... [RUN]
[0m17:11:54.843490 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.844797 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:11:54.845483 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.fct_rewards
[0m17:11:54.845483 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_product, now model.dbt_carton_caps.dim_user)
[0m17:11:54.846477 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m17:11:54.846477 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

      drop table if exists "carton_caps_20260203T221150Z"."main"."dim_school__dbt_backup" cascade
    
[0m17:11:54.846477 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.fct_purchase
[0m17:11:54.847485 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.dim_user
[0m17:11:54.847485 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:11:54.847485 [info ] [Thread-4 (]: 30 of 44 START sql table model main.fct_purchase ............................... [RUN]
[0m17:11:54.849481 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_user"
[0m17:11:54.849481 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.850498 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m17:11:54.850498 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_rewards, now model.dbt_carton_caps.fct_purchase)
[0m17:11:54.851528 [debug] [Thread-1 (]: On model.dbt_carton_caps.dim_school: Close
[0m17:11:54.851837 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.fct_purchase
[0m17:11:54.852464 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.dim_user
[0m17:11:54.855459 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_purchase"
[0m17:11:54.855459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C38AD0D0>]}
[0m17:11:54.857462 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_user"
[0m17:11:54.857462 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m17:11:54.858481 [info ] [Thread-1 (]: 28 of 44 OK created sql table model main.dim_school ............................ [[32mOK[0m in 0.06s]
[0m17:11:54.859455 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:11:54.859455 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.fct_purchase
[0m17:11:54.860484 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.dim_school
[0m17:11:54.860484 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

      drop table if exists "carton_caps_20260203T221150Z"."main"."fct_referral__dbt_backup" cascade
    
[0m17:11:54.862438 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_purchase"
[0m17:11:54.862438 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:11:54.862438 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:11:54.863472 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: BEGIN
[0m17:11:54.863472 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.863472 [info ] [Thread-1 (]: 31 of 44 START test not_null_dim_product_product_id ............................ [RUN]
[0m17:11:54.864472 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:54.864472 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:11:54.865473 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: Close
[0m17:11:54.865473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_school, now test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816)
[0m17:11:54.865473 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_purchase: BEGIN
[0m17:11:54.866472 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.866472 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C3897B90>]}
[0m17:11:54.866472 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:11:54.867472 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:54.867472 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:11:54.870473 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:11:54.867472 [info ] [Thread-2 (]: 27 of 44 OK created sql table model main.fct_referral .......................... [[32mOK[0m in 0.07s]
[0m17:11:54.870473 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

  
    
    

    create  table
      "carton_caps_20260203T221150Z"."main"."dim_user__dbt_tmp"
  
    as (
      select
  u.user_id,
  u.first_name,
  u.last_name,
  u.email,
  u.school_id,
  s.name as school_name,
  s.state as school_state,
  u.created_at,
  u.user_type,
  u.is_verified,
  u.device_id,
  u.marketing_channel
from "carton_caps_20260203T221150Z"."main"."stg_users" u
left join "carton_caps_20260203T221150Z"."main"."stg_schools" s
  on u.school_id = s.school_id
    );
  
  
[0m17:11:54.871472 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:11:54.871472 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.fct_referral
[0m17:11:54.871472 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:11:54.872472 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:11:54.872472 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:11:54.872472 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

  
    
    

    create  table
      "carton_caps_20260203T221150Z"."main"."fct_purchase__dbt_tmp"
  
    as (
      select
  p.purchase_id,
  p.user_id,
  u.school_id,
  p.product_id,
  pr.category as product_category,
  p.quantity,
  p.price_paid,
  p.points_earned,
  p.purchased_at,
  date_trunc('day', p.purchased_at) as purchase_date,
  p.day_of_week,
  p.hour_of_day
from "carton_caps_20260203T221150Z"."main"."stg_purchases" p
left join "carton_caps_20260203T221150Z"."main"."stg_users" u
  on p.user_id = u.user_id
left join "carton_caps_20260203T221150Z"."main"."stg_products" pr
  on p.product_id = pr.product_id
    );
  
  
[0m17:11:54.872472 [info ] [Thread-2 (]: 32 of 44 START test unique_dim_product_product_id .............................. [RUN]
[0m17:11:54.874471 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:11:54.875472 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.875472 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_referral, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m17:11:54.877472 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:11:54.877472 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:11:54.877472 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */
alter table "carton_caps_20260203T221150Z"."main"."dim_user__dbt_tmp" rename to "dim_user"
[0m17:11:54.880484 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:11:54.880484 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:11:54.881460 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m17:11:54.881460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:54.881460 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m17:11:54.881460 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.883484 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:11:54.884452 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m17:11:54.884452 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.885461 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:11:54.885461 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */
alter table "carton_caps_20260203T221150Z"."main"."fct_purchase__dbt_tmp" rename to "fct_purchase"
[0m17:11:54.885461 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:11:54.886305 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:11:54.887462 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:11:54.887462 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m17:11:54.887462 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T221150Z"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:54.888476 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.889490 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m17:11:54.889490 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:11:54.889490 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m17:11:54.890490 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:11:54.890490 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.890490 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m17:11:54.890490 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:54.891489 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m17:11:54.892473 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:11:54.892473 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.893260 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:11:54.895485 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:11:54.895485 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:11:54.895485 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:11:54.896492 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m17:11:54.896492 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

      drop table if exists "carton_caps_20260203T221150Z"."main"."dim_user__dbt_backup" cascade
    
[0m17:11:54.897450 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:11:54.898435 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:54.898435 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

      drop table if exists "carton_caps_20260203T221150Z"."main"."fct_purchase__dbt_backup" cascade
    
[0m17:11:54.898435 [info ] [Thread-1 (]: 31 of 44 PASS not_null_dim_product_product_id .................................. [[32mPASS[0m in 0.03s]
[0m17:11:54.899465 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.900201 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:11:54.900549 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: Close
[0m17:11:54.900549 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.901450 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:11:54.901450 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.902480 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C38CC620>]}
[0m17:11:54.901450 [info ] [Thread-1 (]: 33 of 44 START test not_null_fct_rewards_reward_id ............................. [RUN]
[0m17:11:54.903477 [debug] [Thread-4 (]: On model.dbt_carton_caps.fct_purchase: Close
[0m17:11:54.903477 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m17:11:54.904464 [info ] [Thread-3 (]: 29 of 44 OK created sql table model main.dim_user .............................. [[32mOK[0m in 0.06s]
[0m17:11:54.904464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m17:11:54.905482 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9fb8e-89fb-4b12-88b3-b8ffe12bebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C38C9C10>]}
[0m17:11:54.905482 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m17:11:54.906462 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.dim_user
[0m17:11:54.906462 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:11:54.906462 [info ] [Thread-4 (]: 30 of 44 OK created sql table model main.fct_purchase .......................... [[32mOK[0m in 0.05s]
[0m17:11:54.907139 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m17:11:54.907449 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:11:54.909421 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:11:54.910417 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.fct_purchase
[0m17:11:54.910417 [info ] [Thread-2 (]: 32 of 44 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.03s]
[0m17:11:54.910417 [info ] [Thread-3 (]: 34 of 44 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m17:11:54.911448 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:11:54.911448 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:11:54.911448 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_user, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m17:11:54.912477 [info ] [Thread-4 (]: 35 of 44 START test not_null_dim_school_school_id .............................. [RUN]
[0m17:11:54.912477 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:11:54.912477 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:11:54.913447 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:11:54.913447 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_purchase, now test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b)
[0m17:11:54.914427 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:11:54.915447 [info ] [Thread-2 (]: 36 of 44 START test unique_dim_school_school_id ................................ [RUN]
[0m17:11:54.917433 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:11:54.917433 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:11:54.918466 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m17:11:54.920977 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:11:54.920977 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:11:54.921430 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:11:54.923416 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:11:54.923416 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m17:11:54.923416 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:11:54.924481 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:11:54.924481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:54.925484 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:11:54.927479 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:11:54.927986 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:11:54.928288 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:11:54.929488 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:11:54.929488 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:11:54.930458 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:11:54.930458 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps_20260203T221150Z"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:54.930458 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:11:54.930458 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m17:11:54.931472 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m17:11:54.931472 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:54.931472 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:11:54.932506 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:54.932506 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.932506 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m17:11:54.933490 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.933490 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.933490 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:54.934918 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m17:11:54.935251 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:11:54.935251 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:11:54.936439 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m17:11:54.936439 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:54.936439 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.936439 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T221150Z"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:54.936439 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m17:11:54.937472 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:11:54.937472 [info ] [Thread-1 (]: 33 of 44 PASS not_null_fct_rewards_reward_id ................................... [[32mPASS[0m in 0.03s]
[0m17:11:54.938502 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.938502 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:54.939531 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:11:54.939531 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.940494 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m17:11:54.941457 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:11:54.942176 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m17:11:54.942492 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:11:54.942492 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.943493 [info ] [Thread-1 (]: 37 of 44 START test not_null_fct_referral_referral_id .......................... [RUN]
[0m17:11:54.943493 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m17:11:54.943493 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m17:11:54.944444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m17:11:54.945468 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m17:11:54.945468 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m17:11:54.945468 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:11:54.946460 [info ] [Thread-4 (]: 35 of 44 PASS not_null_dim_school_school_id .................................... [[32mPASS[0m in 0.03s]
[0m17:11:54.946460 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m17:11:54.950457 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:11:54.951432 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:11:54.950457 [info ] [Thread-3 (]: 34 of 44 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:11:54.951432 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m17:11:54.951432 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:11:54.952466 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:11:54.952466 [info ] [Thread-4 (]: 38 of 44 START test unique_fct_referral_referral_id ............................ [RUN]
[0m17:11:54.953493 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:11:54.953493 [debug] [Thread-3 (]: Began running node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:11:54.952466 [info ] [Thread-2 (]: 36 of 44 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m17:11:54.953493 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m17:11:54.955459 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:11:54.955791 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now exposure.dbt_carton_caps.streamlit_referral_finance_dashboard)
[0m17:11:54.956093 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:11:54.956437 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:11:54.956437 [debug] [Thread-3 (]: Began compiling node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:11:54.956437 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:11:54.959449 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:11:54.959449 [debug] [Thread-3 (]: Began executing node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:11:54.959449 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:11:54.959449 [info ] [Thread-2 (]: 40 of 44 START test not_null_dim_user_user_id .................................. [RUN]
[0m17:11:54.960457 [info ] [Thread-3 (]: 39 of 44 NO-OP exposure streamlit_referral_finance_dashboard ................... [[33mNO-OP[0m in 0.00s]
[0m17:11:54.960457 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m17:11:54.960457 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76, now test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3)
[0m17:11:54.961466 [debug] [Thread-3 (]: Finished running node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:11:54.961466 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:11:54.961466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:54.962463 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:11:54.962463 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:11:54.963442 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:11:54.966410 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:11:54.966410 [info ] [Thread-3 (]: 41 of 44 START test unique_dim_user_user_id .................................... [RUN]
[0m17:11:54.966410 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:11:54.967439 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly exposure.dbt_carton_caps.streamlit_referral_finance_dashboard, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m17:11:54.967439 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:11:54.967439 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:11:54.967439 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T221150Z"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:54.968450 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:11:54.970452 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:11:54.970452 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:11:54.972519 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:11:54.972519 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.972519 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m17:11:54.973519 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m17:11:54.973519 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:54.974519 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:11:54.974519 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m17:11:54.975519 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:11:54.976519 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:11:54.976519 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m17:11:54.977518 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.977518 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m17:11:54.978518 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:11:54.977518 [info ] [Thread-1 (]: 37 of 44 PASS not_null_fct_referral_referral_id ................................ [[32mPASS[0m in 0.03s]
[0m17:11:54.978518 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:54.978518 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:54.978518 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:11:54.979519 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:11:54.979519 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m17:11:54.980519 [debug] [Thread-1 (]: Began running node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:11:54.980519 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:11:54.980519 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:54.980519 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.981519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now exposure.dbt_carton_caps.streamlit_product_dashboard)
[0m17:11:54.981519 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:11:54.981519 [debug] [Thread-1 (]: Began compiling node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:11:54.982519 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m17:11:54.982519 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T221150Z"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:54.983519 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:11:54.983519 [debug] [Thread-1 (]: Began executing node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:11:54.983519 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m17:11:54.984518 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:11:54.984518 [info ] [Thread-1 (]: 42 of 44 NO-OP exposure streamlit_product_dashboard ............................ [[33mNO-OP[0m in 0.00s]
[0m17:11:54.984518 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.985519 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m17:11:54.985519 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:54.985519 [debug] [Thread-1 (]: Finished running node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:11:54.986519 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m17:11:54.987436 [info ] [Thread-4 (]: 38 of 44 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.03s]
[0m17:11:54.987436 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:11:54.988459 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:11:54.988459 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:11:54.988459 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:54.988459 [info ] [Thread-1 (]: 43 of 44 START test not_null_fct_purchase_purchase_id .......................... [RUN]
[0m17:11:54.989455 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m17:11:54.989455 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:11:54.990461 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m17:11:54.990837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly exposure.dbt_carton_caps.streamlit_product_dashboard, now test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1)
[0m17:11:54.990837 [info ] [Thread-2 (]: 40 of 44 PASS not_null_dim_user_user_id ........................................ [[32mPASS[0m in 0.03s]
[0m17:11:54.990837 [info ] [Thread-4 (]: 44 of 44 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m17:11:54.991925 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m17:11:54.992456 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:11:54.992456 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:11:54.992456 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m17:11:54.993473 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m17:11:54.995481 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:11:54.995481 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:11:54.996442 [info ] [Thread-3 (]: 41 of 44 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.03s]
[0m17:11:54.998433 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:11:54.998433 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:11:54.999493 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:11:55.000462 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:11:55.001502 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:11:55.003483 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:11:55.003483 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:11:55.004359 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m17:11:55.004697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:55.004697 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:11:55.004697 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m17:11:55.004697 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:55.005746 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:55.005746 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:11:55.006465 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T221150Z"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:55.006465 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:11:55.006465 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:11:55.006465 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:55.007471 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:55.008516 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m17:11:55.009508 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:11:55.009508 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m17:11:55.009508 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:11:55.010475 [info ] [Thread-1 (]: 43 of 44 PASS not_null_fct_purchase_purchase_id ................................ [[32mPASS[0m in 0.02s]
[0m17:11:55.011312 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m17:11:55.011629 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:11:55.011629 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m17:11:55.012449 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m17:11:55.012449 [info ] [Thread-4 (]: 44 of 44 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.02s]
[0m17:11:55.012449 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:11:55.013494 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:55.013494 [debug] [MainThread]: On master: BEGIN
[0m17:11:55.014461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:55.014461 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:55.014461 [debug] [MainThread]: On master: COMMIT
[0m17:11:55.014461 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:55.015445 [debug] [MainThread]: On master: COMMIT
[0m17:11:55.015445 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:55.015445 [debug] [MainThread]: On master: Close
[0m17:11:55.015445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:55.015445 [debug] [MainThread]: Connection 'create_carton_caps_20260203T221150Z_main' was properly closed.
[0m17:11:55.016478 [debug] [MainThread]: Connection 'list_carton_caps_20260203T221150Z_main' was properly closed.
[0m17:11:55.016478 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1' was properly closed.
[0m17:11:55.016478 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3' was properly closed.
[0m17:11:55.016478 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278' was properly closed.
[0m17:11:55.016478 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a' was properly closed.
[0m17:11:55.016478 [info ] [MainThread]: 
[0m17:11:55.017477 [info ] [MainThread]: Finished running 2 exposures, 6 table models, 30 data tests, 6 view models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m17:11:55.020404 [debug] [MainThread]: Command end result
[0m17:11:55.034417 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:11:55.036463 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:11:55.040479 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\run_results.json
[0m17:11:55.040479 [info ] [MainThread]: 
[0m17:11:55.040479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:55.040479 [info ] [MainThread]: 
[0m17:11:55.041438 [info ] [MainThread]: Done. PASS=42 WARN=0 ERROR=0 SKIP=0 NO-OP=2 TOTAL=44
[0m17:11:55.041438 [debug] [MainThread]: Command `dbt build` succeeded at 17:11:55.041438 after 2.24 seconds
[0m17:11:55.041438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191BC916810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C3898920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191BF95A720>]}
[0m17:11:55.042426 [debug] [MainThread]: Flushing usage events
[0m17:11:55.471325 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:56.955816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EBDE1EAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EBD22D640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EBD22CD10>]}


============================== 17:11:56.962744 | ab0ee2ee-6f5b-45b4-a982-e5e5440ca4c2 ==============================
[0m17:11:56.962744 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:11:56.962744 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt test --profiles-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps --project-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m17:11:57.101645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab0ee2ee-6f5b-45b4-a982-e5e5440ca4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EBDC79400>]}
[0m17:11:57.142449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab0ee2ee-6f5b-45b4-a982-e5e5440ca4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EBE43B860>]}
[0m17:11:57.143311 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:11:57.296044 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:11:57.407173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:11:57.407173 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:11:57.407173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:11:57.434923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab0ee2ee-6f5b-45b4-a982-e5e5440ca4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EBF7CD970>]}
[0m17:11:57.501441 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:11:57.502444 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:11:57.524211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab0ee2ee-6f5b-45b4-a982-e5e5440ca4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EBFE61A30>]}
[0m17:11:57.524211 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:11:57.524211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab0ee2ee-6f5b-45b4-a982-e5e5440ca4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EBFB16B70>]}
[0m17:11:57.526217 [info ] [MainThread]: 
[0m17:11:57.526217 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:11:57.526217 [info ] [MainThread]: 
[0m17:11:57.526217 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:11:57.528223 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T221150Z_main'
[0m17:11:57.558083 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T221150Z_main"
[0m17:11:57.558083 [debug] [ThreadPool]: On list_carton_caps_20260203T221150Z_main: BEGIN
[0m17:11:57.558083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:57.589657 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:11:57.589657 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T221150Z_main"
[0m17:11:57.589657 [debug] [ThreadPool]: On list_carton_caps_20260203T221150Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T221150Z_main"} */
select
      'carton_caps_20260203T221150Z' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps_20260203t221150z'
  
[0m17:11:57.600471 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:11:57.602476 [debug] [ThreadPool]: On list_carton_caps_20260203T221150Z_main: ROLLBACK
[0m17:11:57.602476 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_20260203T221150Z_main'
[0m17:11:57.602476 [debug] [ThreadPool]: On list_carton_caps_20260203T221150Z_main: Close
[0m17:11:57.602476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab0ee2ee-6f5b-45b4-a982-e5e5440ca4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EBF992A80>]}
[0m17:11:57.602476 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:57.602476 [debug] [MainThread]: On master: BEGIN
[0m17:11:57.605656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:57.605656 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:57.605656 [debug] [MainThread]: On master: COMMIT
[0m17:11:57.605656 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:57.605656 [debug] [MainThread]: On master: COMMIT
[0m17:11:57.605656 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:57.605656 [debug] [MainThread]: On master: Close
[0m17:11:57.607663 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:11:57.607663 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:11:57.610238 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:11:57.610238 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:11:57.607663 [info ] [Thread-1 (]: 1 of 30 START test not_null_dim_product_product_id ............................. [RUN]
[0m17:11:57.610238 [info ] [Thread-2 (]: 2 of 30 START test not_null_dim_school_school_id ............................... [RUN]
[0m17:11:57.610857 [info ] [Thread-3 (]: 3 of 30 START test not_null_dim_user_user_id ................................... [RUN]
[0m17:11:57.610857 [info ] [Thread-4 (]: 4 of 30 START test not_null_fct_purchase_purchase_id ........................... [RUN]
[0m17:11:57.610857 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:11:57.610857 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:11:57.610857 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:11:57.610857 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:11:57.610857 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:11:57.610857 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:11:57.610857 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:11:57.610857 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:11:57.622287 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:11:57.622287 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:11:57.628069 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:11:57.628069 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:11:57.628069 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:11:57.636704 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:11:57.636704 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:11:57.636704 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:11:57.636704 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:11:57.636704 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:11:57.636704 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:11:57.636704 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:11:57.636704 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:11:57.636704 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:11:57.636704 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m17:11:57.636704 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m17:11:57.636704 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:11:57.636704 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:11:57.636704 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:11:57.636704 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m17:11:57.636704 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:11:57.636704 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:11:57.636704 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m17:11:57.636704 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.636704 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.636704 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:11:57.636704 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.636704 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:11:57.636704 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:11:57.636704 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:11:57.636704 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T221150Z"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.636704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.636704 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:11:57.636704 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T221150Z"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.636704 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T221150Z"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.636704 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T221150Z"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.652533 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.652533 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.652533 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:11:57.652533 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.655711 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m17:11:57.655711 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m17:11:57.655711 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m17:11:57.655711 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m17:11:57.655711 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:11:57.655711 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:11:57.655711 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:11:57.655711 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:11:57.655711 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m17:11:57.655711 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m17:11:57.655711 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m17:11:57.655711 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m17:11:57.655711 [info ] [Thread-2 (]: 2 of 30 PASS not_null_dim_school_school_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:11:57.655711 [info ] [Thread-4 (]: 4 of 30 PASS not_null_fct_purchase_purchase_id ................................. [[32mPASS[0m in 0.04s]
[0m17:11:57.655711 [info ] [Thread-1 (]: 1 of 30 PASS not_null_dim_product_product_id ................................... [[32mPASS[0m in 0.04s]
[0m17:11:57.655711 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:11:57.655711 [info ] [Thread-3 (]: 3 of 30 PASS not_null_dim_user_user_id ......................................... [[32mPASS[0m in 0.04s]
[0m17:11:57.655711 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:11:57.655711 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:11:57.655711 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:11:57.655711 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:11:57.655711 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:11:57.655711 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:11:57.655711 [info ] [Thread-2 (]: 5 of 30 START test not_null_fct_referral_referral_id ........................... [RUN]
[0m17:11:57.655711 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:11:57.655711 [info ] [Thread-4 (]: 6 of 30 START test not_null_fct_rewards_reward_id .............................. [RUN]
[0m17:11:57.655711 [info ] [Thread-1 (]: 7 of 30 START test not_null_stg_events_event_id ................................ [RUN]
[0m17:11:57.655711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m17:11:57.655711 [info ] [Thread-3 (]: 8 of 30 START test not_null_stg_events_user_id ................................. [RUN]
[0m17:11:57.655711 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m17:11:57.655711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m17:11:57.655711 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:11:57.655711 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m17:11:57.655711 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:11:57.655711 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:11:57.669369 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:11:57.669369 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:11:57.672369 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:11:57.674366 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:11:57.676391 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:11:57.676391 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:11:57.678394 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:11:57.679392 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:11:57.679392 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:11:57.679392 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:11:57.709501 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:11:57.709875 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:11:57.711881 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:11:57.711881 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:11:57.712881 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m17:11:57.712881 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:57.712881 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:11:57.713880 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m17:11:57.713880 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:11:57.713880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:57.713880 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m17:11:57.714879 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.714879 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:11:57.715880 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:57.715880 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:11:57.715880 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.715880 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m17:11:57.716879 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T221150Z"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.716879 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:11:57.716879 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.716879 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:57.717879 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps_20260203T221150Z"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.717879 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:11:57.717879 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.717879 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.718880 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T221150Z"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.718880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.718880 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:11:57.719879 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m17:11:57.719879 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps_20260203T221150Z"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.720880 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m17:11:57.720880 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m17:11:57.720880 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.722440 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m17:11:57.722440 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m17:11:57.723444 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.723444 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m17:11:57.724444 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m17:11:57.724444 [info ] [Thread-2 (]: 5 of 30 PASS not_null_fct_referral_referral_id ................................. [[32mPASS[0m in 0.07s]
[0m17:11:57.725444 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m17:11:57.725444 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m17:11:57.726444 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:11:57.726444 [info ] [Thread-1 (]: 7 of 30 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.07s]
[0m17:11:57.726444 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m17:11:57.727444 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m17:11:57.727444 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:11:57.727444 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:11:57.727444 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m17:11:57.728444 [info ] [Thread-3 (]: 8 of 30 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.07s]
[0m17:11:57.728444 [info ] [Thread-2 (]: 9 of 30 START test not_null_stg_products_product_id ............................ [RUN]
[0m17:11:57.728444 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:11:57.729444 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:11:57.729444 [info ] [Thread-4 (]: 6 of 30 PASS not_null_fct_rewards_reward_id .................................... [[32mPASS[0m in 0.07s]
[0m17:11:57.729444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m17:11:57.730444 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:11:57.729444 [info ] [Thread-1 (]: 10 of 30 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m17:11:57.730444 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:11:57.731444 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:11:57.731444 [info ] [Thread-3 (]: 11 of 30 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m17:11:57.731444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m17:11:57.731444 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:11:57.734443 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:11:57.734443 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m17:11:57.734443 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:11:57.734443 [info ] [Thread-4 (]: 12 of 30 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m17:11:57.735443 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:11:57.737446 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:11:57.737446 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m17:11:57.739442 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:11:57.740443 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:11:57.740443 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:11:57.741444 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:11:57.743446 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:11:57.744444 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:11:57.745445 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:11:57.745445 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:11:57.747443 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:11:57.747443 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:11:57.749445 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:11:57.749445 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:11:57.749445 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m17:11:57.750444 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:11:57.750444 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:57.750444 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:11:57.750444 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m17:11:57.751445 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:11:57.751445 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m17:11:57.751445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:57.752444 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.752444 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m17:11:57.752444 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:57.752444 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:11:57.752444 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:57.753482 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.753482 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T221150Z"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.753482 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.753482 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:11:57.754482 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.754482 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:11:57.754482 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T221150Z"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.755482 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:11:57.755482 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.755482 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T221150Z"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.755482 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T221150Z"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.756483 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m17:11:57.756483 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.757482 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m17:11:57.757482 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.758482 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.758482 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m17:11:57.759482 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m17:11:57.759482 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m17:11:57.760483 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m17:11:57.761483 [info ] [Thread-2 (]: 9 of 30 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.03s]
[0m17:11:57.761483 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m17:11:57.762482 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m17:11:57.762482 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m17:11:57.763482 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:11:57.763482 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m17:11:57.763482 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m17:11:57.763482 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m17:11:57.763482 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:11:57.764482 [info ] [Thread-1 (]: 10 of 30 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.03s]
[0m17:11:57.764482 [info ] [Thread-3 (]: 11 of 30 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.03s]
[0m17:11:57.765482 [info ] [Thread-4 (]: 12 of 30 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.03s]
[0m17:11:57.765482 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:11:57.765482 [info ] [Thread-2 (]: 13 of 30 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m17:11:57.765482 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:11:57.766482 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:11:57.766482 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:11:57.766482 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m17:11:57.766482 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:11:57.767482 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:11:57.767482 [info ] [Thread-1 (]: 14 of 30 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m17:11:57.767482 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:11:57.767482 [info ] [Thread-3 (]: 15 of 30 START test not_null_stg_schools_school_id ............................. [RUN]
[0m17:11:57.768482 [info ] [Thread-4 (]: 16 of 30 START test not_null_stg_users_school_id ............................... [RUN]
[0m17:11:57.768482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m17:11:57.770480 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:11:57.770480 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m17:11:57.771482 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m17:11:57.771482 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:11:57.771482 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:11:57.771482 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:11:57.774484 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:11:57.776480 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:11:57.776480 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:11:57.778483 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:11:57.779481 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:11:57.780482 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:11:57.781482 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:11:57.781482 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:11:57.783482 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:11:57.783482 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:11:57.783482 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:11:57.783482 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m17:11:57.783482 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:11:57.783482 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:11:57.783482 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:57.783482 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:11:57.783482 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m17:11:57.783482 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m17:11:57.783482 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.783482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:57.783482 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:11:57.783482 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:57.783482 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:11:57.783482 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m17:11:57.783482 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.783482 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T221150Z"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.783482 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.783482 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:57.783482 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:11:57.783482 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:11:57.783482 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps_20260203T221150Z"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.783482 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T221150Z"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.783482 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.783482 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.783482 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:11:57.783482 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m17:11:57.783482 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T221150Z"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.783482 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.783482 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.783482 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m17:11:57.783482 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m17:11:57.783482 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m17:11:57.783482 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m17:11:57.783482 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.783482 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m17:11:57.783482 [info ] [Thread-2 (]: 13 of 30 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.02s]
[0m17:11:57.783482 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m17:11:57.783482 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m17:11:57.783482 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m17:11:57.783482 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:11:57.783482 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m17:11:57.783482 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m17:11:57.799475 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:11:57.799475 [info ] [Thread-1 (]: 14 of 30 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.03s]
[0m17:11:57.799475 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m17:11:57.799475 [info ] [Thread-3 (]: 15 of 30 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.03s]
[0m17:11:57.799475 [info ] [Thread-2 (]: 17 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m17:11:57.799475 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:11:57.799475 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:11:57.799475 [info ] [Thread-4 (]: 16 of 30 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:11:57.799475 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m17:11:57.799475 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m17:11:57.799475 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:11:57.799475 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:11:57.799475 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:11:57.799475 [info ] [Thread-1 (]: 18 of 30 START test test_events_in_window ...................................... [RUN]
[0m17:11:57.799475 [info ] [Thread-3 (]: 19 of 30 START test unique_dim_product_product_id .............................. [RUN]
[0m17:11:57.799475 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:11:57.799475 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:11:57.799475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.test_events_in_window)
[0m17:11:57.799475 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m17:11:57.799475 [info ] [Thread-4 (]: 20 of 30 START test unique_dim_school_school_id ................................ [RUN]
[0m17:11:57.799475 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m17:11:57.799475 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:11:57.799475 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m17:11:57.809729 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m17:11:57.809729 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:11:57.809729 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:11:57.809729 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:11:57.809729 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:11:57.815484 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:11:57.815484 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m17:11:57.815484 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m17:11:57.815484 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:11:57.815484 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:11:57.815484 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:11:57.815484 [debug] [Thread-1 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m17:11:57.815484 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:11:57.815484 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:11:57.815484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:57.822396 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:11:57.822396 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m17:11:57.822396 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:11:57.822396 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:57.822396 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m17:11:57.822396 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:11:57.822396 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:57.822396 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:11:57.822396 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.822396 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:11:57.822396 [debug] [Thread-1 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps_20260203T221150Z"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m17:11:57.822396 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:11:57.822396 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.822396 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m17:11:57.822396 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T221150Z"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:11:57.822396 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:11:57.822396 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:57.822396 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:57.822396 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.822396 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m17:11:57.822396 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.822396 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.831255 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m17:11:57.831255 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:11:57.831255 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m17:11:57.831255 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:11:57.831255 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m17:11:57.831255 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:57.831255 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m17:11:57.831255 [debug] [Thread-1 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m17:11:57.831255 [info ] [Thread-2 (]: 17 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m17:11:57.831255 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m17:11:57.831255 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m17:11:57.831255 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:11:57.831255 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.831255 [debug] [Thread-1 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m17:11:57.831255 [info ] [Thread-3 (]: 19 of 30 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.03s]
[0m17:11:57.831255 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:11:57.831255 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m17:11:57.831255 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:11:57.831255 [info ] [Thread-1 (]: 18 of 30 PASS test_events_in_window ............................................ [[32mPASS[0m in 0.03s]
[0m17:11:57.831255 [info ] [Thread-2 (]: 21 of 30 START test unique_dim_user_user_id .................................... [RUN]
[0m17:11:57.831255 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m17:11:57.831255 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:11:57.831255 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m17:11:57.831255 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m17:11:57.831255 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m17:11:57.831255 [info ] [Thread-3 (]: 22 of 30 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m17:11:57.831255 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:11:57.831255 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:11:57.831255 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m17:11:57.831255 [info ] [Thread-4 (]: 20 of 30 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m17:11:57.831255 [info ] [Thread-1 (]: 23 of 30 START test unique_fct_referral_referral_id ............................ [RUN]
[0m17:11:57.843942 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:11:57.843942 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:11:57.843942 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:11:57.843942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m17:11:57.847073 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:11:57.847073 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:11:57.847073 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:11:57.847073 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:11:57.847073 [info ] [Thread-4 (]: 24 of 30 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m17:11:57.850442 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:11:57.850442 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:11:57.850442 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:11:57.850442 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m17:11:57.850442 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:11:57.850442 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:11:57.850442 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:11:57.850442 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:11:57.850442 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:11:57.850442 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:11:57.850442 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m17:11:57.850442 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:11:57.850442 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:11:57.850442 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:57.850442 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m17:11:57.850442 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:11:57.850442 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:11:57.850442 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:57.850442 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.862767 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:11:57.850442 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m17:11:57.862767 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:57.862767 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.862767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:57.862767 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:11:57.862767 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:11:57.862767 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m17:11:57.862767 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:57.862767 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.862767 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:57.862767 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.862767 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:11:57.862767 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:57.862767 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m17:11:57.862767 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.862767 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m17:11:57.862767 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:11:57.862767 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.862767 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:11:57.862767 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m17:11:57.862767 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:57.862767 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m17:11:57.862767 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m17:11:57.862767 [info ] [Thread-2 (]: 21 of 30 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.03s]
[0m17:11:57.862767 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m17:11:57.862767 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m17:11:57.862767 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:11:57.862767 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.862767 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m17:11:57.862767 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m17:11:57.862767 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:11:57.862767 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m17:11:57.862767 [info ] [Thread-1 (]: 23 of 30 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.02s]
[0m17:11:57.862767 [info ] [Thread-3 (]: 22 of 30 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.03s]
[0m17:11:57.862767 [info ] [Thread-2 (]: 25 of 30 START test unique_stg_events_event_id ................................. [RUN]
[0m17:11:57.862767 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m17:11:57.862767 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:11:57.862767 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:11:57.862767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m17:11:57.878429 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m17:11:57.878429 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:11:57.878429 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:11:57.878429 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:11:57.879536 [info ] [Thread-4 (]: 24 of 30 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:11:57.879536 [info ] [Thread-1 (]: 26 of 30 START test unique_stg_products_product_id ............................. [RUN]
[0m17:11:57.879536 [info ] [Thread-3 (]: 27 of 30 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m17:11:57.882539 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:11:57.882539 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:11:57.882539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m17:11:57.882539 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m17:11:57.883536 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:11:57.883536 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:11:57.883536 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:11:57.883536 [info ] [Thread-4 (]: 28 of 30 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m17:11:57.884537 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:11:57.886535 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:11:57.888538 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:11:57.888538 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m17:11:57.890538 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:11:57.890538 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:11:57.892536 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:11:57.892536 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:11:57.892536 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:11:57.892536 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:11:57.892536 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:11:57.892536 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:11:57.892536 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:11:57.892536 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m17:11:57.899279 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:11:57.901126 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:11:57.901126 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:11:57.901126 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:57.901126 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m17:11:57.901126 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m17:11:57.901126 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:57.901126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:57.901126 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:11:57.901126 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.901126 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m17:11:57.901126 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.901126 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:11:57.901126 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:57.901126 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:57.901126 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:11:57.901126 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:57.908170 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:11:57.908170 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:57.908170 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.908170 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:57.908170 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:11:57.908170 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:57.908170 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.908170 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m17:11:57.908170 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:11:57.908170 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:11:57.908170 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m17:11:57.908170 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:11:57.908170 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m17:11:57.908170 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m17:11:57.908170 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m17:11:57.908170 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m17:11:57.908170 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m17:11:57.908170 [info ] [Thread-1 (]: 26 of 30 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m17:11:57.908170 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m17:11:57.908170 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m17:11:57.908170 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m17:11:57.908170 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:11:57.908170 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m17:11:57.908170 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m17:11:57.908170 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:11:57.908170 [info ] [Thread-3 (]: 27 of 30 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.03s]
[0m17:11:57.908170 [info ] [Thread-2 (]: 25 of 30 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.05s]
[0m17:11:57.908170 [info ] [Thread-4 (]: 28 of 30 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.02s]
[0m17:11:57.908170 [info ] [Thread-1 (]: 29 of 30 START test unique_stg_schools_school_id ............................... [RUN]
[0m17:11:57.908170 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:11:57.908170 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:11:57.908170 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:11:57.922315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m17:11:57.922315 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:11:57.922315 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:11:57.922315 [info ] [Thread-3 (]: 30 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m17:11:57.924061 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:11:57.924061 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m17:11:57.926092 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:11:57.928030 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:11:57.928030 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:11:57.928030 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:11:57.928030 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:11:57.928030 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:11:57.928030 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:11:57.928030 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m17:11:57.928030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:57.928030 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:11:57.928030 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m17:11:57.928030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.928030 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:57.928030 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:11:57.928030 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:57.928030 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.928030 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:11:57.928030 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T221150Z"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:57.928030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.928030 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m17:11:57.928030 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:57.928030 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m17:11:57.928030 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m17:11:57.928030 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m17:11:57.928030 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m17:11:57.928030 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m17:11:57.928030 [info ] [Thread-1 (]: 29 of 30 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.01s]
[0m17:11:57.928030 [info ] [Thread-3 (]: 30 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.00s]
[0m17:11:57.939762 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:11:57.939762 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:11:57.939762 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:57.939762 [debug] [MainThread]: On master: BEGIN
[0m17:11:57.939762 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:57.939762 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:57.939762 [debug] [MainThread]: On master: COMMIT
[0m17:11:57.939762 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:57.939762 [debug] [MainThread]: On master: COMMIT
[0m17:11:57.939762 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:57.939762 [debug] [MainThread]: On master: Close
[0m17:11:57.939762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:57.939762 [debug] [MainThread]: Connection 'list_carton_caps_20260203T221150Z_main' was properly closed.
[0m17:11:57.939762 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6' was properly closed.
[0m17:11:57.939762 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438' was properly closed.
[0m17:11:57.939762 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m17:11:57.939762 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d' was properly closed.
[0m17:11:57.939762 [info ] [MainThread]: 
[0m17:11:57.939762 [info ] [MainThread]: Finished running 30 data tests in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m17:11:57.939762 [debug] [MainThread]: Command end result
[0m17:11:57.955441 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:11:57.955441 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:11:57.955441 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\run_results.json
[0m17:11:57.955441 [info ] [MainThread]: 
[0m17:11:57.955441 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:57.955441 [info ] [MainThread]: 
[0m17:11:57.955441 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=30
[0m17:11:57.955441 [debug] [MainThread]: Command `dbt test` succeeded at 17:11:57.955441 after 1.09 seconds
[0m17:11:57.955441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EBFE980E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EBDCA3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EBDCA05C0>]}
[0m17:11:57.955441 [debug] [MainThread]: Flushing usage events
[0m17:11:58.269122 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:21:54.076728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C19639BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C17362270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1963A7E0>]}


============================== 17:21:54.080733 | dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b ==============================
[0m17:21:54.080733 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:21:54.080733 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt build --profiles-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps --project-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m17:21:54.228744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1AD4C920>]}
[0m17:21:54.265837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C19A13860>]}
[0m17:21:54.265837 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:21:54.418211 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:21:54.484699 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:21:54.485700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C19639580>]}
[0m17:21:55.330198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1B8C8500>]}
[0m17:21:55.377576 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:21:55.377576 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:21:55.414577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1B88E900>]}
[0m17:21:55.414577 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:21:55.417581 [info ] [MainThread]: 
[0m17:21:55.417581 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:21:55.417581 [info ] [MainThread]: 
[0m17:21:55.417581 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:21:55.417581 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T222151Z'
[0m17:21:55.501795 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T222151Z"
[0m17:21:55.501795 [debug] [ThreadPool]: On list_carton_caps_20260203T222151Z: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T222151Z"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps_20260203t222151z"'
    
  
  
[0m17:21:55.502795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:55.519457 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m17:21:55.520458 [debug] [ThreadPool]: On list_carton_caps_20260203T222151Z: Close
[0m17:21:55.521345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_carton_caps_20260203T222151Z, now create_carton_caps_20260203T222151Z_main)
[0m17:21:55.521345 [debug] [ThreadPool]: Creating schema "database: "carton_caps_20260203T222151Z"
schema: "main"
"
[0m17:21:55.521345 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T222151Z_main"
[0m17:21:55.521345 [debug] [ThreadPool]: On create_carton_caps_20260203T222151Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_20260203T222151Z_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='carton_caps_20260203t222151z'
        and type='sqlite'
    
  
[0m17:21:55.521345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:55.521345 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:21:55.521345 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T222151Z_main"
[0m17:21:55.521345 [debug] [ThreadPool]: On create_carton_caps_20260203T222151Z_main: BEGIN
[0m17:21:55.521345 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:21:55.528343 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T222151Z_main"
[0m17:21:55.528343 [debug] [ThreadPool]: On create_carton_caps_20260203T222151Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_20260203T222151Z_main"} */

    
    
        create schema if not exists "carton_caps_20260203T222151Z"."main"
    
[0m17:21:55.528654 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:21:55.528654 [debug] [ThreadPool]: On create_carton_caps_20260203T222151Z_main: COMMIT
[0m17:21:55.528654 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T222151Z_main"
[0m17:21:55.529668 [debug] [ThreadPool]: On create_carton_caps_20260203T222151Z_main: COMMIT
[0m17:21:55.529668 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:21:55.529668 [debug] [ThreadPool]: On create_carton_caps_20260203T222151Z_main: Close
[0m17:21:55.530668 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T222151Z_main'
[0m17:21:55.533957 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T222151Z_main"
[0m17:21:55.533957 [debug] [ThreadPool]: On list_carton_caps_20260203T222151Z_main: BEGIN
[0m17:21:55.534956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:55.535259 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:21:55.535259 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T222151Z_main"
[0m17:21:55.535259 [debug] [ThreadPool]: On list_carton_caps_20260203T222151Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T222151Z_main"} */
select
      'carton_caps_20260203T222151Z' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps_20260203t222151z'
  
[0m17:21:55.543789 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:21:55.544788 [debug] [ThreadPool]: On list_carton_caps_20260203T222151Z_main: ROLLBACK
[0m17:21:55.545934 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_20260203T222151Z_main'
[0m17:21:55.545934 [debug] [ThreadPool]: On list_carton_caps_20260203T222151Z_main: Close
[0m17:21:55.545934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1B80B440>]}
[0m17:21:55.546936 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:55.546936 [debug] [MainThread]: On master: BEGIN
[0m17:21:55.546936 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:55.546936 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:21:55.546936 [debug] [MainThread]: On master: COMMIT
[0m17:21:55.547936 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:55.547936 [debug] [MainThread]: On master: COMMIT
[0m17:21:55.547936 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:21:55.547936 [debug] [MainThread]: On master: Close
[0m17:21:55.550438 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_events
[0m17:21:55.550438 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.stg_products
[0m17:21:55.551439 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.stg_purchases
[0m17:21:55.551439 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.stg_referrals
[0m17:21:55.551439 [info ] [Thread-1 (]: 1 of 44 START sql view model main.stg_events ................................... [RUN]
[0m17:21:55.551439 [info ] [Thread-2 (]: 2 of 44 START sql view model main.stg_products ................................. [RUN]
[0m17:21:55.552438 [info ] [Thread-3 (]: 3 of 44 START sql view model main.stg_purchases ................................ [RUN]
[0m17:21:55.552438 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_events'
[0m17:21:55.552438 [info ] [Thread-4 (]: 4 of 44 START sql view model main.stg_referrals ................................ [RUN]
[0m17:21:55.553439 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_products'
[0m17:21:55.553439 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_purchases'
[0m17:21:55.553439 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_events
[0m17:21:55.554438 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_referrals'
[0m17:21:55.554438 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.stg_products
[0m17:21:55.554438 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.stg_purchases
[0m17:21:55.558372 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_events"
[0m17:21:55.558372 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.stg_referrals
[0m17:21:55.559875 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_products"
[0m17:21:55.561880 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_purchases"
[0m17:21:55.562880 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_referrals"
[0m17:21:55.564064 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_events
[0m17:21:55.569989 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_events"
[0m17:21:55.569989 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.stg_products
[0m17:21:55.569989 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_products"
[0m17:21:55.569989 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.stg_referrals
[0m17:21:55.584821 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_referrals"
[0m17:21:55.584821 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:21:55.584821 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.stg_purchases
[0m17:21:55.584821 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: BEGIN
[0m17:21:55.584821 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_purchases"
[0m17:21:55.584821 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:21:55.584821 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:21:55.584821 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:21:55.584821 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: BEGIN
[0m17:21:55.584821 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: BEGIN
[0m17:21:55.584821 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.584821 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:21:55.584821 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:21:55.584821 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:21:55.584821 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:21:55.584821 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

  
  create view "carton_caps_20260203T222151Z"."main"."stg_events__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T222151Z"."raw"."events"
)
select
  cast(event_id as integer) as event_id,
  cast(user_id as integer) as user_id,
  cast(event_type as varchar) as event_type,
  cast(event_at as timestamp) as event_at,
  cast(referral_id as integer) as referral_id,
  cast(metadata_json as varchar) as metadata_json
from src
  );

[0m17:21:55.584821 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.584821 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: BEGIN
[0m17:21:55.584821 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.584821 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:21:55.584821 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:21:55.584821 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:21:55.584821 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:21:55.584821 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

  
  create view "carton_caps_20260203T222151Z"."main"."stg_referrals__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T222151Z"."raw"."referrals"
)
select
  cast(referral_id as integer) as referral_id,
  cast(referrer_user_id as integer) as referrer_user_id,
  lower(cast(referred_email as varchar)) as referred_email,
  cast(referred_user_id as integer) as referred_user_id,
  cast(referral_code as varchar) as referral_code,
  cast(sent_at as timestamp) as sent_at,
  cast(converted_at as timestamp) as converted_at,
  cast(status as varchar) as status
from src
  );

[0m17:21:55.596319 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:21:55.596319 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

  
  create view "carton_caps_20260203T222151Z"."main"."stg_products__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T222151Z"."raw"."products"
)
select
  cast(product_id as integer) as product_id,
  cast(name as varchar) as name,
  cast(category as varchar) as category,
  cast(price as double) as price,
  cast(points_per_dollar as integer) as points_per_dollar,
  cast(created_at as timestamp) as created_at
from src
  );

[0m17:21:55.596319 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:21:55.596319 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */
alter view "carton_caps_20260203T222151Z"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m17:21:55.596319 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.596319 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:21:55.596319 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:21:55.600640 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:21:55.600640 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.600640 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

  
  create view "carton_caps_20260203T222151Z"."main"."stg_purchases__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T222151Z"."raw"."purchases"
)
select
  cast(purchase_id as integer) as purchase_id,
  cast(user_id as integer) as user_id,
  cast(product_id as integer) as product_id,
  cast(quantity as integer) as quantity,
  cast(price_paid as double) as price_paid,
  cast(points_earned as integer) as points_earned,
  cast(purchased_at as timestamp) as purchased_at,
  cast(day_of_week as varchar) as day_of_week,
  cast(hour_of_day as integer) as hour_of_day
from src
  );

[0m17:21:55.600640 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:21:55.600640 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */
alter view "carton_caps_20260203T222151Z"."main"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m17:21:55.609254 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m17:21:55.609254 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */
alter view "carton_caps_20260203T222151Z"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m17:21:55.609254 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:21:55.610257 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:21:55.610257 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.611665 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:21:55.612669 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m17:21:55.612669 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.613669 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m17:21:55.613669 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */
alter view "carton_caps_20260203T222151Z"."main"."stg_purchases__dbt_tmp" rename to "stg_purchases"
[0m17:21:55.614671 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m17:21:55.614671 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:21:55.614671 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:21:55.615670 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m17:21:55.615670 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.615670 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m17:21:55.616670 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m17:21:55.616670 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:21:55.617670 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.617670 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:21:55.620673 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:21:55.621675 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:21:55.621675 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:21:55.622674 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m17:21:55.622674 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

      drop view if exists "carton_caps_20260203T222151Z"."main"."stg_events__dbt_backup" cascade
    
[0m17:21:55.622674 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

      drop view if exists "carton_caps_20260203T222151Z"."main"."stg_referrals__dbt_backup" cascade
    
[0m17:21:55.624671 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:21:55.625673 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

      drop view if exists "carton_caps_20260203T222151Z"."main"."stg_products__dbt_backup" cascade
    
[0m17:21:55.625673 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.625673 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.625673 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: Close
[0m17:21:55.625673 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.625673 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:21:55.625673 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:21:55.625673 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: Close
[0m17:21:55.625673 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: Close
[0m17:21:55.625673 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

      drop view if exists "carton_caps_20260203T222151Z"."main"."stg_purchases__dbt_backup" cascade
    
[0m17:21:55.625673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1BE0F2F0>]}
[0m17:21:55.625673 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1B393140>]}
[0m17:21:55.625673 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1B3436E0>]}
[0m17:21:55.625673 [info ] [Thread-1 (]: 1 of 44 OK created sql view model main.stg_events .............................. [[32mOK[0m in 0.07s]
[0m17:21:55.625673 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.625673 [info ] [Thread-2 (]: 2 of 44 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.07s]
[0m17:21:55.625673 [info ] [Thread-4 (]: 4 of 44 OK created sql view model main.stg_referrals ........................... [[32mOK[0m in 0.07s]
[0m17:21:55.625673 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_events
[0m17:21:55.625673 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: Close
[0m17:21:55.625673 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.stg_products
[0m17:21:55.625673 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.stg_referrals
[0m17:21:55.625673 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_schools
[0m17:21:55.625673 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1B8CB320>]}
[0m17:21:55.625673 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.stg_users
[0m17:21:55.625673 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:21:55.625673 [info ] [Thread-1 (]: 5 of 44 START sql view model main.stg_schools .................................. [RUN]
[0m17:21:55.625673 [info ] [Thread-3 (]: 3 of 44 OK created sql view model main.stg_purchases ........................... [[32mOK[0m in 0.07s]
[0m17:21:55.625673 [info ] [Thread-2 (]: 6 of 44 START sql view model main.stg_users .................................... [RUN]
[0m17:21:55.625673 [info ] [Thread-4 (]: 7 of 44 START test not_null_stg_events_event_id ................................ [RUN]
[0m17:21:55.625673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_events, now model.dbt_carton_caps.stg_schools)
[0m17:21:55.625673 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.stg_purchases
[0m17:21:55.625673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_products, now model.dbt_carton_caps.stg_users)
[0m17:21:55.625673 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_referrals, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m17:21:55.625673 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_schools
[0m17:21:55.625673 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:21:55.625673 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.stg_users
[0m17:21:55.625673 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:21:55.641525 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_schools"
[0m17:21:55.641525 [info ] [Thread-3 (]: 8 of 44 START test not_null_stg_events_user_id ................................. [RUN]
[0m17:21:55.641525 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_users"
[0m17:21:55.650354 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:21:55.650354 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_purchases, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m17:21:55.650354 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:21:55.650354 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:21:55.650354 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_schools
[0m17:21:55.650354 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_schools"
[0m17:21:55.650354 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:21:55.657610 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:21:55.667184 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:21:55.667184 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.stg_users
[0m17:21:55.667184 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_users"
[0m17:21:55.666318 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:21:55.667184 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:21:55.667184 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m17:21:55.667184 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:55.667184 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:21:55.667184 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: BEGIN
[0m17:21:55.667184 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:55.667184 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.667184 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:21:55.667184 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T222151Z"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:55.667184 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.667184 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:21:55.667184 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:21:55.667184 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.667184 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:21:55.667184 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

  
  create view "carton_caps_20260203T222151Z"."main"."stg_users__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T222151Z"."raw"."users"
)
select
  cast(user_id as integer) as user_id,
  cast(first_name as varchar) as first_name,
  cast(last_name as varchar) as last_name,
  lower(cast(email as varchar)) as email,
  cast(school_id as integer) as school_id,
  cast(created_at as timestamp) as created_at,
  cast(user_type as varchar) as user_type,
  cast(is_verified as integer) as is_verified,
  cast(device_id as varchar) as device_id,
  cast(marketing_channel as varchar) as marketing_channel
from src
  );

[0m17:21:55.667184 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m17:21:55.667184 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: BEGIN
[0m17:21:55.667184 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m17:21:55.678301 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:55.678301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:55.678301 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.678301 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m17:21:55.678301 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:21:55.678301 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:21:55.681957 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m17:21:55.681957 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */
alter view "carton_caps_20260203T222151Z"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:21:55.681957 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:21:55.681957 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:21:55.683238 [info ] [Thread-3 (]: 8 of 44 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m17:21:55.683238 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:21:55.683238 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.684242 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps_20260203T222151Z"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:55.684242 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:21:55.684242 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

  
  create view "carton_caps_20260203T222151Z"."main"."stg_schools__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T222151Z"."raw"."schools"
)
select
  cast(school_id as integer) as school_id,
  cast(name as varchar) as name,
  cast(address as varchar) as address,
  cast(city as varchar) as city,
  cast(state as varchar) as state,
  cast(zip_code as varchar) as zip_code,
  cast(created_at as timestamp) as created_at
from src
  );

[0m17:21:55.685243 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m17:21:55.685243 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m17:21:55.686243 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:21:55.686243 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.686243 [info ] [Thread-3 (]: 9 of 44 START test test_events_in_window ....................................... [RUN]
[0m17:21:55.686243 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.687242 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m17:21:55.687242 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.test_events_in_window)
[0m17:21:55.688242 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m17:21:55.689616 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:21:55.689616 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m17:21:55.690714 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */
alter view "carton_caps_20260203T222151Z"."main"."stg_schools__dbt_tmp" rename to "stg_schools"
[0m17:21:55.690714 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m17:21:55.692714 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m17:21:55.692714 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:21:55.692714 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m17:21:55.694715 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:21:55.695085 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.695085 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

      drop view if exists "carton_caps_20260203T222151Z"."main"."stg_users__dbt_backup" cascade
    
[0m17:21:55.695085 [info ] [Thread-4 (]: 7 of 44 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.07s]
[0m17:21:55.696225 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m17:21:55.697224 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m17:21:55.697224 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:21:55.698226 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m17:21:55.699224 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.699224 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:21:55.699224 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:21:55.700225 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: Close
[0m17:21:55.700225 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m17:21:55.700225 [info ] [Thread-4 (]: 10 of 44 START test unique_stg_events_event_id ................................. [RUN]
[0m17:21:55.701224 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:21:55.701224 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1B68B590>]}
[0m17:21:55.701922 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m17:21:55.701922 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m17:21:55.701922 [info ] [Thread-2 (]: 6 of 44 OK created sql view model main.stg_users ............................... [[32mOK[0m in 0.08s]
[0m17:21:55.703056 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.703056 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:21:55.703056 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:55.703056 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.stg_users
[0m17:21:55.705057 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:21:55.708459 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:21:55.708870 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:21:55.709182 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

      drop view if exists "carton_caps_20260203T222151Z"."main"."stg_schools__dbt_backup" cascade
    
[0m17:21:55.709182 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:21:55.709182 [info ] [Thread-2 (]: 11 of 44 START test not_null_stg_products_product_id ........................... [RUN]
[0m17:21:55.710186 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:21:55.710186 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_users, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m17:21:55.710186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.710186 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps_20260203T222151Z"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m17:21:55.711187 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:21:55.711187 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:21:55.712185 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: Close
[0m17:21:55.713187 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:21:55.715817 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:21:55.716933 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:21:55.716933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1BE059D0>]}
[0m17:21:55.717931 [info ] [Thread-1 (]: 5 of 44 OK created sql view model main.stg_schools ............................. [[32mOK[0m in 0.09s]
[0m17:21:55.717931 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m17:21:55.718930 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_schools
[0m17:21:55.718930 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:21:55.719946 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m17:21:55.719946 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:21:55.719946 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:21:55.719946 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m17:21:55.720930 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m17:21:55.720930 [info ] [Thread-1 (]: 12 of 44 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m17:21:55.721931 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:21:55.722837 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:55.722837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_schools, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m17:21:55.722837 [info ] [Thread-3 (]: 9 of 44 PASS test_events_in_window ............................................. [[32mPASS[0m in 0.04s]
[0m17:21:55.723916 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:21:55.723916 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.723916 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m17:21:55.724917 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:21:55.727917 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:21:55.727917 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:21:55.727917 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:21:55.728916 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m17:21:55.728916 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:55.728916 [info ] [Thread-3 (]: 13 of 44 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m17:21:55.729704 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:55.729704 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m17:21:55.729704 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:21:55.730774 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:21:55.731774 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:21:55.731774 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:21:55.734774 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:21:55.734774 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:21:55.734774 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:21:55.735773 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m17:21:55.736651 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T222151Z"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:55.736651 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:21:55.736651 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m17:21:55.737829 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:21:55.737829 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m17:21:55.737829 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m17:21:55.738830 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:21:55.739830 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.739830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:55.739830 [info ] [Thread-4 (]: 10 of 44 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m17:21:55.740829 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m17:21:55.741829 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:21:55.741829 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.741829 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m17:21:55.742831 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:21:55.742831 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:21:55.742831 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:21:55.743592 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m17:21:55.743592 [info ] [Thread-4 (]: 14 of 44 START test unique_stg_products_product_id ............................. [RUN]
[0m17:21:55.743592 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m17:21:55.743592 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T222151Z"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:55.744715 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m17:21:55.744715 [info ] [Thread-2 (]: 11 of 44 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.03s]
[0m17:21:55.744715 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:55.745720 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:21:55.745720 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:21:55.745720 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.747721 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:21:55.748719 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:21:55.748719 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:21:55.749719 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m17:21:55.750069 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:21:55.750533 [info ] [Thread-2 (]: 15 of 44 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m17:21:55.750842 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m17:21:55.750842 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps_20260203T222151Z"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:55.750842 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:21:55.751859 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m17:21:55.751859 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m17:21:55.752859 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:21:55.753860 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:21:55.753860 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.753860 [info ] [Thread-1 (]: 12 of 44 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.03s]
[0m17:21:55.756857 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:21:55.756857 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:21:55.757478 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m17:21:55.757478 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:21:55.758550 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:21:55.758550 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m17:21:55.759549 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m17:21:55.759549 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:21:55.759549 [info ] [Thread-1 (]: 16 of 44 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m17:21:55.759549 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m17:21:55.759549 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:55.761783 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:21:55.761783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m17:21:55.761783 [info ] [Thread-3 (]: 13 of 44 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.03s]
[0m17:21:55.762781 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:21:55.762781 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:21:55.762781 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:21:55.765520 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:21:55.765520 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:21:55.765520 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:21:55.766521 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:21:55.766521 [info ] [Thread-3 (]: 17 of 44 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m17:21:55.766521 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m17:21:55.766521 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:55.767521 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m17:21:55.767521 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:55.767521 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:21:55.767521 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:21:55.769521 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:21:55.771366 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:21:55.771366 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:21:55.772406 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:21:55.772406 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:21:55.773695 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m17:21:55.773695 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:55.773695 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:21:55.773695 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:21:55.774699 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m17:21:55.776699 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:21:55.776699 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m17:21:55.777699 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:21:55.777699 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m17:21:55.777699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:55.778700 [info ] [Thread-4 (]: 14 of 44 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m17:21:55.779699 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m17:21:55.779699 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:21:55.779699 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:21:55.779699 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.780699 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m17:21:55.780699 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:21:55.780699 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m17:21:55.781699 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:21:55.781699 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m17:21:55.781699 [info ] [Thread-4 (]: 18 of 44 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m17:21:55.781699 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:55.782699 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T222151Z"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:55.782699 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m17:21:55.782699 [info ] [Thread-2 (]: 15 of 44 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m17:21:55.783699 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.783699 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:21:55.783699 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:21:55.783699 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.784699 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:21:55.786698 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:21:55.786698 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:21:55.787699 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T222151Z"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:55.787699 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m17:21:55.788701 [info ] [Thread-2 (]: 19 of 44 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m17:21:55.788701 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m17:21:55.789699 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m17:21:55.789699 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.789699 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m17:21:55.789699 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:21:55.790699 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:21:55.791699 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m17:21:55.792699 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:21:55.791699 [info ] [Thread-1 (]: 16 of 44 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.03s]
[0m17:21:55.794698 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:21:55.795699 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m17:21:55.795699 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:21:55.796699 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m17:21:55.796699 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:21:55.796699 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:21:55.796699 [info ] [Thread-3 (]: 17 of 44 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.03s]
[0m17:21:55.797699 [info ] [Thread-1 (]: 20 of 44 START test not_null_stg_users_school_id ............................... [RUN]
[0m17:21:55.797699 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m17:21:55.797699 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:21:55.797699 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:21:55.797699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m17:21:55.799152 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:55.800157 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:21:55.800157 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:21:55.800157 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:21:55.801156 [info ] [Thread-3 (]: 21 of 44 START test not_null_stg_users_user_id ................................. [RUN]
[0m17:21:55.801156 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:21:55.803157 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:21:55.804156 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m17:21:55.804156 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:21:55.804156 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:21:55.805156 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:21:55.805156 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T222151Z"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:55.807210 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:21:55.807210 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m17:21:55.807210 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:21:55.808211 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:55.809210 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:21:55.809210 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.810210 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.810210 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:21:55.811210 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m17:21:55.811210 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:21:55.813029 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:21:55.813600 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m17:21:55.813600 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:21:55.813600 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:55.813600 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m17:21:55.813600 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m17:21:55.813600 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:21:55.813600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:55.813600 [info ] [Thread-4 (]: 18 of 44 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.03s]
[0m17:21:55.813600 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m17:21:55.813600 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:21:55.813600 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.813600 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:55.813600 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:21:55.813600 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:21:55.813600 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:21:55.813600 [info ] [Thread-4 (]: 22 of 44 START test unique_stg_users_user_id ................................... [RUN]
[0m17:21:55.813600 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.819999 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m17:21:55.819999 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T222151Z"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:55.819999 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m17:21:55.821003 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:21:55.821003 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m17:21:55.822004 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:21:55.822004 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T222151Z"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:55.822004 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m17:21:55.822004 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.825005 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:21:55.825005 [info ] [Thread-2 (]: 19 of 44 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.04s]
[0m17:21:55.826003 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m17:21:55.826003 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.827003 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:21:55.827003 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m17:21:55.827003 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:21:55.828004 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m17:21:55.829003 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m17:21:55.829003 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:21:55.829003 [info ] [Thread-2 (]: 23 of 44 START test not_null_stg_schools_school_id ............................. [RUN]
[0m17:21:55.830003 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m17:21:55.833004 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:21:55.830003 [info ] [Thread-1 (]: 20 of 44 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:21:55.833004 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m17:21:55.833004 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m17:21:55.833872 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:21:55.833872 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:21:55.833872 [info ] [Thread-3 (]: 21 of 44 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m17:21:55.833872 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:21:55.834948 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:21:55.836949 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:21:55.836949 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:21:55.836949 [info ] [Thread-1 (]: 24 of 44 START test unique_stg_schools_school_id ............................... [RUN]
[0m17:21:55.837948 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m17:21:55.837948 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.fct_rewards
[0m17:21:55.837948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m17:21:55.838951 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:55.838951 [info ] [Thread-3 (]: 25 of 44 START sql table model main.fct_rewards ................................ [RUN]
[0m17:21:55.838951 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:21:55.838951 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:21:55.839947 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now model.dbt_carton_caps.fct_rewards)
[0m17:21:55.841107 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:21:55.841107 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:21:55.844110 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:21:55.844110 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.fct_rewards
[0m17:21:55.844110 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:21:55.846115 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_rewards"
[0m17:21:55.846115 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:55.846115 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:21:55.846115 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:21:55.847115 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m17:21:55.847792 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:21:55.848924 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:55.848924 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.fct_rewards
[0m17:21:55.848924 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.859850 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_rewards"
[0m17:21:55.860353 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m17:21:55.860353 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:21:55.861673 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m17:21:55.861673 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:21:55.861673 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m17:21:55.861673 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T222151Z"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:55.862720 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m17:21:55.862720 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:21:55.862720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:55.863720 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m17:21:55.863720 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: BEGIN
[0m17:21:55.863720 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.864720 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.864720 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:55.864720 [info ] [Thread-4 (]: 22 of 44 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.04s]
[0m17:21:55.865720 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m17:21:55.865720 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:21:55.866720 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:21:55.867038 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.867038 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m17:21:55.867038 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:55.867038 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.dim_product
[0m17:21:55.868040 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:21:55.868040 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m17:21:55.868867 [info ] [Thread-4 (]: 26 of 44 START sql table model main.dim_product ................................ [RUN]
[0m17:21:55.868867 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

  
    
    

    create  table
      "carton_caps_20260203T222151Z"."main"."fct_rewards__dbt_tmp"
  
    as (
      with e as (
  select *
  from "carton_caps_20260203T222151Z"."main"."stg_events"
),

awards as (
  select
    referral_id,
    user_id,
    event_at as awarded_at,
    -- reward_type is inside metadata_json like {"reward_type":"referrer_bonus"}
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_awarded'
),

redeems as (
  select
    referral_id,
    user_id,
    event_at as redeemed_at,
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_redeemed'
)

select
  -- deterministic surrogate key
  md5(cast(a.referral_id as varchar) || '|' || cast(a.user_id as varchar) || '|' || coalesce(a.reward_type,'')) as reward_id,
  a.referral_id,
  a.user_id,
  a.reward_type,
  a.awarded_at,
  min(r.redeemed_at) as redeemed_at
from awards a
left join redeems r
  on a.referral_id = r.referral_id
  and a.user_id = r.user_id
  and coalesce(a.reward_type,'') = coalesce(r.reward_type,'')
group by 1,2,3,4,5
    );
  
  
[0m17:21:55.869876 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b, now model.dbt_carton_caps.dim_product)
[0m17:21:55.868867 [info ] [Thread-2 (]: 23 of 44 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.04s]
[0m17:21:55.869876 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.869876 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.dim_product
[0m17:21:55.870876 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:21:55.871875 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_product"
[0m17:21:55.872876 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m17:21:55.873875 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.fct_referral
[0m17:21:55.874875 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m17:21:55.875592 [info ] [Thread-2 (]: 27 of 44 START sql table model main.fct_referral ............................... [RUN]
[0m17:21:55.875592 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m17:21:55.875592 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now model.dbt_carton_caps.fct_referral)
[0m17:21:55.876694 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:21:55.876694 [info ] [Thread-1 (]: 24 of 44 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:21:55.876694 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.dim_product
[0m17:21:55.877694 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.fct_referral
[0m17:21:55.879051 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:21:55.879051 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:21:55.881050 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_product"
[0m17:21:55.883249 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_referral"
[0m17:21:55.883249 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */
alter table "carton_caps_20260203T222151Z"."main"."fct_rewards__dbt_tmp" rename to "fct_rewards"
[0m17:21:55.883249 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.fct_purchase
[0m17:21:55.883249 [info ] [Thread-1 (]: 28 of 44 START sql table model main.fct_purchase ............................... [RUN]
[0m17:21:55.883249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6, now model.dbt_carton_caps.fct_purchase)
[0m17:21:55.883249 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.fct_purchase
[0m17:21:55.887793 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_purchase"
[0m17:21:55.887793 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:21:55.887793 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_product: BEGIN
[0m17:21:55.887793 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.fct_referral
[0m17:21:55.887793 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:21:55.887793 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:55.890451 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_referral"
[0m17:21:55.893452 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m17:21:55.893452 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.fct_purchase
[0m17:21:55.894450 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:21:55.894450 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:21:55.896452 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_purchase"
[0m17:21:55.896452 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m17:21:55.896452 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:21:55.897452 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:21:55.897452 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

  
    
    

    create  table
      "carton_caps_20260203T222151Z"."main"."dim_product__dbt_tmp"
  
    as (
      select
  product_id,
  name,
  category,
  price,
  points_per_dollar,
  created_at
from "carton_caps_20260203T222151Z"."main"."stg_products"
    );
  
  
[0m17:21:55.897452 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: BEGIN
[0m17:21:55.898451 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:21:55.898451 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:55.898451 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: BEGIN
[0m17:21:55.899451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:55.899451 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.899451 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:21:55.899451 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.900450 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

  
    
    

    create  table
      "carton_caps_20260203T222151Z"."main"."fct_referral__dbt_tmp"
  
    as (
      with r as (
  select *
  from "carton_caps_20260203T222151Z"."main"."stg_referrals"
),

e as (
  select *
  from "carton_caps_20260203T222151Z"."main"."stg_events"
),

-- Referral-related event timestamps for referred users
ref_events as (
  select
    referral_id,
    user_id,

    min(case when event_type = 'install' then event_at end) as install_at,
    min(case when event_type = 'referral_applied' then event_at end) as referral_applied_at,
    min(case when event_type = 'onboarding_complete' then event_at end) as onboarding_completed_at,
    min(case when event_type = 'school_linked' then event_at end) as school_linked_at

  from e
  where referral_id is not null
  group by 1,2
),

-- First scan/purchase time for referred users (proxy for qualifying action)
first_purchase as (
  select
    user_id,
    min(purchased_at) as first_purchase_at
  from "carton_caps_20260203T222151Z"."main"."stg_purchases"
  group by 1
)

select
  r.referral_id,
  r.referrer_user_id,
  r.referred_email,
  r.referred_user_id,
  r.referral_code,
  r.sent_at,
  r.converted_at,
  r.status,

  re.install_at,
  re.referral_applied_at,
  re.onboarding_completed_at,
  re.school_linked_at,

  fp.first_purchase_at,

  -- qualifying action is: first_purchase OR school_linked (whichever happens first)
  least(fp.first_purchase_at, re.school_linked_at) as qualifying_action_at,

  -- window compliance (48 hours) using install -> referral_applied
  case
    when re.install_at is null or re.referral_applied_at is null then null
    when datediff('hour', re.install_at, re.referral_applied_at) <= 48 then true
    else false
  end as within_48h_window,

  -- simple eligibility (rules-compliant posture)
  case
    when r.status <> 'converted' then false
    when re.onboarding_completed_at is null then false
    when least(fp.first_purchase_at, re.school_linked_at) is null then false
    when re.install_at is null or re.referral_applied_at is null then false
    when datediff('hour', re.install_at, re.referral_applied_at) > 48 then false
    else true
  end as eligible_referral

from r
left join ref_events re
  on r.referral_id = re.referral_id
  and r.referred_user_id = re.user_id
left join first_purchase fp
  on r.referred_user_id = fp.user_id
    );
  
  
[0m17:21:55.900450 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:21:55.900450 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:21:55.900450 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:21:55.902452 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:21:55.903307 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

  
    
    

    create  table
      "carton_caps_20260203T222151Z"."main"."fct_purchase__dbt_tmp"
  
    as (
      select
  p.purchase_id,
  p.user_id,
  u.school_id,
  p.product_id,
  pr.category as product_category,
  p.quantity,
  p.price_paid,
  p.points_earned,
  p.purchased_at,
  date_trunc('day', p.purchased_at) as purchase_date,
  p.day_of_week,
  p.hour_of_day
from "carton_caps_20260203T222151Z"."main"."stg_purchases" p
left join "carton_caps_20260203T222151Z"."main"."stg_users" u
  on p.user_id = u.user_id
left join "carton_caps_20260203T222151Z"."main"."stg_products" pr
  on p.product_id = pr.product_id
    );
  
  
[0m17:21:55.904616 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:21:55.904616 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

      drop table if exists "carton_caps_20260203T222151Z"."main"."fct_rewards__dbt_backup" cascade
    
[0m17:21:55.905616 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */
alter table "carton_caps_20260203T222151Z"."main"."dim_product__dbt_tmp" rename to "dim_product"
[0m17:21:55.906616 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.907618 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: Close
[0m17:21:55.907618 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.909616 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m17:21:55.909616 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1B8C9760>]}
[0m17:21:55.910281 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:21:55.910281 [info ] [Thread-3 (]: 25 of 44 OK created sql table model main.fct_rewards ........................... [[32mOK[0m in 0.07s]
[0m17:21:55.910281 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m17:21:55.911408 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m17:21:55.911408 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.fct_rewards
[0m17:21:55.913407 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:21:55.913407 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:21:55.914408 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.dim_school
[0m17:21:55.914408 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */
alter table "carton_caps_20260203T222151Z"."main"."fct_referral__dbt_tmp" rename to "fct_referral"
[0m17:21:55.916148 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:21:55.916148 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:21:55.916148 [info ] [Thread-3 (]: 29 of 44 START sql table model main.dim_school ................................. [RUN]
[0m17:21:55.917480 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */
alter table "carton_caps_20260203T222151Z"."main"."fct_purchase__dbt_tmp" rename to "fct_purchase"
[0m17:21:55.918538 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:21:55.918538 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.918538 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_rewards, now model.dbt_carton_caps.dim_school)
[0m17:21:55.919537 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

      drop table if exists "carton_caps_20260203T222151Z"."main"."dim_product__dbt_backup" cascade
    
[0m17:21:55.920539 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m17:21:55.920539 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.920539 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.dim_school
[0m17:21:55.921537 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:21:55.921537 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m17:21:55.922539 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.924129 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_school"
[0m17:21:55.924129 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m17:21:55.924129 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:21:55.925194 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_product: Close
[0m17:21:55.925194 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m17:21:55.925999 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1B3436E0>]}
[0m17:21:55.925999 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.dim_school
[0m17:21:55.925999 [info ] [Thread-4 (]: 26 of 44 OK created sql table model main.dim_product ........................... [[32mOK[0m in 0.06s]
[0m17:21:55.929026 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_school"
[0m17:21:55.930025 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.dim_product
[0m17:21:55.930025 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:21:55.930025 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:21:55.931025 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.dim_user
[0m17:21:55.932388 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:21:55.933388 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:21:55.933388 [info ] [Thread-4 (]: 30 of 44 START sql table model main.dim_user ................................... [RUN]
[0m17:21:55.934388 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:21:55.934388 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

      drop table if exists "carton_caps_20260203T222151Z"."main"."fct_referral__dbt_backup" cascade
    
[0m17:21:55.934388 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

      drop table if exists "carton_caps_20260203T222151Z"."main"."fct_purchase__dbt_backup" cascade
    
[0m17:21:55.934388 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_product, now model.dbt_carton_caps.dim_user)
[0m17:21:55.935389 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_school: BEGIN
[0m17:21:55.935389 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.dim_user
[0m17:21:55.935389 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:55.935389 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.936388 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.938008 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_user"
[0m17:21:55.938008 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_purchase: Close
[0m17:21:55.939171 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_referral: Close
[0m17:21:55.939171 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:21:55.940171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1CEC6870>]}
[0m17:21:55.940171 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:21:55.940171 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1CE7AD50>]}
[0m17:21:55.941171 [info ] [Thread-1 (]: 28 of 44 OK created sql table model main.fct_purchase .......................... [[32mOK[0m in 0.06s]
[0m17:21:55.941171 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.dim_user
[0m17:21:55.941171 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

  
    
    

    create  table
      "carton_caps_20260203T222151Z"."main"."dim_school__dbt_tmp"
  
    as (
      select
  school_id,
  name,
  address,
  city,
  state,
  zip_code,
  created_at
from "carton_caps_20260203T222151Z"."main"."stg_schools"
    );
  
  
[0m17:21:55.942171 [info ] [Thread-2 (]: 27 of 44 OK created sql table model main.fct_referral .......................... [[32mOK[0m in 0.06s]
[0m17:21:55.942171 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.fct_purchase
[0m17:21:55.944172 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_user"
[0m17:21:55.944172 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.fct_referral
[0m17:21:55.945005 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:21:55.945005 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:21:55.945005 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.945005 [info ] [Thread-1 (]: 31 of 44 START test not_null_fct_rewards_reward_id ............................. [RUN]
[0m17:21:55.948107 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:21:55.946109 [info ] [Thread-2 (]: 32 of 44 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m17:21:55.948107 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:21:55.948107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_purchase, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m17:21:55.948107 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */
alter table "carton_caps_20260203T222151Z"."main"."dim_school__dbt_tmp" rename to "dim_school"
[0m17:21:55.949108 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_referral, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m17:21:55.949108 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_user: BEGIN
[0m17:21:55.949108 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:21:55.949108 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:21:55.950109 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:55.950109 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.951971 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:21:55.954134 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:21:55.955134 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m17:21:55.956134 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:21:55.956134 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:21:55.956134 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:21:55.957132 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:21:55.957132 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m17:21:55.957132 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:21:55.957132 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

  
    
    

    create  table
      "carton_caps_20260203T222151Z"."main"."dim_user__dbt_tmp"
  
    as (
      select
  u.user_id,
  u.first_name,
  u.last_name,
  u.email,
  u.school_id,
  s.name as school_name,
  s.state as school_state,
  u.created_at,
  u.user_type,
  u.is_verified,
  u.device_id,
  u.marketing_channel
from "carton_caps_20260203T222151Z"."main"."stg_users" u
left join "carton_caps_20260203T222151Z"."main"."stg_schools" s
  on u.school_id = s.school_id
    );
  
  
[0m17:21:55.958906 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:21:55.959988 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:21:55.960992 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:21:55.960992 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m17:21:55.961992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:55.961992 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:21:55.961992 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.963993 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:21:55.963993 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:21:55.963993 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:21:55.963993 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:21:55.964993 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

      drop table if exists "carton_caps_20260203T222151Z"."main"."dim_school__dbt_backup" cascade
    
[0m17:21:55.964993 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps_20260203T222151Z"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:55.967017 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:21:55.968017 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m17:21:55.968017 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */
alter table "carton_caps_20260203T222151Z"."main"."dim_user__dbt_tmp" rename to "dim_user"
[0m17:21:55.968017 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:21:55.969015 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:55.969015 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.970016 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_school: Close
[0m17:21:55.970016 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.970016 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.971015 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m17:21:55.971015 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1CEF7F20>]}
[0m17:21:55.972788 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m17:21:55.972788 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:21:55.972788 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m17:21:55.973860 [info ] [Thread-3 (]: 29 of 44 OK created sql table model main.dim_school ............................ [[32mOK[0m in 0.05s]
[0m17:21:55.973860 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:21:55.973860 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:55.973860 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m17:21:55.974860 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.dim_school
[0m17:21:55.974860 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m17:21:55.975861 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:21:55.974860 [info ] [Thread-1 (]: 31 of 44 PASS not_null_fct_rewards_reward_id ................................... [[32mPASS[0m in 0.03s]
[0m17:21:55.976265 [info ] [Thread-3 (]: 33 of 44 START test not_null_dim_product_product_id ............................ [RUN]
[0m17:21:55.977341 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.977341 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:21:55.977341 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_school, now test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816)
[0m17:21:55.978340 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:21:55.978340 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:21:55.979340 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m17:21:55.979737 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:21:55.980046 [info ] [Thread-1 (]: 34 of 44 START test unique_dim_product_product_id .............................. [RUN]
[0m17:21:55.981085 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:21:55.982083 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m17:21:55.984085 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:21:55.984085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m17:21:55.984085 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

      drop table if exists "carton_caps_20260203T222151Z"."main"."dim_user__dbt_backup" cascade
    
[0m17:21:55.985085 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m17:21:55.985085 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:21:55.987749 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:21:55.987749 [info ] [Thread-2 (]: 32 of 44 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:21:55.987749 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:21:55.988747 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:21:55.988747 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:21:55.989747 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_user: Close
[0m17:21:55.990749 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:21:55.990749 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:21:55.991747 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:21:55.991747 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec4fbe0-29be-4f06-a8af-7a0e5ae0a78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1B594E60>]}
[0m17:21:55.991747 [info ] [Thread-2 (]: 35 of 44 START test not_null_fct_purchase_purchase_id .......................... [RUN]
[0m17:21:55.993749 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:21:55.993749 [info ] [Thread-4 (]: 30 of 44 OK created sql table model main.dim_user .............................. [[32mOK[0m in 0.06s]
[0m17:21:55.993749 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1)
[0m17:21:55.994748 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:21:55.994748 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.dim_user
[0m17:21:55.994748 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:21:55.994748 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m17:21:55.995748 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:21:55.995748 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:21:55.997746 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:21:55.997746 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:55.998746 [info ] [Thread-4 (]: 36 of 44 START test not_null_fct_referral_referral_id .......................... [RUN]
[0m17:21:55.998746 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m17:21:55.998746 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_user, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m17:21:55.999747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:55.999747 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:55.999747 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:21:55.999747 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:21:56.000748 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:21:56.002747 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:21:56.002747 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:21:56.003747 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:21:56.004748 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T222151Z"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:56.004748 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:21:56.005747 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:21:56.005747 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:56.006747 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:21:56.006747 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:21:56.007748 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:21:56.007748 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m17:21:56.008750 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m17:21:56.008750 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:56.009750 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:21:56.009750 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:21:56.010747 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:21:56.010747 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m17:21:56.011747 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m17:21:56.011747 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:21:56.011747 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m17:21:56.012747 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m17:21:56.012747 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:21:56.012747 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:56.012747 [info ] [Thread-3 (]: 33 of 44 PASS not_null_dim_product_product_id .................................. [[32mPASS[0m in 0.04s]
[0m17:21:56.013747 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m17:21:56.013747 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T222151Z"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:56.014747 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:21:56.014747 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:21:56.014747 [info ] [Thread-1 (]: 34 of 44 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.03s]
[0m17:21:56.015747 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:21:56.015747 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:21:56.015747 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:56.015747 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:21:56.016747 [info ] [Thread-3 (]: 37 of 44 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m17:21:56.016747 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T222151Z"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:56.017748 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m17:21:56.017748 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:21:56.018748 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m17:21:56.018748 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:21:56.018748 [info ] [Thread-1 (]: 38 of 44 START test unique_fct_referral_referral_id ............................ [RUN]
[0m17:21:56.019748 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:56.019748 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:21:56.019748 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m17:21:56.019748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m17:21:56.020747 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m17:21:56.024749 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:21:56.024749 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:21:56.024749 [info ] [Thread-2 (]: 35 of 44 PASS not_null_fct_purchase_purchase_id ................................ [[32mPASS[0m in 0.03s]
[0m17:21:56.025748 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m17:21:56.027749 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:21:56.028312 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:21:56.028312 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m17:21:56.028312 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:21:56.028312 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:21:56.030451 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:21:56.030451 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:21:56.029446 [info ] [Thread-4 (]: 36 of 44 PASS not_null_fct_referral_referral_id ................................ [[32mPASS[0m in 0.03s]
[0m17:21:56.031450 [info ] [Thread-2 (]: 39 of 44 START test not_null_dim_school_school_id .............................. [RUN]
[0m17:21:56.032451 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:21:56.033450 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:21:56.033450 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1, now test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b)
[0m17:21:56.033450 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:21:56.033450 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:21:56.034451 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:21:56.034451 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m17:21:56.034451 [info ] [Thread-4 (]: 40 of 44 START test unique_dim_school_school_id ................................ [RUN]
[0m17:21:56.035264 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:21:56.037037 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:21:56.038037 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:56.038037 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m17:21:56.038037 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m17:21:56.038037 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:21:56.039037 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:56.039037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:56.039037 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:21:56.041036 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:21:56.042037 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:21:56.043607 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:21:56.043607 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:21:56.043607 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:56.043607 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:21:56.043607 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:56.045110 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:21:56.046948 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:21:56.046948 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:21:56.047999 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m17:21:56.048520 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:21:56.048520 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:21:56.049034 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m17:21:56.049034 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m17:21:56.049775 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m17:21:56.049775 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:21:56.050812 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m17:21:56.050812 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:56.051838 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m17:21:56.051324 [info ] [Thread-1 (]: 38 of 44 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.03s]
[0m17:21:56.052351 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m17:21:56.052351 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:56.052864 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:21:56.052864 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:21:56.053377 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m17:21:56.053888 [debug] [Thread-1 (]: Began running node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:21:56.053888 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:21:56.054402 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:21:56.054914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now exposure.dbt_carton_caps.streamlit_product_dashboard)
[0m17:21:56.054402 [info ] [Thread-3 (]: 37 of 44 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.04s]
[0m17:21:56.054914 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T222151Z"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:56.055427 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:21:56.055427 [debug] [Thread-1 (]: Began compiling node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:21:56.055938 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:21:56.055938 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:56.056673 [debug] [Thread-1 (]: Began executing node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:21:56.056673 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:56.057189 [debug] [Thread-3 (]: Began running node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:21:56.058461 [info ] [Thread-1 (]: 41 of 44 NO-OP exposure streamlit_product_dashboard ............................ [[33mNO-OP[0m in 0.00s]
[0m17:21:56.058461 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a, now exposure.dbt_carton_caps.streamlit_referral_finance_dashboard)
[0m17:21:56.058461 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m17:21:56.059969 [debug] [Thread-1 (]: Finished running node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:21:56.059969 [debug] [Thread-3 (]: Began compiling node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:21:56.059969 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:21:56.060974 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:21:56.060974 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:21:56.060974 [debug] [Thread-3 (]: Began executing node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:21:56.060974 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m17:21:56.061974 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m17:21:56.061974 [info ] [Thread-1 (]: 43 of 44 START test not_null_dim_user_user_id .................................. [RUN]
[0m17:21:56.062977 [info ] [Thread-3 (]: 42 of 44 NO-OP exposure streamlit_referral_finance_dashboard ................... [[33mNO-OP[0m in 0.00s]
[0m17:21:56.062977 [info ] [Thread-2 (]: 39 of 44 PASS not_null_dim_school_school_id .................................... [[32mPASS[0m in 0.03s]
[0m17:21:56.064117 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m17:21:56.064117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly exposure.dbt_carton_caps.streamlit_product_dashboard, now test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3)
[0m17:21:56.064117 [debug] [Thread-3 (]: Finished running node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:21:56.064117 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:21:56.065118 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m17:21:56.065118 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:21:56.065118 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:21:56.068024 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:21:56.066118 [info ] [Thread-4 (]: 40 of 44 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m17:21:56.068024 [info ] [Thread-3 (]: 44 of 44 START test unique_dim_user_user_id .................................... [RUN]
[0m17:21:56.069062 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:21:56.069062 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly exposure.dbt_carton_caps.streamlit_referral_finance_dashboard, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m17:21:56.069984 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:21:56.070287 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:21:56.072291 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:21:56.073289 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:21:56.074288 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:21:56.076287 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:21:56.076287 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:21:56.076931 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m17:21:56.076931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:56.076931 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:21:56.078008 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m17:21:56.078008 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:56.078008 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:56.078008 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:21:56.079008 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T222151Z"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:56.079008 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:56.079008 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:21:56.079008 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:56.079008 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:56.080009 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m17:21:56.081005 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:56.081005 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:21:56.082035 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m17:21:56.082035 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m17:21:56.083035 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m17:21:56.083864 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m17:21:56.083035 [info ] [Thread-1 (]: 43 of 44 PASS not_null_dim_user_user_id ........................................ [[32mPASS[0m in 0.02s]
[0m17:21:56.083864 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:21:56.083864 [info ] [Thread-3 (]: 44 of 44 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.01s]
[0m17:21:56.083864 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:21:56.085140 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:56.085140 [debug] [MainThread]: On master: BEGIN
[0m17:21:56.086140 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:21:56.086140 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:21:56.086140 [debug] [MainThread]: On master: COMMIT
[0m17:21:56.086140 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:56.086140 [debug] [MainThread]: On master: COMMIT
[0m17:21:56.087139 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:21:56.087139 [debug] [MainThread]: On master: Close
[0m17:21:56.087139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:56.087139 [debug] [MainThread]: Connection 'create_carton_caps_20260203T222151Z_main' was properly closed.
[0m17:21:56.087139 [debug] [MainThread]: Connection 'list_carton_caps_20260203T222151Z_main' was properly closed.
[0m17:21:56.088139 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3' was properly closed.
[0m17:21:56.088139 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b' was properly closed.
[0m17:21:56.088139 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278' was properly closed.
[0m17:21:56.088139 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76' was properly closed.
[0m17:21:56.088139 [info ] [MainThread]: 
[0m17:21:56.088139 [info ] [MainThread]: Finished running 2 exposures, 6 table models, 30 data tests, 6 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m17:21:56.090795 [debug] [MainThread]: Command end result
[0m17:21:56.105946 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:21:56.106948 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:21:56.110948 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\run_results.json
[0m17:21:56.111658 [info ] [MainThread]: 
[0m17:21:56.111658 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:56.111658 [info ] [MainThread]: 
[0m17:21:56.111658 [info ] [MainThread]: Done. PASS=42 WARN=0 ERROR=0 SKIP=0 NO-OP=2 TOTAL=44
[0m17:21:56.112861 [debug] [MainThread]: Command `dbt build` succeeded at 17:21:56.112861 after 2.11 seconds
[0m17:21:56.112861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C17362270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C19664E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C19664200>]}
[0m17:21:56.112861 [debug] [MainThread]: Flushing usage events
[0m17:21:56.545332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:21:58.040831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF2CF65E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF2DB3F800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF2F5CA5D0>]}


============================== 17:21:58.045433 | a2edf79f-7554-4b61-8471-9481c1296714 ==============================
[0m17:21:58.045433 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:21:58.045433 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --profiles-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps --project-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m17:21:58.190140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2edf79f-7554-4b61-8471-9481c1296714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF303818B0>]}
[0m17:21:58.231227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2edf79f-7554-4b61-8471-9481c1296714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF2FCA7D70>]}
[0m17:21:58.233227 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:21:58.392545 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:21:58.494685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:21:58.494685 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:21:58.494685 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:21:58.528325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2edf79f-7554-4b61-8471-9481c1296714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF317DFE00>]}
[0m17:21:58.588120 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:21:58.589121 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:21:58.611665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2edf79f-7554-4b61-8471-9481c1296714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF31D01B80>]}
[0m17:21:58.612194 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:21:58.612194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2edf79f-7554-4b61-8471-9481c1296714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF31C1DC40>]}
[0m17:21:58.612194 [info ] [MainThread]: 
[0m17:21:58.612194 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:21:58.612194 [info ] [MainThread]: 
[0m17:21:58.612194 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:21:58.617540 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T222151Z_main'
[0m17:21:58.660268 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T222151Z_main"
[0m17:21:58.660268 [debug] [ThreadPool]: On list_carton_caps_20260203T222151Z_main: BEGIN
[0m17:21:58.661890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:58.678349 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m17:21:58.679350 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T222151Z_main"
[0m17:21:58.679350 [debug] [ThreadPool]: On list_carton_caps_20260203T222151Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T222151Z_main"} */
select
      'carton_caps_20260203T222151Z' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps_20260203t222151z'
  
[0m17:21:58.688038 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:21:58.689214 [debug] [ThreadPool]: On list_carton_caps_20260203T222151Z_main: ROLLBACK
[0m17:21:58.690215 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_20260203T222151Z_main'
[0m17:21:58.690215 [debug] [ThreadPool]: On list_carton_caps_20260203T222151Z_main: Close
[0m17:21:58.691216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2edf79f-7554-4b61-8471-9481c1296714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF31C1D5B0>]}
[0m17:21:58.691216 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:58.691216 [debug] [MainThread]: On master: BEGIN
[0m17:21:58.692213 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:58.692213 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:21:58.692213 [debug] [MainThread]: On master: COMMIT
[0m17:21:58.692213 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:58.692213 [debug] [MainThread]: On master: COMMIT
[0m17:21:58.693213 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:21:58.693213 [debug] [MainThread]: On master: Close
[0m17:21:58.696259 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:21:58.696259 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:21:58.696259 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:21:58.696259 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:21:58.696259 [info ] [Thread-1 (]: 1 of 30 START test not_null_dim_product_product_id ............................. [RUN]
[0m17:21:58.697259 [info ] [Thread-2 (]: 2 of 30 START test not_null_dim_school_school_id ............................... [RUN]
[0m17:21:58.697259 [info ] [Thread-3 (]: 3 of 30 START test not_null_dim_user_user_id ................................... [RUN]
[0m17:21:58.697259 [info ] [Thread-4 (]: 4 of 30 START test not_null_fct_purchase_purchase_id ........................... [RUN]
[0m17:21:58.698259 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:21:58.698259 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:21:58.698259 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:21:58.698259 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:21:58.699259 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:21:58.699259 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:21:58.699259 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:21:58.699259 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:21:58.708880 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:21:58.710984 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:21:58.713987 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:21:58.715845 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:21:58.717069 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:21:58.722652 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:21:58.731889 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:21:58.732889 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:21:58.732889 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:21:58.734888 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:21:58.734888 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:21:58.735890 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:21:58.736666 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:21:58.737217 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m17:21:58.737217 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:21:58.737217 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:21:58.738230 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:21:58.738230 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:21:58.738230 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m17:21:58.739230 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m17:21:58.739230 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:21:58.739230 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m17:21:58.739230 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:21:58.739230 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:21:58.740230 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:21:58.740230 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:21:58.740230 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T222151Z"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.740230 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.741230 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.741230 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.741230 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:21:58.742230 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:21:58.742230 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.742230 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:21:58.742230 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T222151Z"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.742230 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T222151Z"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.743230 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T222151Z"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.745318 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m17:21:58.746317 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:21:58.746317 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.747322 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.747322 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:21:58.748322 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m17:21:58.749322 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m17:21:58.749322 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m17:21:58.750321 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m17:21:58.750626 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:21:58.750626 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:21:58.751703 [info ] [Thread-3 (]: 3 of 30 PASS not_null_dim_user_user_id ......................................... [[32mPASS[0m in 0.05s]
[0m17:21:58.751703 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:21:58.752703 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m17:21:58.752703 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m17:21:58.752703 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:21:58.752703 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m17:21:58.753702 [info ] [Thread-2 (]: 2 of 30 PASS not_null_dim_school_school_id ..................................... [[32mPASS[0m in 0.06s]
[0m17:21:58.753702 [info ] [Thread-4 (]: 4 of 30 PASS not_null_fct_purchase_purchase_id ................................. [[32mPASS[0m in 0.06s]
[0m17:21:58.753702 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:21:58.755054 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:21:58.754703 [info ] [Thread-1 (]: 1 of 30 PASS not_null_dim_product_product_id ................................... [[32mPASS[0m in 0.06s]
[0m17:21:58.755054 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:21:58.755054 [info ] [Thread-3 (]: 5 of 30 START test not_null_fct_referral_referral_id ........................... [RUN]
[0m17:21:58.756094 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:21:58.756094 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:21:58.756094 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:21:58.757094 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m17:21:58.757094 [info ] [Thread-2 (]: 6 of 30 START test not_null_fct_rewards_reward_id .............................. [RUN]
[0m17:21:58.757094 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:21:58.757094 [info ] [Thread-4 (]: 7 of 30 START test not_null_stg_events_event_id ................................ [RUN]
[0m17:21:58.758094 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:21:58.758094 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m17:21:58.758094 [info ] [Thread-1 (]: 8 of 30 START test not_null_stg_events_user_id ................................. [RUN]
[0m17:21:58.758094 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m17:21:58.761096 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:21:58.761096 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:21:58.761096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m17:21:58.762094 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:21:58.764189 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:21:58.764189 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:21:58.766189 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:21:58.768190 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:21:58.769190 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:21:58.771190 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:21:58.771190 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:21:58.801326 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:21:58.801326 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:21:58.803326 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:21:58.803326 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:21:58.804327 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:21:58.804327 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:21:58.805326 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m17:21:58.805326 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:21:58.806129 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:58.806129 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:21:58.806129 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m17:21:58.806129 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:21:58.807349 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m17:21:58.807349 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:58.807349 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:21:58.807349 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m17:21:58.808353 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:58.808353 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:21:58.808353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:58.808353 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.809353 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T222151Z"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.809353 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.809353 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:21:58.809353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.810353 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:21:58.810353 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps_20260203T222151Z"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.810353 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:21:58.810353 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.811354 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps_20260203T222151Z"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.811354 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T222151Z"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.812354 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m17:21:58.812354 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.813638 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m17:21:58.813638 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.813638 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m17:21:58.813638 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:21:58.813638 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m17:21:58.813638 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m17:21:58.813638 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m17:21:58.813638 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m17:21:58.813638 [info ] [Thread-3 (]: 5 of 30 PASS not_null_fct_referral_referral_id ................................. [[32mPASS[0m in 0.06s]
[0m17:21:58.813638 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m17:21:58.813638 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m17:21:58.813638 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m17:21:58.813638 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:21:58.813638 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m17:21:58.819987 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m17:21:58.819987 [info ] [Thread-2 (]: 6 of 30 PASS not_null_fct_rewards_reward_id .................................... [[32mPASS[0m in 0.06s]
[0m17:21:58.819987 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:21:58.819987 [info ] [Thread-1 (]: 8 of 30 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.06s]
[0m17:21:58.820992 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:21:58.820992 [info ] [Thread-4 (]: 7 of 30 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.06s]
[0m17:21:58.820992 [info ] [Thread-3 (]: 9 of 30 START test not_null_stg_products_product_id ............................ [RUN]
[0m17:21:58.821994 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:21:58.821994 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:21:58.821994 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:21:58.822993 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m17:21:58.822993 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:21:58.822993 [info ] [Thread-2 (]: 10 of 30 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m17:21:58.822993 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:21:58.823992 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:21:58.823992 [info ] [Thread-1 (]: 11 of 30 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m17:21:58.823992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m17:21:58.826995 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:21:58.823992 [info ] [Thread-4 (]: 12 of 30 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m17:21:58.826995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m17:21:58.826995 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:21:58.827994 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m17:21:58.827994 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:21:58.829991 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:21:58.829991 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:21:58.830993 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:21:58.832994 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:21:58.834995 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:21:58.835993 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:21:58.836991 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:21:58.837993 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:21:58.837993 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:21:58.838994 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:21:58.839993 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:21:58.839993 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:21:58.841995 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:21:58.841995 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:21:58.842994 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m17:21:58.842994 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m17:21:58.842994 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:58.843993 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:21:58.843993 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:58.843993 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:21:58.843993 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m17:21:58.844994 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.844994 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m17:21:58.844994 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:58.844994 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:21:58.845993 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:21:58.845993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:58.845993 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:21:58.845993 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T222151Z"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.846994 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.846994 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T222151Z"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.846994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.848045 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:21:58.848045 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.848045 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:21:58.848045 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T222151Z"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.849045 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.849045 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T222151Z"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.850043 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m17:21:58.851043 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m17:21:58.851043 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.852045 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m17:21:58.852045 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m17:21:58.852045 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:21:58.853046 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m17:21:58.853046 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m17:21:58.853046 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m17:21:58.854046 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m17:21:58.855047 [info ] [Thread-3 (]: 9 of 30 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.03s]
[0m17:21:58.855047 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m17:21:58.856047 [info ] [Thread-2 (]: 10 of 30 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.03s]
[0m17:21:58.856047 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m17:21:58.856047 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:21:58.857046 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m17:21:58.857046 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:21:58.857046 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m17:21:58.857046 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:21:58.858045 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:21:58.858045 [info ] [Thread-4 (]: 12 of 30 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.03s]
[0m17:21:58.858045 [info ] [Thread-1 (]: 11 of 30 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.03s]
[0m17:21:58.858045 [info ] [Thread-3 (]: 13 of 30 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m17:21:58.859046 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:21:58.859046 [info ] [Thread-2 (]: 14 of 30 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m17:21:58.859046 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:21:58.860045 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m17:21:58.860045 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:21:58.860045 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m17:21:58.860045 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:21:58.861045 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:21:58.861045 [info ] [Thread-4 (]: 15 of 30 START test not_null_stg_schools_school_id ............................. [RUN]
[0m17:21:58.861045 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:21:58.862045 [info ] [Thread-1 (]: 16 of 30 START test not_null_stg_users_school_id ............................... [RUN]
[0m17:21:58.863553 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:21:58.864553 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m17:21:58.866553 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:21:58.866553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m17:21:58.866553 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:21:58.867556 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:21:58.869554 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:21:58.871553 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:21:58.871553 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:21:58.871553 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:21:58.873556 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:21:58.874553 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:21:58.874553 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:21:58.875557 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:21:58.876556 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:21:58.878553 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:21:58.878553 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:21:58.878553 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:21:58.879558 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m17:21:58.879558 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m17:21:58.879558 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:21:58.879558 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:58.880556 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:58.880556 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:21:58.880556 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m17:21:58.881557 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m17:21:58.881557 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.881557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:58.882489 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:21:58.882489 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:58.882489 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:21:58.882489 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:21:58.883573 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.883573 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps_20260203T222151Z"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.883573 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.883573 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T222151Z"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.883573 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:21:58.884572 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:21:58.884572 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T222151Z"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.884572 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T222151Z"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.885574 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.885574 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.886575 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m17:21:58.886575 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.886575 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.887574 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m17:21:58.888572 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m17:21:58.889460 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m17:21:58.889460 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m17:21:58.890654 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m17:21:58.890654 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m17:21:58.890654 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m17:21:58.891654 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m17:21:58.891654 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m17:21:58.892657 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m17:21:58.891654 [info ] [Thread-2 (]: 14 of 30 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.03s]
[0m17:21:58.892657 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m17:21:58.892657 [info ] [Thread-3 (]: 13 of 30 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.03s]
[0m17:21:58.893656 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:21:58.893656 [info ] [Thread-1 (]: 16 of 30 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:21:58.894656 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:21:58.893656 [info ] [Thread-4 (]: 15 of 30 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.03s]
[0m17:21:58.894656 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:21:58.894656 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:21:58.894656 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m17:21:58.895657 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:21:58.895657 [info ] [Thread-2 (]: 17 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m17:21:58.895657 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:21:58.896443 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:21:58.896443 [info ] [Thread-3 (]: 18 of 30 START test test_events_in_window ...................................... [RUN]
[0m17:21:58.896443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m17:21:58.896443 [info ] [Thread-1 (]: 19 of 30 START test unique_dim_product_product_id .............................. [RUN]
[0m17:21:58.897550 [info ] [Thread-4 (]: 20 of 30 START test unique_dim_school_school_id ................................ [RUN]
[0m17:21:58.897550 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.test_events_in_window)
[0m17:21:58.897550 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:21:58.897550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m17:21:58.898550 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m17:21:58.898550 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m17:21:58.900546 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:21:58.900546 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:21:58.901548 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:21:58.903313 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m17:21:58.906421 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:21:58.908423 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:21:58.909421 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:21:58.910321 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:21:58.911422 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m17:21:58.912427 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m17:21:58.912427 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:21:58.913425 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:21:58.913425 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:21:58.914424 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:21:58.915422 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m17:21:58.916426 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:21:58.916426 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:21:58.917210 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:58.917210 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m17:21:58.917210 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:21:58.918391 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:58.918391 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m17:21:58.918391 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:21:58.919391 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:21:58.919391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:58.919391 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:21:58.919391 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:21:58.919391 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m17:21:58.920390 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T222151Z"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:58.920390 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:21:58.920390 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:21:58.920390 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:58.921390 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps_20260203T222151Z"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m17:21:58.921390 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:21:58.921390 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.922390 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.922390 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:58.922390 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:21:58.923390 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m17:21:58.924192 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:58.924192 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m17:21:58.925311 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m17:21:58.925311 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:21:58.925311 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:21:58.926311 [info ] [Thread-2 (]: 17 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m17:21:58.926311 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m17:21:58.927309 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:21:58.927309 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:21:58.928313 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m17:21:58.928313 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m17:21:58.929312 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m17:21:58.929312 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:21:58.930312 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m17:21:58.930312 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m17:21:58.931165 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m17:21:58.931165 [info ] [Thread-2 (]: 21 of 30 START test unique_dim_user_user_id .................................... [RUN]
[0m17:21:58.931165 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m17:21:58.932289 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m17:21:58.932289 [info ] [Thread-1 (]: 19 of 30 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.03s]
[0m17:21:58.932289 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m17:21:58.932289 [info ] [Thread-3 (]: 18 of 30 PASS test_events_in_window ............................................ [[32mPASS[0m in 0.03s]
[0m17:21:58.933289 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:21:58.933289 [info ] [Thread-4 (]: 20 of 30 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m17:21:58.933289 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:21:58.934289 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m17:21:58.934289 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:21:58.934289 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:21:58.936292 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:21:58.937292 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:21:58.937292 [info ] [Thread-1 (]: 22 of 30 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m17:21:58.937292 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:21:58.938093 [info ] [Thread-3 (]: 23 of 30 START test unique_fct_referral_referral_id ............................ [RUN]
[0m17:21:58.938093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m17:21:58.938093 [info ] [Thread-4 (]: 24 of 30 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m17:21:58.939178 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:21:58.939178 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m17:21:58.939178 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:21:58.939178 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m17:21:58.941179 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:21:58.941179 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:21:58.943180 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:21:58.943180 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:21:58.945012 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:21:58.948200 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:21:58.949200 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:21:58.949200 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m17:21:58.949200 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:58.950204 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:21:58.950204 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:21:58.950204 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:21:58.951205 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.951935 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:21:58.953023 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:21:58.955026 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:21:58.955026 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:21:58.955026 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:58.956026 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:21:58.956026 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m17:21:58.956026 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:58.957034 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:21:58.957034 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:21:58.957034 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:21:58.958024 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m17:21:58.958024 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.958024 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m17:21:58.958024 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:58.958906 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m17:21:58.958906 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:21:58.960012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:58.960012 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m17:21:58.961012 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:58.961012 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:21:58.961012 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m17:21:58.961012 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:21:58.962012 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:21:58.962519 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:21:58.962012 [info ] [Thread-2 (]: 21 of 30 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.03s]
[0m17:21:58.962519 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.962519 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:58.962519 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:58.963526 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:21:58.964527 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m17:21:58.964527 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:21:58.965528 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m17:21:58.965528 [info ] [Thread-2 (]: 25 of 30 START test unique_stg_events_event_id ................................. [RUN]
[0m17:21:58.966526 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m17:21:58.966526 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m17:21:58.967524 [info ] [Thread-3 (]: 23 of 30 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.03s]
[0m17:21:58.967524 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:21:58.967524 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:21:58.968525 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:21:58.968525 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:21:58.970529 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:21:58.971525 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:21:58.971525 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m17:21:58.972523 [info ] [Thread-3 (]: 26 of 30 START test unique_stg_products_product_id ............................. [RUN]
[0m17:21:58.973523 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m17:21:58.973523 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m17:21:58.974522 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m17:21:58.974522 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:21:58.974522 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m17:21:58.975523 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:21:58.975523 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m17:21:58.977522 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:21:58.977522 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m17:21:58.978522 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:21:58.979522 [info ] [Thread-4 (]: 24 of 30 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:21:58.979522 [info ] [Thread-1 (]: 22 of 30 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.04s]
[0m17:21:58.980524 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:21:58.980524 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:21:58.980524 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:21:58.981524 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:21:58.981524 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:21:58.981524 [info ] [Thread-4 (]: 27 of 30 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m17:21:58.981524 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:21:58.983522 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:21:58.983522 [info ] [Thread-1 (]: 28 of 30 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m17:21:58.983522 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m17:21:58.983522 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m17:21:58.984522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m17:21:58.984522 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:21:58.984522 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:58.985522 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:21:58.985522 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:21:58.987523 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:21:58.989522 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:21:58.989522 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m17:21:58.990522 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:21:58.990522 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:58.990522 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:21:58.991522 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:21:58.991522 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:58.991522 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:21:58.992524 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.993523 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:21:58.995656 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:21:58.995656 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:21:58.996656 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:21:58.996656 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:58.997658 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m17:21:58.997658 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:21:58.998658 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:21:58.998658 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m17:21:58.998658 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m17:21:58.999656 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:58.999656 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m17:21:58.999656 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m17:21:58.999656 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:59.000595 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m17:21:59.000595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:59.001768 [info ] [Thread-2 (]: 25 of 30 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m17:21:59.001768 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:21:59.002767 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m17:21:59.002767 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:21:59.002767 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:21:59.002767 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:21:59.003766 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m17:21:59.003766 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:21:59.003766 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:59.003766 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:21:59.004766 [info ] [Thread-3 (]: 26 of 30 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m17:21:59.004766 [info ] [Thread-2 (]: 29 of 30 START test unique_stg_schools_school_id ............................... [RUN]
[0m17:21:59.004766 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:59.005766 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:21:59.005766 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m17:21:59.005766 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:21:59.006768 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:21:59.007509 [info ] [Thread-3 (]: 30 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m17:21:59.009727 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:21:59.009727 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m17:21:59.010727 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:21:59.010727 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:21:59.010727 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:21:59.011732 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m17:21:59.011732 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:21:59.014468 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:21:59.015017 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m17:21:59.015017 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m17:21:59.015017 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:21:59.015017 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m17:21:59.015017 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m17:21:59.015017 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m17:21:59.015017 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:21:59.015017 [info ] [Thread-1 (]: 28 of 30 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m17:21:59.015017 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:21:59.015017 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:21:59.015017 [info ] [Thread-4 (]: 27 of 30 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.03s]
[0m17:21:59.021379 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:21:59.021379 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m17:21:59.021379 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:21:59.022384 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:59.022384 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:21:59.022384 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m17:21:59.023385 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:59.023385 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:59.023385 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:21:59.023385 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:59.024383 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:59.024383 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:21:59.024383 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222151Z"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:59.025383 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:59.026382 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m17:21:59.026382 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:21:59.026382 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m17:21:59.027383 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m17:21:59.027383 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m17:21:59.028384 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m17:21:59.028384 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m17:21:59.028384 [info ] [Thread-2 (]: 29 of 30 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.02s]
[0m17:21:59.029383 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:21:59.029383 [info ] [Thread-3 (]: 30 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.02s]
[0m17:21:59.029383 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:21:59.030383 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:59.031386 [debug] [MainThread]: On master: BEGIN
[0m17:21:59.031386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:21:59.031386 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:21:59.031386 [debug] [MainThread]: On master: COMMIT
[0m17:21:59.031386 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:59.032386 [debug] [MainThread]: On master: COMMIT
[0m17:21:59.032386 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:21:59.032386 [debug] [MainThread]: On master: Close
[0m17:21:59.032386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:59.033385 [debug] [MainThread]: Connection 'list_carton_caps_20260203T222151Z_main' was properly closed.
[0m17:21:59.033385 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d' was properly closed.
[0m17:21:59.033385 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6' was properly closed.
[0m17:21:59.033385 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m17:21:59.033385 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103' was properly closed.
[0m17:21:59.033385 [info ] [MainThread]: 
[0m17:21:59.034385 [info ] [MainThread]: Finished running 30 data tests in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m17:21:59.036384 [debug] [MainThread]: Command end result
[0m17:21:59.050777 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:21:59.051818 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:21:59.055928 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\run_results.json
[0m17:21:59.056694 [info ] [MainThread]: 
[0m17:21:59.056694 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:59.057224 [info ] [MainThread]: 
[0m17:21:59.057224 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=30
[0m17:21:59.057224 [debug] [MainThread]: Command `dbt test` succeeded at 17:21:59.057224 after 1.09 seconds
[0m17:21:59.057224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF2CF65E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF3020AE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF2F0ECC50>]}
[0m17:21:59.058227 [debug] [MainThread]: Flushing usage events
[0m17:21:59.416801 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:22:30.258476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9CC0AF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9C769BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9A56D2B0>]}


============================== 17:22:30.261480 | e61d7cda-3512-48ce-8d96-d19bb61d4520 ==============================
[0m17:22:30.261480 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:22:30.262480 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --profiles-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps --project-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m17:22:30.403488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9CD83BC0>]}
[0m17:22:30.445142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE99B3A750>]}
[0m17:22:30.445142 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:22:30.596448 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:22:30.663059 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:22:30.663059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9E55F830>]}
[0m17:22:31.485219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9E55FAA0>]}
[0m17:22:31.544347 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:22:31.546348 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:22:31.569786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9E7A7110>]}
[0m17:22:31.569786 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:22:31.569786 [info ] [MainThread]: 
[0m17:22:31.569786 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:22:31.569786 [info ] [MainThread]: 
[0m17:22:31.569786 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:22:31.569786 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T222227Z'
[0m17:22:31.646837 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T222227Z"
[0m17:22:31.646837 [debug] [ThreadPool]: On list_carton_caps_20260203T222227Z: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T222227Z"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps_20260203t222227z"'
    
  
  
[0m17:22:31.646837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:31.674717 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m17:22:31.674717 [debug] [ThreadPool]: On list_carton_caps_20260203T222227Z: Close
[0m17:22:31.674717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_carton_caps_20260203T222227Z, now create_carton_caps_20260203T222227Z_main)
[0m17:22:31.674717 [debug] [ThreadPool]: Creating schema "database: "carton_caps_20260203T222227Z"
schema: "main"
"
[0m17:22:31.674717 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T222227Z_main"
[0m17:22:31.674717 [debug] [ThreadPool]: On create_carton_caps_20260203T222227Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_20260203T222227Z_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='carton_caps_20260203t222227z'
        and type='sqlite'
    
  
[0m17:22:31.674717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:31.674717 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:22:31.674717 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T222227Z_main"
[0m17:22:31.674717 [debug] [ThreadPool]: On create_carton_caps_20260203T222227Z_main: BEGIN
[0m17:22:31.674717 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:22:31.674717 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T222227Z_main"
[0m17:22:31.674717 [debug] [ThreadPool]: On create_carton_caps_20260203T222227Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_20260203T222227Z_main"} */

    
    
        create schema if not exists "carton_caps_20260203T222227Z"."main"
    
[0m17:22:31.674717 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:22:31.674717 [debug] [ThreadPool]: On create_carton_caps_20260203T222227Z_main: COMMIT
[0m17:22:31.674717 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T222227Z_main"
[0m17:22:31.674717 [debug] [ThreadPool]: On create_carton_caps_20260203T222227Z_main: COMMIT
[0m17:22:31.674717 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:22:31.674717 [debug] [ThreadPool]: On create_carton_caps_20260203T222227Z_main: Close
[0m17:22:31.674717 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T222227Z_main'
[0m17:22:31.674717 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T222227Z_main"
[0m17:22:31.674717 [debug] [ThreadPool]: On list_carton_caps_20260203T222227Z_main: BEGIN
[0m17:22:31.674717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:31.674717 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:22:31.674717 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T222227Z_main"
[0m17:22:31.674717 [debug] [ThreadPool]: On list_carton_caps_20260203T222227Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T222227Z_main"} */
select
      'carton_caps_20260203T222227Z' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps_20260203t222227z'
  
[0m17:22:31.695780 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:22:31.695780 [debug] [ThreadPool]: On list_carton_caps_20260203T222227Z_main: ROLLBACK
[0m17:22:31.695780 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_20260203T222227Z_main'
[0m17:22:31.695780 [debug] [ThreadPool]: On list_carton_caps_20260203T222227Z_main: Close
[0m17:22:31.695780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9E996480>]}
[0m17:22:31.695780 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:31.695780 [debug] [MainThread]: On master: BEGIN
[0m17:22:31.695780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:22:31.695780 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:22:31.695780 [debug] [MainThread]: On master: COMMIT
[0m17:22:31.695780 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:31.695780 [debug] [MainThread]: On master: COMMIT
[0m17:22:31.701851 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:22:31.701851 [debug] [MainThread]: On master: Close
[0m17:22:31.701851 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_events
[0m17:22:31.701851 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.stg_products
[0m17:22:31.701851 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.stg_purchases
[0m17:22:31.701851 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.stg_referrals
[0m17:22:31.701851 [info ] [Thread-1 (]: 1 of 44 START sql view model main.stg_events ................................... [RUN]
[0m17:22:31.701851 [info ] [Thread-2 (]: 2 of 44 START sql view model main.stg_products ................................. [RUN]
[0m17:22:31.701851 [info ] [Thread-3 (]: 3 of 44 START sql view model main.stg_purchases ................................ [RUN]
[0m17:22:31.701851 [info ] [Thread-4 (]: 4 of 44 START sql view model main.stg_referrals ................................ [RUN]
[0m17:22:31.706663 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_events'
[0m17:22:31.706663 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_products'
[0m17:22:31.706663 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_purchases'
[0m17:22:31.706663 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_referrals'
[0m17:22:31.706663 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_events
[0m17:22:31.706663 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.stg_products
[0m17:22:31.706663 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.stg_purchases
[0m17:22:31.706663 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.stg_referrals
[0m17:22:31.706663 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_events"
[0m17:22:31.706663 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_products"
[0m17:22:31.706663 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_purchases"
[0m17:22:31.706663 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_referrals"
[0m17:22:31.706663 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_events
[0m17:22:31.734556 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_events"
[0m17:22:31.734556 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.stg_referrals
[0m17:22:31.734556 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.stg_purchases
[0m17:22:31.736017 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.stg_products
[0m17:22:31.737028 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_referrals"
[0m17:22:31.739064 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_purchases"
[0m17:22:31.741064 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_products"
[0m17:22:31.741064 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:22:31.742066 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: BEGIN
[0m17:22:31.742066 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:22:31.742066 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:22:31.743065 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: BEGIN
[0m17:22:31.743065 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:22:31.743065 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.744065 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:22:31.744065 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:22:31.744065 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.744065 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:22:31.745066 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: BEGIN
[0m17:22:31.745066 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

  
  create view "carton_caps_20260203T222227Z"."main"."stg_events__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T222227Z"."raw"."events"
)
select
  cast(event_id as integer) as event_id,
  cast(user_id as integer) as user_id,
  cast(event_type as varchar) as event_type,
  cast(event_at as timestamp) as event_at,
  cast(referral_id as integer) as referral_id,
  cast(metadata_json as varchar) as metadata_json
from src
  );

[0m17:22:31.745066 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:22:31.745066 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: BEGIN
[0m17:22:31.745066 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:22:31.746064 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

  
  create view "carton_caps_20260203T222227Z"."main"."stg_referrals__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T222227Z"."raw"."referrals"
)
select
  cast(referral_id as integer) as referral_id,
  cast(referrer_user_id as integer) as referrer_user_id,
  lower(cast(referred_email as varchar)) as referred_email,
  cast(referred_user_id as integer) as referred_user_id,
  cast(referral_code as varchar) as referral_code,
  cast(sent_at as timestamp) as sent_at,
  cast(converted_at as timestamp) as converted_at,
  cast(status as varchar) as status
from src
  );

[0m17:22:31.746064 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:22:31.746064 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.747066 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.750064 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:22:31.751065 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:22:31.751065 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:22:31.751065 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:22:31.751065 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */
alter view "carton_caps_20260203T222227Z"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m17:22:31.751065 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:22:31.752064 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

  
  create view "carton_caps_20260203T222227Z"."main"."stg_purchases__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T222227Z"."raw"."purchases"
)
select
  cast(purchase_id as integer) as purchase_id,
  cast(user_id as integer) as user_id,
  cast(product_id as integer) as product_id,
  cast(quantity as integer) as quantity,
  cast(price_paid as double) as price_paid,
  cast(points_earned as integer) as points_earned,
  cast(purchased_at as timestamp) as purchased_at,
  cast(day_of_week as varchar) as day_of_week,
  cast(hour_of_day as integer) as hour_of_day
from src
  );

[0m17:22:31.753064 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:22:31.754064 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

  
  create view "carton_caps_20260203T222227Z"."main"."stg_products__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T222227Z"."raw"."products"
)
select
  cast(product_id as integer) as product_id,
  cast(name as varchar) as name,
  cast(category as varchar) as category,
  cast(price as double) as price,
  cast(points_per_dollar as integer) as points_per_dollar,
  cast(created_at as timestamp) as created_at
from src
  );

[0m17:22:31.754064 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */
alter view "carton_caps_20260203T222227Z"."main"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m17:22:31.754064 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.754064 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.760064 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m17:22:31.760064 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m17:22:31.762064 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:22:31.762064 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m17:22:31.762064 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:22:31.764064 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:22:31.764064 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */
alter view "carton_caps_20260203T222227Z"."main"."stg_purchases__dbt_tmp" rename to "stg_purchases"
[0m17:22:31.765065 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m17:22:31.765065 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m17:22:31.765065 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */
alter view "carton_caps_20260203T222227Z"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m17:22:31.766065 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:22:31.766065 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:22:31.766065 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m17:22:31.767066 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m17:22:31.768067 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.768067 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:22:31.769102 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m17:22:31.769102 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m17:22:31.769102 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:22:31.769102 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:22:31.770101 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:31.773100 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:22:31.773100 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m17:22:31.773100 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:22:31.775100 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:22:31.775100 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

      drop view if exists "carton_caps_20260203T222227Z"."main"."stg_events__dbt_backup" cascade
    
[0m17:22:31.777100 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:22:31.777100 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

      drop view if exists "carton_caps_20260203T222227Z"."main"."stg_referrals__dbt_backup" cascade
    
[0m17:22:31.777100 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:22:31.778100 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

      drop view if exists "carton_caps_20260203T222227Z"."main"."stg_purchases__dbt_backup" cascade
    
[0m17:22:31.778100 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:22:31.779103 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:22:31.780102 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:31.781103 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: Close
[0m17:22:31.781103 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

      drop view if exists "carton_caps_20260203T222227Z"."main"."stg_products__dbt_backup" cascade
    
[0m17:22:31.782103 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:22:31.782103 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: Close
[0m17:22:31.784103 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: Close
[0m17:22:31.784757 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.784757 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: Close
[0m17:22:31.784757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9E76A9C0>]}
[0m17:22:31.784757 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9E49B2F0>]}
[0m17:22:31.784757 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9E499DF0>]}
[0m17:22:31.784757 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9E76AFC0>]}
[0m17:22:31.784757 [info ] [Thread-1 (]: 1 of 44 OK created sql view model main.stg_events .............................. [[32mOK[0m in 0.08s]
[0m17:22:31.784757 [info ] [Thread-4 (]: 4 of 44 OK created sql view model main.stg_referrals ........................... [[32mOK[0m in 0.08s]
[0m17:22:31.784757 [info ] [Thread-2 (]: 2 of 44 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.08s]
[0m17:22:31.784757 [info ] [Thread-3 (]: 3 of 44 OK created sql view model main.stg_purchases ........................... [[32mOK[0m in 0.08s]
[0m17:22:31.784757 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_events
[0m17:22:31.784757 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.stg_referrals
[0m17:22:31.784757 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.stg_products
[0m17:22:31.784757 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.stg_purchases
[0m17:22:31.784757 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_schools
[0m17:22:31.784757 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.stg_users
[0m17:22:31.784757 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:22:31.784757 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:22:31.784757 [info ] [Thread-1 (]: 5 of 44 START sql view model main.stg_schools .................................. [RUN]
[0m17:22:31.784757 [info ] [Thread-4 (]: 6 of 44 START sql view model main.stg_users .................................... [RUN]
[0m17:22:31.784757 [info ] [Thread-2 (]: 7 of 44 START test not_null_stg_events_event_id ................................ [RUN]
[0m17:22:31.784757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_events, now model.dbt_carton_caps.stg_schools)
[0m17:22:31.784757 [info ] [Thread-3 (]: 8 of 44 START test not_null_stg_events_user_id ................................. [RUN]
[0m17:22:31.784757 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_referrals, now model.dbt_carton_caps.stg_users)
[0m17:22:31.784757 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_products, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m17:22:31.784757 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_schools
[0m17:22:31.784757 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_purchases, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m17:22:31.784757 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.stg_users
[0m17:22:31.784757 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:22:31.793708 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_schools"
[0m17:22:31.793708 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:22:31.793708 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_users"
[0m17:22:31.800061 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:22:31.800061 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:22:31.800061 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_schools
[0m17:22:31.800061 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_schools"
[0m17:22:31.807994 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:22:31.807994 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.stg_users
[0m17:22:31.815726 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:22:31.817047 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:22:31.817047 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_users"
[0m17:22:31.822171 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:22:31.822171 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:22:31.822171 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: BEGIN
[0m17:22:31.823172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:31.823172 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:22:31.824172 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.824172 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:22:31.824172 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:22:31.824172 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m17:22:31.825173 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:22:31.825173 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: BEGIN
[0m17:22:31.825173 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m17:22:31.825173 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:31.825173 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

  
  create view "carton_caps_20260203T222227Z"."main"."stg_schools__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T222227Z"."raw"."schools"
)
select
  cast(school_id as integer) as school_id,
  cast(name as varchar) as name,
  cast(address as varchar) as address,
  cast(city as varchar) as city,
  cast(state as varchar) as state,
  cast(zip_code as varchar) as zip_code,
  cast(created_at as timestamp) as created_at
from src
  );

[0m17:22:31.826173 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:31.826173 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:31.827172 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.827172 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:22:31.827172 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.827172 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:31.827172 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T222227Z"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:31.828364 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:22:31.829366 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:22:31.830364 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:22:31.830364 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:22:31.830364 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */
alter view "carton_caps_20260203T222227Z"."main"."stg_schools__dbt_tmp" rename to "stg_schools"
[0m17:22:31.831363 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

  
  create view "carton_caps_20260203T222227Z"."main"."stg_users__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T222227Z"."raw"."users"
)
select
  cast(user_id as integer) as user_id,
  cast(first_name as varchar) as first_name,
  cast(last_name as varchar) as last_name,
  lower(cast(email as varchar)) as email,
  cast(school_id as integer) as school_id,
  cast(created_at as timestamp) as created_at,
  cast(user_type as varchar) as user_type,
  cast(is_verified as integer) as is_verified,
  cast(device_id as varchar) as device_id,
  cast(marketing_channel as varchar) as marketing_channel
from src
  );

[0m17:22:31.831363 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps_20260203T222227Z"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:31.831363 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.832364 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:22:31.834364 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m17:22:31.834364 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m17:22:31.834364 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:22:31.834364 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:22:31.834364 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:22:31.834364 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m17:22:31.834364 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:22:31.834364 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m17:22:31.834364 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m17:22:31.834364 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m17:22:31.834364 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */
alter view "carton_caps_20260203T222227Z"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:22:31.834364 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m17:22:31.834364 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m17:22:31.834364 [info ] [Thread-3 (]: 8 of 44 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.05s]
[0m17:22:31.834364 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.834364 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:22:31.834364 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m17:22:31.834364 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m17:22:31.834364 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:22:31.834364 [info ] [Thread-2 (]: 7 of 44 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.05s]
[0m17:22:31.834364 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:22:31.834364 [info ] [Thread-3 (]: 9 of 44 START test test_events_in_window ....................................... [RUN]
[0m17:22:31.834364 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:22:31.834364 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:22:31.834364 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m17:22:31.834364 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.test_events_in_window)
[0m17:22:31.834364 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

      drop view if exists "carton_caps_20260203T222227Z"."main"."stg_schools__dbt_backup" cascade
    
[0m17:22:31.834364 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:22:31.834364 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m17:22:31.834364 [info ] [Thread-2 (]: 10 of 44 START test unique_stg_events_event_id ................................. [RUN]
[0m17:22:31.834364 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m17:22:31.834364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m17:22:31.834364 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:22:31.834364 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:22:31.834364 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:22:31.852412 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:22:31.853447 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: Close
[0m17:22:31.856962 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:22:31.856962 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

      drop view if exists "carton_caps_20260203T222227Z"."main"."stg_users__dbt_backup" cascade
    
[0m17:22:31.856962 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m17:22:31.857963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9E834B90>]}
[0m17:22:31.858965 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m17:22:31.859963 [info ] [Thread-1 (]: 5 of 44 OK created sql view model main.stg_schools ............................. [[32mOK[0m in 0.07s]
[0m17:22:31.859963 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:31.859963 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_schools
[0m17:22:31.860965 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: Close
[0m17:22:31.861932 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:22:31.861932 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:22:31.861932 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:22:31.861932 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9E630C80>]}
[0m17:22:31.861932 [info ] [Thread-1 (]: 11 of 44 START test not_null_stg_products_product_id ........................... [RUN]
[0m17:22:31.861932 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:22:31.861932 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m17:22:31.861932 [info ] [Thread-4 (]: 6 of 44 OK created sql view model main.stg_users ............................... [[32mOK[0m in 0.08s]
[0m17:22:31.861932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_schools, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m17:22:31.861932 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:31.861932 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.stg_users
[0m17:22:31.861932 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:22:31.861932 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:22:31.861932 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:22:31.861932 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:22:31.861932 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:22:31.861932 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m17:22:31.861932 [info ] [Thread-4 (]: 12 of 44 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m17:22:31.861932 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:22:31.861932 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:31.861932 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_users, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m17:22:31.861932 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps_20260203T222227Z"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m17:22:31.861932 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:22:31.861932 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:22:31.861932 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.861932 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:22:31.876680 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:22:31.876680 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:22:31.876680 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:22:31.876680 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:31.876680 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m17:22:31.876680 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:22:31.876680 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m17:22:31.876680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:31.876680 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m17:22:31.876680 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:22:31.876680 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:22:31.876680 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m17:22:31.876680 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:22:31.876680 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:22:31.876680 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m17:22:31.876680 [info ] [Thread-3 (]: 9 of 44 PASS test_events_in_window ............................................. [[32mPASS[0m in 0.04s]
[0m17:22:31.876680 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:22:31.876680 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m17:22:31.876680 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m17:22:31.876680 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T222227Z"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:31.876680 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:22:31.876680 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:22:31.876680 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m17:22:31.876680 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m17:22:31.876680 [info ] [Thread-3 (]: 13 of 44 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m17:22:31.876680 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.876680 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:31.876680 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m17:22:31.876680 [info ] [Thread-2 (]: 10 of 44 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m17:22:31.876680 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:22:31.876680 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m17:22:31.876680 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:22:31.876680 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:31.893853 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:22:31.893853 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:22:31.893853 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m17:22:31.893853 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:22:31.893853 [info ] [Thread-2 (]: 14 of 44 START test unique_stg_products_product_id ............................. [RUN]
[0m17:22:31.893853 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m17:22:31.893853 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T222227Z"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:31.893853 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m17:22:31.893853 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:22:31.893853 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:22:31.893853 [info ] [Thread-1 (]: 11 of 44 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.03s]
[0m17:22:31.893853 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:22:31.893853 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:22:31.893853 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:22:31.893853 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:22:31.893853 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:22:31.893853 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m17:22:31.893853 [info ] [Thread-1 (]: 15 of 44 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m17:22:31.893853 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:22:31.893853 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m17:22:31.893853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m17:22:31.893853 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:22:31.893853 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:22:31.908008 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m17:22:31.908008 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:22:31.908008 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m17:22:31.910629 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:22:31.910629 [info ] [Thread-4 (]: 12 of 44 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.05s]
[0m17:22:31.910629 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:31.910629 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:22:31.910629 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:22:31.910629 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:22:31.910629 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m17:22:31.910629 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:22:31.910629 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:22:31.910629 [info ] [Thread-4 (]: 16 of 44 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m17:22:31.910629 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:31.910629 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:22:31.910629 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:22:31.910629 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m17:22:31.910629 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps_20260203T222227Z"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:31.910629 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:22:31.910629 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:22:31.910629 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:22:31.910629 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:22:31.910629 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:22:31.910629 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:22:31.910629 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:31.910629 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m17:22:31.910629 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m17:22:31.910629 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:22:31.910629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:31.910629 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m17:22:31.924076 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:22:31.924076 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:22:31.924076 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m17:22:31.924076 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:22:31.924076 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m17:22:31.924076 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:22:31.924076 [info ] [Thread-3 (]: 13 of 44 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.05s]
[0m17:22:31.924076 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:31.924076 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m17:22:31.924076 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:22:31.924076 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:22:31.924076 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m17:22:31.924076 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m17:22:31.924076 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:22:31.924076 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:31.924076 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:22:31.924076 [info ] [Thread-2 (]: 14 of 44 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m17:22:31.924076 [info ] [Thread-3 (]: 17 of 44 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m17:22:31.924076 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m17:22:31.924076 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:22:31.924076 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:31.924076 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m17:22:31.924076 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m17:22:31.924076 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:22:31.924076 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:22:31.924076 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:22:31.924076 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m17:22:31.924076 [info ] [Thread-2 (]: 18 of 44 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m17:22:31.924076 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T222227Z"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:31.936515 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:22:31.936515 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m17:22:31.936515 [info ] [Thread-1 (]: 15 of 44 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.04s]
[0m17:22:31.936515 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:22:31.936515 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:22:31.940152 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:22:31.940152 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:22:31.940152 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:22:31.940152 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:22:31.940152 [info ] [Thread-1 (]: 19 of 44 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m17:22:31.940152 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m17:22:31.940152 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:22:31.940152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m17:22:31.940152 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:22:31.940152 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m17:22:31.940152 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:22:31.940152 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:22:31.940152 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m17:22:31.940152 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:22:31.940152 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:22:31.940152 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m17:22:31.940152 [info ] [Thread-4 (]: 16 of 44 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.03s]
[0m17:22:31.940152 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:31.940152 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:22:31.940152 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:22:31.940152 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:22:31.940152 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m17:22:31.940152 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:22:31.940152 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:22:31.940152 [info ] [Thread-4 (]: 20 of 44 START test not_null_stg_schools_school_id ............................. [RUN]
[0m17:22:31.940152 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:31.940152 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:22:31.955929 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m17:22:31.940152 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:22:31.955929 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:22:31.955929 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T222227Z"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:31.955929 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:22:31.955929 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:22:31.955929 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:22:31.955929 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:22:31.955929 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m17:22:31.955929 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.955929 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T222227Z"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:31.955929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:31.955929 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:22:31.955929 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m17:22:31.955929 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:22:31.955929 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:22:31.955929 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:22:31.955929 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m17:22:31.955929 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:22:31.955929 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m17:22:31.955929 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m17:22:31.955929 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:31.955929 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:22:31.955929 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m17:22:31.955929 [info ] [Thread-3 (]: 17 of 44 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.03s]
[0m17:22:31.955929 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m17:22:31.955929 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m17:22:31.955929 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:22:31.955929 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:31.955929 [info ] [Thread-2 (]: 18 of 44 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.02s]
[0m17:22:31.955929 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:22:31.955929 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:22:31.955929 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:22:31.971688 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:22:31.955929 [info ] [Thread-3 (]: 21 of 44 START test unique_stg_schools_school_id ............................... [RUN]
[0m17:22:31.971688 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:22:31.972918 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m17:22:31.972918 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:22:31.973918 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m17:22:31.973918 [info ] [Thread-2 (]: 22 of 44 START test not_null_stg_users_school_id ............................... [RUN]
[0m17:22:31.973918 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T222227Z"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:31.974918 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m17:22:31.974918 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:22:31.974918 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m17:22:31.975918 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m17:22:31.977917 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:22:31.977917 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:22:31.978916 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:22:31.978916 [info ] [Thread-1 (]: 19 of 44 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.04s]
[0m17:22:31.980919 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:22:31.981919 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m17:22:31.982919 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:22:31.982919 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:22:31.983920 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m17:22:31.983920 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:22:31.984921 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:22:31.985920 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m17:22:31.985920 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:22:31.985920 [info ] [Thread-1 (]: 23 of 44 START test not_null_stg_users_user_id ................................. [RUN]
[0m17:22:31.987921 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:22:31.987921 [info ] [Thread-4 (]: 20 of 44 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.03s]
[0m17:22:31.988919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m17:22:31.989919 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:22:31.989919 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:22:31.989919 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:22:31.990921 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:22:31.992920 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:22:31.992920 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:22:31.992920 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m17:22:31.993919 [info ] [Thread-4 (]: 24 of 44 START test unique_stg_users_user_id ................................... [RUN]
[0m17:22:31.993919 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m17:22:31.993919 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:31.993919 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m17:22:31.993919 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:31.995244 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:22:31.995244 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:22:31.995244 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:31.997243 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:22:31.999243 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:22:31.999243 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:22:31.999243 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:22:32.000244 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:22:32.000244 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:32.000244 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T222227Z"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:32.001244 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:22:32.001244 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m17:22:32.001244 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:22:32.002246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:32.002246 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.002246 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:22:32.002246 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:22:32.002246 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:22:32.002246 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m17:22:32.002246 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m17:22:32.002246 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:22:32.002246 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m17:22:32.002246 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:22:32.002246 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m17:22:32.002246 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T222227Z"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:32.002246 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m17:22:32.002246 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m17:22:32.002246 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m17:22:32.002246 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:32.002246 [info ] [Thread-3 (]: 21 of 44 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:22:32.002246 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.002246 [info ] [Thread-2 (]: 22 of 44 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:22:32.002246 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:22:32.002246 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.002246 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m17:22:32.002246 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:22:32.002246 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.fct_rewards
[0m17:22:32.002246 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:22:32.002246 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m17:22:32.002246 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.dim_product
[0m17:22:32.002246 [info ] [Thread-3 (]: 25 of 44 START sql table model main.fct_rewards ................................ [RUN]
[0m17:22:32.002246 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:32.002246 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m17:22:32.002246 [info ] [Thread-2 (]: 26 of 44 START sql table model main.dim_product ................................ [RUN]
[0m17:22:32.002246 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6, now model.dbt_carton_caps.fct_rewards)
[0m17:22:32.002246 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now model.dbt_carton_caps.dim_product)
[0m17:22:32.002246 [info ] [Thread-1 (]: 23 of 44 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.01s]
[0m17:22:32.002246 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.fct_rewards
[0m17:22:32.002246 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.dim_product
[0m17:22:32.002246 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.002246 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:22:32.018759 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_rewards"
[0m17:22:32.019106 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_product"
[0m17:22:32.019106 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.fct_referral
[0m17:22:32.021569 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m17:22:32.021569 [info ] [Thread-1 (]: 27 of 44 START sql table model main.fct_referral ............................... [RUN]
[0m17:22:32.022573 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m17:22:32.022573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now model.dbt_carton_caps.fct_referral)
[0m17:22:32.022573 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m17:22:32.023573 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.dim_product
[0m17:22:32.023573 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.fct_rewards
[0m17:22:32.023573 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.fct_referral
[0m17:22:32.034625 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_product"
[0m17:22:32.034625 [info ] [Thread-4 (]: 24 of 44 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.04s]
[0m17:22:32.035625 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_rewards"
[0m17:22:32.035625 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_referral"
[0m17:22:32.039330 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:22:32.039330 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.dim_school
[0m17:22:32.039330 [info ] [Thread-4 (]: 28 of 44 START sql table model main.dim_school ................................. [RUN]
[0m17:22:32.039330 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b, now model.dbt_carton_caps.dim_school)
[0m17:22:32.039330 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:22:32.039330 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:22:32.039330 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.fct_referral
[0m17:22:32.039330 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.dim_school
[0m17:22:32.039330 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: BEGIN
[0m17:22:32.039330 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: BEGIN
[0m17:22:32.045337 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_referral"
[0m17:22:32.045337 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_school"
[0m17:22:32.045337 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:32.045337 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:32.045337 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.045337 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:22:32.045337 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:22:32.045337 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:22:32.045337 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.dim_school
[0m17:22:32.045337 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: BEGIN
[0m17:22:32.045337 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:22:32.049720 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

  
    
    

    create  table
      "carton_caps_20260203T222227Z"."main"."fct_rewards__dbt_tmp"
  
    as (
      with e as (
  select *
  from "carton_caps_20260203T222227Z"."main"."stg_events"
),

awards as (
  select
    referral_id,
    user_id,
    event_at as awarded_at,
    -- reward_type is inside metadata_json like {"reward_type":"referrer_bonus"}
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_awarded'
),

redeems as (
  select
    referral_id,
    user_id,
    event_at as redeemed_at,
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_redeemed'
)

select
  -- deterministic surrogate key
  md5(cast(a.referral_id as varchar) || '|' || cast(a.user_id as varchar) || '|' || coalesce(a.reward_type,'')) as reward_id,
  a.referral_id,
  a.user_id,
  a.reward_type,
  a.awarded_at,
  min(r.redeemed_at) as redeemed_at
from awards a
left join redeems r
  on a.referral_id = r.referral_id
  and a.user_id = r.user_id
  and coalesce(a.reward_type,'') = coalesce(r.reward_type,'')
group by 1,2,3,4,5
    );
  
  
[0m17:22:32.051275 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_school"
[0m17:22:32.051825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:32.051825 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

  
    
    

    create  table
      "carton_caps_20260203T222227Z"."main"."dim_product__dbt_tmp"
  
    as (
      select
  product_id,
  name,
  category,
  price,
  points_per_dollar,
  created_at
from "carton_caps_20260203T222227Z"."main"."stg_products"
    );
  
  
[0m17:22:32.052904 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.052904 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:22:32.053439 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

  
    
    

    create  table
      "carton_caps_20260203T222227Z"."main"."fct_referral__dbt_tmp"
  
    as (
      with r as (
  select *
  from "carton_caps_20260203T222227Z"."main"."stg_referrals"
),

e as (
  select *
  from "carton_caps_20260203T222227Z"."main"."stg_events"
),

-- Referral-related event timestamps for referred users
ref_events as (
  select
    referral_id,
    user_id,

    min(case when event_type = 'install' then event_at end) as install_at,
    min(case when event_type = 'referral_applied' then event_at end) as referral_applied_at,
    min(case when event_type = 'onboarding_complete' then event_at end) as onboarding_completed_at,
    min(case when event_type = 'school_linked' then event_at end) as school_linked_at

  from e
  where referral_id is not null
  group by 1,2
),

-- First scan/purchase time for referred users (proxy for qualifying action)
first_purchase as (
  select
    user_id,
    min(purchased_at) as first_purchase_at
  from "carton_caps_20260203T222227Z"."main"."stg_purchases"
  group by 1
)

select
  r.referral_id,
  r.referrer_user_id,
  r.referred_email,
  r.referred_user_id,
  r.referral_code,
  r.sent_at,
  r.converted_at,
  r.status,

  re.install_at,
  re.referral_applied_at,
  re.onboarding_completed_at,
  re.school_linked_at,

  fp.first_purchase_at,

  -- qualifying action is: first_purchase OR school_linked (whichever happens first)
  least(fp.first_purchase_at, re.school_linked_at) as qualifying_action_at,

  -- window compliance (48 hours) using install -> referral_applied
  case
    when re.install_at is null or re.referral_applied_at is null then null
    when datediff('hour', re.install_at, re.referral_applied_at) <= 48 then true
    else false
  end as within_48h_window,

  -- simple eligibility (rules-compliant posture)
  case
    when r.status <> 'converted' then false
    when re.onboarding_completed_at is null then false
    when least(fp.first_purchase_at, re.school_linked_at) is null then false
    when re.install_at is null or re.referral_applied_at is null then false
    when datediff('hour', re.install_at, re.referral_applied_at) > 48 then false
    else true
  end as eligible_referral

from r
left join ref_events re
  on r.referral_id = re.referral_id
  and r.referred_user_id = re.user_id
left join first_purchase fp
  on r.referred_user_id = fp.user_id
    );
  
  
[0m17:22:32.053997 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:22:32.054562 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: BEGIN
[0m17:22:32.054562 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:32.054562 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:22:32.057225 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:22:32.057225 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */
alter table "carton_caps_20260203T222227Z"."main"."dim_product__dbt_tmp" rename to "dim_product"
[0m17:22:32.057750 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:22:32.058275 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:22:32.058858 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.058858 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

  
    
    

    create  table
      "carton_caps_20260203T222227Z"."main"."dim_school__dbt_tmp"
  
    as (
      select
  school_id,
  name,
  address,
  city,
  state,
  zip_code,
  created_at
from "carton_caps_20260203T222227Z"."main"."stg_schools"
    );
  
  
[0m17:22:32.062017 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m17:22:32.062017 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m17:22:32.062017 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:22:32.067142 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:22:32.067142 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m17:22:32.067142 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:22:32.067142 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m17:22:32.067142 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */
alter table "carton_caps_20260203T222227Z"."main"."fct_rewards__dbt_tmp" rename to "fct_rewards"
[0m17:22:32.067142 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:22:32.067142 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:22:32.067142 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */
alter table "carton_caps_20260203T222227Z"."main"."dim_school__dbt_tmp" rename to "dim_school"
[0m17:22:32.067142 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:22:32.067142 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */
alter table "carton_caps_20260203T222227Z"."main"."fct_referral__dbt_tmp" rename to "fct_referral"
[0m17:22:32.067142 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.067142 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:22:32.067142 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m17:22:32.067142 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:22:32.067142 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

      drop table if exists "carton_caps_20260203T222227Z"."main"."dim_product__dbt_backup" cascade
    
[0m17:22:32.067142 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:22:32.067142 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:22:32.083207 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m17:22:32.083207 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m17:22:32.083207 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m17:22:32.083207 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.083207 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:22:32.083207 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:22:32.083207 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: Close
[0m17:22:32.083207 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m17:22:32.083207 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m17:22:32.083207 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:22:32.083207 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9FF6DD60>]}
[0m17:22:32.083207 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:22:32.083207 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:32.083207 [info ] [Thread-2 (]: 26 of 44 OK created sql table model main.dim_product ........................... [[32mOK[0m in 0.08s]
[0m17:22:32.083207 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

      drop table if exists "carton_caps_20260203T222227Z"."main"."fct_rewards__dbt_backup" cascade
    
[0m17:22:32.094090 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:22:32.094090 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.dim_product
[0m17:22:32.094090 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:22:32.094090 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

      drop table if exists "carton_caps_20260203T222227Z"."main"."dim_school__dbt_backup" cascade
    
[0m17:22:32.094090 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.094090 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.dim_user
[0m17:22:32.094090 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:22:32.100381 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: Close
[0m17:22:32.111383 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m17:22:32.111383 [info ] [Thread-2 (]: 29 of 44 START sql table model main.dim_user ................................... [RUN]
[0m17:22:32.111383 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

      drop table if exists "carton_caps_20260203T222227Z"."main"."fct_referral__dbt_backup" cascade
    
[0m17:22:32.111383 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: Close
[0m17:22:32.111383 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_product, now model.dbt_carton_caps.dim_user)
[0m17:22:32.111383 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9FFE3BC0>]}
[0m17:22:32.111383 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9FFC7DA0>]}
[0m17:22:32.111383 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.dim_user
[0m17:22:32.111383 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.127015 [info ] [Thread-3 (]: 25 of 44 OK created sql table model main.fct_rewards ........................... [[32mOK[0m in 0.11s]
[0m17:22:32.127015 [info ] [Thread-4 (]: 28 of 44 OK created sql table model main.dim_school ............................ [[32mOK[0m in 0.07s]
[0m17:22:32.127015 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_user"
[0m17:22:32.127015 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: Close
[0m17:22:32.142644 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.fct_rewards
[0m17:22:32.142644 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.dim_school
[0m17:22:32.142644 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.fct_purchase
[0m17:22:32.142644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9FFE4C80>]}
[0m17:22:32.142644 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:22:32.142644 [info ] [Thread-3 (]: 30 of 44 START sql table model main.fct_purchase ............................... [RUN]
[0m17:22:32.142644 [info ] [Thread-1 (]: 27 of 44 OK created sql table model main.fct_referral .......................... [[32mOK[0m in 0.12s]
[0m17:22:32.142644 [info ] [Thread-4 (]: 31 of 44 START test not_null_dim_product_product_id ............................ [RUN]
[0m17:22:32.142644 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.dim_user
[0m17:22:32.142644 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_rewards, now model.dbt_carton_caps.fct_purchase)
[0m17:22:32.142644 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.fct_referral
[0m17:22:32.142644 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_school, now test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816)
[0m17:22:32.142644 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_user"
[0m17:22:32.142644 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.fct_purchase
[0m17:22:32.142644 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:22:32.142644 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:22:32.158276 [info ] [Thread-1 (]: 32 of 44 START test unique_dim_product_product_id .............................. [RUN]
[0m17:22:32.158276 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_purchase"
[0m17:22:32.162178 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:22:32.162178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_referral, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m17:22:32.162178 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:22:32.162178 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:22:32.162178 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: BEGIN
[0m17:22:32.162178 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:22:32.162178 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:32.162178 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.fct_purchase
[0m17:22:32.162178 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:22:32.169378 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_purchase"
[0m17:22:32.169378 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:22:32.169378 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:22:32.169378 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:22:32.169378 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:22:32.169378 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:22:32.169378 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

  
    
    

    create  table
      "carton_caps_20260203T222227Z"."main"."dim_user__dbt_tmp"
  
    as (
      select
  u.user_id,
  u.first_name,
  u.last_name,
  u.email,
  u.school_id,
  s.name as school_name,
  s.state as school_state,
  u.created_at,
  u.user_type,
  u.is_verified,
  u.device_id,
  u.marketing_channel
from "carton_caps_20260203T222227Z"."main"."stg_users" u
left join "carton_caps_20260203T222227Z"."main"."stg_schools" s
  on u.school_id = s.school_id
    );
  
  
[0m17:22:32.169378 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:22:32.169378 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:22:32.174060 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: BEGIN
[0m17:22:32.174060 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m17:22:32.174060 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:22:32.174060 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:32.174060 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:32.174060 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m17:22:32.174060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:32.174060 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:22:32.174060 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:32.174060 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:22:32.174060 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.174060 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:22:32.174060 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:22:32.174060 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

  
    
    

    create  table
      "carton_caps_20260203T222227Z"."main"."fct_purchase__dbt_tmp"
  
    as (
      select
  p.purchase_id,
  p.user_id,
  u.school_id,
  p.product_id,
  pr.category as product_category,
  p.quantity,
  p.price_paid,
  p.points_earned,
  p.purchased_at,
  date_trunc('day', p.purchased_at) as purchase_date,
  p.day_of_week,
  p.hour_of_day
from "carton_caps_20260203T222227Z"."main"."stg_purchases" p
left join "carton_caps_20260203T222227Z"."main"."stg_users" u
  on p.user_id = u.user_id
left join "carton_caps_20260203T222227Z"."main"."stg_products" pr
  on p.product_id = pr.product_id
    );
  
  
[0m17:22:32.174060 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:22:32.174060 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:22:32.174060 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T222227Z"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:32.174060 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:32.174060 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */
alter table "carton_caps_20260203T222227Z"."main"."dim_user__dbt_tmp" rename to "dim_user"
[0m17:22:32.174060 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:22:32.174060 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m17:22:32.174060 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.174060 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:22:32.174060 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m17:22:32.174060 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:22:32.174060 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m17:22:32.174060 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:22:32.174060 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m17:22:32.174060 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:22:32.174060 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m17:22:32.174060 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m17:22:32.174060 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:22:32.174060 [info ] [Thread-4 (]: 31 of 44 PASS not_null_dim_product_product_id .................................. [[32mPASS[0m in 0.03s]
[0m17:22:32.189829 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m17:22:32.189829 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */
alter table "carton_caps_20260203T222227Z"."main"."fct_purchase__dbt_tmp" rename to "fct_purchase"
[0m17:22:32.189829 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:22:32.189829 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:22:32.189829 [info ] [Thread-4 (]: 33 of 44 START test not_null_fct_rewards_reward_id ............................. [RUN]
[0m17:22:32.189829 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.189829 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m17:22:32.189829 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m17:22:32.189829 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:22:32.189829 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:22:32.189829 [info ] [Thread-1 (]: 32 of 44 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.03s]
[0m17:22:32.189829 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:22:32.194064 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:22:32.194064 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:22:32.194064 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:22:32.194064 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m17:22:32.194064 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

      drop table if exists "carton_caps_20260203T222227Z"."main"."dim_user__dbt_backup" cascade
    
[0m17:22:32.194064 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:22:32.194064 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:22:32.194064 [info ] [Thread-1 (]: 34 of 44 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m17:22:32.194064 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.194064 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:22:32.194064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m17:22:32.194064 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:22:32.194064 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_user: Close
[0m17:22:32.194064 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:22:32.194064 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:22:32.205888 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CEA0005880>]}
[0m17:22:32.208091 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:22:32.208091 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:22:32.208091 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

      drop table if exists "carton_caps_20260203T222227Z"."main"."fct_purchase__dbt_backup" cascade
    
[0m17:22:32.209091 [info ] [Thread-2 (]: 29 of 44 OK created sql table model main.dim_user .............................. [[32mOK[0m in 0.09s]
[0m17:22:32.209091 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m17:22:32.210092 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.dim_user
[0m17:22:32.210092 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:32.210092 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.210092 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:22:32.211093 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:22:32.212091 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: Close
[0m17:22:32.212091 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:32.212091 [info ] [Thread-2 (]: 35 of 44 START test not_null_dim_school_school_id .............................. [RUN]
[0m17:22:32.214091 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:22:32.214091 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61d7cda-3512-48ce-8d96-d19bb61d4520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9EF489E0>]}
[0m17:22:32.214091 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:22:32.215091 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_user, now test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b)
[0m17:22:32.215091 [info ] [Thread-3 (]: 30 of 44 OK created sql table model main.fct_purchase .......................... [[32mOK[0m in 0.07s]
[0m17:22:32.215091 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps_20260203T222227Z"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:32.216092 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:22:32.216092 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.fct_purchase
[0m17:22:32.216092 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:22:32.218091 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:22:32.219091 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:22:32.219091 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:22:32.219091 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m17:22:32.220091 [info ] [Thread-3 (]: 36 of 44 START test unique_dim_school_school_id ................................ [RUN]
[0m17:22:32.221091 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m17:22:32.221091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:32.221091 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_purchase, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m17:22:32.221091 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:22:32.222324 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m17:22:32.222324 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:22:32.224323 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:22:32.224323 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:22:32.225321 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m17:22:32.227321 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:22:32.227321 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:22:32.228322 [info ] [Thread-4 (]: 33 of 44 PASS not_null_fct_rewards_reward_id ................................... [[32mPASS[0m in 0.04s]
[0m17:22:32.228322 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:32.228322 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:22:32.229322 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:22:32.229322 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:22:32.229322 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:22:32.230323 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m17:22:32.230323 [info ] [Thread-4 (]: 37 of 44 START test not_null_fct_referral_referral_id .......................... [RUN]
[0m17:22:32.232323 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:22:32.232323 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:22:32.232323 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:32.233322 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m17:22:32.234322 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m17:22:32.234322 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:22:32.234322 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:22:32.235322 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m17:22:32.238321 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:22:32.238321 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:22:32.239321 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:22:32.239321 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m17:22:32.239321 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m17:22:32.240322 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T222227Z"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:32.240322 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:32.240322 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:22:32.240322 [info ] [Thread-1 (]: 34 of 44 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.05s]
[0m17:22:32.242322 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:22:32.242322 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:22:32.243321 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:22:32.243321 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:22:32.243321 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:22:32.244321 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:22:32.244321 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m17:22:32.245323 [info ] [Thread-1 (]: 38 of 44 START test unique_fct_referral_referral_id ............................ [RUN]
[0m17:22:32.245323 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:22:32.245323 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:32.246321 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:22:32.246321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m17:22:32.246321 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m17:22:32.247321 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m17:22:32.247321 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:22:32.247321 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:32.248321 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.250321 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:22:32.248321 [info ] [Thread-2 (]: 35 of 44 PASS not_null_dim_school_school_id .................................... [[32mPASS[0m in 0.03s]
[0m17:22:32.251321 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m17:22:32.251321 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:22:32.252321 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:22:32.252321 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:22:32.253322 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m17:22:32.253322 [debug] [Thread-2 (]: Began running node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:22:32.253705 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:22:32.253705 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T222227Z"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:32.253705 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m17:22:32.253705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now exposure.dbt_carton_caps.streamlit_referral_finance_dashboard)
[0m17:22:32.255731 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:22:32.256731 [debug] [Thread-2 (]: Began compiling node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:22:32.255731 [info ] [Thread-3 (]: 36 of 44 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m17:22:32.256731 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.256731 [debug] [Thread-2 (]: Began executing node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:22:32.257731 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:22:32.257731 [info ] [Thread-2 (]: 39 of 44 NO-OP exposure streamlit_referral_finance_dashboard ................... [[33mNO-OP[0m in 0.00s]
[0m17:22:32.258731 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m17:22:32.258731 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:22:32.258731 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:22:32.259731 [debug] [Thread-2 (]: Finished running node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:22:32.259731 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m17:22:32.259731 [info ] [Thread-3 (]: 40 of 44 START test not_null_dim_user_user_id .................................. [RUN]
[0m17:22:32.260731 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m17:22:32.260731 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:22:32.260731 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m17:22:32.260731 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76, now test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3)
[0m17:22:32.261731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:32.261731 [info ] [Thread-2 (]: 41 of 44 START test unique_dim_user_user_id .................................... [RUN]
[0m17:22:32.261731 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:22:32.261731 [info ] [Thread-4 (]: 37 of 44 PASS not_null_fct_referral_referral_id ................................ [[32mPASS[0m in 0.03s]
[0m17:22:32.262731 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly exposure.dbt_carton_caps.streamlit_referral_finance_dashboard, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m17:22:32.264731 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:22:32.265731 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:22:32.265731 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:22:32.265731 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:22:32.265731 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:22:32.266731 [debug] [Thread-4 (]: Began running node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:22:32.268731 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:22:32.268731 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:32.268731 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:22:32.269731 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now exposure.dbt_carton_caps.streamlit_product_dashboard)
[0m17:22:32.270733 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:22:32.271731 [debug] [Thread-4 (]: Began compiling node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:22:32.271731 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:22:32.271731 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:22:32.271731 [debug] [Thread-4 (]: Began executing node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:22:32.272732 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m17:22:32.274730 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:22:32.274730 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:22:32.274730 [info ] [Thread-4 (]: 42 of 44 NO-OP exposure streamlit_product_dashboard ............................ [[33mNO-OP[0m in 0.00s]
[0m17:22:32.275731 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m17:22:32.275731 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m17:22:32.275731 [debug] [Thread-4 (]: Finished running node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:22:32.276731 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m17:22:32.276731 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:32.276731 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:22:32.276731 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:22:32.277731 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m17:22:32.277731 [info ] [Thread-1 (]: 38 of 44 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.03s]
[0m17:22:32.277731 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:22:32.278731 [info ] [Thread-4 (]: 43 of 44 START test not_null_fct_purchase_purchase_id .......................... [RUN]
[0m17:22:32.278731 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:32.278731 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:22:32.278731 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:22:32.279733 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly exposure.dbt_carton_caps.streamlit_product_dashboard, now test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1)
[0m17:22:32.279733 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:22:32.279733 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T222227Z"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:32.280733 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:22:32.280733 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:22:32.280733 [info ] [Thread-1 (]: 44 of 44 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m17:22:32.280733 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:22:32.283734 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:22:32.283734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m17:22:32.283734 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:22:32.283734 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:32.284734 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:22:32.285734 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m17:22:32.287733 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:22:32.287733 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:22:32.288733 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:22:32.288733 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:22:32.288733 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m17:22:32.288733 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m17:22:32.288733 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:22:32.288733 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m17:22:32.288733 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:22:32.288733 [info ] [Thread-3 (]: 40 of 44 PASS not_null_dim_user_user_id ........................................ [[32mPASS[0m in 0.03s]
[0m17:22:32.288733 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m17:22:32.294330 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:22:32.294330 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:22:32.294330 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:22:32.294330 [info ] [Thread-2 (]: 41 of 44 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.03s]
[0m17:22:32.294330 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m17:22:32.294330 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:22:32.294330 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:32.294330 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:22:32.294330 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m17:22:32.294330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:32.294330 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.294330 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:22:32.294330 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T222227Z"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:32.294330 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.294330 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:22:32.294330 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:32.294330 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:22:32.294330 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m17:22:32.294330 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:22:32.294330 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m17:22:32.294330 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:22:32.294330 [info ] [Thread-4 (]: 43 of 44 PASS not_null_fct_purchase_purchase_id ................................ [[32mPASS[0m in 0.01s]
[0m17:22:32.294330 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m17:22:32.294330 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:22:32.304433 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m17:22:32.304433 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m17:22:32.304433 [info ] [Thread-1 (]: 44 of 44 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.02s]
[0m17:22:32.304433 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:22:32.304433 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:32.304433 [debug] [MainThread]: On master: BEGIN
[0m17:22:32.304433 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:22:32.304433 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:22:32.304433 [debug] [MainThread]: On master: COMMIT
[0m17:22:32.304433 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:32.304433 [debug] [MainThread]: On master: COMMIT
[0m17:22:32.304433 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:22:32.304433 [debug] [MainThread]: On master: Close
[0m17:22:32.304433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:32.304433 [debug] [MainThread]: Connection 'create_carton_caps_20260203T222227Z_main' was properly closed.
[0m17:22:32.304433 [debug] [MainThread]: Connection 'list_carton_caps_20260203T222227Z_main' was properly closed.
[0m17:22:32.304433 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a' was properly closed.
[0m17:22:32.304433 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278' was properly closed.
[0m17:22:32.304433 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3' was properly closed.
[0m17:22:32.304433 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1' was properly closed.
[0m17:22:32.304433 [info ] [MainThread]: 
[0m17:22:32.304433 [info ] [MainThread]: Finished running 2 exposures, 6 table models, 30 data tests, 6 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m17:22:32.304433 [debug] [MainThread]: Command end result
[0m17:22:32.325443 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:22:32.327184 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:22:32.331270 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\run_results.json
[0m17:22:32.331270 [info ] [MainThread]: 
[0m17:22:32.332270 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:22:32.332270 [info ] [MainThread]: 
[0m17:22:32.332270 [info ] [MainThread]: Done. PASS=42 WARN=0 ERROR=0 SKIP=0 NO-OP=2 TOTAL=44
[0m17:22:32.333270 [debug] [MainThread]: Command `dbt build` succeeded at 17:22:32.332270 after 2.15 seconds
[0m17:22:32.333270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9C7EC8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9B9B0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE9EA98B30>]}
[0m17:22:32.333270 [debug] [MainThread]: Flushing usage events
[0m17:22:32.696325 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:22:34.209137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024192EB4260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024192EB7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024192EB72C0>]}


============================== 17:22:34.213373 | 07df5f0e-a587-4af7-8cbe-f3a37ccc2008 ==============================
[0m17:22:34.213373 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:22:34.213373 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'use_colors': 'True', 'invocation_command': 'dbt test --profiles-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps --project-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m17:22:34.359930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07df5f0e-a587-4af7-8cbe-f3a37ccc2008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024192B64380>]}
[0m17:22:34.400808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07df5f0e-a587-4af7-8cbe-f3a37ccc2008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241948B58B0>]}
[0m17:22:34.402808 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:22:34.560396 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:22:34.663669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:22:34.664669 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:22:34.664669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:22:34.697830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07df5f0e-a587-4af7-8cbe-f3a37ccc2008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002419461D670>]}
[0m17:22:34.758845 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:22:34.759846 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:22:34.781635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07df5f0e-a587-4af7-8cbe-f3a37ccc2008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024194EB1B80>]}
[0m17:22:34.782638 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:22:34.782638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07df5f0e-a587-4af7-8cbe-f3a37ccc2008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024194E89D30>]}
[0m17:22:34.784637 [info ] [MainThread]: 
[0m17:22:34.784637 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:22:34.785473 [info ] [MainThread]: 
[0m17:22:34.785473 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:22:34.788636 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T222227Z_main'
[0m17:22:34.832436 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T222227Z_main"
[0m17:22:34.833435 [debug] [ThreadPool]: On list_carton_caps_20260203T222227Z_main: BEGIN
[0m17:22:34.833435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:34.854069 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:22:34.854069 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T222227Z_main"
[0m17:22:34.854917 [debug] [ThreadPool]: On list_carton_caps_20260203T222227Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T222227Z_main"} */
select
      'carton_caps_20260203T222227Z' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps_20260203t222227z'
  
[0m17:22:34.863235 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:22:34.864234 [debug] [ThreadPool]: On list_carton_caps_20260203T222227Z_main: ROLLBACK
[0m17:22:34.865233 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_20260203T222227Z_main'
[0m17:22:34.865233 [debug] [ThreadPool]: On list_carton_caps_20260203T222227Z_main: Close
[0m17:22:34.867236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07df5f0e-a587-4af7-8cbe-f3a37ccc2008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024193520680>]}
[0m17:22:34.867236 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:34.867236 [debug] [MainThread]: On master: BEGIN
[0m17:22:34.867236 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:22:34.868236 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:22:34.868789 [debug] [MainThread]: On master: COMMIT
[0m17:22:34.868789 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:34.868789 [debug] [MainThread]: On master: COMMIT
[0m17:22:34.868789 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:22:34.868789 [debug] [MainThread]: On master: Close
[0m17:22:34.871894 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:22:34.871894 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:22:34.872894 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:22:34.872894 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:22:34.871894 [info ] [Thread-1 (]: 1 of 30 START test not_null_dim_product_product_id ............................. [RUN]
[0m17:22:34.872894 [info ] [Thread-2 (]: 2 of 30 START test not_null_dim_school_school_id ............................... [RUN]
[0m17:22:34.872894 [info ] [Thread-3 (]: 3 of 30 START test not_null_dim_user_user_id ................................... [RUN]
[0m17:22:34.873893 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:22:34.873893 [info ] [Thread-4 (]: 4 of 30 START test not_null_fct_purchase_purchase_id ........................... [RUN]
[0m17:22:34.873893 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:22:34.874893 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:22:34.874893 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:22:34.874893 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:22:34.875726 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:22:34.875726 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:22:34.885821 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:22:34.885821 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:22:34.887821 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:22:34.890890 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:22:34.892888 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:22:34.893889 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:22:34.903235 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:22:34.903549 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:22:34.904774 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:22:34.904774 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:22:34.905774 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:22:34.905774 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:22:34.906774 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:22:34.907773 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:22:34.908773 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m17:22:34.908773 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:22:34.908773 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:22:34.909774 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m17:22:34.909774 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:22:34.910537 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:22:34.910537 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:22:34.910537 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:22:34.910537 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m17:22:34.911692 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m17:22:34.911692 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:22:34.911692 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:22:34.911692 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:22:34.912692 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:22:34.912692 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:22:34.912692 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T222227Z"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:34.913691 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T222227Z"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:34.913691 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:22:34.913691 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:22:34.913691 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:22:34.914693 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:22:34.914693 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:34.914693 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T222227Z"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:34.915693 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:34.915693 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T222227Z"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:34.917497 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m17:22:34.918684 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m17:22:34.919685 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:22:34.919685 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:22:34.919685 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:34.920685 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:22:34.921685 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m17:22:34.921685 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m17:22:34.922685 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m17:22:34.922685 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m17:22:34.923685 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:22:34.923685 [info ] [Thread-3 (]: 3 of 30 PASS not_null_dim_user_user_id ......................................... [[32mPASS[0m in 0.05s]
[0m17:22:34.924427 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:22:34.924427 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m17:22:34.924427 [info ] [Thread-1 (]: 1 of 30 PASS not_null_dim_product_product_id ................................... [[32mPASS[0m in 0.05s]
[0m17:22:34.925558 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:22:34.925558 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m17:22:34.926558 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:22:34.925558 [info ] [Thread-2 (]: 2 of 30 PASS not_null_dim_school_school_id ..................................... [[32mPASS[0m in 0.05s]
[0m17:22:34.926558 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:22:34.926558 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:22:34.926558 [info ] [Thread-4 (]: 4 of 30 PASS not_null_fct_purchase_purchase_id ................................. [[32mPASS[0m in 0.05s]
[0m17:22:34.927558 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:22:34.927558 [info ] [Thread-3 (]: 5 of 30 START test not_null_fct_referral_referral_id ........................... [RUN]
[0m17:22:34.927558 [info ] [Thread-1 (]: 6 of 30 START test not_null_fct_rewards_reward_id .............................. [RUN]
[0m17:22:34.928558 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:22:34.928558 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:22:34.928558 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m17:22:34.928558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m17:22:34.929558 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:22:34.929558 [info ] [Thread-2 (]: 7 of 30 START test not_null_stg_events_event_id ................................ [RUN]
[0m17:22:34.929558 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:22:34.929558 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:22:34.930558 [info ] [Thread-4 (]: 8 of 30 START test not_null_stg_events_user_id ................................. [RUN]
[0m17:22:34.930558 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m17:22:34.932576 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:22:34.935578 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:22:34.935578 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m17:22:34.935578 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:22:34.936577 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:22:34.938267 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:22:34.940378 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:22:34.941377 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:22:34.941377 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:22:34.942377 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:22:34.945211 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:22:34.945211 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:22:34.945211 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:22:34.979240 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:22:34.979929 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:22:34.981062 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:22:34.981062 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m17:22:34.981062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:34.982062 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:22:34.982062 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m17:22:34.982062 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:34.982062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:34.983065 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:22:34.983065 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:22:34.983065 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:22:34.984065 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m17:22:34.984065 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:34.984065 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m17:22:34.984065 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps_20260203T222227Z"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:34.985066 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:34.985066 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:22:34.985066 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:34.985066 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T222227Z"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:34.986066 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:34.986066 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:34.986869 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:22:34.986869 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m17:22:34.988083 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:22:34.988083 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:22:34.988083 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:34.989084 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m17:22:34.989084 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T222227Z"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:34.989084 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps_20260203T222227Z"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:34.989084 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m17:22:34.990084 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m17:22:34.991085 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m17:22:34.991085 [info ] [Thread-1 (]: 6 of 30 PASS not_null_fct_rewards_reward_id .................................... [[32mPASS[0m in 0.06s]
[0m17:22:34.992083 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:22:34.992083 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m17:22:34.992083 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:22:34.992083 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:22:34.993796 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m17:22:34.994885 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m17:22:34.993796 [info ] [Thread-4 (]: 8 of 30 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.06s]
[0m17:22:34.994885 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:22:34.995884 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m17:22:34.995884 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m17:22:34.995884 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:22:34.995884 [info ] [Thread-1 (]: 9 of 30 START test not_null_stg_products_product_id ............................ [RUN]
[0m17:22:34.997387 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m17:22:34.997387 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m17:22:34.997387 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:22:34.997387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m17:22:34.998392 [info ] [Thread-3 (]: 5 of 30 PASS not_null_fct_referral_referral_id ................................. [[32mPASS[0m in 0.07s]
[0m17:22:34.998392 [info ] [Thread-2 (]: 7 of 30 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.07s]
[0m17:22:34.998392 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:22:34.998392 [info ] [Thread-4 (]: 10 of 30 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m17:22:34.999392 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:22:34.999392 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:22:35.001861 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:22:35.001861 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m17:22:35.002862 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:22:35.002862 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:22:35.002862 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:22:35.003862 [info ] [Thread-3 (]: 11 of 30 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m17:22:35.003862 [info ] [Thread-2 (]: 12 of 30 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m17:22:35.005864 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:22:35.005864 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:22:35.006863 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m17:22:35.006863 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m17:22:35.008806 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:22:35.010806 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:22:35.011806 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:22:35.012807 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:22:35.013806 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:22:35.016835 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:22:35.018836 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:22:35.018836 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:22:35.018836 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m17:22:35.019837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:35.019837 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:22:35.020837 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:35.020837 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:22:35.020837 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:22:35.022342 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:22:35.022342 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:22:35.022342 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m17:22:35.022342 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:22:35.022342 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T222227Z"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:35.022342 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:35.022342 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:22:35.022342 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m17:22:35.022342 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:35.022342 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:35.022342 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:35.022342 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:35.022342 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m17:22:35.028545 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:22:35.028545 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:22:35.028545 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:22:35.029551 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m17:22:35.029551 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T222227Z"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:35.029551 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m17:22:35.030551 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T222227Z"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:35.030551 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m17:22:35.030551 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:35.031550 [info ] [Thread-1 (]: 9 of 30 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.03s]
[0m17:22:35.031550 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:22:35.031550 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:22:35.032551 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:35.032551 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:22:35.033551 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m17:22:35.033551 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:22:35.034551 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m17:22:35.034551 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:22:35.035555 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m17:22:35.035555 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T222227Z"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:35.036555 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m17:22:35.036555 [info ] [Thread-1 (]: 13 of 30 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m17:22:35.036555 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m17:22:35.036555 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m17:22:35.037555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m17:22:35.037555 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:22:35.037555 [info ] [Thread-3 (]: 11 of 30 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.03s]
[0m17:22:35.038555 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:22:35.038555 [info ] [Thread-4 (]: 10 of 30 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.04s]
[0m17:22:35.038555 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:22:35.039555 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m17:22:35.043557 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:22:35.043557 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:22:35.043557 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:22:35.044555 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m17:22:35.044555 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:22:35.044555 [info ] [Thread-3 (]: 14 of 30 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m17:22:35.045556 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m17:22:35.045556 [info ] [Thread-4 (]: 15 of 30 START test not_null_stg_schools_school_id ............................. [RUN]
[0m17:22:35.045556 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m17:22:35.045556 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:22:35.046555 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m17:22:35.046555 [info ] [Thread-2 (]: 12 of 30 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.04s]
[0m17:22:35.046555 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:22:35.048555 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:22:35.048555 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:22:35.048555 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:22:35.051363 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:22:35.053576 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:22:35.054110 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:22:35.054638 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:22:35.054638 [info ] [Thread-2 (]: 16 of 30 START test not_null_stg_users_school_id ............................... [RUN]
[0m17:22:35.055221 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m17:22:35.055221 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m17:22:35.055754 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:22:35.055754 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:22:35.056320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:35.056320 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:22:35.057920 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:22:35.058978 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:22:35.061076 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:22:35.061601 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:22:35.062128 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:22:35.062128 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T222227Z"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:35.062128 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:22:35.063132 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m17:22:35.063132 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:22:35.063132 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:35.063132 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m17:22:35.064133 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:22:35.064133 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:22:35.064133 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:35.065132 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:22:35.066134 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:22:35.066134 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:22:35.067133 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m17:22:35.067133 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:22:35.068132 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T222227Z"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:35.068132 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:22:35.068132 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m17:22:35.069132 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:22:35.069132 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps_20260203T222227Z"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:35.069132 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m17:22:35.070132 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:22:35.070132 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m17:22:35.071339 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m17:22:35.071339 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:35.070132 [info ] [Thread-1 (]: 13 of 30 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.03s]
[0m17:22:35.072340 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:22:35.072340 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m17:22:35.073339 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:22:35.073339 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:22:35.074339 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m17:22:35.074339 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m17:22:35.074339 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:22:35.074339 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:22:35.075339 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m17:22:35.075339 [info ] [Thread-1 (]: 17 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m17:22:35.076339 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T222227Z"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:35.076339 [info ] [Thread-4 (]: 15 of 30 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.03s]
[0m17:22:35.076339 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m17:22:35.077161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m17:22:35.077161 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:22:35.078261 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:22:35.077161 [info ] [Thread-3 (]: 14 of 30 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.03s]
[0m17:22:35.078261 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:22:35.078261 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m17:22:35.081259 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:22:35.081259 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:22:35.081259 [info ] [Thread-4 (]: 18 of 30 START test test_events_in_window ...................................... [RUN]
[0m17:22:35.082260 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m17:22:35.082260 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:22:35.083265 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.test_events_in_window)
[0m17:22:35.084073 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m17:22:35.083265 [info ] [Thread-3 (]: 19 of 30 START test unique_dim_product_product_id .............................. [RUN]
[0m17:22:35.084073 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:22:35.084073 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m17:22:35.085509 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m17:22:35.085509 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m17:22:35.087000 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:22:35.089003 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m17:22:35.090003 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:22:35.090003 [info ] [Thread-2 (]: 16 of 30 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:22:35.094254 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:22:35.095254 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:22:35.095254 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:22:35.096253 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:22:35.096253 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m17:22:35.097252 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m17:22:35.098109 [info ] [Thread-2 (]: 20 of 30 START test unique_dim_school_school_id ................................ [RUN]
[0m17:22:35.098109 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:22:35.100156 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m17:22:35.100156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:35.101155 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m17:22:35.101975 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:22:35.101975 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:22:35.101975 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:22:35.106066 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:22:35.106066 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:22:35.106066 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:22:35.107067 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T222227Z"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:22:35.107067 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:22:35.107067 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m17:22:35.108067 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m17:22:35.108067 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:22:35.108067 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:35.108067 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:35.109067 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:22:35.110069 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:22:35.110069 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:35.111068 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m17:22:35.111890 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:22:35.111890 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:22:35.111890 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:22:35.112992 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m17:22:35.112992 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps_20260203T222227Z"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m17:22:35.112992 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:22:35.113993 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:35.113993 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m17:22:35.113993 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m17:22:35.114992 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:35.114992 [info ] [Thread-1 (]: 17 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.04s]
[0m17:22:35.114992 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:22:35.115992 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:22:35.115992 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:22:35.115992 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:22:35.116992 [info ] [Thread-1 (]: 21 of 30 START test unique_dim_user_user_id .................................... [RUN]
[0m17:22:35.116992 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:22:35.116992 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:22:35.117992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m17:22:35.118840 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m17:22:35.118840 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:35.118840 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:22:35.119953 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m17:22:35.122952 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:22:35.122952 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m17:22:35.123952 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:22:35.123952 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m17:22:35.124952 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m17:22:35.125783 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m17:22:35.125783 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m17:22:35.126884 [info ] [Thread-3 (]: 19 of 30 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.04s]
[0m17:22:35.126884 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:22:35.127885 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m17:22:35.127885 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:22:35.129884 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:22:35.128884 [info ] [Thread-4 (]: 18 of 30 PASS test_events_in_window ............................................ [[32mPASS[0m in 0.04s]
[0m17:22:35.130883 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m17:22:35.130883 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:22:35.131883 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m17:22:35.132737 [info ] [Thread-2 (]: 20 of 30 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m17:22:35.132737 [info ] [Thread-3 (]: 22 of 30 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m17:22:35.132737 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:22:35.133918 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:22:35.133918 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:22:35.133918 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m17:22:35.134917 [info ] [Thread-4 (]: 23 of 30 START test unique_fct_referral_referral_id ............................ [RUN]
[0m17:22:35.134917 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m17:22:35.135917 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:22:35.135917 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:22:35.135917 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m17:22:35.135917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:35.136917 [info ] [Thread-2 (]: 24 of 30 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m17:22:35.140784 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:22:35.140784 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:22:35.141784 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m17:22:35.141784 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:22:35.144783 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:22:35.145783 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:22:35.145783 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:22:35.149794 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:22:35.149794 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:22:35.150794 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:35.153582 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:22:35.153582 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:22:35.153582 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:22:35.156729 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:22:35.157729 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:22:35.157729 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:22:35.158728 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:22:35.159730 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m17:22:35.160550 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:22:35.160550 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m17:22:35.160550 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m17:22:35.160550 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:22:35.161681 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m17:22:35.162680 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:35.162680 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:35.162680 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m17:22:35.162680 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m17:22:35.163680 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:22:35.163680 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:35.164680 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:35.164680 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:22:35.165680 [info ] [Thread-1 (]: 21 of 30 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.05s]
[0m17:22:35.165680 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:22:35.165680 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:22:35.166680 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:35.166680 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:22:35.167681 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:35.167681 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:22:35.167681 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:22:35.168680 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:35.168680 [info ] [Thread-1 (]: 25 of 30 START test unique_stg_events_event_id ................................. [RUN]
[0m17:22:35.169680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m17:22:35.170682 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:22:35.170682 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:22:35.173680 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:22:35.174397 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:22:35.174397 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:22:35.176533 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m17:22:35.177532 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m17:22:35.178531 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m17:22:35.178531 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:22:35.179531 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m17:22:35.180531 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m17:22:35.181353 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:22:35.182555 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m17:22:35.182555 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m17:22:35.183557 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m17:22:35.183557 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m17:22:35.184557 [info ] [Thread-4 (]: 23 of 30 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.05s]
[0m17:22:35.184557 [info ] [Thread-2 (]: 24 of 30 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:22:35.185558 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:22:35.185558 [info ] [Thread-3 (]: 22 of 30 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.05s]
[0m17:22:35.186557 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:22:35.186557 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:22:35.186557 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m17:22:35.187557 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:22:35.187557 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:22:35.188266 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:22:35.188266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:35.189363 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:22:35.189363 [info ] [Thread-4 (]: 26 of 30 START test unique_stg_products_product_id ............................. [RUN]
[0m17:22:35.189363 [info ] [Thread-2 (]: 27 of 30 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m17:22:35.190363 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m17:22:35.190363 [info ] [Thread-3 (]: 28 of 30 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m17:22:35.191363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m17:22:35.191363 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:22:35.191363 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:22:35.192363 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m17:22:35.192363 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:22:35.192363 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:22:35.195247 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:22:35.195247 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:22:35.198902 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:22:35.199900 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:35.202203 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:22:35.203250 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:22:35.203250 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:22:35.204252 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:22:35.206251 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:22:35.206251 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:22:35.207251 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:22:35.208251 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:22:35.209151 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:22:35.211349 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m17:22:35.211349 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m17:22:35.212351 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:22:35.212351 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:22:35.212351 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m17:22:35.213352 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:35.213352 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m17:22:35.213352 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m17:22:35.213352 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m17:22:35.214352 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:35.214352 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:35.214352 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:22:35.215351 [info ] [Thread-1 (]: 25 of 30 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.05s]
[0m17:22:35.216037 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:22:35.216037 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:22:35.216550 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:22:35.216868 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:22:35.216868 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:22:35.216868 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:35.216868 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:22:35.216868 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:22:35.216868 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:35.216868 [info ] [Thread-1 (]: 29 of 30 START test unique_stg_schools_school_id ............................... [RUN]
[0m17:22:35.216868 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:35.216868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m17:22:35.216868 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:22:35.216868 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:22:35.223006 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:22:35.223006 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m17:22:35.224013 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:22:35.224013 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:22:35.225012 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m17:22:35.225012 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m17:22:35.226012 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m17:22:35.227011 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m17:22:35.227011 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:22:35.227011 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m17:22:35.228012 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m17:22:35.230011 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:22:35.228012 [info ] [Thread-4 (]: 26 of 30 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.04s]
[0m17:22:35.230011 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m17:22:35.230011 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m17:22:35.231011 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:22:35.231011 [info ] [Thread-3 (]: 28 of 30 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.04s]
[0m17:22:35.231011 [info ] [Thread-2 (]: 27 of 30 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.04s]
[0m17:22:35.232011 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:22:35.232011 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:22:35.232011 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:22:35.233012 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:22:35.233012 [info ] [Thread-4 (]: 30 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m17:22:35.233012 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m17:22:35.234011 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m17:22:35.234011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:35.234011 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:22:35.237012 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:22:35.237012 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:22:35.237012 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:22:35.237012 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:35.238011 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:22:35.239013 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:22:35.239013 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:22:35.240010 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m17:22:35.241011 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m17:22:35.241011 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m17:22:35.241011 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:22:35.242011 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m17:22:35.242011 [info ] [Thread-1 (]: 29 of 30 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:22:35.242011 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:35.242011 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:22:35.243010 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:22:35.243010 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:22:35.243795 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T222227Z"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:22:35.244915 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:22:35.245914 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m17:22:35.245914 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m17:22:35.245914 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m17:22:35.246913 [info ] [Thread-4 (]: 30 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.01s]
[0m17:22:35.246913 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:22:35.247916 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:35.247916 [debug] [MainThread]: On master: BEGIN
[0m17:22:35.247916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:22:35.247916 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:22:35.248914 [debug] [MainThread]: On master: COMMIT
[0m17:22:35.248914 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:35.248914 [debug] [MainThread]: On master: COMMIT
[0m17:22:35.248914 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:22:35.249914 [debug] [MainThread]: On master: Close
[0m17:22:35.249914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:35.249914 [debug] [MainThread]: Connection 'list_carton_caps_20260203T222227Z_main' was properly closed.
[0m17:22:35.249914 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6' was properly closed.
[0m17:22:35.249914 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103' was properly closed.
[0m17:22:35.249914 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d' was properly closed.
[0m17:22:35.250779 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m17:22:35.250779 [info ] [MainThread]: 
[0m17:22:35.250779 [info ] [MainThread]: Finished running 30 data tests in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m17:22:35.252868 [debug] [MainThread]: Command end result
[0m17:22:35.266695 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:22:35.268695 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:22:35.272626 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\run_results.json
[0m17:22:35.272626 [info ] [MainThread]: 
[0m17:22:35.273627 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:22:35.273627 [info ] [MainThread]: 
[0m17:22:35.273627 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=30
[0m17:22:35.274626 [debug] [MainThread]: Command `dbt test` succeeded at 17:22:35.273627 after 1.15 seconds
[0m17:22:35.274626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024194D53620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024194990DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241953507D0>]}
[0m17:22:35.274626 [debug] [MainThread]: Flushing usage events
[0m17:22:35.551525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:40:16.500085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C3D37260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C3DF9BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C06D6570>]}


============================== 17:40:16.504139 | 78fe9e70-a7f8-4694-807f-3d39ebe4f476 ==============================
[0m17:40:16.504139 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:40:16.504139 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'use_colors': 'True', 'invocation_command': 'dbt build --profiles-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps --project-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m17:40:16.668124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C4333D10>]}
[0m17:40:16.709363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C1C21E20>]}
[0m17:40:16.710363 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:40:16.971502 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:40:17.052876 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:40:17.053876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C5B682F0>]}
[0m17:40:18.202479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C5FBE870>]}
[0m17:40:18.262225 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:40:18.263985 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:40:18.289799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C5F57E60>]}
[0m17:40:18.289799 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:40:18.291738 [info ] [MainThread]: 
[0m17:40:18.292864 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:40:18.292864 [info ] [MainThread]: 
[0m17:40:18.292864 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:40:18.295862 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T224013Z'
[0m17:40:19.101475 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T224013Z"
[0m17:40:19.102476 [debug] [ThreadPool]: On list_carton_caps_20260203T224013Z: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T224013Z"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps_20260203t224013z"'
    
  
  
[0m17:40:19.102476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:19.122781 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m17:40:19.123313 [debug] [ThreadPool]: On list_carton_caps_20260203T224013Z: Close
[0m17:40:19.123839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_carton_caps_20260203T224013Z, now create_carton_caps_20260203T224013Z_main)
[0m17:40:19.124358 [debug] [ThreadPool]: Creating schema "database: "carton_caps_20260203T224013Z"
schema: "main"
"
[0m17:40:19.128561 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T224013Z_main"
[0m17:40:19.128561 [debug] [ThreadPool]: On create_carton_caps_20260203T224013Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_20260203T224013Z_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='carton_caps_20260203t224013z'
        and type='sqlite'
    
  
[0m17:40:19.129095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:19.129629 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:40:19.130167 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T224013Z_main"
[0m17:40:19.130167 [debug] [ThreadPool]: On create_carton_caps_20260203T224013Z_main: BEGIN
[0m17:40:19.130167 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:19.130167 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T224013Z_main"
[0m17:40:19.130167 [debug] [ThreadPool]: On create_carton_caps_20260203T224013Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_20260203T224013Z_main"} */

    
    
        create schema if not exists "carton_caps_20260203T224013Z"."main"
    
[0m17:40:19.131679 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:19.131679 [debug] [ThreadPool]: On create_carton_caps_20260203T224013Z_main: COMMIT
[0m17:40:19.132684 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T224013Z_main"
[0m17:40:19.132684 [debug] [ThreadPool]: On create_carton_caps_20260203T224013Z_main: COMMIT
[0m17:40:19.133683 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:19.133683 [debug] [ThreadPool]: On create_carton_caps_20260203T224013Z_main: Close
[0m17:40:19.134685 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T224013Z_main'
[0m17:40:19.137685 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T224013Z_main"
[0m17:40:19.138686 [debug] [ThreadPool]: On list_carton_caps_20260203T224013Z_main: BEGIN
[0m17:40:19.138686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:19.138686 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:19.138686 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T224013Z_main"
[0m17:40:19.139685 [debug] [ThreadPool]: On list_carton_caps_20260203T224013Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T224013Z_main"} */
select
      'carton_caps_20260203T224013Z' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps_20260203t224013z'
  
[0m17:40:19.147686 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:40:19.148684 [debug] [ThreadPool]: On list_carton_caps_20260203T224013Z_main: ROLLBACK
[0m17:40:19.161856 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_20260203T224013Z_main'
[0m17:40:19.161856 [debug] [ThreadPool]: On list_carton_caps_20260203T224013Z_main: Close
[0m17:40:19.162859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C5FBF560>]}
[0m17:40:19.162859 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:19.162859 [debug] [MainThread]: On master: BEGIN
[0m17:40:19.163858 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:19.163858 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:19.163858 [debug] [MainThread]: On master: COMMIT
[0m17:40:19.164855 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:19.164855 [debug] [MainThread]: On master: COMMIT
[0m17:40:19.164855 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:19.164855 [debug] [MainThread]: On master: Close
[0m17:40:19.167857 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_events
[0m17:40:19.167857 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.stg_products
[0m17:40:19.167857 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.stg_purchases
[0m17:40:19.168856 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.stg_referrals
[0m17:40:19.168856 [info ] [Thread-1 (]: 1 of 44 START sql view model main.stg_events ................................... [RUN]
[0m17:40:19.168856 [info ] [Thread-2 (]: 2 of 44 START sql view model main.stg_products ................................. [RUN]
[0m17:40:19.169857 [info ] [Thread-3 (]: 3 of 44 START sql view model main.stg_purchases ................................ [RUN]
[0m17:40:19.169857 [info ] [Thread-4 (]: 4 of 44 START sql view model main.stg_referrals ................................ [RUN]
[0m17:40:19.169857 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_events'
[0m17:40:19.170857 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_products'
[0m17:40:19.170857 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_purchases'
[0m17:40:19.170857 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_referrals'
[0m17:40:19.171856 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_events
[0m17:40:19.171856 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.stg_products
[0m17:40:19.171856 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.stg_purchases
[0m17:40:19.171856 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.stg_referrals
[0m17:40:19.176661 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_events"
[0m17:40:19.177660 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_products"
[0m17:40:19.179663 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_purchases"
[0m17:40:19.180638 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_referrals"
[0m17:40:19.181670 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_events
[0m17:40:19.199547 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_events"
[0m17:40:19.199547 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.stg_purchases
[0m17:40:19.201547 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_purchases"
[0m17:40:19.202548 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.stg_referrals
[0m17:40:19.203548 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_referrals"
[0m17:40:19.204547 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:40:19.204547 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.stg_products
[0m17:40:19.204547 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: BEGIN
[0m17:40:19.206547 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_products"
[0m17:40:19.206547 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:40:19.207547 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:40:19.207547 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:40:19.208430 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: BEGIN
[0m17:40:19.208430 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: BEGIN
[0m17:40:19.208430 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.209534 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:40:19.209534 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:40:19.209534 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:40:19.209534 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:40:19.210534 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: BEGIN
[0m17:40:19.210534 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

  
  create view "carton_caps_20260203T224013Z"."main"."stg_events__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T224013Z"."raw"."events"
)
select
  cast(event_id as integer) as event_id,
  cast(user_id as integer) as user_id,
  cast(event_type as varchar) as event_type,
  cast(event_at as timestamp) as event_at,
  cast(referral_id as integer) as referral_id,
  cast(metadata_json as varchar) as metadata_json
from src
  );

[0m17:40:19.210534 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.211534 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:40:19.211534 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.211534 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:40:19.211534 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:40:19.212534 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.212534 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

  
  create view "carton_caps_20260203T224013Z"."main"."stg_purchases__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T224013Z"."raw"."purchases"
)
select
  cast(purchase_id as integer) as purchase_id,
  cast(user_id as integer) as user_id,
  cast(product_id as integer) as product_id,
  cast(quantity as integer) as quantity,
  cast(price_paid as double) as price_paid,
  cast(points_earned as integer) as points_earned,
  cast(purchased_at as timestamp) as purchased_at,
  cast(day_of_week as varchar) as day_of_week,
  cast(hour_of_day as integer) as hour_of_day
from src
  );

[0m17:40:19.212534 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.212534 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

  
  create view "carton_caps_20260203T224013Z"."main"."stg_referrals__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T224013Z"."raw"."referrals"
)
select
  cast(referral_id as integer) as referral_id,
  cast(referrer_user_id as integer) as referrer_user_id,
  lower(cast(referred_email as varchar)) as referred_email,
  cast(referred_user_id as integer) as referred_user_id,
  cast(referral_code as varchar) as referral_code,
  cast(sent_at as timestamp) as sent_at,
  cast(converted_at as timestamp) as converted_at,
  cast(status as varchar) as status
from src
  );

[0m17:40:19.216534 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:40:19.217538 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:40:19.217538 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:40:19.217538 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */
alter view "carton_caps_20260203T224013Z"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m17:40:19.217538 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.218538 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

  
  create view "carton_caps_20260203T224013Z"."main"."stg_products__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T224013Z"."raw"."products"
)
select
  cast(product_id as integer) as product_id,
  cast(name as varchar) as name,
  cast(category as varchar) as category,
  cast(price as double) as price,
  cast(points_per_dollar as integer) as points_per_dollar,
  cast(created_at as timestamp) as created_at
from src
  );

[0m17:40:19.219537 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:40:19.221537 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:40:19.222538 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.222538 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */
alter view "carton_caps_20260203T224013Z"."main"."stg_purchases__dbt_tmp" rename to "stg_purchases"
[0m17:40:19.222538 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.222538 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */
alter view "carton_caps_20260203T224013Z"."main"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m17:40:19.228536 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m17:40:19.230237 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:40:19.230237 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:40:19.230237 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.231741 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */
alter view "carton_caps_20260203T224013Z"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m17:40:19.231741 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.231741 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m17:40:19.232746 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m17:40:19.233747 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m17:40:19.233747 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:40:19.233747 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.234746 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:40:19.234746 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m17:40:19.235744 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m17:40:19.235744 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m17:40:19.235744 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:40:19.236745 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m17:40:19.241745 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:40:19.244119 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:40:19.245118 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

      drop view if exists "carton_caps_20260203T224013Z"."main"."stg_events__dbt_backup" cascade
    
[0m17:40:19.245118 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m17:40:19.245118 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:40:19.246120 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m17:40:19.247122 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:40:19.249118 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:40:19.249118 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:40:19.251122 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:40:19.251122 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

      drop view if exists "carton_caps_20260203T224013Z"."main"."stg_referrals__dbt_backup" cascade
    
[0m17:40:19.251122 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

      drop view if exists "carton_caps_20260203T224013Z"."main"."stg_products__dbt_backup" cascade
    
[0m17:40:19.253118 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: Close
[0m17:40:19.253118 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

      drop view if exists "carton_caps_20260203T224013Z"."main"."stg_purchases__dbt_backup" cascade
    
[0m17:40:19.253118 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:40:19.254120 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: Close
[0m17:40:19.254120 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.256124 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: Close
[0m17:40:19.256936 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:40:19.256936 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: Close
[0m17:40:19.258016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C5FAE750>]}
[0m17:40:19.258016 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C5F852B0>]}
[0m17:40:19.259021 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C5F86090>]}
[0m17:40:19.259021 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C5FAC6B0>]}
[0m17:40:19.259021 [info ] [Thread-1 (]: 1 of 44 OK created sql view model main.stg_events .............................. [[32mOK[0m in 0.09s]
[0m17:40:19.260021 [info ] [Thread-4 (]: 4 of 44 OK created sql view model main.stg_referrals ........................... [[32mOK[0m in 0.08s]
[0m17:40:19.260021 [info ] [Thread-2 (]: 2 of 44 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.09s]
[0m17:40:19.261021 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_events
[0m17:40:19.260021 [info ] [Thread-3 (]: 3 of 44 OK created sql view model main.stg_purchases ........................... [[32mOK[0m in 0.09s]
[0m17:40:19.261021 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.stg_referrals
[0m17:40:19.261021 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.stg_products
[0m17:40:19.262021 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_schools
[0m17:40:19.262021 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.stg_purchases
[0m17:40:19.262021 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.stg_users
[0m17:40:19.263021 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:40:19.263021 [info ] [Thread-1 (]: 5 of 44 START sql view model main.stg_schools .................................. [RUN]
[0m17:40:19.263021 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:40:19.263917 [info ] [Thread-4 (]: 6 of 44 START sql view model main.stg_users .................................... [RUN]
[0m17:40:19.263917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_events, now model.dbt_carton_caps.stg_schools)
[0m17:40:19.263917 [info ] [Thread-2 (]: 7 of 44 START test not_null_stg_events_event_id ................................ [RUN]
[0m17:40:19.264941 [info ] [Thread-3 (]: 8 of 44 START test not_null_stg_events_user_id ................................. [RUN]
[0m17:40:19.264941 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_referrals, now model.dbt_carton_caps.stg_users)
[0m17:40:19.264941 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_schools
[0m17:40:19.265941 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_products, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m17:40:19.265941 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_purchases, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m17:40:19.265941 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.stg_users
[0m17:40:19.267943 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_schools"
[0m17:40:19.267943 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:40:19.267943 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:40:19.270115 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_users"
[0m17:40:19.276553 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:40:19.278858 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:40:19.278858 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_schools
[0m17:40:19.280860 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_schools"
[0m17:40:19.280860 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.stg_users
[0m17:40:19.282859 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_users"
[0m17:40:19.283857 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:40:19.283857 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:40:19.283857 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:40:19.293846 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:40:19.295844 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:40:19.295844 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: BEGIN
[0m17:40:19.296845 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:40:19.296845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:19.296845 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: BEGIN
[0m17:40:19.297845 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:40:19.297845 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:40:19.297845 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:19.298845 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.298845 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m17:40:19.298845 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m17:40:19.298845 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:40:19.299845 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:19.299845 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.299845 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:19.299845 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

  
  create view "carton_caps_20260203T224013Z"."main"."stg_schools__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T224013Z"."raw"."schools"
)
select
  cast(school_id as integer) as school_id,
  cast(name as varchar) as name,
  cast(address as varchar) as address,
  cast(city as varchar) as city,
  cast(state as varchar) as state,
  cast(zip_code as varchar) as zip_code,
  cast(created_at as timestamp) as created_at
from src
  );

[0m17:40:19.300845 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:40:19.300845 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.300845 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.301845 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

  
  create view "carton_caps_20260203T224013Z"."main"."stg_users__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T224013Z"."raw"."users"
)
select
  cast(user_id as integer) as user_id,
  cast(first_name as varchar) as first_name,
  cast(last_name as varchar) as last_name,
  lower(cast(email as varchar)) as email,
  cast(school_id as integer) as school_id,
  cast(created_at as timestamp) as created_at,
  cast(user_type as varchar) as user_type,
  cast(is_verified as integer) as is_verified,
  cast(device_id as varchar) as device_id,
  cast(marketing_channel as varchar) as marketing_channel
from src
  );

[0m17:40:19.301845 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:40:19.301845 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.301845 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:40:19.302847 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T224013Z"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.303845 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:40:19.304844 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps_20260203T224013Z"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.304844 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.305545 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */
alter view "carton_caps_20260203T224013Z"."main"."stg_schools__dbt_tmp" rename to "stg_schools"
[0m17:40:19.307294 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:40:19.307294 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.307294 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */
alter view "carton_caps_20260203T224013Z"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:40:19.308295 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:40:19.308295 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.310297 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m17:40:19.310297 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.311295 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m17:40:19.312295 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m17:40:19.312295 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m17:40:19.313557 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m17:40:19.313557 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m17:40:19.314558 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:40:19.314558 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m17:40:19.314558 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:40:19.314558 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m17:40:19.315557 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m17:40:19.315557 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m17:40:19.315557 [info ] [Thread-2 (]: 7 of 44 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.05s]
[0m17:40:19.316557 [info ] [Thread-3 (]: 8 of 44 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.05s]
[0m17:40:19.316557 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:40:19.316557 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:40:19.317561 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m17:40:19.317561 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:40:19.317561 [info ] [Thread-2 (]: 9 of 44 START test test_events_in_window ....................................... [RUN]
[0m17:40:19.318561 [info ] [Thread-3 (]: 10 of 44 START test unique_stg_events_event_id ................................. [RUN]
[0m17:40:19.318561 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.test_events_in_window)
[0m17:40:19.318561 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m17:40:19.319555 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:40:19.319555 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m17:40:19.319555 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:40:19.319555 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:40:19.321641 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:40:19.322644 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m17:40:19.324641 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:40:19.327565 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:40:19.328567 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

      drop view if exists "carton_caps_20260203T224013Z"."main"."stg_schools__dbt_backup" cascade
    
[0m17:40:19.328567 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

      drop view if exists "carton_caps_20260203T224013Z"."main"."stg_users__dbt_backup" cascade
    
[0m17:40:19.329566 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:19.329566 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m17:40:19.330566 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: Close
[0m17:40:19.330566 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:40:19.330566 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.332069 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m17:40:19.332069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C5DEA7B0>]}
[0m17:40:19.333484 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:40:19.334535 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_users: Close
[0m17:40:19.335537 [info ] [Thread-1 (]: 5 of 44 OK created sql view model main.stg_schools ............................. [[32mOK[0m in 0.07s]
[0m17:40:19.335537 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_schools
[0m17:40:19.335537 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C64EC980>]}
[0m17:40:19.336537 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:40:19.336537 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:40:19.336537 [info ] [Thread-4 (]: 6 of 44 OK created sql view model main.stg_users ............................... [[32mOK[0m in 0.07s]
[0m17:40:19.337538 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:40:19.337538 [info ] [Thread-1 (]: 11 of 44 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m17:40:19.337538 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m17:40:19.338536 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.stg_users
[0m17:40:19.338536 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m17:40:19.338536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_schools, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m17:40:19.338536 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:19.339536 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:40:19.339536 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:19.339536 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:40:19.340397 [info ] [Thread-4 (]: 12 of 44 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m17:40:19.340397 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.342440 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:40:19.343440 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:40:19.343440 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_users, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m17:40:19.343440 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:40:19.344438 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:40:19.344438 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:40:19.344438 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps_20260203T224013Z"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m17:40:19.344438 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:19.345439 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:40:19.347439 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:40:19.350438 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:40:19.351439 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:40:19.353439 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:40:19.354438 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m17:40:19.354438 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:40:19.354438 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:40:19.355438 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m17:40:19.355438 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m17:40:19.356440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:19.357439 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m17:40:19.357439 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m17:40:19.358438 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:40:19.358438 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m17:40:19.358438 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m17:40:19.359438 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:40:19.359438 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m17:40:19.359438 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m17:40:19.359438 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:40:19.360439 [info ] [Thread-2 (]: 9 of 44 PASS test_events_in_window ............................................. [[32mPASS[0m in 0.04s]
[0m17:40:19.360439 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:19.361438 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T224013Z"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.360439 [info ] [Thread-3 (]: 10 of 44 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m17:40:19.361438 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m17:40:19.362439 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:40:19.362439 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.362439 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:40:19.362439 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.363439 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:40:19.363439 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:40:19.363439 [info ] [Thread-2 (]: 13 of 44 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m17:40:19.363439 [info ] [Thread-3 (]: 14 of 44 START test not_null_stg_products_product_id ........................... [RUN]
[0m17:40:19.364439 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps_20260203T224013Z"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.365440 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m17:40:19.365440 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m17:40:19.365440 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m17:40:19.366439 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:40:19.366439 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m17:40:19.366439 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:40:19.367438 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.369440 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:40:19.369440 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m17:40:19.371440 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:40:19.372441 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m17:40:19.373438 [info ] [Thread-1 (]: 11 of 44 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.03s]
[0m17:40:19.374438 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m17:40:19.374438 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:40:19.375029 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:40:19.375029 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m17:40:19.375029 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:40:19.375029 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:40:19.377059 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:40:19.377059 [info ] [Thread-4 (]: 12 of 44 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.03s]
[0m17:40:19.379058 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:40:19.378060 [info ] [Thread-1 (]: 15 of 44 START test unique_stg_products_product_id ............................. [RUN]
[0m17:40:19.379058 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:40:19.380061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m17:40:19.380061 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:40:19.380061 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:40:19.383115 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:40:19.381059 [info ] [Thread-4 (]: 16 of 44 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m17:40:19.383115 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:40:19.384115 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m17:40:19.384115 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m17:40:19.384115 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:40:19.384115 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:40:19.385116 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:40:19.385116 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:19.387118 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:40:19.387118 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m17:40:19.388976 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:40:19.388976 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:19.390000 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:40:19.390000 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:40:19.390000 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T224013Z"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.391000 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:40:19.391000 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.392000 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:40:19.392000 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.392999 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:40:19.392999 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:40:19.394001 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m17:40:19.394001 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:19.395000 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m17:40:19.395000 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m17:40:19.395897 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:40:19.395897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:19.395897 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m17:40:19.395897 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m17:40:19.396934 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:19.396934 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.396934 [info ] [Thread-3 (]: 14 of 44 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.03s]
[0m17:40:19.397934 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.397934 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.397934 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:40:19.398934 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m17:40:19.398934 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:40:19.399933 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:40:19.399933 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:40:19.399933 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m17:40:19.400933 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:19.400933 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T224013Z"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.400933 [info ] [Thread-3 (]: 17 of 44 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m17:40:19.401932 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m17:40:19.401932 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m17:40:19.402775 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:40:19.402775 [info ] [Thread-2 (]: 13 of 44 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.04s]
[0m17:40:19.404840 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:40:19.404840 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:40:19.405843 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:40:19.405843 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:40:19.406843 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m17:40:19.406843 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:40:19.407842 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m17:40:19.408842 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m17:40:19.408842 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:40:19.408842 [info ] [Thread-2 (]: 18 of 44 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m17:40:19.409737 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m17:40:19.409737 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m17:40:19.412805 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:40:19.412805 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m17:40:19.412805 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m17:40:19.412805 [info ] [Thread-1 (]: 15 of 44 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m17:40:19.413808 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:40:19.413808 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:40:19.413808 [info ] [Thread-4 (]: 16 of 44 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.03s]
[0m17:40:19.416688 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:40:19.416688 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:40:19.416688 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:40:19.417736 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:40:19.417736 [info ] [Thread-1 (]: 19 of 44 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m17:40:19.417736 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m17:40:19.418737 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:40:19.418737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m17:40:19.418737 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:40:19.418737 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:19.419737 [info ] [Thread-4 (]: 20 of 44 START test not_null_stg_schools_school_id ............................. [RUN]
[0m17:40:19.419737 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:40:19.420736 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:40:19.421734 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m17:40:19.423615 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:40:19.423615 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:40:19.424700 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:40:19.424700 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:40:19.426698 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:40:19.427699 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T224013Z"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.427699 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:40:19.427699 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:40:19.428700 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m17:40:19.429699 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:40:19.430591 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.430591 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:19.430591 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:40:19.431650 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m17:40:19.432655 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:40:19.433653 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m17:40:19.433653 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:40:19.434656 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m17:40:19.434656 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:40:19.434656 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:40:19.435655 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T224013Z"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.435655 [info ] [Thread-3 (]: 17 of 44 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.03s]
[0m17:40:19.435655 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:40:19.435655 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m17:40:19.436656 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:40:19.436656 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m17:40:19.437556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:19.437556 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.437556 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:40:19.437556 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:19.438586 [info ] [Thread-3 (]: 21 of 44 START test unique_stg_schools_school_id ............................... [RUN]
[0m17:40:19.438586 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.439587 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m17:40:19.439587 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m17:40:19.439587 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.440587 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:40:19.440587 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m17:40:19.440587 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:40:19.441586 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:40:19.441586 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:19.441586 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m17:40:19.444477 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:40:19.444477 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T224013Z"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.444477 [info ] [Thread-2 (]: 18 of 44 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.03s]
[0m17:40:19.445528 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:40:19.445528 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:40:19.446527 [info ] [Thread-2 (]: 22 of 44 START test not_null_stg_users_school_id ............................... [RUN]
[0m17:40:19.447527 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m17:40:19.447527 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:40:19.447527 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:40:19.447527 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:40:19.448528 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:40:19.450525 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:40:19.451473 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:40:19.452563 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m17:40:19.453562 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m17:40:19.454564 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m17:40:19.454564 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m17:40:19.455564 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m17:40:19.455564 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m17:40:19.455564 [info ] [Thread-1 (]: 19 of 44 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.04s]
[0m17:40:19.456564 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:40:19.456564 [info ] [Thread-4 (]: 20 of 44 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.03s]
[0m17:40:19.456564 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:40:19.458563 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:40:19.458563 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:40:19.458563 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:40:19.459563 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:40:19.459563 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m17:40:19.459563 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:40:19.459563 [info ] [Thread-1 (]: 23 of 44 START test not_null_stg_users_user_id ................................. [RUN]
[0m17:40:19.460564 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:19.460564 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:40:19.460564 [info ] [Thread-4 (]: 24 of 44 START test unique_stg_users_user_id ................................... [RUN]
[0m17:40:19.461563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m17:40:19.461563 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m17:40:19.461563 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m17:40:19.463563 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.463563 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:40:19.463563 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:19.463563 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:40:19.464564 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:40:19.466565 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:40:19.468565 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:40:19.469565 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:19.469565 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m17:40:19.469565 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:40:19.470563 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T224013Z"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.470563 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:40:19.470563 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:40:19.472380 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:40:19.472380 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:40:19.474408 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:40:19.474408 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:40:19.475407 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m17:40:19.476406 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m17:40:19.476406 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m17:40:19.477408 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m17:40:19.477408 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m17:40:19.478408 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m17:40:19.477408 [info ] [Thread-3 (]: 21 of 44 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:40:19.478408 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:40:19.478408 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:40:19.479297 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:40:19.479297 [info ] [Thread-2 (]: 22 of 44 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:40:19.479297 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m17:40:19.480367 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m17:40:19.480367 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.fct_rewards
[0m17:40:19.480367 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:40:19.481368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:19.481368 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:19.481368 [info ] [Thread-3 (]: 25 of 44 START sql table model main.fct_rewards ................................ [RUN]
[0m17:40:19.481368 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.dim_product
[0m17:40:19.482368 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6, now model.dbt_carton_caps.fct_rewards)
[0m17:40:19.482368 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.482368 [info ] [Thread-2 (]: 26 of 44 START sql table model main.dim_product ................................ [RUN]
[0m17:40:19.483368 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.483368 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.fct_rewards
[0m17:40:19.483368 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:40:19.483368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now model.dbt_carton_caps.dim_product)
[0m17:40:19.484368 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:40:19.486173 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_rewards"
[0m17:40:19.486173 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T224013Z"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.486173 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.dim_product
[0m17:40:19.486173 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:19.488242 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_product"
[0m17:40:19.488242 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.489240 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.fct_rewards
[0m17:40:19.500244 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_rewards"
[0m17:40:19.501247 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m17:40:19.501247 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m17:40:19.501247 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m17:40:19.502245 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.dim_product
[0m17:40:19.502245 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m17:40:19.502245 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:40:19.503245 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m17:40:19.505247 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_product"
[0m17:40:19.506245 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: BEGIN
[0m17:40:19.505247 [info ] [Thread-1 (]: 23 of 44 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.04s]
[0m17:40:19.506245 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m17:40:19.507004 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:19.507004 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:40:19.507004 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m17:40:19.508090 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:40:19.508090 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.fct_referral
[0m17:40:19.508090 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.509091 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: BEGIN
[0m17:40:19.509091 [info ] [Thread-4 (]: 24 of 44 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.05s]
[0m17:40:19.509091 [info ] [Thread-1 (]: 27 of 44 START sql table model main.fct_referral ............................... [RUN]
[0m17:40:19.509091 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:40:19.510090 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:19.510090 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:40:19.510090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now model.dbt_carton_caps.fct_referral)
[0m17:40:19.511090 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

  
    
    

    create  table
      "carton_caps_20260203T224013Z"."main"."fct_rewards__dbt_tmp"
  
    as (
      with e as (
  select *
  from "carton_caps_20260203T224013Z"."main"."stg_events"
),

awards as (
  select
    referral_id,
    user_id,
    event_at as awarded_at,
    -- reward_type is inside metadata_json like {"reward_type":"referrer_bonus"}
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_awarded'
),

redeems as (
  select
    referral_id,
    user_id,
    event_at as redeemed_at,
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_redeemed'
)

select
  -- deterministic surrogate key
  md5(cast(a.referral_id as varchar) || '|' || cast(a.user_id as varchar) || '|' || coalesce(a.reward_type,'')) as reward_id,
  a.referral_id,
  a.user_id,
  a.reward_type,
  a.awarded_at,
  min(r.redeemed_at) as redeemed_at
from awards a
left join redeems r
  on a.referral_id = r.referral_id
  and a.user_id = r.user_id
  and coalesce(a.reward_type,'') = coalesce(r.reward_type,'')
group by 1,2,3,4,5
    );
  
  
[0m17:40:19.511090 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.dim_school
[0m17:40:19.511090 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.fct_referral
[0m17:40:19.511090 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.512091 [info ] [Thread-4 (]: 28 of 44 START sql table model main.dim_school ................................. [RUN]
[0m17:40:19.514028 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_referral"
[0m17:40:19.514028 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:40:19.515066 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b, now model.dbt_carton_caps.dim_school)
[0m17:40:19.515066 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

  
    
    

    create  table
      "carton_caps_20260203T224013Z"."main"."dim_product__dbt_tmp"
  
    as (
      select
  product_id,
  name,
  category,
  price,
  points_per_dollar,
  created_at
from "carton_caps_20260203T224013Z"."main"."stg_products"
    );
  
  
[0m17:40:19.516066 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.dim_school
[0m17:40:19.518070 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_school"
[0m17:40:19.518070 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.fct_referral
[0m17:40:19.518070 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:40:19.519070 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:40:19.522069 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_referral"
[0m17:40:19.524074 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:40:19.525073 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:40:19.525073 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.dim_school
[0m17:40:19.526071 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */
alter table "carton_caps_20260203T224013Z"."main"."fct_rewards__dbt_tmp" rename to "fct_rewards"
[0m17:40:19.526071 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */
alter table "carton_caps_20260203T224013Z"."main"."dim_product__dbt_tmp" rename to "dim_product"
[0m17:40:19.527796 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_school"
[0m17:40:19.528851 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:40:19.528851 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.528851 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: BEGIN
[0m17:40:19.529852 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.532358 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m17:40:19.532358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:19.533363 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m17:40:19.534362 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:40:19.534362 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:40:19.534815 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:40:19.534815 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: BEGIN
[0m17:40:19.534815 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.534815 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m17:40:19.535873 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m17:40:19.535873 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:19.535873 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:40:19.536873 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

  
    
    

    create  table
      "carton_caps_20260203T224013Z"."main"."fct_referral__dbt_tmp"
  
    as (
      with r as (
  select *
  from "carton_caps_20260203T224013Z"."main"."stg_referrals"
),

e as (
  select *
  from "carton_caps_20260203T224013Z"."main"."stg_events"
),

-- Referral-related event timestamps for referred users
ref_events as (
  select
    referral_id,
    user_id,

    min(case when event_type = 'install' then event_at end) as install_at,
    min(case when event_type = 'referral_applied' then event_at end) as referral_applied_at,
    min(case when event_type = 'onboarding_complete' then event_at end) as onboarding_completed_at,
    min(case when event_type = 'school_linked' then event_at end) as school_linked_at

  from e
  where referral_id is not null
  group by 1,2
),

-- First scan/purchase time for referred users (proxy for qualifying action)
first_purchase as (
  select
    user_id,
    min(purchased_at) as first_purchase_at
  from "carton_caps_20260203T224013Z"."main"."stg_purchases"
  group by 1
)

select
  r.referral_id,
  r.referrer_user_id,
  r.referred_email,
  r.referred_user_id,
  r.referral_code,
  r.sent_at,
  r.converted_at,
  r.status,

  re.install_at,
  re.referral_applied_at,
  re.onboarding_completed_at,
  re.school_linked_at,

  fp.first_purchase_at,

  -- qualifying action is: first_purchase OR school_linked (whichever happens first)
  least(fp.first_purchase_at, re.school_linked_at) as qualifying_action_at,

  -- window compliance (48 hours) using install -> referral_applied
  case
    when re.install_at is null or re.referral_applied_at is null then null
    when datediff('hour', re.install_at, re.referral_applied_at) <= 48 then true
    else false
  end as within_48h_window,

  -- simple eligibility (rules-compliant posture)
  case
    when r.status <> 'converted' then false
    when re.onboarding_completed_at is null then false
    when least(fp.first_purchase_at, re.school_linked_at) is null then false
    when re.install_at is null or re.referral_applied_at is null then false
    when datediff('hour', re.install_at, re.referral_applied_at) > 48 then false
    else true
  end as eligible_referral

from r
left join ref_events re
  on r.referral_id = re.referral_id
  and r.referred_user_id = re.user_id
left join first_purchase fp
  on r.referred_user_id = fp.user_id
    );
  
  
[0m17:40:19.536873 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.537873 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:40:19.537873 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

  
    
    

    create  table
      "carton_caps_20260203T224013Z"."main"."dim_school__dbt_tmp"
  
    as (
      select
  school_id,
  name,
  address,
  city,
  state,
  zip_code,
  created_at
from "carton_caps_20260203T224013Z"."main"."stg_schools"
    );
  
  
[0m17:40:19.546871 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m17:40:19.547873 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:40:19.548935 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

      drop table if exists "carton_caps_20260203T224013Z"."main"."fct_rewards__dbt_backup" cascade
    
[0m17:40:19.548935 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m17:40:19.548935 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m17:40:19.551934 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:40:19.554934 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:40:19.554934 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */
alter table "carton_caps_20260203T224013Z"."main"."dim_school__dbt_tmp" rename to "dim_school"
[0m17:40:19.555639 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:40:19.555639 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

      drop table if exists "carton_caps_20260203T224013Z"."main"."dim_product__dbt_backup" cascade
    
[0m17:40:19.556662 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: Close
[0m17:40:19.556662 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.557661 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m17:40:19.557661 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C758FF20>]}
[0m17:40:19.557661 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.558661 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m17:40:19.560660 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:40:19.560660 [info ] [Thread-3 (]: 25 of 44 OK created sql table model main.fct_rewards ........................... [[32mOK[0m in 0.08s]
[0m17:40:19.561662 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_product: Close
[0m17:40:19.562559 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:40:19.562559 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */
alter table "carton_caps_20260203T224013Z"."main"."fct_referral__dbt_tmp" rename to "fct_referral"
[0m17:40:19.562559 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.fct_rewards
[0m17:40:19.562559 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m17:40:19.563620 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C5D88E60>]}
[0m17:40:19.563620 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.dim_user
[0m17:40:19.564620 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.564620 [info ] [Thread-2 (]: 26 of 44 OK created sql table model main.dim_product ........................... [[32mOK[0m in 0.08s]
[0m17:40:19.564620 [info ] [Thread-3 (]: 29 of 44 START sql table model main.dim_user ................................... [RUN]
[0m17:40:19.566619 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m17:40:19.566619 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.dim_product
[0m17:40:19.567620 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:40:19.567620 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_rewards, now model.dbt_carton_caps.dim_user)
[0m17:40:19.568619 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:40:19.568619 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.fct_purchase
[0m17:40:19.570618 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:40:19.570618 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.dim_user
[0m17:40:19.570618 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m17:40:19.570618 [info ] [Thread-2 (]: 30 of 44 START sql table model main.fct_purchase ............................... [RUN]
[0m17:40:19.571619 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

      drop table if exists "carton_caps_20260203T224013Z"."main"."dim_school__dbt_backup" cascade
    
[0m17:40:19.572619 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_user"
[0m17:40:19.573619 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_product, now model.dbt_carton_caps.fct_purchase)
[0m17:40:19.573619 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.fct_purchase
[0m17:40:19.576621 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_purchase"
[0m17:40:19.576621 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:40:19.577620 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_school: Close
[0m17:40:19.577620 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:40:19.578621 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C75B24E0>]}
[0m17:40:19.579620 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:40:19.579620 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.dim_user
[0m17:40:19.580620 [info ] [Thread-4 (]: 28 of 44 OK created sql table model main.dim_school ............................ [[32mOK[0m in 0.06s]
[0m17:40:19.580620 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.fct_purchase
[0m17:40:19.581620 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

      drop table if exists "carton_caps_20260203T224013Z"."main"."fct_referral__dbt_backup" cascade
    
[0m17:40:19.583619 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_user"
[0m17:40:19.584621 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.dim_school
[0m17:40:19.586621 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_purchase"
[0m17:40:19.586621 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:40:19.587621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.587621 [info ] [Thread-4 (]: 31 of 44 START test not_null_fct_rewards_reward_id ............................. [RUN]
[0m17:40:19.588620 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: Close
[0m17:40:19.589618 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_school, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m17:40:19.589618 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:40:19.590621 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:40:19.590621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C5C22780>]}
[0m17:40:19.591620 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:40:19.591620 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_purchase: BEGIN
[0m17:40:19.591620 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: BEGIN
[0m17:40:19.592619 [info ] [Thread-1 (]: 27 of 44 OK created sql table model main.fct_referral .......................... [[32mOK[0m in 0.08s]
[0m17:40:19.595621 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:40:19.595621 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:19.596622 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:19.596622 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.fct_referral
[0m17:40:19.597622 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:40:19.597622 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.597622 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:40:19.598623 [info ] [Thread-1 (]: 32 of 44 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m17:40:19.598623 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.598623 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:40:19.600624 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:40:19.600624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_referral, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m17:40:19.600624 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:40:19.601622 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

  
    
    

    create  table
      "carton_caps_20260203T224013Z"."main"."fct_purchase__dbt_tmp"
  
    as (
      select
  p.purchase_id,
  p.user_id,
  u.school_id,
  p.product_id,
  pr.category as product_category,
  p.quantity,
  p.price_paid,
  p.points_earned,
  p.purchased_at,
  date_trunc('day', p.purchased_at) as purchase_date,
  p.day_of_week,
  p.hour_of_day
from "carton_caps_20260203T224013Z"."main"."stg_purchases" p
left join "carton_caps_20260203T224013Z"."main"."stg_users" u
  on p.user_id = u.user_id
left join "carton_caps_20260203T224013Z"."main"."stg_products" pr
  on p.product_id = pr.product_id
    );
  
  
[0m17:40:19.601622 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:40:19.602622 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

  
    
    

    create  table
      "carton_caps_20260203T224013Z"."main"."dim_user__dbt_tmp"
  
    as (
      select
  u.user_id,
  u.first_name,
  u.last_name,
  u.email,
  u.school_id,
  s.name as school_name,
  s.state as school_state,
  u.created_at,
  u.user_type,
  u.is_verified,
  u.device_id,
  u.marketing_channel
from "carton_caps_20260203T224013Z"."main"."stg_users" u
left join "carton_caps_20260203T224013Z"."main"."stg_schools" s
  on u.school_id = s.school_id
    );
  
  
[0m17:40:19.602622 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:40:19.605309 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:40:19.606309 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m17:40:19.606309 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:19.607309 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.607309 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:40:19.607309 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:40:19.609307 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:40:19.609307 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps_20260203T224013Z"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.609307 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m17:40:19.610306 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:40:19.612250 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:40:19.612250 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.615249 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:40:19.615249 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */
alter table "carton_caps_20260203T224013Z"."main"."fct_purchase__dbt_tmp" rename to "fct_purchase"
[0m17:40:19.615249 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:40:19.617254 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m17:40:19.617254 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */
alter table "carton_caps_20260203T224013Z"."main"."dim_user__dbt_tmp" rename to "dim_user"
[0m17:40:19.618113 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m17:40:19.618113 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:40:19.618113 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m17:40:19.619163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:19.620164 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m17:40:19.620164 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.620164 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m17:40:19.621164 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:40:19.621164 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m17:40:19.622165 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:40:19.622165 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m17:40:19.622165 [info ] [Thread-4 (]: 31 of 44 PASS not_null_fct_rewards_reward_id ................................... [[32mPASS[0m in 0.03s]
[0m17:40:19.623163 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:40:19.623163 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:40:19.623163 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:40:19.624163 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m17:40:19.624163 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:19.624163 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:40:19.625042 [info ] [Thread-4 (]: 33 of 44 START test not_null_dim_product_product_id ............................ [RUN]
[0m17:40:19.625042 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816)
[0m17:40:19.626156 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:40:19.631159 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:40:19.631159 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:40:19.632031 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:40:19.632031 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:40:19.633129 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:40:19.634126 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m17:40:19.636127 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:40:19.637126 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

      drop table if exists "carton_caps_20260203T224013Z"."main"."fct_purchase__dbt_backup" cascade
    
[0m17:40:19.637126 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:40:19.638127 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m17:40:19.638127 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

      drop table if exists "carton_caps_20260203T224013Z"."main"."dim_user__dbt_backup" cascade
    
[0m17:40:19.640129 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:40:19.640129 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m17:40:19.640129 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.641128 [debug] [Thread-2 (]: On model.dbt_carton_caps.fct_purchase: Close
[0m17:40:19.641128 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.642128 [info ] [Thread-1 (]: 32 of 44 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:40:19.642128 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C64666F0>]}
[0m17:40:19.643128 [debug] [Thread-3 (]: On model.dbt_carton_caps.dim_user: Close
[0m17:40:19.643128 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:40:19.644126 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:40:19.644126 [info ] [Thread-2 (]: 30 of 44 OK created sql table model main.fct_purchase .......................... [[32mOK[0m in 0.07s]
[0m17:40:19.645129 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78fe9e70-a7f8-4694-807f-3d39ebe4f476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C6575310>]}
[0m17:40:19.645129 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m17:40:19.645129 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:40:19.645929 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.fct_purchase
[0m17:40:19.645929 [info ] [Thread-3 (]: 29 of 44 OK created sql table model main.dim_user .............................. [[32mOK[0m in 0.08s]
[0m17:40:19.645929 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:19.646962 [info ] [Thread-1 (]: 34 of 44 START test unique_dim_product_product_id .............................. [RUN]
[0m17:40:19.646962 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:40:19.646962 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.dim_user
[0m17:40:19.647962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m17:40:19.647962 [info ] [Thread-2 (]: 35 of 44 START test not_null_dim_school_school_id .............................. [RUN]
[0m17:40:19.647962 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.647962 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:40:19.648962 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:40:19.648962 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_purchase, now test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b)
[0m17:40:19.648962 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:40:19.649961 [info ] [Thread-3 (]: 36 of 44 START test unique_dim_school_school_id ................................ [RUN]
[0m17:40:19.651963 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:40:19.651963 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:40:19.652891 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T224013Z"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.652891 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_user, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m17:40:19.654921 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:40:19.655919 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:40:19.657922 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:40:19.657922 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:40:19.658920 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:40:19.659791 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:40:19.660815 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:40:19.661813 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:40:19.661813 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:40:19.662813 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m17:40:19.663813 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:40:19.664813 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:40:19.664813 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:40:19.664813 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m17:40:19.665813 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m17:40:19.665813 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:40:19.665813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:19.666813 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m17:40:19.666813 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:40:19.666813 [info ] [Thread-4 (]: 33 of 44 PASS not_null_dim_product_product_id .................................. [[32mPASS[0m in 0.04s]
[0m17:40:19.667814 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:19.667814 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m17:40:19.667814 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.667814 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:40:19.668813 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:19.668813 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:40:19.668813 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.668813 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:40:19.669813 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:19.669813 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:40:19.669813 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.669813 [info ] [Thread-4 (]: 37 of 44 START test not_null_fct_referral_referral_id .......................... [RUN]
[0m17:40:19.670813 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T224013Z"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.670813 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:40:19.670813 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m17:40:19.671813 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.671813 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:19.671813 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:40:19.672813 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.672813 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m17:40:19.676815 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:40:19.676815 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:40:19.677814 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m17:40:19.678813 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m17:40:19.679813 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m17:40:19.679813 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:40:19.679813 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m17:40:19.680815 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m17:40:19.680815 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m17:40:19.680815 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:40:19.681814 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m17:40:19.681814 [info ] [Thread-1 (]: 34 of 44 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.03s]
[0m17:40:19.683814 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:40:19.681814 [info ] [Thread-2 (]: 35 of 44 PASS not_null_dim_school_school_id .................................... [[32mPASS[0m in 0.03s]
[0m17:40:19.683814 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:40:19.683814 [info ] [Thread-3 (]: 36 of 44 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m17:40:19.684814 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:40:19.684814 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:40:19.685814 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:40:19.685814 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:40:19.685814 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:40:19.686813 [info ] [Thread-1 (]: 38 of 44 START test unique_fct_referral_referral_id ............................ [RUN]
[0m17:40:19.686813 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:40:19.686813 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m17:40:19.686813 [info ] [Thread-2 (]: 39 of 44 START test not_null_fct_purchase_purchase_id .......................... [RUN]
[0m17:40:19.687813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m17:40:19.687813 [info ] [Thread-3 (]: 40 of 44 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m17:40:19.687813 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:19.687813 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1)
[0m17:40:19.688813 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:40:19.688813 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m17:40:19.688813 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:40:19.691816 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:40:19.691816 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:40:19.691816 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:40:19.694515 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:40:19.694515 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:40:19.696537 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:40:19.697536 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T224013Z"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.697536 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:40:19.698536 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:40:19.699534 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.699534 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:40:19.701399 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:40:19.701399 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:40:19.702468 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m17:40:19.703471 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:40:19.703471 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:40:19.704471 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m17:40:19.704471 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m17:40:19.705472 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:40:19.705472 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m17:40:19.705472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:19.705472 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m17:40:19.706472 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:40:19.706472 [info ] [Thread-4 (]: 37 of 44 PASS not_null_fct_referral_referral_id ................................ [[32mPASS[0m in 0.04s]
[0m17:40:19.706472 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:19.707472 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.707472 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m17:40:19.707472 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:40:19.708348 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:40:19.708348 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:19.708348 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.709404 [debug] [Thread-4 (]: Began running node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:40:19.709404 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:19.709404 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:40:19.710404 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now exposure.dbt_carton_caps.streamlit_product_dashboard)
[0m17:40:19.710404 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.710404 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T224013Z"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.710404 [debug] [Thread-4 (]: Began compiling node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:40:19.711404 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:40:19.711404 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.711404 [debug] [Thread-4 (]: Began executing node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:40:19.711404 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:19.712404 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.713406 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m17:40:19.713406 [info ] [Thread-4 (]: 41 of 44 NO-OP exposure streamlit_product_dashboard ............................ [[33mNO-OP[0m in 0.00s]
[0m17:40:19.714405 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m17:40:19.714405 [debug] [Thread-4 (]: Finished running node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:40:19.715358 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m17:40:19.715358 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m17:40:19.716445 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:40:19.716445 [debug] [Thread-4 (]: Began running node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:40:19.716445 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:40:19.717451 [info ] [Thread-1 (]: 38 of 44 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.03s]
[0m17:40:19.717451 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly exposure.dbt_carton_caps.streamlit_product_dashboard, now exposure.dbt_carton_caps.streamlit_referral_finance_dashboard)
[0m17:40:19.718449 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m17:40:19.718449 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m17:40:19.719449 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:40:19.719449 [debug] [Thread-4 (]: Began compiling node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:40:19.719449 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m17:40:19.720449 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:40:19.720449 [info ] [Thread-2 (]: 39 of 44 PASS not_null_fct_purchase_purchase_id ................................ [[32mPASS[0m in 0.03s]
[0m17:40:19.720449 [debug] [Thread-4 (]: Began executing node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:40:19.720449 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m17:40:19.721450 [info ] [Thread-1 (]: 43 of 44 START test not_null_dim_user_user_id .................................. [RUN]
[0m17:40:19.721450 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:40:19.722219 [info ] [Thread-4 (]: 42 of 44 NO-OP exposure streamlit_referral_finance_dashboard ................... [[33mNO-OP[0m in 0.00s]
[0m17:40:19.722219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3)
[0m17:40:19.722219 [info ] [Thread-3 (]: 40 of 44 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.03s]
[0m17:40:19.723272 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:40:19.723272 [debug] [Thread-4 (]: Finished running node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:40:19.723272 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:40:19.723272 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:40:19.724272 [info ] [Thread-2 (]: 44 of 44 START test unique_dim_user_user_id .................................... [RUN]
[0m17:40:19.726271 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:40:19.727272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m17:40:19.727272 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:40:19.729193 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:40:19.730265 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:40:19.731266 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:40:19.731266 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:40:19.734370 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:40:19.734370 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:40:19.734370 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m17:40:19.735371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:19.735371 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:40:19.735371 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m17:40:19.736373 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.736373 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:19.736373 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:40:19.736373 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T224013Z"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:19.737371 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.737371 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:40:19.737371 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:19.738371 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.739373 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m17:40:19.739373 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:19.739373 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:40:19.740373 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m17:40:19.740373 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m17:40:19.741372 [info ] [Thread-1 (]: 43 of 44 PASS not_null_dim_user_user_id ........................................ [[32mPASS[0m in 0.02s]
[0m17:40:19.741372 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m17:40:19.742372 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:40:19.742372 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m17:40:19.743413 [info ] [Thread-2 (]: 44 of 44 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.02s]
[0m17:40:19.743413 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:40:19.744413 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:19.744413 [debug] [MainThread]: On master: BEGIN
[0m17:40:19.744413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:19.745413 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:19.745413 [debug] [MainThread]: On master: COMMIT
[0m17:40:19.745413 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:19.745413 [debug] [MainThread]: On master: COMMIT
[0m17:40:19.746413 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:19.746413 [debug] [MainThread]: On master: Close
[0m17:40:19.746413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:19.746413 [debug] [MainThread]: Connection 'create_carton_caps_20260203T224013Z_main' was properly closed.
[0m17:40:19.746413 [debug] [MainThread]: Connection 'list_carton_caps_20260203T224013Z_main' was properly closed.
[0m17:40:19.746413 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3' was properly closed.
[0m17:40:19.747414 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278' was properly closed.
[0m17:40:19.747414 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a' was properly closed.
[0m17:40:19.747414 [debug] [MainThread]: Connection 'exposure.dbt_carton_caps.streamlit_referral_finance_dashboard' was properly closed.
[0m17:40:19.747414 [info ] [MainThread]: 
[0m17:40:19.747414 [info ] [MainThread]: Finished running 2 exposures, 6 table models, 30 data tests, 6 view models in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m17:40:19.750412 [debug] [MainThread]: Command end result
[0m17:40:19.765023 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:40:19.767022 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:40:19.771024 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\run_results.json
[0m17:40:19.771024 [info ] [MainThread]: 
[0m17:40:19.772087 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:19.772087 [info ] [MainThread]: 
[0m17:40:19.772087 [info ] [MainThread]: Done. PASS=42 WARN=0 ERROR=0 SKIP=0 NO-OP=2 TOTAL=44
[0m17:40:19.773088 [debug] [MainThread]: Command `dbt build` succeeded at 17:40:19.772087 after 3.38 seconds
[0m17:40:19.773088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C35EB590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C35EA7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C35EBC20>]}
[0m17:40:19.773088 [debug] [MainThread]: Flushing usage events
[0m17:40:20.175257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:40:21.663904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC4429D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC65AF260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC71CB080>]}


============================== 17:40:21.667781 | d69ba582-26af-448f-a398-b7e3de8142a6 ==============================
[0m17:40:21.667781 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:40:21.667781 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --profiles-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps --project-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m17:40:21.809809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd69ba582-26af-448f-a398-b7e3de8142a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC8C61BB0>]}
[0m17:40:21.850379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd69ba582-26af-448f-a398-b7e3de8142a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC6CEAFC0>]}
[0m17:40:21.852379 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:40:22.009322 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:40:22.117495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:40:22.117495 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:40:22.117495 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:40:22.151045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd69ba582-26af-448f-a398-b7e3de8142a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC8D72C00>]}
[0m17:40:22.215343 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:40:22.217365 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:40:22.239275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd69ba582-26af-448f-a398-b7e3de8142a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC9241DC0>]}
[0m17:40:22.240274 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:40:22.240274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd69ba582-26af-448f-a398-b7e3de8142a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC915FC50>]}
[0m17:40:22.242274 [info ] [MainThread]: 
[0m17:40:22.242274 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:40:22.243275 [info ] [MainThread]: 
[0m17:40:22.243275 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:40:22.246273 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T224013Z_main'
[0m17:40:22.290877 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T224013Z_main"
[0m17:40:22.290877 [debug] [ThreadPool]: On list_carton_caps_20260203T224013Z_main: BEGIN
[0m17:40:22.290877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:22.311791 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:40:22.312790 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T224013Z_main"
[0m17:40:22.312790 [debug] [ThreadPool]: On list_carton_caps_20260203T224013Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T224013Z_main"} */
select
      'carton_caps_20260203T224013Z' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps_20260203t224013z'
  
[0m17:40:22.321699 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:40:22.322697 [debug] [ThreadPool]: On list_carton_caps_20260203T224013Z_main: ROLLBACK
[0m17:40:22.323697 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_20260203T224013Z_main'
[0m17:40:22.323697 [debug] [ThreadPool]: On list_carton_caps_20260203T224013Z_main: Close
[0m17:40:22.324699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd69ba582-26af-448f-a398-b7e3de8142a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC9219FA0>]}
[0m17:40:22.325699 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:22.325699 [debug] [MainThread]: On master: BEGIN
[0m17:40:22.325699 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:22.325699 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:22.326581 [debug] [MainThread]: On master: COMMIT
[0m17:40:22.326581 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:22.326581 [debug] [MainThread]: On master: COMMIT
[0m17:40:22.326581 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:22.326581 [debug] [MainThread]: On master: Close
[0m17:40:22.329690 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:40:22.329690 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:40:22.330691 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:40:22.330691 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:40:22.330691 [info ] [Thread-1 (]: 1 of 30 START test not_null_dim_product_product_id ............................. [RUN]
[0m17:40:22.330691 [info ] [Thread-2 (]: 2 of 30 START test not_null_dim_school_school_id ............................... [RUN]
[0m17:40:22.331690 [info ] [Thread-3 (]: 3 of 30 START test not_null_dim_user_user_id ................................... [RUN]
[0m17:40:22.331690 [info ] [Thread-4 (]: 4 of 30 START test not_null_fct_purchase_purchase_id ........................... [RUN]
[0m17:40:22.331690 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:40:22.331690 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:40:22.332690 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:40:22.332690 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:40:22.333475 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:40:22.333475 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:40:22.333475 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:40:22.333475 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:40:22.342516 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:40:22.345513 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:40:22.348515 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:40:22.350516 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:40:22.351516 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:40:22.360515 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:40:22.361553 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:40:22.362553 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:40:22.362553 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:40:22.364553 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:40:22.364553 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:40:22.365552 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:40:22.366550 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:40:22.366550 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m17:40:22.366550 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:40:22.367553 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:40:22.367553 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:40:22.367553 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m17:40:22.368595 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:40:22.368595 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m17:40:22.369595 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:40:22.369595 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:40:22.369595 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m17:40:22.369595 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:40:22.370594 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:40:22.370594 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:40:22.370594 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.371594 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T224013Z"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.371594 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.371594 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:40:22.371594 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.372594 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:40:22.372594 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T224013Z"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.372594 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.372594 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:40:22.373594 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T224013Z"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.375636 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m17:40:22.376637 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T224013Z"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.376637 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:40:22.377636 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:40:22.377636 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.377636 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m17:40:22.378635 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.378635 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m17:40:22.379634 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m17:40:22.380635 [info ] [Thread-1 (]: 1 of 30 PASS not_null_dim_product_product_id ................................... [[32mPASS[0m in 0.05s]
[0m17:40:22.380635 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m17:40:22.381634 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:40:22.381634 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:40:22.382672 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:40:22.382672 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:40:22.383671 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m17:40:22.383671 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m17:40:22.383671 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:40:22.383671 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m17:40:22.384671 [info ] [Thread-2 (]: 2 of 30 PASS not_null_dim_school_school_id ..................................... [[32mPASS[0m in 0.05s]
[0m17:40:22.384671 [info ] [Thread-3 (]: 3 of 30 PASS not_null_dim_user_user_id ......................................... [[32mPASS[0m in 0.05s]
[0m17:40:22.384671 [info ] [Thread-1 (]: 5 of 30 START test not_null_fct_referral_referral_id ........................... [RUN]
[0m17:40:22.385671 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:40:22.385671 [info ] [Thread-4 (]: 4 of 30 PASS not_null_fct_purchase_purchase_id ................................. [[32mPASS[0m in 0.05s]
[0m17:40:22.385671 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:40:22.386670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m17:40:22.386670 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:40:22.386670 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:40:22.386670 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:40:22.387670 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:40:22.387670 [info ] [Thread-2 (]: 6 of 30 START test not_null_fct_rewards_reward_id .............................. [RUN]
[0m17:40:22.387670 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:40:22.387670 [info ] [Thread-3 (]: 7 of 30 START test not_null_stg_events_event_id ................................ [RUN]
[0m17:40:22.391032 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:40:22.391032 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m17:40:22.391032 [info ] [Thread-4 (]: 8 of 30 START test not_null_stg_events_user_id ................................. [RUN]
[0m17:40:22.392033 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m17:40:22.392033 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:40:22.392033 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m17:40:22.392033 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:40:22.395034 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:40:22.395034 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:40:22.395034 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:40:22.397032 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:40:22.399033 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:40:22.401035 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:40:22.401035 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:40:22.404148 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:40:22.404148 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:40:22.404148 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m17:40:22.405149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:22.405149 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:40:22.405149 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:40:22.440730 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:40:22.441728 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:40:22.442728 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m17:40:22.442728 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m17:40:22.443730 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:40:22.444778 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:22.444778 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:40:22.444778 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T224013Z"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.445777 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:40:22.445777 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m17:40:22.445777 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:40:22.446779 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.446779 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:22.446779 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:40:22.446779 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:40:22.447777 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m17:40:22.448777 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps_20260203T224013Z"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.448777 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m17:40:22.448777 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:40:22.449776 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m17:40:22.449776 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:22.449776 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:40:22.449776 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m17:40:22.450778 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.450778 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps_20260203T224013Z"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.451938 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:22.451938 [info ] [Thread-1 (]: 5 of 30 PASS not_null_fct_referral_referral_id ................................. [[32mPASS[0m in 0.07s]
[0m17:40:22.452938 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m17:40:22.452938 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:40:22.453937 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:40:22.453937 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.453937 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m17:40:22.454938 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T224013Z"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.454938 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:40:22.455938 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m17:40:22.455938 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m17:40:22.455938 [info ] [Thread-1 (]: 9 of 30 START test not_null_stg_products_product_id ............................ [RUN]
[0m17:40:22.456939 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m17:40:22.457939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m17:40:22.456939 [info ] [Thread-2 (]: 6 of 30 PASS not_null_fct_rewards_reward_id .................................... [[32mPASS[0m in 0.07s]
[0m17:40:22.457939 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:22.457939 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m17:40:22.457939 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:40:22.458976 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:40:22.459977 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m17:40:22.461977 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:40:22.459977 [info ] [Thread-3 (]: 7 of 30 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.07s]
[0m17:40:22.462975 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:40:22.462975 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m17:40:22.463976 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:40:22.463976 [info ] [Thread-2 (]: 10 of 30 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m17:40:22.463976 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m17:40:22.463976 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:40:22.464975 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:40:22.464975 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m17:40:22.464975 [info ] [Thread-4 (]: 8 of 30 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.07s]
[0m17:40:22.467015 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:40:22.466016 [info ] [Thread-3 (]: 11 of 30 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m17:40:22.467015 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:40:22.468014 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:40:22.468014 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m17:40:22.470014 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:40:22.471016 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:40:22.471016 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:40:22.471016 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:40:22.472016 [info ] [Thread-4 (]: 12 of 30 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m17:40:22.474378 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:40:22.474378 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m17:40:22.474378 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m17:40:22.475378 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:40:22.475378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:22.475378 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:40:22.476378 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:40:22.477379 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:40:22.479378 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:40:22.480378 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:40:22.481379 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:40:22.481379 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:40:22.482377 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:40:22.482377 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T224013Z"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.482377 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m17:40:22.482377 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:40:22.483377 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:22.483377 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:40:22.484379 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:40:22.485377 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:40:22.485377 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m17:40:22.486145 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:40:22.486145 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:22.487165 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m17:40:22.487165 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:40:22.488164 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:40:22.488164 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m17:40:22.488164 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T224013Z"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.489165 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:40:22.489165 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m17:40:22.489165 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m17:40:22.489165 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:40:22.490165 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:22.490165 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.490165 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T224013Z"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.491165 [info ] [Thread-1 (]: 9 of 30 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.03s]
[0m17:40:22.491165 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.493166 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m17:40:22.493166 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:40:22.493166 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:40:22.494164 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:40:22.494164 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m17:40:22.494164 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:40:22.495165 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T224013Z"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.496166 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m17:40:22.496166 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m17:40:22.496166 [info ] [Thread-1 (]: 13 of 30 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m17:40:22.497164 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m17:40:22.497164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m17:40:22.497164 [info ] [Thread-2 (]: 10 of 30 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.03s]
[0m17:40:22.498165 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.498165 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m17:40:22.498165 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:40:22.499164 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:40:22.499164 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m17:40:22.502166 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:40:22.500164 [info ] [Thread-3 (]: 11 of 30 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.03s]
[0m17:40:22.502166 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:40:22.503164 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m17:40:22.503164 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:40:22.504165 [info ] [Thread-2 (]: 14 of 30 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m17:40:22.504165 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m17:40:22.504165 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:40:22.505164 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:40:22.505164 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m17:40:22.505164 [info ] [Thread-4 (]: 12 of 30 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.03s]
[0m17:40:22.507164 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:40:22.505164 [info ] [Thread-3 (]: 15 of 30 START test not_null_stg_schools_school_id ............................. [RUN]
[0m17:40:22.507164 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:40:22.508164 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:40:22.508164 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m17:40:22.510166 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:40:22.510166 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:40:22.511165 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:40:22.511165 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:40:22.511165 [info ] [Thread-4 (]: 16 of 30 START test not_null_stg_users_school_id ............................... [RUN]
[0m17:40:22.514166 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:40:22.515166 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m17:40:22.515166 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m17:40:22.515166 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:40:22.515166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:22.516165 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:40:22.517164 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:40:22.518164 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:40:22.520166 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:40:22.520166 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:40:22.521165 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:40:22.522170 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:40:22.522170 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T224013Z"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.522170 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:40:22.523169 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m17:40:22.523169 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:22.523169 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:40:22.524169 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.525170 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:40:22.525170 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:40:22.526169 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:40:22.527168 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m17:40:22.527168 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:40:22.527168 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m17:40:22.528169 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m17:40:22.528169 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps_20260203T224013Z"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.528169 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:40:22.529169 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:22.529169 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m17:40:22.529169 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m17:40:22.530170 [info ] [Thread-1 (]: 13 of 30 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.03s]
[0m17:40:22.530170 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:22.530170 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:40:22.530170 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.531169 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:40:22.531169 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:40:22.531169 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.532169 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:40:22.532169 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m17:40:22.533170 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T224013Z"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.533170 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:40:22.533170 [info ] [Thread-1 (]: 17 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m17:40:22.534168 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m17:40:22.534168 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T224013Z"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.535170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m17:40:22.535170 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m17:40:22.535170 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.535170 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:40:22.536169 [info ] [Thread-2 (]: 14 of 30 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.03s]
[0m17:40:22.536169 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m17:40:22.539496 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:40:22.539496 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:40:22.540496 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:40:22.540496 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m17:40:22.541497 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m17:40:22.541497 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m17:40:22.542544 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m17:40:22.542544 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m17:40:22.543544 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:40:22.543544 [info ] [Thread-2 (]: 18 of 30 START test test_events_in_window ...................................... [RUN]
[0m17:40:22.543544 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m17:40:22.543544 [info ] [Thread-3 (]: 15 of 30 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.04s]
[0m17:40:22.545545 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:40:22.545545 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.test_events_in_window)
[0m17:40:22.546544 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:40:22.546544 [info ] [Thread-4 (]: 16 of 30 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:40:22.546544 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m17:40:22.547543 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:40:22.547543 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:40:22.549737 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m17:40:22.550739 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:40:22.550739 [info ] [Thread-3 (]: 19 of 30 START test unique_dim_product_product_id .............................. [RUN]
[0m17:40:22.550739 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:40:22.551738 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m17:40:22.551738 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m17:40:22.551738 [info ] [Thread-4 (]: 20 of 30 START test unique_dim_school_school_id ................................ [RUN]
[0m17:40:22.551738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:22.552738 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m17:40:22.552738 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:40:22.552738 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m17:40:22.554740 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m17:40:22.558763 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:40:22.558763 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:40:22.558763 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:40:22.559764 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:40:22.561766 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:40:22.561766 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T224013Z"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:22.561766 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:40:22.562764 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:40:22.562764 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m17:40:22.564764 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:40:22.564764 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:22.564764 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:40:22.565764 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:40:22.566764 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m17:40:22.567765 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:40:22.567765 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:40:22.568764 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:40:22.568764 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m17:40:22.569764 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:40:22.569764 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m17:40:22.569764 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m17:40:22.569764 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps_20260203T224013Z"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m17:40:22.570764 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:40:22.570764 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:22.570764 [info ] [Thread-1 (]: 17 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.04s]
[0m17:40:22.571763 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m17:40:22.571763 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:40:22.572765 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:22.572765 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:40:22.572765 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:40:22.573764 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:40:22.573764 [info ] [Thread-1 (]: 21 of 30 START test unique_dim_user_user_id .................................... [RUN]
[0m17:40:22.573764 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.573764 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:22.574764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m17:40:22.574764 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:40:22.575764 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:40:22.575764 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:22.575764 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:40:22.578762 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:40:22.578762 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:40:22.579764 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m17:40:22.580763 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m17:40:22.581765 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:22.581765 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m17:40:22.582765 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m17:40:22.583812 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m17:40:22.583812 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:40:22.583812 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m17:40:22.584813 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m17:40:22.584813 [debug] [Thread-2 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m17:40:22.585812 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:40:22.586811 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m17:40:22.586811 [info ] [Thread-3 (]: 19 of 30 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.04s]
[0m17:40:22.587813 [info ] [Thread-2 (]: 18 of 30 PASS test_events_in_window ............................................ [[32mPASS[0m in 0.04s]
[0m17:40:22.587813 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:40:22.587813 [info ] [Thread-4 (]: 20 of 30 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.04s]
[0m17:40:22.591371 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m17:40:22.591371 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:40:22.591371 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:40:22.592599 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:40:22.592599 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:40:22.592599 [info ] [Thread-3 (]: 22 of 30 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m17:40:22.593599 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:40:22.593599 [info ] [Thread-2 (]: 23 of 30 START test unique_fct_referral_referral_id ............................ [RUN]
[0m17:40:22.593599 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m17:40:22.593599 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m17:40:22.594600 [info ] [Thread-4 (]: 24 of 30 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m17:40:22.594600 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m17:40:22.594600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:22.594600 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:40:22.595600 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m17:40:22.595600 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:40:22.598601 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:40:22.598601 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:40:22.598601 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:40:22.600601 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:40:22.602601 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:40:22.603601 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:40:22.603601 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:40:22.604660 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:22.606659 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:40:22.606659 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:40:22.608662 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:40:22.608662 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:40:22.609662 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:40:22.610660 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:40:22.610660 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:40:22.610660 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m17:40:22.611698 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:40:22.612698 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m17:40:22.612698 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:22.612698 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m17:40:22.612698 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:40:22.613698 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m17:40:22.613698 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:22.614697 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m17:40:22.614697 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:40:22.614697 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m17:40:22.614697 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:22.615698 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:40:22.615698 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:40:22.615698 [info ] [Thread-1 (]: 21 of 30 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.04s]
[0m17:40:22.616698 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:22.616698 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.616698 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:40:22.616698 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:40:22.617697 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:40:22.618191 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:22.618191 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:40:22.618191 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:22.619211 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.619211 [info ] [Thread-1 (]: 25 of 30 START test unique_stg_events_event_id ................................. [RUN]
[0m17:40:22.619211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m17:40:22.620212 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:40:22.623214 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:40:22.624216 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m17:40:22.624216 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:40:22.624216 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:40:22.625215 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m17:40:22.625215 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m17:40:22.626215 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m17:40:22.627216 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m17:40:22.627216 [info ] [Thread-2 (]: 23 of 30 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.03s]
[0m17:40:22.628214 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:40:22.628214 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m17:40:22.629214 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m17:40:22.629214 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:40:22.631213 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:40:22.631213 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m17:40:22.631213 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m17:40:22.632215 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:40:22.632215 [info ] [Thread-3 (]: 22 of 30 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.04s]
[0m17:40:22.632215 [info ] [Thread-2 (]: 26 of 30 START test unique_stg_products_product_id ............................. [RUN]
[0m17:40:22.633215 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:40:22.633215 [info ] [Thread-4 (]: 24 of 30 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:40:22.633215 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:40:22.634215 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m17:40:22.634215 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:40:22.634215 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:40:22.634215 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m17:40:22.635215 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:40:22.635215 [info ] [Thread-3 (]: 27 of 30 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m17:40:22.635215 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:40:22.636214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:22.638230 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:40:22.638230 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m17:40:22.639230 [info ] [Thread-4 (]: 28 of 30 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m17:40:22.639230 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:40:22.639230 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m17:40:22.640230 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:40:22.642228 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:40:22.642228 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:40:22.642228 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:40:22.643231 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:40:22.645232 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:40:22.646230 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:40:22.647230 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:22.647230 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:40:22.649232 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:40:22.649232 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:40:22.650231 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:40:22.651232 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:40:22.651232 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:40:22.651232 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m17:40:22.652230 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:22.654228 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m17:40:22.654228 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:40:22.655230 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:40:22.655230 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m17:40:22.655230 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:40:22.656230 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:40:22.656230 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m17:40:22.656230 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m17:40:22.656230 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m17:40:22.657230 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:22.657230 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:22.657230 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:22.657230 [info ] [Thread-1 (]: 25 of 30 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m17:40:22.658230 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:40:22.658230 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:40:22.659230 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:22.659230 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:40:22.659230 [info ] [Thread-1 (]: 29 of 30 START test unique_stg_schools_school_id ............................... [RUN]
[0m17:40:22.659230 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:40:22.659230 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:40:22.660230 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:22.660230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m17:40:22.660230 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:40:22.661230 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m17:40:22.661230 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:40:22.662231 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:22.662231 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m17:40:22.665230 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:40:22.665230 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:40:22.665230 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m17:40:22.666701 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m17:40:22.666701 [info ] [Thread-2 (]: 26 of 30 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m17:40:22.667751 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m17:40:22.667751 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:40:22.668752 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:40:22.668752 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:40:22.668752 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m17:40:22.668752 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:40:22.670751 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:40:22.671751 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m17:40:22.671751 [info ] [Thread-4 (]: 28 of 30 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m17:40:22.671751 [info ] [Thread-2 (]: 30 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m17:40:22.672751 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m17:40:22.672751 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:40:22.673716 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m17:40:22.673716 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m17:40:22.673716 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:40:22.673716 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:40:22.674837 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m17:40:22.674837 [info ] [Thread-3 (]: 27 of 30 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.04s]
[0m17:40:22.676838 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:40:22.677838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:22.677838 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:40:22.678839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.678839 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:40:22.678839 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:40:22.680644 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:40:22.680644 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:22.680644 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:40:22.681745 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m17:40:22.681745 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:22.681745 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.681745 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.682744 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:40:22.682744 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m17:40:22.683745 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224013Z"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:22.683745 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m17:40:22.684743 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m17:40:22.684743 [info ] [Thread-1 (]: 29 of 30 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.02s]
[0m17:40:22.684743 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:40:22.685744 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:40:22.685744 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m17:40:22.686746 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m17:40:22.686746 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m17:40:22.687568 [info ] [Thread-2 (]: 30 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.01s]
[0m17:40:22.687568 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:40:22.688620 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:22.688620 [debug] [MainThread]: On master: BEGIN
[0m17:40:22.688620 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:22.689620 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:22.689620 [debug] [MainThread]: On master: COMMIT
[0m17:40:22.689620 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:22.689620 [debug] [MainThread]: On master: COMMIT
[0m17:40:22.689620 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:22.690619 [debug] [MainThread]: On master: Close
[0m17:40:22.690619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:22.690619 [debug] [MainThread]: Connection 'list_carton_caps_20260203T224013Z_main' was properly closed.
[0m17:40:22.690619 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6' was properly closed.
[0m17:40:22.690619 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m17:40:22.690619 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103' was properly closed.
[0m17:40:22.691619 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d' was properly closed.
[0m17:40:22.691619 [info ] [MainThread]: 
[0m17:40:22.691619 [info ] [MainThread]: Finished running 30 data tests in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m17:40:22.693619 [debug] [MainThread]: Command end result
[0m17:40:22.708620 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:40:22.709619 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:40:22.713619 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\run_results.json
[0m17:40:22.713619 [info ] [MainThread]: 
[0m17:40:22.714620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:22.714620 [info ] [MainThread]: 
[0m17:40:22.714620 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=30
[0m17:40:22.715620 [debug] [MainThread]: Command `dbt test` succeeded at 17:40:22.715620 after 1.13 seconds
[0m17:40:22.715620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC7267B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC6E818B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC65AF260>]}
[0m17:40:22.715620 [debug] [MainThread]: Flushing usage events
[0m17:40:23.019209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:54.304451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020926EA9CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020929BE1B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020929BE1280>]}


============================== 17:47:54.310269 | 7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527 ==============================
[0m17:47:54.310269 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:47:54.310269 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt build --profiles-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps --project-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m17:47:54.463033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092B703A70>]}
[0m17:47:54.505889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092B3229F0>]}
[0m17:47:54.507891 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:47:54.674396 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:47:54.739601 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:47:54.739601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092BA986B0>]}
[0m17:47:55.619897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092BE63D70>]}
[0m17:47:55.677333 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:47:55.679333 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:47:55.704916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092BE9B3E0>]}
[0m17:47:55.704916 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:47:55.707482 [info ] [MainThread]: 
[0m17:47:55.707482 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:47:55.707482 [info ] [MainThread]: 
[0m17:47:55.707482 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:47:55.713046 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T224751Z'
[0m17:47:55.798432 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T224751Z"
[0m17:47:55.799432 [debug] [ThreadPool]: On list_carton_caps_20260203T224751Z: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T224751Z"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"carton_caps_20260203t224751z"'
    
  
  
[0m17:47:55.799432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:55.817559 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m17:47:55.818561 [debug] [ThreadPool]: On list_carton_caps_20260203T224751Z: Close
[0m17:47:55.819541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_carton_caps_20260203T224751Z, now create_carton_caps_20260203T224751Z_main)
[0m17:47:55.819541 [debug] [ThreadPool]: Creating schema "database: "carton_caps_20260203T224751Z"
schema: "main"
"
[0m17:47:55.823523 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T224751Z_main"
[0m17:47:55.823523 [debug] [ThreadPool]: On create_carton_caps_20260203T224751Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_20260203T224751Z_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='carton_caps_20260203t224751z'
        and type='sqlite'
    
  
[0m17:47:55.823523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:55.824530 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:47:55.825497 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T224751Z_main"
[0m17:47:55.825497 [debug] [ThreadPool]: On create_carton_caps_20260203T224751Z_main: BEGIN
[0m17:47:55.825497 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:47:55.825497 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T224751Z_main"
[0m17:47:55.826507 [debug] [ThreadPool]: On create_carton_caps_20260203T224751Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "create_carton_caps_20260203T224751Z_main"} */

    
    
        create schema if not exists "carton_caps_20260203T224751Z"."main"
    
[0m17:47:55.826507 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:47:55.826507 [debug] [ThreadPool]: On create_carton_caps_20260203T224751Z_main: COMMIT
[0m17:47:55.827496 [debug] [ThreadPool]: Using duckdb connection "create_carton_caps_20260203T224751Z_main"
[0m17:47:55.827496 [debug] [ThreadPool]: On create_carton_caps_20260203T224751Z_main: COMMIT
[0m17:47:55.827496 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:47:55.827496 [debug] [ThreadPool]: On create_carton_caps_20260203T224751Z_main: Close
[0m17:47:55.829061 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T224751Z_main'
[0m17:47:55.832567 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T224751Z_main"
[0m17:47:55.832567 [debug] [ThreadPool]: On list_carton_caps_20260203T224751Z_main: BEGIN
[0m17:47:55.832567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:55.832567 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:47:55.832567 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T224751Z_main"
[0m17:47:55.833514 [debug] [ThreadPool]: On list_carton_caps_20260203T224751Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T224751Z_main"} */
select
      'carton_caps_20260203T224751Z' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps_20260203t224751z'
  
[0m17:47:55.841561 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:47:55.842571 [debug] [ThreadPool]: On list_carton_caps_20260203T224751Z_main: ROLLBACK
[0m17:47:55.843562 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_20260203T224751Z_main'
[0m17:47:55.843562 [debug] [ThreadPool]: On list_carton_caps_20260203T224751Z_main: Close
[0m17:47:55.843562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092BEB7860>]}
[0m17:47:55.843562 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:55.844570 [debug] [MainThread]: On master: BEGIN
[0m17:47:55.844570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:55.844570 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:47:55.844570 [debug] [MainThread]: On master: COMMIT
[0m17:47:55.845535 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:55.845535 [debug] [MainThread]: On master: COMMIT
[0m17:47:55.845535 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:47:55.845535 [debug] [MainThread]: On master: Close
[0m17:47:55.847823 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_events
[0m17:47:55.848549 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.stg_products
[0m17:47:55.848549 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.stg_purchases
[0m17:47:55.848549 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.stg_referrals
[0m17:47:55.848549 [info ] [Thread-1 (]: 1 of 44 START sql view model main.stg_events ................................... [RUN]
[0m17:47:55.849567 [info ] [Thread-2 (]: 2 of 44 START sql view model main.stg_products ................................. [RUN]
[0m17:47:55.849912 [info ] [Thread-3 (]: 3 of 44 START sql view model main.stg_purchases ................................ [RUN]
[0m17:47:55.850569 [info ] [Thread-4 (]: 4 of 44 START sql view model main.stg_referrals ................................ [RUN]
[0m17:47:55.850569 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_events'
[0m17:47:55.850569 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_products'
[0m17:47:55.851579 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_purchases'
[0m17:47:55.851579 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_carton_caps.stg_referrals'
[0m17:47:55.851579 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_events
[0m17:47:55.851579 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.stg_products
[0m17:47:55.852563 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.stg_purchases
[0m17:47:55.852563 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.stg_referrals
[0m17:47:55.856847 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_events"
[0m17:47:55.858589 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_products"
[0m17:47:55.859540 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_purchases"
[0m17:47:55.860557 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_referrals"
[0m17:47:55.861599 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_events
[0m17:47:55.879768 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_events"
[0m17:47:55.880768 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.stg_referrals
[0m17:47:55.880768 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.stg_products
[0m17:47:55.883075 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_referrals"
[0m17:47:55.884643 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_products"
[0m17:47:55.885553 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.stg_purchases
[0m17:47:55.885553 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:47:55.887559 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_purchases"
[0m17:47:55.887559 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: BEGIN
[0m17:47:55.887559 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:47:55.888568 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:47:55.888568 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:47:55.889568 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: BEGIN
[0m17:47:55.889568 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:55.889568 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: BEGIN
[0m17:47:55.889568 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:47:55.890569 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:47:55.890569 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:47:55.890569 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:47:55.890569 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: BEGIN
[0m17:47:55.891543 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

  
  create view "carton_caps_20260203T224751Z"."main"."stg_events__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T224751Z"."raw"."events"
)
select
  cast(event_id as integer) as event_id,
  cast(user_id as integer) as user_id,
  cast(event_type as varchar) as event_type,
  cast(event_at as timestamp) as event_at,
  cast(referral_id as integer) as referral_id,
  cast(metadata_json as varchar) as metadata_json
from src
  );

[0m17:47:55.891543 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:47:55.891543 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:47:55.892583 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:47:55.892583 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:47:55.892583 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:47:55.893580 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:47:55.893580 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:55.893580 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

  
  create view "carton_caps_20260203T224751Z"."main"."stg_referrals__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T224751Z"."raw"."referrals"
)
select
  cast(referral_id as integer) as referral_id,
  cast(referrer_user_id as integer) as referrer_user_id,
  lower(cast(referred_email as varchar)) as referred_email,
  cast(referred_user_id as integer) as referred_user_id,
  cast(referral_code as varchar) as referral_code,
  cast(sent_at as timestamp) as sent_at,
  cast(converted_at as timestamp) as converted_at,
  cast(status as varchar) as status
from src
  );

[0m17:47:55.897507 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:47:55.897507 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

  
  create view "carton_caps_20260203T224751Z"."main"."stg_products__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T224751Z"."raw"."products"
)
select
  cast(product_id as integer) as product_id,
  cast(name as varchar) as name,
  cast(category as varchar) as category,
  cast(price as double) as price,
  cast(points_per_dollar as integer) as points_per_dollar,
  cast(created_at as timestamp) as created_at
from src
  );

[0m17:47:55.897507 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:47:55.898515 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */
alter view "carton_caps_20260203T224751Z"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m17:47:55.898871 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:47:55.898871 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

  
  create view "carton_caps_20260203T224751Z"."main"."stg_purchases__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T224751Z"."raw"."purchases"
)
select
  cast(purchase_id as integer) as purchase_id,
  cast(user_id as integer) as user_id,
  cast(product_id as integer) as product_id,
  cast(quantity as integer) as quantity,
  cast(price_paid as double) as price_paid,
  cast(points_earned as integer) as points_earned,
  cast(purchased_at as timestamp) as purchased_at,
  cast(day_of_week as varchar) as day_of_week,
  cast(hour_of_day as integer) as hour_of_day
from src
  );

[0m17:47:55.899578 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:47:55.900552 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:47:55.901538 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:55.902550 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:47:55.903547 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:47:55.903547 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */
alter view "carton_caps_20260203T224751Z"."main"."stg_referrals__dbt_tmp" rename to "stg_referrals"
[0m17:47:55.909534 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m17:47:55.909534 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */
alter view "carton_caps_20260203T224751Z"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m17:47:55.911507 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:47:55.911507 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:47:55.912421 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:47:55.912421 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */
alter view "carton_caps_20260203T224751Z"."main"."stg_purchases__dbt_tmp" rename to "stg_purchases"
[0m17:47:55.912421 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: COMMIT
[0m17:47:55.912421 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:47:55.913570 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m17:47:55.914571 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m17:47:55.914571 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:47:55.914571 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:47:55.915559 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:55.915559 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: COMMIT
[0m17:47:55.915559 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: COMMIT
[0m17:47:55.916539 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m17:47:55.916539 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:47:55.917551 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: COMMIT
[0m17:47:55.919377 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:47:55.922555 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_events"
[0m17:47:55.922555 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_events"} */

      drop view if exists "carton_caps_20260203T224751Z"."main"."stg_events__dbt_backup" cascade
    
[0m17:47:55.922555 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m17:47:55.922555 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:47:55.923546 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:47:55.924543 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_products"
[0m17:47:55.927064 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.stg_referrals"
[0m17:47:55.927064 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:47:55.928544 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.stg_purchases"
[0m17:47:55.928544 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_products"} */

      drop view if exists "carton_caps_20260203T224751Z"."main"."stg_products__dbt_backup" cascade
    
[0m17:47:55.928544 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_referrals"} */

      drop view if exists "carton_caps_20260203T224751Z"."main"."stg_referrals__dbt_backup" cascade
    
[0m17:47:55.930514 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_events: Close
[0m17:47:55.930514 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_purchases"} */

      drop view if exists "carton_caps_20260203T224751Z"."main"."stg_purchases__dbt_backup" cascade
    
[0m17:47:55.930514 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:47:55.931524 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_products: Close
[0m17:47:55.931524 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:47:55.933634 [debug] [Thread-4 (]: On model.dbt_carton_caps.stg_referrals: Close
[0m17:47:55.933634 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:47:55.934645 [debug] [Thread-3 (]: On model.dbt_carton_caps.stg_purchases: Close
[0m17:47:55.935561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092BB49430>]}
[0m17:47:55.935561 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092C0C3F50>]}
[0m17:47:55.935561 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092BF08DD0>]}
[0m17:47:55.936576 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092B702F00>]}
[0m17:47:55.936576 [info ] [Thread-1 (]: 1 of 44 OK created sql view model main.stg_events .............................. [[32mOK[0m in 0.08s]
[0m17:47:55.936576 [info ] [Thread-2 (]: 2 of 44 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.08s]
[0m17:47:55.937575 [info ] [Thread-4 (]: 4 of 44 OK created sql view model main.stg_referrals ........................... [[32mOK[0m in 0.08s]
[0m17:47:55.937575 [info ] [Thread-3 (]: 3 of 44 OK created sql view model main.stg_purchases ........................... [[32mOK[0m in 0.08s]
[0m17:47:55.937575 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_events
[0m17:47:55.938574 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.stg_products
[0m17:47:55.938574 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.stg_referrals
[0m17:47:55.938574 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.stg_purchases
[0m17:47:55.939557 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.stg_schools
[0m17:47:55.939557 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.stg_users
[0m17:47:55.940187 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:47:55.940570 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:47:55.940570 [info ] [Thread-1 (]: 5 of 44 START sql view model main.stg_schools .................................. [RUN]
[0m17:47:55.941576 [info ] [Thread-2 (]: 6 of 44 START sql view model main.stg_users .................................... [RUN]
[0m17:47:55.941576 [info ] [Thread-4 (]: 7 of 44 START test not_null_stg_events_event_id ................................ [RUN]
[0m17:47:55.941576 [info ] [Thread-3 (]: 8 of 44 START test not_null_stg_events_user_id ................................. [RUN]
[0m17:47:55.941576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_events, now model.dbt_carton_caps.stg_schools)
[0m17:47:55.942568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_products, now model.dbt_carton_caps.stg_users)
[0m17:47:55.942568 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_referrals, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m17:47:55.942568 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_purchases, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m17:47:55.943569 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.stg_schools
[0m17:47:55.943569 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.stg_users
[0m17:47:55.943569 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:47:55.943569 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:47:55.945556 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_schools"
[0m17:47:55.947128 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.stg_users"
[0m17:47:55.954066 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:47:55.956564 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:47:55.956564 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.stg_schools
[0m17:47:55.958579 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_schools"
[0m17:47:55.958579 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:47:55.966524 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:47:55.967972 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:47:55.970254 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:47:55.970254 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:47:55.970254 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.stg_users
[0m17:47:55.971255 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: BEGIN
[0m17:47:55.973597 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.stg_users"
[0m17:47:55.974596 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:47:55.974925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:55.974925 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m17:47:55.974925 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:47:55.974925 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:55.976176 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:55.976176 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m17:47:55.976176 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:47:55.977177 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:47:55.977177 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:47:55.977177 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:55.977177 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: BEGIN
[0m17:47:55.978175 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

  
  create view "carton_caps_20260203T224751Z"."main"."stg_schools__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T224751Z"."raw"."schools"
)
select
  cast(school_id as integer) as school_id,
  cast(name as varchar) as name,
  cast(address as varchar) as address,
  cast(city as varchar) as city,
  cast(state as varchar) as state,
  cast(zip_code as varchar) as zip_code,
  cast(created_at as timestamp) as created_at
from src
  );

[0m17:47:55.978175 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:47:55.978175 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:55.978175 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:55.979176 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps_20260203T224751Z"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:55.979605 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:47:55.979605 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:55.979605 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:47:55.979605 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T224751Z"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:55.981952 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:47:55.981952 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:47:55.981952 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:47:55.983119 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */
alter view "carton_caps_20260203T224751Z"."main"."stg_schools__dbt_tmp" rename to "stg_schools"
[0m17:47:55.983119 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

  
  create view "carton_caps_20260203T224751Z"."main"."stg_users__dbt_tmp" as (
    with src as (
  select * from "carton_caps_20260203T224751Z"."raw"."users"
)
select
  cast(user_id as integer) as user_id,
  cast(first_name as varchar) as first_name,
  cast(last_name as varchar) as last_name,
  lower(cast(email as varchar)) as email,
  cast(school_id as integer) as school_id,
  cast(created_at as timestamp) as created_at,
  cast(user_type as varchar) as user_type,
  cast(is_verified as integer) as is_verified,
  cast(device_id as varchar) as device_id,
  cast(marketing_channel as varchar) as marketing_channel
from src
  );

[0m17:47:55.984598 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m17:47:55.984598 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:47:55.985608 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m17:47:55.986576 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:55.986576 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m17:47:55.987590 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m17:47:55.987590 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:47:55.988589 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m17:47:55.988911 [info ] [Thread-4 (]: 7 of 44 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.05s]
[0m17:47:55.988911 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m17:47:55.991067 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:47:55.991067 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:47:55.991602 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:47:55.991602 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m17:47:55.991602 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */
alter view "carton_caps_20260203T224751Z"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:47:55.992633 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: COMMIT
[0m17:47:55.992633 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m17:47:55.992633 [info ] [Thread-3 (]: 8 of 44 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.05s]
[0m17:47:55.993632 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:47:55.993632 [info ] [Thread-4 (]: 9 of 44 START test test_events_in_window ....................................... [RUN]
[0m17:47:55.993632 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:47:55.994633 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m17:47:55.994633 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.test_events_in_window)
[0m17:47:55.995632 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:47:55.995943 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:55.995943 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:47:55.995943 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m17:47:55.995943 [info ] [Thread-3 (]: 10 of 44 START test unique_stg_events_event_id ................................. [RUN]
[0m17:47:55.997591 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.stg_schools"
[0m17:47:55.997591 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: COMMIT
[0m17:47:55.999602 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m17:47:55.999602 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m17:47:55.999602 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_schools"} */

      drop view if exists "carton_caps_20260203T224751Z"."main"."stg_schools__dbt_backup" cascade
    
[0m17:47:56.000604 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:47:56.003557 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:47:56.004567 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:47:56.004567 [debug] [Thread-1 (]: On model.dbt_carton_caps.stg_schools: Close
[0m17:47:56.005567 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m17:47:56.005567 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:47:56.005567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092C3BE600>]}
[0m17:47:56.007565 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m17:47:56.008567 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.stg_users"
[0m17:47:56.008567 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:47:56.009612 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.stg_users"} */

      drop view if exists "carton_caps_20260203T224751Z"."main"."stg_users__dbt_backup" cascade
    
[0m17:47:56.008567 [info ] [Thread-1 (]: 5 of 44 OK created sql view model main.stg_schools ............................. [[32mOK[0m in 0.06s]
[0m17:47:56.010573 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:47:56.011583 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.stg_schools
[0m17:47:56.011583 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:47:56.011583 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.012588 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:47:56.012588 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m17:47:56.013586 [debug] [Thread-2 (]: On model.dbt_carton_caps.stg_users: Close
[0m17:47:56.013586 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:47:56.013586 [info ] [Thread-1 (]: 11 of 44 START test not_null_stg_products_product_id ........................... [RUN]
[0m17:47:56.014613 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:56.014613 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092C413F50>]}
[0m17:47:56.014613 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m17:47:56.014613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_schools, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m17:47:56.015591 [info ] [Thread-2 (]: 6 of 44 OK created sql view model main.stg_users ............................... [[32mOK[0m in 0.07s]
[0m17:47:56.015591 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:56.016586 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.016586 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:47:56.016586 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.stg_users
[0m17:47:56.016586 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:47:56.019522 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:47:56.019522 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:47:56.019522 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:47:56.020531 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps_20260203T224751Z"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m17:47:56.020531 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:47:56.020531 [info ] [Thread-2 (]: 12 of 44 START test unique_stg_products_product_id ............................. [RUN]
[0m17:47:56.021531 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:56.021531 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:47:56.021531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.stg_users, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m17:47:56.023562 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:47:56.023562 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:47:56.028097 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:47:56.028558 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:47:56.028558 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:47:56.029571 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m17:47:56.029571 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:47:56.030844 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:47:56.030844 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m17:47:56.031875 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m17:47:56.033570 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:47:56.033570 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m17:47:56.033570 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m17:47:56.034572 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m17:47:56.034572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:56.034572 [debug] [Thread-4 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m17:47:56.035598 [info ] [Thread-3 (]: 10 of 44 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m17:47:56.035598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.036592 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:47:56.036592 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:47:56.035598 [info ] [Thread-4 (]: 9 of 44 PASS test_events_in_window ............................................. [[32mPASS[0m in 0.04s]
[0m17:47:56.037443 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:47:56.037725 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:47:56.037725 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m17:47:56.037725 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m17:47:56.037725 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T224751Z"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:56.038733 [info ] [Thread-3 (]: 13 of 44 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m17:47:56.038733 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:56.038733 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:47:56.039579 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m17:47:56.039579 [info ] [Thread-4 (]: 14 of 44 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m17:47:56.040596 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.040596 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.040596 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:47:56.040596 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m17:47:56.041581 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m17:47:56.041581 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:47:56.044374 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:47:56.044374 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:47:56.045575 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m17:47:56.045575 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:56.047586 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:47:56.048585 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m17:47:56.048585 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:47:56.049642 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:47:56.050574 [info ] [Thread-1 (]: 11 of 44 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.04s]
[0m17:47:56.051355 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.051355 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:47:56.051355 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:47:56.052601 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m17:47:56.052601 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:47:56.054554 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:47:56.054554 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m17:47:56.055563 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:47:56.054554 [info ] [Thread-1 (]: 15 of 44 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m17:47:56.055563 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m17:47:56.055563 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m17:47:56.056562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m17:47:56.056562 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:47:56.056562 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:56.056562 [info ] [Thread-2 (]: 12 of 44 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.04s]
[0m17:47:56.057578 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:47:56.057578 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m17:47:56.058275 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:47:56.060564 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:47:56.060564 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:47:56.060564 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:56.060564 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:47:56.061520 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:47:56.061520 [info ] [Thread-2 (]: 16 of 44 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m17:47:56.061520 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.062533 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T224751Z"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:56.062533 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m17:47:56.062533 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:47:56.062533 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:47:56.063574 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:47:56.065202 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:47:56.065202 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps_20260203T224751Z"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:56.065581 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.065885 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:47:56.065885 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m17:47:56.065885 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.065885 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:47:56.065885 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m17:47:56.065885 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m17:47:56.065885 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m17:47:56.065885 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m17:47:56.065885 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:47:56.072145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:56.072145 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m17:47:56.074148 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:47:56.074148 [info ] [Thread-3 (]: 13 of 44 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.03s]
[0m17:47:56.074148 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m17:47:56.075148 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:47:56.075148 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:47:56.075148 [info ] [Thread-4 (]: 14 of 44 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.03s]
[0m17:47:56.076148 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:47:56.076148 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:47:56.076148 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:47:56.076148 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:47:56.077149 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:56.077149 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m17:47:56.077149 [info ] [Thread-3 (]: 17 of 44 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m17:47:56.077149 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:47:56.078149 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:56.078149 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m17:47:56.078149 [info ] [Thread-4 (]: 18 of 44 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m17:47:56.079149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.079149 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:47:56.079149 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.080149 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m17:47:56.083148 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:47:56.084148 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m17:47:56.084148 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:47:56.084148 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:47:56.085148 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m17:47:56.085148 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T224751Z"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:56.087566 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:47:56.087566 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m17:47:56.087566 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:47:56.089578 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:47:56.088567 [info ] [Thread-1 (]: 15 of 44 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m17:47:56.090516 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.090516 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:47:56.091527 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:47:56.091527 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:47:56.092548 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m17:47:56.093557 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:47:56.093557 [info ] [Thread-1 (]: 19 of 44 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m17:47:56.094548 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:47:56.094548 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m17:47:56.095559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m17:47:56.095559 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m17:47:56.095559 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m17:47:56.095559 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:47:56.096551 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:56.096551 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:47:56.098549 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:47:56.096551 [info ] [Thread-2 (]: 16 of 44 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.03s]
[0m17:47:56.099906 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m17:47:56.099906 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:47:56.100575 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:47:56.100575 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:56.100575 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:47:56.100575 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:47:56.101587 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:47:56.101587 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T224751Z"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:56.102562 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:47:56.103567 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:47:56.103567 [info ] [Thread-2 (]: 20 of 44 START test not_null_stg_schools_school_id ............................. [RUN]
[0m17:47:56.103567 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:47:56.104532 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m17:47:56.104532 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T224751Z"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:56.104532 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.104532 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:47:56.105561 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:47:56.107567 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:47:56.107567 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m17:47:56.108527 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m17:47:56.109502 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:47:56.109502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:56.109502 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m17:47:56.110520 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m17:47:56.111508 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m17:47:56.111508 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:47:56.111508 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.112495 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m17:47:56.113805 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:47:56.112495 [info ] [Thread-3 (]: 17 of 44 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.03s]
[0m17:47:56.114537 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:47:56.114537 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m17:47:56.114537 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:47:56.114537 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:56.115544 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:47:56.115544 [info ] [Thread-4 (]: 18 of 44 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.04s]
[0m17:47:56.116522 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:47:56.116522 [info ] [Thread-3 (]: 21 of 44 START test unique_stg_schools_school_id ............................... [RUN]
[0m17:47:56.116522 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:47:56.117534 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m17:47:56.117534 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m17:47:56.117534 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:47:56.118535 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:56.118535 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:47:56.118535 [info ] [Thread-4 (]: 22 of 44 START test not_null_stg_users_school_id ............................... [RUN]
[0m17:47:56.118535 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.121543 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:47:56.121543 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m17:47:56.121543 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:47:56.122519 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m17:47:56.122519 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:47:56.123502 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:47:56.123502 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m17:47:56.125503 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:47:56.126495 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:47:56.126495 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T224751Z"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:56.127005 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m17:47:56.128541 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:47:56.129516 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:47:56.128541 [info ] [Thread-1 (]: 19 of 44 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.03s]
[0m17:47:56.131499 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:47:56.131499 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:47:56.131499 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:47:56.132506 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:47:56.132506 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:47:56.133506 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m17:47:56.133506 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m17:47:56.133506 [info ] [Thread-1 (]: 23 of 44 START test not_null_stg_users_user_id ................................. [RUN]
[0m17:47:56.135021 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m17:47:56.135021 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:47:56.135578 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:56.135578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m17:47:56.135578 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m17:47:56.135578 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m17:47:56.136566 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:47:56.136566 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.137577 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:56.136566 [info ] [Thread-2 (]: 20 of 44 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.03s]
[0m17:47:56.139534 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:47:56.139534 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:47:56.140528 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:47:56.140528 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:47:56.140528 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:56.141541 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:47:56.141541 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:47:56.141541 [info ] [Thread-2 (]: 24 of 44 START test unique_stg_users_user_id ................................... [RUN]
[0m17:47:56.142609 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:47:56.142609 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T224751Z"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:56.142609 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m17:47:56.144609 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:47:56.144609 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:47:56.144609 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:47:56.147547 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:47:56.148545 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m17:47:56.148545 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:47:56.148545 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:47:56.149578 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m17:47:56.149578 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m17:47:56.150571 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m17:47:56.150571 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m17:47:56.150571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:56.151584 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:47:56.151584 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m17:47:56.153594 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:47:56.152582 [info ] [Thread-3 (]: 21 of 44 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:47:56.153594 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:47:56.154551 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m17:47:56.154551 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:47:56.154551 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:47:56.155984 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.fct_rewards
[0m17:47:56.155488 [info ] [Thread-4 (]: 22 of 44 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:47:56.156301 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T224751Z"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:56.156301 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:47:56.156301 [info ] [Thread-3 (]: 25 of 44 START sql table model main.fct_rewards ................................ [RUN]
[0m17:47:56.156301 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:47:56.156301 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m17:47:56.156301 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6, now model.dbt_carton_caps.fct_rewards)
[0m17:47:56.156301 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.dim_product
[0m17:47:56.156301 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.156301 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:56.156301 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.fct_rewards
[0m17:47:56.156301 [info ] [Thread-4 (]: 26 of 44 START sql table model main.dim_product ................................ [RUN]
[0m17:47:56.156301 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m17:47:56.162450 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_rewards"
[0m17:47:56.162450 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:47:56.162450 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now model.dbt_carton_caps.dim_product)
[0m17:47:56.163454 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m17:47:56.163454 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:47:56.163454 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.dim_product
[0m17:47:56.164454 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m17:47:56.164454 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:56.164454 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.fct_rewards
[0m17:47:56.166453 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_product"
[0m17:47:56.166453 [info ] [Thread-1 (]: 23 of 44 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m17:47:56.177544 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m17:47:56.177544 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_rewards"
[0m17:47:56.178553 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:47:56.179552 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m17:47:56.179552 [debug] [Thread-1 (]: Began running node model.dbt_carton_caps.fct_referral
[0m17:47:56.179552 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.dim_product
[0m17:47:56.180569 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m17:47:56.180569 [info ] [Thread-1 (]: 27 of 44 START sql table model main.fct_referral ............................... [RUN]
[0m17:47:56.180569 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:47:56.183243 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_product"
[0m17:47:56.183605 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m17:47:56.183927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now model.dbt_carton_caps.fct_referral)
[0m17:47:56.183927 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: BEGIN
[0m17:47:56.183927 [debug] [Thread-1 (]: Began compiling node model.dbt_carton_caps.fct_referral
[0m17:47:56.183927 [info ] [Thread-2 (]: 24 of 44 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.04s]
[0m17:47:56.183927 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:56.183927 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_referral"
[0m17:47:56.187423 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:47:56.187423 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:47:56.187423 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_product: BEGIN
[0m17:47:56.187423 [debug] [Thread-2 (]: Began running node model.dbt_carton_caps.dim_school
[0m17:47:56.187423 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:47:56.187423 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:56.187423 [debug] [Thread-1 (]: Began executing node model.dbt_carton_caps.fct_referral
[0m17:47:56.187423 [info ] [Thread-2 (]: 28 of 44 START sql table model main.dim_school ................................. [RUN]
[0m17:47:56.187423 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:47:56.192534 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_referral"
[0m17:47:56.192534 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b, now model.dbt_carton_caps.dim_school)
[0m17:47:56.192534 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:47:56.193535 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

  
    
    

    create  table
      "carton_caps_20260203T224751Z"."main"."fct_rewards__dbt_tmp"
  
    as (
      with e as (
  select *
  from "carton_caps_20260203T224751Z"."main"."stg_events"
),

awards as (
  select
    referral_id,
    user_id,
    event_at as awarded_at,
    -- reward_type is inside metadata_json like {"reward_type":"referrer_bonus"}
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_awarded'
),

redeems as (
  select
    referral_id,
    user_id,
    event_at as redeemed_at,
    regexp_extract(metadata_json, '"reward_type":"([^"]+)"', 1) as reward_type
  from e
  where event_type = 'reward_redeemed'
)

select
  -- deterministic surrogate key
  md5(cast(a.referral_id as varchar) || '|' || cast(a.user_id as varchar) || '|' || coalesce(a.reward_type,'')) as reward_id,
  a.referral_id,
  a.user_id,
  a.reward_type,
  a.awarded_at,
  min(r.redeemed_at) as redeemed_at
from awards a
left join redeems r
  on a.referral_id = r.referral_id
  and a.user_id = r.user_id
  and coalesce(a.reward_type,'') = coalesce(r.reward_type,'')
group by 1,2,3,4,5
    );
  
  
[0m17:47:56.193535 [debug] [Thread-2 (]: Began compiling node model.dbt_carton_caps.dim_school
[0m17:47:56.193535 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:47:56.195535 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_school"
[0m17:47:56.195535 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:47:56.196534 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

  
    
    

    create  table
      "carton_caps_20260203T224751Z"."main"."dim_product__dbt_tmp"
  
    as (
      select
  product_id,
  name,
  category,
  price,
  points_per_dollar,
  created_at
from "carton_caps_20260203T224751Z"."main"."stg_products"
    );
  
  
[0m17:47:56.196534 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: BEGIN
[0m17:47:56.196534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:56.197535 [debug] [Thread-2 (]: Began executing node model.dbt_carton_caps.dim_school
[0m17:47:56.197535 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.201638 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_school"
[0m17:47:56.201638 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:47:56.201638 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m17:47:56.201638 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:47:56.203638 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:47:56.205545 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:47:56.205545 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

  
    
    

    create  table
      "carton_caps_20260203T224751Z"."main"."fct_referral__dbt_tmp"
  
    as (
      with r as (
  select *
  from "carton_caps_20260203T224751Z"."main"."stg_referrals"
),

e as (
  select *
  from "carton_caps_20260203T224751Z"."main"."stg_events"
),

-- Referral-related event timestamps for referred users
ref_events as (
  select
    referral_id,
    user_id,

    min(case when event_type = 'install' then event_at end) as install_at,
    min(case when event_type = 'referral_applied' then event_at end) as referral_applied_at,
    min(case when event_type = 'onboarding_complete' then event_at end) as onboarding_completed_at,
    min(case when event_type = 'school_linked' then event_at end) as school_linked_at

  from e
  where referral_id is not null
  group by 1,2
),

-- First scan/purchase time for referred users (proxy for qualifying action)
first_purchase as (
  select
    user_id,
    min(purchased_at) as first_purchase_at
  from "carton_caps_20260203T224751Z"."main"."stg_purchases"
  group by 1
)

select
  r.referral_id,
  r.referrer_user_id,
  r.referred_email,
  r.referred_user_id,
  r.referral_code,
  r.sent_at,
  r.converted_at,
  r.status,

  re.install_at,
  re.referral_applied_at,
  re.onboarding_completed_at,
  re.school_linked_at,

  fp.first_purchase_at,

  -- qualifying action is: first_purchase OR school_linked (whichever happens first)
  least(fp.first_purchase_at, re.school_linked_at) as qualifying_action_at,

  -- window compliance (48 hours) using install -> referral_applied
  case
    when re.install_at is null or re.referral_applied_at is null then null
    when datediff('hour', re.install_at, re.referral_applied_at) <= 48 then true
    else false
  end as within_48h_window,

  -- simple eligibility (rules-compliant posture)
  case
    when r.status <> 'converted' then false
    when re.onboarding_completed_at is null then false
    when least(fp.first_purchase_at, re.school_linked_at) is null then false
    when re.install_at is null or re.referral_applied_at is null then false
    when datediff('hour', re.install_at, re.referral_applied_at) > 48 then false
    else true
  end as eligible_referral

from r
left join ref_events re
  on r.referral_id = re.referral_id
  and r.referred_user_id = re.user_id
left join first_purchase fp
  on r.referred_user_id = fp.user_id
    );
  
  
[0m17:47:56.206555 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */
alter table "carton_caps_20260203T224751Z"."main"."dim_product__dbt_tmp" rename to "dim_product"
[0m17:47:56.206555 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:47:56.206555 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */
alter table "carton_caps_20260203T224751Z"."main"."fct_rewards__dbt_tmp" rename to "fct_rewards"
[0m17:47:56.207571 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: BEGIN
[0m17:47:56.207571 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:47:56.208565 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:56.212183 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m17:47:56.212183 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:47:56.212183 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:47:56.212183 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m17:47:56.212183 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:47:56.212183 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_product: COMMIT
[0m17:47:56.212183 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:47:56.212183 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:47:56.212183 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: COMMIT
[0m17:47:56.212183 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m17:47:56.218005 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

  
    
    

    create  table
      "carton_caps_20260203T224751Z"."main"."dim_school__dbt_tmp"
  
    as (
      select
  school_id,
  name,
  address,
  city,
  state,
  zip_code,
  created_at
from "carton_caps_20260203T224751Z"."main"."stg_schools"
    );
  
  
[0m17:47:56.218624 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:47:56.218624 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */
alter table "carton_caps_20260203T224751Z"."main"."fct_referral__dbt_tmp" rename to "fct_referral"
[0m17:47:56.218624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:47:56.218624 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m17:47:56.218624 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:47:56.218624 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: COMMIT
[0m17:47:56.218624 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:47:56.218624 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_product"
[0m17:47:56.224933 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:47:56.224933 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_product"} */

      drop table if exists "carton_caps_20260203T224751Z"."main"."dim_product__dbt_backup" cascade
    
[0m17:47:56.225805 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:47:56.227310 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m17:47:56.227310 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:47:56.227310 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */
alter table "carton_caps_20260203T224751Z"."main"."dim_school__dbt_tmp" rename to "dim_school"
[0m17:47:56.227310 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_rewards"
[0m17:47:56.227310 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.227310 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_carton_caps.fct_referral"
[0m17:47:56.227310 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_rewards"} */

      drop table if exists "carton_caps_20260203T224751Z"."main"."fct_rewards__dbt_backup" cascade
    
[0m17:47:56.232340 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.231869 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_product: Close
[0m17:47:56.232340 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_referral"} */

      drop table if exists "carton_caps_20260203T224751Z"."main"."fct_referral__dbt_backup" cascade
    
[0m17:47:56.232340 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m17:47:56.232340 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.232340 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092D4EEB10>]}
[0m17:47:56.232340 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:47:56.232340 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_rewards: Close
[0m17:47:56.232340 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.232340 [info ] [Thread-4 (]: 26 of 44 OK created sql table model main.dim_product ........................... [[32mOK[0m in 0.07s]
[0m17:47:56.232340 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: COMMIT
[0m17:47:56.232340 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092B3C29F0>]}
[0m17:47:56.232340 [debug] [Thread-1 (]: On model.dbt_carton_caps.fct_referral: Close
[0m17:47:56.232340 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.dim_product
[0m17:47:56.232340 [info ] [Thread-3 (]: 25 of 44 OK created sql table model main.fct_rewards ........................... [[32mOK[0m in 0.08s]
[0m17:47:56.232340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092D4B4C50>]}
[0m17:47:56.238808 [debug] [Thread-4 (]: Began running node model.dbt_carton_caps.dim_user
[0m17:47:56.239152 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.fct_rewards
[0m17:47:56.239152 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.239152 [info ] [Thread-1 (]: 27 of 44 OK created sql table model main.fct_referral .......................... [[32mOK[0m in 0.05s]
[0m17:47:56.239152 [info ] [Thread-4 (]: 29 of 44 START sql table model main.dim_user ................................... [RUN]
[0m17:47:56.239152 [debug] [Thread-3 (]: Began running node model.dbt_carton_caps.fct_purchase
[0m17:47:56.239152 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_carton_caps.dim_school"
[0m17:47:56.239152 [debug] [Thread-1 (]: Finished running node model.dbt_carton_caps.fct_referral
[0m17:47:56.239152 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_product, now model.dbt_carton_caps.dim_user)
[0m17:47:56.239152 [info ] [Thread-3 (]: 30 of 44 START sql table model main.fct_purchase ............................... [RUN]
[0m17:47:56.239152 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_school"} */

      drop table if exists "carton_caps_20260203T224751Z"."main"."dim_school__dbt_backup" cascade
    
[0m17:47:56.239152 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:47:56.239152 [debug] [Thread-4 (]: Began compiling node model.dbt_carton_caps.dim_user
[0m17:47:56.239152 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_rewards, now model.dbt_carton_caps.fct_purchase)
[0m17:47:56.239152 [info ] [Thread-1 (]: 31 of 44 START test not_null_dim_product_product_id ............................ [RUN]
[0m17:47:56.246139 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_carton_caps.dim_user"
[0m17:47:56.246139 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.246139 [debug] [Thread-3 (]: Began compiling node model.dbt_carton_caps.fct_purchase
[0m17:47:56.246139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_referral, now test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816)
[0m17:47:56.246139 [debug] [Thread-2 (]: On model.dbt_carton_caps.dim_school: Close
[0m17:47:56.246139 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_carton_caps.fct_purchase"
[0m17:47:56.246139 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:47:56.246139 [debug] [Thread-4 (]: Began executing node model.dbt_carton_caps.dim_user
[0m17:47:56.246139 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092D4BD310>]}
[0m17:47:56.253032 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:47:56.253032 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_carton_caps.dim_user"
[0m17:47:56.253032 [info ] [Thread-2 (]: 28 of 44 OK created sql table model main.dim_school ............................ [[32mOK[0m in 0.05s]
[0m17:47:56.253032 [debug] [Thread-3 (]: Began executing node model.dbt_carton_caps.fct_purchase
[0m17:47:56.253032 [debug] [Thread-2 (]: Finished running node model.dbt_carton_caps.dim_school
[0m17:47:56.253032 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_carton_caps.fct_purchase"
[0m17:47:56.253032 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:47:56.259661 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:47:56.259661 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:47:56.259661 [info ] [Thread-2 (]: 32 of 44 START test unique_dim_product_product_id .............................. [RUN]
[0m17:47:56.260638 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_user: BEGIN
[0m17:47:56.260638 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:47:56.260638 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_school, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m17:47:56.260638 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:47:56.260638 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:56.260638 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:47:56.260638 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: BEGIN
[0m17:47:56.260638 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:47:56.260638 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:56.260638 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:47:56.266579 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:47:56.266985 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m17:47:56.266985 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:47:56.266985 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.266985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:56.266985 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:47:56.266985 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

  
    
    

    create  table
      "carton_caps_20260203T224751Z"."main"."dim_user__dbt_tmp"
  
    as (
      select
  u.user_id,
  u.first_name,
  u.last_name,
  u.email,
  u.school_id,
  s.name as school_name,
  s.state as school_state,
  u.created_at,
  u.user_type,
  u.is_verified,
  u.device_id,
  u.marketing_channel
from "carton_caps_20260203T224751Z"."main"."stg_users" u
left join "carton_caps_20260203T224751Z"."main"."stg_schools" s
  on u.school_id = s.school_id
    );
  
  
[0m17:47:56.266985 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:47:56.266985 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:47:56.266985 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:47:56.266985 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

  
    
    

    create  table
      "carton_caps_20260203T224751Z"."main"."fct_purchase__dbt_tmp"
  
    as (
      select
  p.purchase_id,
  p.user_id,
  u.school_id,
  p.product_id,
  pr.category as product_category,
  p.quantity,
  p.price_paid,
  p.points_earned,
  p.purchased_at,
  date_trunc('day', p.purchased_at) as purchase_date,
  p.day_of_week,
  p.hour_of_day
from "carton_caps_20260203T224751Z"."main"."stg_purchases" p
left join "carton_caps_20260203T224751Z"."main"."stg_users" u
  on p.user_id = u.user_id
left join "carton_caps_20260203T224751Z"."main"."stg_products" pr
  on p.product_id = pr.product_id
    );
  
  
[0m17:47:56.266985 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:47:56.266985 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T224751Z"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:56.266985 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:47:56.266985 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m17:47:56.266985 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:56.266985 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.273542 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m17:47:56.273542 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.274546 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:47:56.274546 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:47:56.274546 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:47:56.274546 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:56.274546 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m17:47:56.274546 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:47:56.274546 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:47:56.274546 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */
alter table "carton_caps_20260203T224751Z"."main"."dim_user__dbt_tmp" rename to "dim_user"
[0m17:47:56.274546 [info ] [Thread-1 (]: 31 of 44 PASS not_null_dim_product_product_id .................................. [[32mPASS[0m in 0.03s]
[0m17:47:56.280893 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:47:56.280893 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:47:56.280893 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:47:56.280893 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:47:56.280893 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */
alter table "carton_caps_20260203T224751Z"."main"."fct_purchase__dbt_tmp" rename to "fct_purchase"
[0m17:47:56.280893 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m17:47:56.280893 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:47:56.280893 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m17:47:56.280893 [info ] [Thread-1 (]: 33 of 44 START test not_null_fct_rewards_reward_id ............................. [RUN]
[0m17:47:56.280893 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m17:47:56.280893 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:47:56.280893 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.280893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m17:47:56.280893 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m17:47:56.280893 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_user: COMMIT
[0m17:47:56.287768 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m17:47:56.287768 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:47:56.287768 [info ] [Thread-2 (]: 32 of 44 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.03s]
[0m17:47:56.287768 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:47:56.287768 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:47:56.287768 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:47:56.287768 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:47:56.287768 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: COMMIT
[0m17:47:56.287768 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:47:56.294387 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_carton_caps.dim_user"
[0m17:47:56.294816 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:47:56.294816 [info ] [Thread-2 (]: 34 of 44 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m17:47:56.294816 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_user: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.dim_user"} */

      drop table if exists "carton_caps_20260203T224751Z"."main"."dim_user__dbt_backup" cascade
    
[0m17:47:56.294816 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:47:56.294816 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m17:47:56.294816 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:47:56.294816 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:47:56.294816 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_carton_caps.fct_purchase"
[0m17:47:56.294816 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.301849 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:47:56.301849 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:47:56.301849 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "model.dbt_carton_caps.fct_purchase"} */

      drop table if exists "carton_caps_20260203T224751Z"."main"."fct_purchase__dbt_backup" cascade
    
[0m17:47:56.301849 [debug] [Thread-4 (]: On model.dbt_carton_caps.dim_user: Close
[0m17:47:56.301849 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m17:47:56.301849 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092BD3A2A0>]}
[0m17:47:56.301849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:56.301849 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:47:56.301849 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.301849 [info ] [Thread-4 (]: 29 of 44 OK created sql table model main.dim_user .............................. [[32mOK[0m in 0.06s]
[0m17:47:56.308258 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:47:56.308694 [debug] [Thread-3 (]: On model.dbt_carton_caps.fct_purchase: Close
[0m17:47:56.308694 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:47:56.308694 [debug] [Thread-4 (]: Finished running node model.dbt_carton_caps.dim_user
[0m17:47:56.308694 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc8daa3-7ce6-4ab0-acb2-ee6d1b7bb527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092B733950>]}
[0m17:47:56.308694 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:47:56.308694 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:47:56.308694 [info ] [Thread-3 (]: 30 of 44 OK created sql table model main.fct_purchase .......................... [[32mOK[0m in 0.07s]
[0m17:47:56.308694 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:47:56.308694 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps_20260203T224751Z"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:56.308694 [info ] [Thread-4 (]: 35 of 44 START test not_null_fct_referral_referral_id .......................... [RUN]
[0m17:47:56.308694 [debug] [Thread-3 (]: Finished running node model.dbt_carton_caps.fct_purchase
[0m17:47:56.308694 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m17:47:56.308694 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.dim_user, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m17:47:56.308694 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:47:56.308694 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.308694 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:56.308694 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:47:56.308694 [info ] [Thread-3 (]: 36 of 44 START test unique_fct_referral_referral_id ............................ [RUN]
[0m17:47:56.315655 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m17:47:56.315655 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:47:56.315655 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:47:56.315655 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_carton_caps.fct_purchase, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m17:47:56.315655 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m17:47:56.315655 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:47:56.315655 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:47:56.315655 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m17:47:56.315655 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:56.315655 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:47:56.322485 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:47:56.322485 [info ] [Thread-1 (]: 33 of 44 PASS not_null_fct_rewards_reward_id ................................... [[32mPASS[0m in 0.04s]
[0m17:47:56.322485 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:47:56.322485 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:47:56.322485 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.322485 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:47:56.322485 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:47:56.322485 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:47:56.327452 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m17:47:56.327452 [info ] [Thread-1 (]: 37 of 44 START test not_null_dim_school_school_id .............................. [RUN]
[0m17:47:56.329093 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:47:56.329093 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m17:47:56.329093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b)
[0m17:47:56.330099 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m17:47:56.330451 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:56.330451 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:47:56.330451 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m17:47:56.330451 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:47:56.335079 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:47:56.335079 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:47:56.336029 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m17:47:56.335591 [info ] [Thread-2 (]: 34 of 44 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:47:56.336496 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:47:56.336496 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:56.337011 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:47:56.337011 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T224751Z"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:56.337526 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:47:56.338038 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:47:56.339578 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:47:56.339578 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:47:56.340089 [info ] [Thread-2 (]: 38 of 44 START test unique_dim_school_school_id ................................ [RUN]
[0m17:47:56.340089 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.340598 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:47:56.340598 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m17:47:56.341113 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:56.342136 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m17:47:56.342136 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:47:56.342652 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:47:56.342993 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m17:47:56.344619 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:47:56.344619 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m17:47:56.344619 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:47:56.344619 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m17:47:56.344619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:56.344619 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m17:47:56.344619 [info ] [Thread-4 (]: 35 of 44 PASS not_null_fct_referral_referral_id ................................ [[32mPASS[0m in 0.04s]
[0m17:47:56.344619 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.344619 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m17:47:56.344619 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:47:56.344619 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:47:56.349915 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:47:56.350531 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m17:47:56.350531 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:47:56.350531 [debug] [Thread-4 (]: Began running node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:47:56.350531 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T224751Z"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:56.350531 [info ] [Thread-3 (]: 36 of 44 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.03s]
[0m17:47:56.350531 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now exposure.dbt_carton_caps.streamlit_referral_finance_dashboard)
[0m17:47:56.350531 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:47:56.350531 [debug] [Thread-4 (]: Began compiling node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:47:56.350531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.350531 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:47:56.350531 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:47:56.350531 [debug] [Thread-4 (]: Began executing node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:47:56.350531 [info ] [Thread-3 (]: 40 of 44 START test not_null_dim_user_user_id .................................. [RUN]
[0m17:47:56.350531 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m17:47:56.356867 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m17:47:56.356867 [info ] [Thread-4 (]: 39 of 44 NO-OP exposure streamlit_referral_finance_dashboard ................... [[33mNO-OP[0m in 0.00s]
[0m17:47:56.357301 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3)
[0m17:47:56.357301 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:47:56.357301 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:56.357301 [debug] [Thread-4 (]: Finished running node exposure.dbt_carton_caps.streamlit_referral_finance_dashboard
[0m17:47:56.357301 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:47:56.357301 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m17:47:56.357301 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:47:56.361464 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:47:56.361464 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:47:56.361464 [info ] [Thread-1 (]: 37 of 44 PASS not_null_dim_school_school_id .................................... [[32mPASS[0m in 0.03s]
[0m17:47:56.361464 [info ] [Thread-4 (]: 41 of 44 START test unique_dim_user_user_id .................................... [RUN]
[0m17:47:56.361464 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:47:56.361464 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:47:56.363798 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly exposure.dbt_carton_caps.streamlit_referral_finance_dashboard, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m17:47:56.364193 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:56.364193 [debug] [Thread-1 (]: Began running node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:47:56.364193 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:47:56.364193 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:47:56.364193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now exposure.dbt_carton_caps.streamlit_product_dashboard)
[0m17:47:56.364193 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:47:56.368890 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:47:56.368890 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:47:56.368890 [debug] [Thread-1 (]: Began compiling node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:47:56.368890 [debug] [Thread-1 (]: Began executing node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:47:56.368890 [info ] [Thread-1 (]: 42 of 44 NO-OP exposure streamlit_product_dashboard ............................ [[33mNO-OP[0m in 0.00s]
[0m17:47:56.370879 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m17:47:56.371723 [debug] [Thread-1 (]: Finished running node exposure.dbt_carton_caps.streamlit_product_dashboard
[0m17:47:56.371723 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:47:56.371723 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:47:56.371723 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m17:47:56.371723 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:47:56.371723 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m17:47:56.371723 [info ] [Thread-1 (]: 43 of 44 START test not_null_fct_purchase_purchase_id .......................... [RUN]
[0m17:47:56.371723 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m17:47:56.371723 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:47:56.371723 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:56.371723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly exposure.dbt_carton_caps.streamlit_product_dashboard, now test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1)
[0m17:47:56.371723 [info ] [Thread-2 (]: 38 of 44 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m17:47:56.371723 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:47:56.371723 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:47:56.371723 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.378150 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:47:56.378150 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:47:56.378150 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:47:56.378150 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:47:56.378150 [info ] [Thread-2 (]: 44 of 44 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m17:47:56.378150 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m17:47:56.378150 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T224751Z"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:56.378150 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m17:47:56.378150 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:47:56.378150 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:56.378150 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:47:56.378150 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:47:56.378150 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.385247 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:47:56.385247 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:47:56.385247 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:47:56.385247 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m17:47:56.385247 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:56.385247 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:47:56.385247 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:47:56.385247 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:47:56.385247 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m17:47:56.385247 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m17:47:56.385247 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.392009 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:47:56.392009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:56.392009 [info ] [Thread-3 (]: 40 of 44 PASS not_null_dim_user_user_id ........................................ [[32mPASS[0m in 0.03s]
[0m17:47:56.392009 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m17:47:56.392009 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:47:56.392009 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.392009 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m17:47:56.392009 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:47:56.392009 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:47:56.392009 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m17:47:56.392009 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m17:47:56.392009 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T224751Z"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:56.392009 [info ] [Thread-4 (]: 41 of 44 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.03s]
[0m17:47:56.398526 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:56.398907 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:47:56.398907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.398907 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.398907 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:47:56.398907 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m17:47:56.398907 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:56.398907 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:47:56.398907 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m17:47:56.398907 [info ] [Thread-1 (]: 43 of 44 PASS not_null_fct_purchase_purchase_id ................................ [[32mPASS[0m in 0.03s]
[0m17:47:56.398907 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:47:56.398907 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.398907 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m17:47:56.398907 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m17:47:56.398907 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m17:47:56.405508 [info ] [Thread-2 (]: 44 of 44 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.03s]
[0m17:47:56.405904 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:47:56.405904 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:56.405904 [debug] [MainThread]: On master: BEGIN
[0m17:47:56.405904 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:56.405904 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:47:56.405904 [debug] [MainThread]: On master: COMMIT
[0m17:47:56.405904 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:56.405904 [debug] [MainThread]: On master: COMMIT
[0m17:47:56.405904 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:47:56.405904 [debug] [MainThread]: On master: Close
[0m17:47:56.405904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:56.405904 [debug] [MainThread]: Connection 'create_carton_caps_20260203T224751Z_main' was properly closed.
[0m17:47:56.405904 [debug] [MainThread]: Connection 'list_carton_caps_20260203T224751Z_main' was properly closed.
[0m17:47:56.405904 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1' was properly closed.
[0m17:47:56.405904 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a' was properly closed.
[0m17:47:56.405904 [debug] [MainThread]: Connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3' was properly closed.
[0m17:47:56.405904 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278' was properly closed.
[0m17:47:56.405904 [info ] [MainThread]: 
[0m17:47:56.405904 [info ] [MainThread]: Finished running 2 exposures, 6 table models, 30 data tests, 6 view models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m17:47:56.412795 [debug] [MainThread]: Command end result
[0m17:47:56.434433 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:47:56.437407 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:47:56.442315 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\run_results.json
[0m17:47:56.443289 [info ] [MainThread]: 
[0m17:47:56.443289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:47:56.443289 [info ] [MainThread]: 
[0m17:47:56.443289 [info ] [MainThread]: Done. PASS=42 WARN=0 ERROR=0 SKIP=0 NO-OP=2 TOTAL=44
[0m17:47:56.444290 [debug] [MainThread]: Command `dbt build` succeeded at 17:47:56.444290 after 2.22 seconds
[0m17:47:56.444290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209273CE5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209273CE930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020929F06B40>]}
[0m17:47:56.444290 [debug] [MainThread]: Flushing usage events
[0m17:47:56.871742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:58.386627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27A036060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27CBE9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27C6B9520>]}


============================== 17:47:58.390438 | 45fb0bdb-fd25-4e7c-8a7c-0177cd5804d3 ==============================
[0m17:47:58.390438 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:47:58.390438 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'invocation_command': 'dbt test --profiles-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps --project-dir C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\repos\\livefront\\carton_caps_analytics\\dbt_carton_caps\\logs'}
[0m17:47:58.530545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45fb0bdb-fd25-4e7c-8a7c-0177cd5804d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27D3E13A0>]}
[0m17:47:58.567545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45fb0bdb-fd25-4e7c-8a7c-0177cd5804d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27D2DA510>]}
[0m17:47:58.569551 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:47:58.715833 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:47:58.822181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:47:58.822181 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:47:58.822181 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:47:58.855003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45fb0bdb-fd25-4e7c-8a7c-0177cd5804d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27E4B1C40>]}
[0m17:47:58.909011 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:47:58.909011 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:47:58.936180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45fb0bdb-fd25-4e7c-8a7c-0177cd5804d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27ED46E10>]}
[0m17:47:58.936180 [info ] [MainThread]: Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m17:47:58.936180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45fb0bdb-fd25-4e7c-8a7c-0177cd5804d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27E985F40>]}
[0m17:47:58.936180 [info ] [MainThread]: 
[0m17:47:58.936180 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:47:58.936180 [info ] [MainThread]: 
[0m17:47:58.936180 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:47:58.945602 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_carton_caps_20260203T224751Z_main'
[0m17:47:58.982730 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T224751Z_main"
[0m17:47:58.982730 [debug] [ThreadPool]: On list_carton_caps_20260203T224751Z_main: BEGIN
[0m17:47:58.982730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:58.998468 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m17:47:58.998468 [debug] [ThreadPool]: Using duckdb connection "list_carton_caps_20260203T224751Z_main"
[0m17:47:58.998468 [debug] [ThreadPool]: On list_carton_caps_20260203T224751Z_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "connection_name": "list_carton_caps_20260203T224751Z_main"} */
select
      'carton_caps_20260203T224751Z' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'carton_caps_20260203t224751z'
  
[0m17:47:59.017064 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:47:59.023758 [debug] [ThreadPool]: On list_carton_caps_20260203T224751Z_main: ROLLBACK
[0m17:47:59.023758 [debug] [ThreadPool]: Failed to rollback 'list_carton_caps_20260203T224751Z_main'
[0m17:47:59.023758 [debug] [ThreadPool]: On list_carton_caps_20260203T224751Z_main: Close
[0m17:47:59.025772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45fb0bdb-fd25-4e7c-8a7c-0177cd5804d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27E947F50>]}
[0m17:47:59.025772 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:59.025772 [debug] [MainThread]: On master: BEGIN
[0m17:47:59.025772 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:59.025772 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:47:59.025772 [debug] [MainThread]: On master: COMMIT
[0m17:47:59.025772 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:59.025772 [debug] [MainThread]: On master: COMMIT
[0m17:47:59.025772 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:47:59.025772 [debug] [MainThread]: On master: Close
[0m17:47:59.030969 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:47:59.030969 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:47:59.030969 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:47:59.030969 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:47:59.030969 [info ] [Thread-1 (]: 1 of 30 START test not_null_dim_product_product_id ............................. [RUN]
[0m17:47:59.030969 [info ] [Thread-2 (]: 2 of 30 START test not_null_dim_school_school_id ............................... [RUN]
[0m17:47:59.030969 [info ] [Thread-3 (]: 3 of 30 START test not_null_dim_user_user_id ................................... [RUN]
[0m17:47:59.030969 [info ] [Thread-4 (]: 4 of 30 START test not_null_fct_purchase_purchase_id ........................... [RUN]
[0m17:47:59.030969 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:47:59.030969 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:47:59.030969 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:47:59.030969 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:47:59.030969 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:47:59.030969 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:47:59.030969 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:47:59.030969 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:47:59.030969 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:47:59.046374 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:47:59.046374 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:47:59.051392 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:47:59.051392 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:47:59.051392 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:47:59.051392 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:47:59.062265 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:47:59.051392 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:47:59.062265 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:47:59.062265 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:47:59.062265 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:47:59.062265 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:47:59.062265 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m17:47:59.062265 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:47:59.062265 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:47:59.062265 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:47:59.062265 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: BEGIN
[0m17:47:59.062265 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.062265 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:47:59.062265 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: BEGIN
[0m17:47:59.062265 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:47:59.062265 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"
[0m17:47:59.062265 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m17:47:59.062265 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:47:59.062265 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T224751Z"."main"."dim_product"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.062265 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:47:59.062265 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.062265 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.062265 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"
[0m17:47:59.062265 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.062265 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.062265 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"
[0m17:47:59.062265 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T224751Z"."main"."fct_purchase"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.062265 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"
[0m17:47:59.062265 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T224751Z"."main"."dim_school"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.074124 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m17:47:59.074124 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T224751Z"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.074124 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:47:59.074124 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816'
[0m17:47:59.074124 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.074124 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816: Close
[0m17:47:59.078045 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: ROLLBACK
[0m17:47:59.078674 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.078674 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: ROLLBACK
[0m17:47:59.079680 [info ] [Thread-1 (]: 1 of 30 PASS not_null_dim_product_product_id ................................... [[32mPASS[0m in 0.05s]
[0m17:47:59.079680 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b'
[0m17:47:59.080678 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m17:47:59.081678 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1'
[0m17:47:59.081678 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816
[0m17:47:59.081678 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b: Close
[0m17:47:59.082678 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3'
[0m17:47:59.082678 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1: Close
[0m17:47:59.082678 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:47:59.083678 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3: Close
[0m17:47:59.082678 [info ] [Thread-2 (]: 2 of 30 PASS not_null_dim_school_school_id ..................................... [[32mPASS[0m in 0.05s]
[0m17:47:59.083678 [info ] [Thread-4 (]: 4 of 30 PASS not_null_fct_purchase_purchase_id ................................. [[32mPASS[0m in 0.05s]
[0m17:47:59.083678 [info ] [Thread-1 (]: 5 of 30 START test not_null_fct_referral_referral_id ........................... [RUN]
[0m17:47:59.084678 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b
[0m17:47:59.084678 [info ] [Thread-3 (]: 3 of 30 PASS not_null_dim_user_user_id ......................................... [[32mPASS[0m in 0.05s]
[0m17:47:59.084678 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1
[0m17:47:59.085678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_product_product_id.02b1f06816, now test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf)
[0m17:47:59.085678 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:47:59.085678 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3
[0m17:47:59.085678 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:47:59.086678 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:47:59.086678 [info ] [Thread-2 (]: 6 of 30 START test not_null_fct_rewards_reward_id .............................. [RUN]
[0m17:47:59.086678 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:47:59.086678 [info ] [Thread-4 (]: 7 of 30 START test not_null_stg_events_event_id ................................ [RUN]
[0m17:47:59.086678 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:47:59.086678 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_school_school_id.36d55ce30b, now test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea)
[0m17:47:59.086678 [info ] [Thread-3 (]: 8 of 30 START test not_null_stg_events_user_id ................................. [RUN]
[0m17:47:59.086678 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_purchase_purchase_id.bff49e3ee1, now test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012)
[0m17:47:59.086678 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:47:59.086678 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_dim_user_user_id.4b202b08a3, now test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4)
[0m17:47:59.086678 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:47:59.086678 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:47:59.094100 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:47:59.094100 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:47:59.096100 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:47:59.098097 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:47:59.099940 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:47:59.100963 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:47:59.103007 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:47:59.103007 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:47:59.131401 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:47:59.131401 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: BEGIN
[0m17:47:59.131401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:59.131401 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:47:59.131401 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.131401 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:47:59.131401 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:47:59.131401 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"
[0m17:47:59.131401 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: BEGIN
[0m17:47:59.131401 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:47:59.131401 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T224751Z"."main"."fct_referral"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.131401 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:47:59.131401 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:59.131401 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:47:59.131401 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m17:47:59.138855 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: BEGIN
[0m17:47:59.138855 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.138855 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.138855 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:59.138855 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:59.138855 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"
[0m17:47:59.138855 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: ROLLBACK
[0m17:47:59.138855 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.138855 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reward_id
from "carton_caps_20260203T224751Z"."main"."fct_rewards"
where reward_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.138855 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.138855 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf'
[0m17:47:59.138855 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"
[0m17:47:59.138855 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"
[0m17:47:59.138855 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf: Close
[0m17:47:59.138855 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.138855 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "carton_caps_20260203T224751Z"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.138855 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T224751Z"."main"."stg_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.138855 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: ROLLBACK
[0m17:47:59.138855 [info ] [Thread-1 (]: 5 of 30 PASS not_null_fct_referral_referral_id ................................. [[32mPASS[0m in 0.05s]
[0m17:47:59.138855 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea'
[0m17:47:59.138855 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.138855 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.138855 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf
[0m17:47:59.138855 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea: Close
[0m17:47:59.138855 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: ROLLBACK
[0m17:47:59.138855 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m17:47:59.138855 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:47:59.138855 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4'
[0m17:47:59.138855 [info ] [Thread-2 (]: 6 of 30 PASS not_null_fct_rewards_reward_id .................................... [[32mPASS[0m in 0.05s]
[0m17:47:59.138855 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012'
[0m17:47:59.138855 [info ] [Thread-1 (]: 9 of 30 START test not_null_stg_products_product_id ............................ [RUN]
[0m17:47:59.138855 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4: Close
[0m17:47:59.138855 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea
[0m17:47:59.138855 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012: Close
[0m17:47:59.138855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_referral_referral_id.6c6049bbbf, now test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3)
[0m17:47:59.138855 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:47:59.138855 [info ] [Thread-3 (]: 8 of 30 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.05s]
[0m17:47:59.138855 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:47:59.138855 [info ] [Thread-4 (]: 7 of 30 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.05s]
[0m17:47:59.138855 [info ] [Thread-2 (]: 10 of 30 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m17:47:59.138855 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4
[0m17:47:59.154649 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:47:59.154649 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012
[0m17:47:59.154649 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_fct_rewards_reward_id.c9e984e1ea, now test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e)
[0m17:47:59.154649 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:47:59.154649 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:47:59.154649 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:47:59.154649 [info ] [Thread-3 (]: 11 of 30 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m17:47:59.154649 [info ] [Thread-4 (]: 12 of 30 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m17:47:59.154649 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:47:59.154649 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:47:59.154649 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_user_id.63ec98fbc4, now test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009)
[0m17:47:59.154649 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_events_event_id.715b3f7012, now test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85)
[0m17:47:59.154649 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:47:59.154649 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:47:59.154649 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:47:59.163687 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:47:59.163687 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:47:59.163687 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:47:59.163687 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:47:59.163687 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:47:59.163687 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:47:59.163687 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m17:47:59.163687 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:47:59.163687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:59.163687 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:47:59.170655 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: BEGIN
[0m17:47:59.170655 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:47:59.170655 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:59.170655 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.170655 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:47:59.170655 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:47:59.170655 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"
[0m17:47:59.170655 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.170655 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: BEGIN
[0m17:47:59.170655 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T224751Z"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.170655 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"
[0m17:47:59.170655 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:59.170655 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:47:59.170655 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "carton_caps_20260203T224751Z"."main"."stg_purchases"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.170655 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: BEGIN
[0m17:47:59.170655 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.170655 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.170655 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:59.170655 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.170655 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"
[0m17:47:59.170655 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m17:47:59.170655 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select purchase_id
from "carton_caps_20260203T224751Z"."main"."stg_purchases"
where purchase_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.170655 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: ROLLBACK
[0m17:47:59.170655 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:47:59.170655 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3'
[0m17:47:59.170655 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e'
[0m17:47:59.170655 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"
[0m17:47:59.170655 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3: Close
[0m17:47:59.170655 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.170655 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e: Close
[0m17:47:59.170655 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T224751Z"."main"."stg_purchases"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.170655 [info ] [Thread-1 (]: 9 of 30 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.03s]
[0m17:47:59.170655 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: ROLLBACK
[0m17:47:59.170655 [info ] [Thread-2 (]: 10 of 30 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.02s]
[0m17:47:59.170655 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3
[0m17:47:59.170655 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e
[0m17:47:59.170655 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.170655 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009'
[0m17:47:59.170655 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:47:59.170655 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:47:59.186426 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009: Close
[0m17:47:59.170655 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: ROLLBACK
[0m17:47:59.186426 [info ] [Thread-1 (]: 13 of 30 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m17:47:59.186426 [info ] [Thread-2 (]: 14 of 30 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m17:47:59.186426 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85'
[0m17:47:59.186426 [info ] [Thread-3 (]: 11 of 30 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.03s]
[0m17:47:59.186426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_products_product_id.6373b0acf3, now test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba)
[0m17:47:59.186426 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_product_id.60a3e4ab1e, now test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461)
[0m17:47:59.186426 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85: Close
[0m17:47:59.186426 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009
[0m17:47:59.186426 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:47:59.186426 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:47:59.186426 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:47:59.186426 [info ] [Thread-4 (]: 12 of 30 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.03s]
[0m17:47:59.192199 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:47:59.192199 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:47:59.192199 [info ] [Thread-3 (]: 15 of 30 START test not_null_stg_schools_school_id ............................. [RUN]
[0m17:47:59.192199 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85
[0m17:47:59.192199 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_purchase_id.9f227a0009, now test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2)
[0m17:47:59.192199 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:47:59.192199 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:47:59.192199 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:47:59.192199 [info ] [Thread-4 (]: 16 of 30 START test not_null_stg_users_school_id ............................... [RUN]
[0m17:47:59.192199 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:47:59.192199 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:47:59.192199 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:47:59.192199 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_purchases_user_id.591320ea85, now test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a)
[0m17:47:59.192199 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:47:59.202165 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:47:59.192199 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:47:59.202165 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:47:59.205968 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:47:59.205968 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:47:59.205968 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:47:59.205968 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: BEGIN
[0m17:47:59.205968 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:47:59.205968 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:47:59.205968 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: BEGIN
[0m17:47:59.205968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:59.205968 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: BEGIN
[0m17:47:59.205968 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:47:59.205968 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:59.205968 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:59.205968 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:47:59.205968 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"
[0m17:47:59.205968 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referral_id
from "carton_caps_20260203T224751Z"."main"."stg_referrals"
where referral_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.205968 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.205968 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.205968 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"
[0m17:47:59.205968 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"
[0m17:47:59.205968 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T224751Z"."main"."stg_schools"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.205968 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:47:59.205968 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.205968 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select referrer_user_id
from "carton_caps_20260203T224751Z"."main"."stg_referrals"
where referrer_user_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.205968 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: BEGIN
[0m17:47:59.205968 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: ROLLBACK
[0m17:47:59.205968 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.205968 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:59.205968 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.205968 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba'
[0m17:47:59.205968 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: ROLLBACK
[0m17:47:59.205968 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.205968 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: ROLLBACK
[0m17:47:59.205968 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba: Close
[0m17:47:59.217917 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2'
[0m17:47:59.217917 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"
[0m17:47:59.217917 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461'
[0m17:47:59.217917 [debug] [Thread-3 (]: On test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2: Close
[0m17:47:59.217917 [info ] [Thread-1 (]: 13 of 30 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.03s]
[0m17:47:59.217917 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select school_id
from "carton_caps_20260203T224751Z"."main"."stg_users"
where school_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.217917 [debug] [Thread-2 (]: On test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461: Close
[0m17:47:59.217917 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba
[0m17:47:59.217917 [info ] [Thread-3 (]: 15 of 30 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.03s]
[0m17:47:59.217917 [info ] [Thread-2 (]: 14 of 30 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.03s]
[0m17:47:59.217917 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:47:59.221900 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2
[0m17:47:59.222271 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.222271 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461
[0m17:47:59.222271 [info ] [Thread-1 (]: 17 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m17:47:59.223350 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.test_events_in_window
[0m17:47:59.223350 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: ROLLBACK
[0m17:47:59.224352 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:47:59.224352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referral_id.654c3d3fba, now test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77)
[0m17:47:59.224976 [info ] [Thread-3 (]: 18 of 30 START test test_events_in_window ...................................... [RUN]
[0m17:47:59.224976 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a'
[0m17:47:59.224976 [info ] [Thread-2 (]: 19 of 30 START test unique_dim_product_product_id .............................. [RUN]
[0m17:47:59.226012 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:47:59.226012 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_schools_school_id.cf538b72f2, now test.dbt_carton_caps.test_events_in_window)
[0m17:47:59.226012 [debug] [Thread-4 (]: On test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a: Close
[0m17:47:59.226012 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_referrals_referrer_user_id.8ae0b5e461, now test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe)
[0m17:47:59.228014 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:47:59.228014 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.test_events_in_window
[0m17:47:59.229518 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:47:59.229518 [info ] [Thread-4 (]: 16 of 30 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.04s]
[0m17:47:59.230524 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.test_events_in_window"
[0m17:47:59.231868 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:47:59.231868 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a
[0m17:47:59.231868 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:47:59.231868 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:47:59.231868 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:47:59.231868 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.test_events_in_window
[0m17:47:59.231868 [info ] [Thread-4 (]: 20 of 30 START test unique_dim_school_school_id ................................ [RUN]
[0m17:47:59.231868 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.test_events_in_window"
[0m17:47:59.231868 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_school_id.234e95175a, now test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76)
[0m17:47:59.231868 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:47:59.231868 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:47:59.231868 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:47:59.231868 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:47:59.244314 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:47:59.244314 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:47:59.244314 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m17:47:59.244314 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: BEGIN
[0m17:47:59.244314 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:47:59.244314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:59.244314 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:59.244314 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m17:47:59.244314 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:47:59.247299 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:59.247299 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.247299 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:47:59.247299 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:47:59.247299 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"
[0m17:47:59.247299 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:47:59.247299 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.test_events_in_window"
[0m17:47:59.247299 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "carton_caps_20260203T224751Z"."main"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m17:47:59.247299 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"
[0m17:47:59.247299 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.test_events_in_window"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Sanity check: events that are expected to occur during the analytics window
-- should not fall outside that window.
--
-- We intentionally EXCLUDE 'install' because some users may have created accounts
-- before the analytics window and we still keep those installs for longitudinal context.

with bounds as (
  select
    timestamp '2024-01-01 00:00:00' as start_dt,
    timestamp '2024-06-30 23:59:59' as end_dt
),
scoped as (
  select *
  from "carton_caps_20260203T224751Z"."main"."stg_events"
  where event_type != 'install'
),
out_of_window as (
  select count(*) as cnt
  from scoped, bounds
  where event_at < start_dt or event_at > end_dt
),
total as (
  select count(*) as cnt from scoped
)
select 1
from out_of_window, total
where (out_of_window.cnt * 1.0 / nullif(total.cnt, 0)) > 0.001
  
  
      
    ) dbt_internal_test
[0m17:47:59.247299 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:47:59.247299 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:59.247299 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: BEGIN
[0m17:47:59.247299 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:59.247299 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.247299 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m17:47:59.247299 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.247299 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77'
[0m17:47:59.247299 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:47:59.247299 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"
[0m17:47:59.247299 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:47:59.247299 [debug] [Thread-1 (]: On test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77: Close
[0m17:47:59.247299 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m17:47:59.247299 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."dim_school"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:59.247299 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe'
[0m17:47:59.247299 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: ROLLBACK
[0m17:47:59.247299 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe: Close
[0m17:47:59.247299 [info ] [Thread-1 (]: 17 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.02s]
[0m17:47:59.247299 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.test_events_in_window'
[0m17:47:59.247299 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.247299 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77
[0m17:47:59.247299 [info ] [Thread-2 (]: 19 of 30 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.02s]
[0m17:47:59.247299 [debug] [Thread-3 (]: On test.dbt_carton_caps.test_events_in_window: Close
[0m17:47:59.247299 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: ROLLBACK
[0m17:47:59.247299 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:47:59.247299 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe
[0m17:47:59.247299 [info ] [Thread-3 (]: 18 of 30 PASS test_events_in_window ............................................ [[32mPASS[0m in 0.02s]
[0m17:47:59.247299 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76'
[0m17:47:59.247299 [info ] [Thread-1 (]: 21 of 30 START test unique_dim_user_user_id .................................... [RUN]
[0m17:47:59.263272 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:47:59.263272 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.test_events_in_window
[0m17:47:59.264011 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76: Close
[0m17:47:59.264609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.not_null_stg_users_user_id.980dfc1b77, now test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278)
[0m17:47:59.264609 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:47:59.264609 [info ] [Thread-2 (]: 22 of 30 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m17:47:59.264609 [info ] [Thread-4 (]: 20 of 30 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m17:47:59.264609 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:47:59.264609 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_product_product_id.46495bf7fe, now test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a)
[0m17:47:59.264609 [info ] [Thread-3 (]: 23 of 30 START test unique_fct_referral_referral_id ............................ [RUN]
[0m17:47:59.267481 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76
[0m17:47:59.269508 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:47:59.269508 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:47:59.270510 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.test_events_in_window, now test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302)
[0m17:47:59.270510 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:47:59.272512 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:47:59.272512 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:47:59.273510 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:47:59.273510 [info ] [Thread-4 (]: 24 of 30 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m17:47:59.275629 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:47:59.277625 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:47:59.277625 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_school_school_id.d10cafcd76, now test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292)
[0m17:47:59.277625 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:47:59.278627 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:47:59.279627 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:47:59.283231 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:47:59.283231 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:47:59.283231 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:47:59.284232 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:47:59.285230 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:47:59.285230 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:47:59.285230 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m17:47:59.286231 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: BEGIN
[0m17:47:59.287233 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:47:59.287233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:59.287233 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:59.288531 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:47:59.288531 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: BEGIN
[0m17:47:59.288531 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:59.289531 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.289531 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.289531 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"
[0m17:47:59.289531 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.290531 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"
[0m17:47:59.290531 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:47:59.290531 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:59.290531 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"
[0m17:47:59.291531 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."fct_purchase"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:59.291531 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: BEGIN
[0m17:47:59.291531 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."fct_referral"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:59.291531 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:59.292532 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.293531 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m17:47:59.294390 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278'
[0m17:47:59.294390 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.294390 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:47:59.294390 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278: Close
[0m17:47:59.294390 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:47:59.294390 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: ROLLBACK
[0m17:47:59.294390 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"
[0m17:47:59.294390 [info ] [Thread-1 (]: 21 of 30 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.03s]
[0m17:47:59.294390 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: ROLLBACK
[0m17:47:59.294390 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302'
[0m17:47:59.294390 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reward_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."fct_rewards"
where reward_id is not null
group by reward_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:59.294390 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278
[0m17:47:59.294390 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a'
[0m17:47:59.294390 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302: Close
[0m17:47:59.294390 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:47:59.294390 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a: Close
[0m17:47:59.294390 [info ] [Thread-3 (]: 23 of 30 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.02s]
[0m17:47:59.294390 [info ] [Thread-1 (]: 25 of 30 START test unique_stg_events_event_id ................................. [RUN]
[0m17:47:59.294390 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.294390 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302
[0m17:47:59.294390 [info ] [Thread-2 (]: 22 of 30 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.03s]
[0m17:47:59.294390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_dim_user_user_id.eff0a2a278, now test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438)
[0m17:47:59.294390 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:47:59.294390 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: ROLLBACK
[0m17:47:59.294390 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a
[0m17:47:59.294390 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:47:59.294390 [info ] [Thread-3 (]: 26 of 30 START test unique_stg_products_product_id ............................. [RUN]
[0m17:47:59.294390 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292'
[0m17:47:59.294390 [debug] [Thread-2 (]: Began running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:47:59.307752 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:47:59.307752 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_referral_referral_id.6a144d4302, now test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467)
[0m17:47:59.307752 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292: Close
[0m17:47:59.307752 [info ] [Thread-2 (]: 27 of 30 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m17:47:59.307752 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:47:59.309491 [info ] [Thread-4 (]: 24 of 30 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.03s]
[0m17:47:59.309491 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_purchase_purchase_id.c63efe550a, now test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103)
[0m17:47:59.309491 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:47:59.312210 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:47:59.312210 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292
[0m17:47:59.312210 [debug] [Thread-2 (]: Began compiling node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:47:59.312210 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:47:59.312210 [debug] [Thread-4 (]: Began running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:47:59.312210 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:47:59.312210 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:47:59.312210 [info ] [Thread-4 (]: 28 of 30 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m17:47:59.312210 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:47:59.312210 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_fct_rewards_reward_id.b180edc292, now test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d)
[0m17:47:59.312210 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:47:59.312210 [debug] [Thread-4 (]: Began compiling node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:47:59.312210 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: BEGIN
[0m17:47:59.312210 [debug] [Thread-2 (]: Began executing node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:47:59.322093 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:47:59.322093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:59.322093 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:47:59.322093 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:47:59.322093 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: BEGIN
[0m17:47:59.322093 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.322093 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:59.325266 [debug] [Thread-4 (]: Began executing node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:47:59.327149 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"
[0m17:47:59.329652 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:47:59.329652 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:47:59.329652 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:47:59.329652 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:59.329652 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: BEGIN
[0m17:47:59.329652 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"
[0m17:47:59.329652 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:59.332972 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:47:59.332972 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:59.333546 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: BEGIN
[0m17:47:59.333546 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.334135 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:59.334721 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"
[0m17:47:59.335297 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."stg_purchases"
where purchase_id is not null
group by purchase_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:59.335297 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:47:59.335819 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.335819 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:47:59.336334 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"
[0m17:47:59.338557 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m17:47:59.339069 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m17:47:59.339580 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    referral_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."stg_referrals"
where referral_id is not null
group by referral_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:59.339580 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:47:59.340091 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438'
[0m17:47:59.341201 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467'
[0m17:47:59.341201 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438: Close
[0m17:47:59.342242 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: ROLLBACK
[0m17:47:59.342242 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467: Close
[0m17:47:59.342754 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.343268 [info ] [Thread-1 (]: 25 of 30 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.05s]
[0m17:47:59.343782 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103'
[0m17:47:59.343782 [info ] [Thread-3 (]: 26 of 30 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.04s]
[0m17:47:59.344298 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438
[0m17:47:59.344298 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: ROLLBACK
[0m17:47:59.344298 [debug] [Thread-2 (]: On test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103: Close
[0m17:47:59.344298 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467
[0m17:47:59.344298 [debug] [Thread-1 (]: Began running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:47:59.344298 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d'
[0m17:47:59.344298 [debug] [Thread-3 (]: Began running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:47:59.344298 [info ] [Thread-2 (]: 27 of 30 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.03s]
[0m17:47:59.344298 [info ] [Thread-1 (]: 29 of 30 START test unique_stg_schools_school_id ............................... [RUN]
[0m17:47:59.344298 [debug] [Thread-4 (]: On test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d: Close
[0m17:47:59.344298 [info ] [Thread-3 (]: 30 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m17:47:59.344298 [debug] [Thread-2 (]: Finished running node test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103
[0m17:47:59.344298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_events_event_id.66ebb17438, now test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6)
[0m17:47:59.344298 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_carton_caps.unique_stg_products_product_id.7d950a1467, now test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b)
[0m17:47:59.344298 [info ] [Thread-4 (]: 28 of 30 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m17:47:59.344298 [debug] [Thread-1 (]: Began compiling node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:47:59.344298 [debug] [Thread-3 (]: Began compiling node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:47:59.344298 [debug] [Thread-4 (]: Finished running node test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d
[0m17:47:59.351955 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:47:59.351955 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:47:59.351955 [debug] [Thread-1 (]: Began executing node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:47:59.351955 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:47:59.356583 [debug] [Thread-3 (]: Began executing node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:47:59.356583 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:47:59.356583 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:47:59.356583 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: BEGIN
[0m17:47:59.356583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:59.356583 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:47:59.356583 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m17:47:59.356583 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.356583 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:59.356583 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"
[0m17:47:59.356583 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    school_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."stg_schools"
where school_id is not null
group by school_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:59.356583 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.356583 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"
[0m17:47:59.356583 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_carton_caps", "target_name": "dev", "node_id": "test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "carton_caps_20260203T224751Z"."main"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:59.356583 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.356583 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: ROLLBACK
[0m17:47:59.356583 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:47:59.356583 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6'
[0m17:47:59.356583 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m17:47:59.356583 [debug] [Thread-1 (]: On test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6: Close
[0m17:47:59.356583 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b'
[0m17:47:59.356583 [debug] [Thread-3 (]: On test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b: Close
[0m17:47:59.356583 [info ] [Thread-1 (]: 29 of 30 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.01s]
[0m17:47:59.356583 [debug] [Thread-1 (]: Finished running node test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6
[0m17:47:59.356583 [info ] [Thread-3 (]: 30 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.01s]
[0m17:47:59.356583 [debug] [Thread-3 (]: Finished running node test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b
[0m17:47:59.356583 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:59.356583 [debug] [MainThread]: On master: BEGIN
[0m17:47:59.356583 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:59.356583 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:47:59.356583 [debug] [MainThread]: On master: COMMIT
[0m17:47:59.356583 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:59.356583 [debug] [MainThread]: On master: COMMIT
[0m17:47:59.356583 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:47:59.356583 [debug] [MainThread]: On master: Close
[0m17:47:59.356583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:59.356583 [debug] [MainThread]: Connection 'list_carton_caps_20260203T224751Z_main' was properly closed.
[0m17:47:59.356583 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_schools_school_id.c2eeb191c6' was properly closed.
[0m17:47:59.356583 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_purchases_purchase_id.bb42e3e103' was properly closed.
[0m17:47:59.356583 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m17:47:59.356583 [debug] [MainThread]: Connection 'test.dbt_carton_caps.unique_stg_referrals_referral_id.06e315664d' was properly closed.
[0m17:47:59.356583 [info ] [MainThread]: 
[0m17:47:59.356583 [info ] [MainThread]: Finished running 30 data tests in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m17:47:59.356583 [debug] [MainThread]: Command end result
[0m17:47:59.372312 [debug] [MainThread]: Wrote artifact WritableManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\manifest.json
[0m17:47:59.372312 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\semantic_manifest.json
[0m17:47:59.388018 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\repos\livefront\carton_caps_analytics\dbt_carton_caps\target\run_results.json
[0m17:47:59.388018 [info ] [MainThread]: 
[0m17:47:59.388018 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:47:59.388018 [info ] [MainThread]: 
[0m17:47:59.388018 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=30
[0m17:47:59.388018 [debug] [MainThread]: Command `dbt test` succeeded at 17:47:59.388018 after 1.09 seconds
[0m17:47:59.388018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27A036060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27CCBF7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27CCBEFF0>]}
[0m17:47:59.388018 [debug] [MainThread]: Flushing usage events
[0m17:47:59.752995 [debug] [MainThread]: An error was encountered while trying to flush usage events
