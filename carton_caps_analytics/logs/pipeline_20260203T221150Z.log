Pipeline run_id=20260203T221150Z
Using PYTHON=C:\repos\livefront\.venv\Scripts\python.exe
Target DuckDB file=C:\repos\livefront\carton_caps_analytics\duckdb\carton_caps_20260203T221150Z.duckdb

$ C:\repos\livefront\.venv\Scripts\python.exe generator/data_generator.py
C:\repos\livefront\carton_caps_analytics\generator\data_generator.py:775: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
  conn.execute(insert_sql, values)
Generating Carton Caps data...
----------------------------------------
Generating 50 schools...
Saved 50 records to ./data\schools.csv
Generating 1000 users...
Saved 1000 records to ./data\users.csv
Generating 100 products...
Saved 100 records to ./data\products.csv
Generating 1000 referrals (may add new users)...
Saved 1000 records to ./data\referrals.csv
Generating 10000 purchases...
Saved 10151 records to ./data\purchases.csv
Generating events (product + referral lifecycle)...
Saved 27398 records to ./data\events.csv

Saving to SQLite database...
Saved all data to ./data\carton_caps_generated.db
----------------------------------------
Data generation complete!

Artifacts written to ./data/
 - schools.csv, users.csv, products.csv, referrals.csv, purchases.csv, events.csv
 - carton_caps_generated.db

$ C:\repos\livefront\.venv\Scripts\python.exe duckdb/load_raw.py 20260203T221150Z
Using Python interpreter: C:\repos\livefront\.venv\Scripts\python.exe
Writing DuckDB to: C:\repos\livefront\carton_caps_analytics\duckdb\carton_caps_20260203T221150Z.duckdb
events     27398
products   100
purchases  10151
referrals  1000
schools    50
users      1000

Wrote dbt profiles.yml:
dbt_carton_caps:
  target: dev
  outputs:
    dev:
      type: duckdb
      path: C:/repos/livefront/carton_caps_analytics/duckdb/carton_caps_20260203T221150Z.duckdb
      threads: 4


$ dbt build --profiles-dir C:\repos\livefront\carton_caps_analytics\dbt_carton_caps --project-dir C:\repos\livefront\carton_caps_analytics\dbt_carton_caps
[0m22:11:52  Running with dbt=1.11.2
[0m22:11:53  Registered adapter: duckdb=1.10.0
[0m22:11:53  Unable to do partial parsing because profile has changed
[0m22:11:54  Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m22:11:54  
[0m22:11:54  Concurrency: 4 threads (target='dev')
[0m22:11:54  
[0m22:11:54  1 of 44 START sql view model main.stg_events ................................... [RUN]
[0m22:11:54  2 of 44 START sql view model main.stg_products ................................. [RUN]
[0m22:11:54  3 of 44 START sql view model main.stg_purchases ................................ [RUN]
[0m22:11:54  4 of 44 START sql view model main.stg_referrals ................................ [RUN]
[0m22:11:54  1 of 44 OK created sql view model main.stg_events .............................. [[32mOK[0m in 0.08s]
[0m22:11:54  2 of 44 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.08s]
[0m22:11:54  4 of 44 OK created sql view model main.stg_referrals ........................... [[32mOK[0m in 0.08s]
[0m22:11:54  3 of 44 OK created sql view model main.stg_purchases ........................... [[32mOK[0m in 0.09s]
[0m22:11:54  5 of 44 START sql view model main.stg_schools .................................. [RUN]
[0m22:11:54  6 of 44 START sql view model main.stg_users .................................... [RUN]
[0m22:11:54  7 of 44 START test not_null_stg_events_event_id ................................ [RUN]
[0m22:11:54  8 of 44 START test not_null_stg_events_user_id ................................. [RUN]
[0m22:11:54  8 of 44 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.05s]
[0m22:11:54  7 of 44 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.05s]
[0m22:11:54  9 of 44 START test test_events_in_window ....................................... [RUN]
[0m22:11:54  10 of 44 START test unique_stg_events_event_id ................................. [RUN]
[0m22:11:54  5 of 44 OK created sql view model main.stg_schools ............................. [[32mOK[0m in 0.07s]
[0m22:11:54  6 of 44 OK created sql view model main.stg_users ............................... [[32mOK[0m in 0.07s]
[0m22:11:54  11 of 44 START test not_null_stg_products_product_id ........................... [RUN]
[0m22:11:54  12 of 44 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m22:11:54  9 of 44 PASS test_events_in_window ............................................. [[32mPASS[0m in 0.04s]
[0m22:11:54  10 of 44 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m22:11:54  13 of 44 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m22:11:54  14 of 44 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m22:11:54  12 of 44 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.04s]
[0m22:11:54  11 of 44 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.04s]
[0m22:11:54  15 of 44 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m22:11:54  16 of 44 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m22:11:54  14 of 44 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.03s]
[0m22:11:54  13 of 44 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.04s]
[0m22:11:54  17 of 44 START test unique_stg_products_product_id ............................. [RUN]
[0m22:11:54  18 of 44 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m22:11:54  15 of 44 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.03s]
[0m22:11:54  16 of 44 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.04s]
[0m22:11:54  19 of 44 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m22:11:54  20 of 44 START test not_null_stg_schools_school_id ............................. [RUN]
[0m22:11:54  17 of 44 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.04s]
[0m22:11:54  18 of 44 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.04s]
[0m22:11:54  21 of 44 START test unique_stg_schools_school_id ............................... [RUN]
[0m22:11:54  22 of 44 START test not_null_stg_users_school_id ............................... [RUN]
[0m22:11:54  19 of 44 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m22:11:54  20 of 44 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.03s]
[0m22:11:54  23 of 44 START test not_null_stg_users_user_id ................................. [RUN]
[0m22:11:54  24 of 44 START test unique_stg_users_user_id ................................... [RUN]
[0m22:11:54  21 of 44 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.04s]
[0m22:11:54  22 of 44 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.04s]
[0m22:11:54  25 of 44 START sql table model main.fct_rewards ................................ [RUN]
[0m22:11:54  26 of 44 START sql table model main.dim_product ................................ [RUN]
[0m22:11:54  23 of 44 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:11:54  24 of 44 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.05s]
[0m22:11:54  27 of 44 START sql table model main.fct_referral ............................... [RUN]
[0m22:11:54  28 of 44 START sql table model main.dim_school ................................. [RUN]
[0m22:11:54  26 of 44 OK created sql table model main.dim_product ........................... [[32mOK[0m in 0.07s]
[0m22:11:54  25 of 44 OK created sql table model main.fct_rewards ........................... [[32mOK[0m in 0.07s]
[0m22:11:54  29 of 44 START sql table model main.dim_user ................................... [RUN]
[0m22:11:54  30 of 44 START sql table model main.fct_purchase ............................... [RUN]
[0m22:11:54  28 of 44 OK created sql table model main.dim_school ............................ [[32mOK[0m in 0.06s]
[0m22:11:54  31 of 44 START test not_null_dim_product_product_id ............................ [RUN]
[0m22:11:54  27 of 44 OK created sql table model main.fct_referral .......................... [[32mOK[0m in 0.07s]
[0m22:11:54  32 of 44 START test unique_dim_product_product_id .............................. [RUN]
[0m22:11:54  31 of 44 PASS not_null_dim_product_product_id .................................. [[32mPASS[0m in 0.03s]
[0m22:11:54  33 of 44 START test not_null_fct_rewards_reward_id ............................. [RUN]
[0m22:11:54  29 of 44 OK created sql table model main.dim_user .............................. [[32mOK[0m in 0.06s]
[0m22:11:54  30 of 44 OK created sql table model main.fct_purchase .......................... [[32mOK[0m in 0.05s]
[0m22:11:54  32 of 44 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.03s]
[0m22:11:54  34 of 44 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m22:11:54  35 of 44 START test not_null_dim_school_school_id .............................. [RUN]
[0m22:11:54  36 of 44 START test unique_dim_school_school_id ................................ [RUN]
[0m22:11:54  33 of 44 PASS not_null_fct_rewards_reward_id ................................... [[32mPASS[0m in 0.03s]
[0m22:11:54  37 of 44 START test not_null_fct_referral_referral_id .......................... [RUN]
[0m22:11:54  35 of 44 PASS not_null_dim_school_school_id .................................... [[32mPASS[0m in 0.03s]
[0m22:11:54  34 of 44 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.04s]
[0m22:11:54  38 of 44 START test unique_fct_referral_referral_id ............................ [RUN]
[0m22:11:54  36 of 44 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m22:11:54  40 of 44 START test not_null_dim_user_user_id .................................. [RUN]
[0m22:11:54  39 of 44 NO-OP exposure streamlit_referral_finance_dashboard ................... [[33mNO-OP[0m in 0.00s]
[0m22:11:54  41 of 44 START test unique_dim_user_user_id .................................... [RUN]
[0m22:11:54  37 of 44 PASS not_null_fct_referral_referral_id ................................ [[32mPASS[0m in 0.03s]
[0m22:11:54  42 of 44 NO-OP exposure streamlit_product_dashboard ............................ [[33mNO-OP[0m in 0.00s]
[0m22:11:54  38 of 44 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.03s]
[0m22:11:54  43 of 44 START test not_null_fct_purchase_purchase_id .......................... [RUN]
[0m22:11:54  40 of 44 PASS not_null_dim_user_user_id ........................................ [[32mPASS[0m in 0.03s]
[0m22:11:54  44 of 44 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m22:11:54  41 of 44 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.03s]
[0m22:11:55  43 of 44 PASS not_null_fct_purchase_purchase_id ................................ [[32mPASS[0m in 0.02s]
[0m22:11:55  44 of 44 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.02s]
[0m22:11:55  
[0m22:11:55  Finished running 2 exposures, 6 table models, 30 data tests, 6 view models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m22:11:55  
[0m22:11:55  [32mCompleted successfully[0m
[0m22:11:55  
[0m22:11:55  Done. PASS=42 WARN=0 ERROR=0 SKIP=0 NO-OP=2 TOTAL=44

$ dbt test --profiles-dir C:\repos\livefront\carton_caps_analytics\dbt_carton_caps --project-dir C:\repos\livefront\carton_caps_analytics\dbt_carton_caps
[0m22:11:56  Running with dbt=1.11.2
[0m22:11:57  Registered adapter: duckdb=1.10.0
[0m22:11:57  Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m22:11:57  
[0m22:11:57  Concurrency: 4 threads (target='dev')
[0m22:11:57  
[0m22:11:57  1 of 30 START test not_null_dim_product_product_id ............................. [RUN]
[0m22:11:57  2 of 30 START test not_null_dim_school_school_id ............................... [RUN]
[0m22:11:57  3 of 30 START test not_null_dim_user_user_id ................................... [RUN]
[0m22:11:57  4 of 30 START test not_null_fct_purchase_purchase_id ........................... [RUN]
[0m22:11:57  2 of 30 PASS not_null_dim_school_school_id ..................................... [[32mPASS[0m in 0.04s]
[0m22:11:57  4 of 30 PASS not_null_fct_purchase_purchase_id ................................. [[32mPASS[0m in 0.04s]
[0m22:11:57  1 of 30 PASS not_null_dim_product_product_id ................................... [[32mPASS[0m in 0.04s]
[0m22:11:57  3 of 30 PASS not_null_dim_user_user_id ......................................... [[32mPASS[0m in 0.04s]
[0m22:11:57  5 of 30 START test not_null_fct_referral_referral_id ........................... [RUN]
[0m22:11:57  6 of 30 START test not_null_fct_rewards_reward_id .............................. [RUN]
[0m22:11:57  7 of 30 START test not_null_stg_events_event_id ................................ [RUN]
[0m22:11:57  8 of 30 START test not_null_stg_events_user_id ................................. [RUN]
[0m22:11:57  5 of 30 PASS not_null_fct_referral_referral_id ................................. [[32mPASS[0m in 0.07s]
[0m22:11:57  7 of 30 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.07s]
[0m22:11:57  8 of 30 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.07s]
[0m22:11:57  9 of 30 START test not_null_stg_products_product_id ............................ [RUN]
[0m22:11:57  6 of 30 PASS not_null_fct_rewards_reward_id .................................... [[32mPASS[0m in 0.07s]
[0m22:11:57  10 of 30 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m22:11:57  11 of 30 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m22:11:57  12 of 30 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m22:11:57  9 of 30 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.03s]
[0m22:11:57  10 of 30 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.03s]
[0m22:11:57  11 of 30 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.03s]
[0m22:11:57  12 of 30 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.03s]
[0m22:11:57  13 of 30 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m22:11:57  14 of 30 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m22:11:57  15 of 30 START test not_null_stg_schools_school_id ............................. [RUN]
[0m22:11:57  16 of 30 START test not_null_stg_users_school_id ............................... [RUN]
[0m22:11:57  13 of 30 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.02s]
[0m22:11:57  14 of 30 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.03s]
[0m22:11:57  15 of 30 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.03s]
[0m22:11:57  17 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m22:11:57  16 of 30 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m22:11:57  18 of 30 START test test_events_in_window ...................................... [RUN]
[0m22:11:57  19 of 30 START test unique_dim_product_product_id .............................. [RUN]
[0m22:11:57  20 of 30 START test unique_dim_school_school_id ................................ [RUN]
[0m22:11:57  17 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:11:57  19 of 30 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.03s]
[0m22:11:57  18 of 30 PASS test_events_in_window ............................................ [[32mPASS[0m in 0.03s]
[0m22:11:57  21 of 30 START test unique_dim_user_user_id .................................... [RUN]
[0m22:11:57  22 of 30 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m22:11:57  20 of 30 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m22:11:57  23 of 30 START test unique_fct_referral_referral_id ............................ [RUN]
[0m22:11:57  24 of 30 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m22:11:57  21 of 30 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.03s]
[0m22:11:57  23 of 30 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.02s]
[0m22:11:57  22 of 30 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.03s]
[0m22:11:57  25 of 30 START test unique_stg_events_event_id ................................. [RUN]
[0m22:11:57  24 of 30 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.03s]
[0m22:11:57  26 of 30 START test unique_stg_products_product_id ............................. [RUN]
[0m22:11:57  27 of 30 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m22:11:57  28 of 30 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m22:11:57  26 of 30 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m22:11:57  27 of 30 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.03s]
[0m22:11:57  25 of 30 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.05s]
[0m22:11:57  28 of 30 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.02s]
[0m22:11:57  29 of 30 START test unique_stg_schools_school_id ............................... [RUN]
[0m22:11:57  30 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m22:11:57  29 of 30 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.01s]
[0m22:11:57  30 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.00s]
[0m22:11:57  
[0m22:11:57  Finished running 30 data tests in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m22:11:57  
[0m22:11:57  [32mCompleted successfully[0m
[0m22:11:57  
[0m22:11:57  Done. PASS=30 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=30
