Pipeline run_id=20260203T222151Z
Using PYTHON=C:\repos\livefront\.venv\Scripts\python.exe
Target DuckDB file=C:\repos\livefront\carton_caps_analytics\duckdb\carton_caps_20260203T222151Z.duckdb

$ C:\repos\livefront\.venv\Scripts\python.exe generator/data_generator.py
C:\repos\livefront\carton_caps_analytics\generator\data_generator.py:775: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
  conn.execute(insert_sql, values)
Generating Carton Caps data...
----------------------------------------
Generating 50 schools...
Saved 50 records to ./data\schools.csv
Generating 1000 users...
Saved 1000 records to ./data\users.csv
Generating 100 products...
Saved 100 records to ./data\products.csv
Generating 1000 referrals (may add new users)...
Saved 1000 records to ./data\referrals.csv
Generating 10000 purchases...
Saved 10151 records to ./data\purchases.csv
Generating events (product + referral lifecycle)...
Saved 27398 records to ./data\events.csv

Saving to SQLite database...
Saved all data to ./data\carton_caps_generated.db
----------------------------------------
Data generation complete!

Artifacts written to ./data/
 - schools.csv, users.csv, products.csv, referrals.csv, purchases.csv, events.csv
 - carton_caps_generated.db

$ C:\repos\livefront\.venv\Scripts\python.exe duckdb/load_raw.py 20260203T222151Z
Using Python interpreter: C:\repos\livefront\.venv\Scripts\python.exe
Writing DuckDB to: C:\repos\livefront\carton_caps_analytics\duckdb\carton_caps_20260203T222151Z.duckdb
events     27398
products   100
purchases  10151
referrals  1000
schools    50
users      1000

Wrote dbt profiles.yml:
dbt_carton_caps:
  target: dev
  outputs:
    dev:
      type: duckdb
      path: C:/repos/livefront/carton_caps_analytics/duckdb/carton_caps_20260203T222151Z.duckdb
      threads: 4


$ dbt build --profiles-dir C:\repos\livefront\carton_caps_analytics\dbt_carton_caps --project-dir C:\repos\livefront\carton_caps_analytics\dbt_carton_caps
[0m22:21:54  Running with dbt=1.11.2
[0m22:21:54  Registered adapter: duckdb=1.10.0
[0m22:21:54  Unable to do partial parsing because profile has changed
[0m22:21:55  Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m22:21:55  
[0m22:21:55  Concurrency: 4 threads (target='dev')
[0m22:21:55  
[0m22:21:55  1 of 44 START sql view model main.stg_events ................................... [RUN]
[0m22:21:55  2 of 44 START sql view model main.stg_products ................................. [RUN]
[0m22:21:55  3 of 44 START sql view model main.stg_purchases ................................ [RUN]
[0m22:21:55  4 of 44 START sql view model main.stg_referrals ................................ [RUN]
[0m22:21:55  1 of 44 OK created sql view model main.stg_events .............................. [[32mOK[0m in 0.07s]
[0m22:21:55  2 of 44 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.07s]
[0m22:21:55  4 of 44 OK created sql view model main.stg_referrals ........................... [[32mOK[0m in 0.07s]
[0m22:21:55  5 of 44 START sql view model main.stg_schools .................................. [RUN]
[0m22:21:55  3 of 44 OK created sql view model main.stg_purchases ........................... [[32mOK[0m in 0.07s]
[0m22:21:55  6 of 44 START sql view model main.stg_users .................................... [RUN]
[0m22:21:55  7 of 44 START test not_null_stg_events_event_id ................................ [RUN]
[0m22:21:55  8 of 44 START test not_null_stg_events_user_id ................................. [RUN]
[0m22:21:55  8 of 44 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:21:55  9 of 44 START test test_events_in_window ....................................... [RUN]
[0m22:21:55  7 of 44 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.07s]
[0m22:21:55  10 of 44 START test unique_stg_events_event_id ................................. [RUN]
[0m22:21:55  6 of 44 OK created sql view model main.stg_users ............................... [[32mOK[0m in 0.08s]
[0m22:21:55  11 of 44 START test not_null_stg_products_product_id ........................... [RUN]
[0m22:21:55  5 of 44 OK created sql view model main.stg_schools ............................. [[32mOK[0m in 0.09s]
[0m22:21:55  12 of 44 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m22:21:55  9 of 44 PASS test_events_in_window ............................................. [[32mPASS[0m in 0.04s]
[0m22:21:55  13 of 44 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m22:21:55  10 of 44 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m22:21:55  14 of 44 START test unique_stg_products_product_id ............................. [RUN]
[0m22:21:55  11 of 44 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.03s]
[0m22:21:55  15 of 44 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m22:21:55  12 of 44 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.03s]
[0m22:21:55  16 of 44 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m22:21:55  13 of 44 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.03s]
[0m22:21:55  17 of 44 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m22:21:55  14 of 44 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m22:21:55  18 of 44 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m22:21:55  15 of 44 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m22:21:55  19 of 44 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m22:21:55  16 of 44 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.03s]
[0m22:21:55  17 of 44 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.03s]
[0m22:21:55  20 of 44 START test not_null_stg_users_school_id ............................... [RUN]
[0m22:21:55  21 of 44 START test not_null_stg_users_user_id ................................. [RUN]
[0m22:21:55  18 of 44 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.03s]
[0m22:21:55  22 of 44 START test unique_stg_users_user_id ................................... [RUN]
[0m22:21:55  19 of 44 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.04s]
[0m22:21:55  23 of 44 START test not_null_stg_schools_school_id ............................. [RUN]
[0m22:21:55  20 of 44 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m22:21:55  21 of 44 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:21:55  24 of 44 START test unique_stg_schools_school_id ............................... [RUN]
[0m22:21:55  25 of 44 START sql table model main.fct_rewards ................................ [RUN]
[0m22:21:55  22 of 44 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.04s]
[0m22:21:55  26 of 44 START sql table model main.dim_product ................................ [RUN]
[0m22:21:55  23 of 44 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.04s]
[0m22:21:55  27 of 44 START sql table model main.fct_referral ............................... [RUN]
[0m22:21:55  24 of 44 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.04s]
[0m22:21:55  28 of 44 START sql table model main.fct_purchase ............................... [RUN]
[0m22:21:55  25 of 44 OK created sql table model main.fct_rewards ........................... [[32mOK[0m in 0.07s]
[0m22:21:55  29 of 44 START sql table model main.dim_school ................................. [RUN]
[0m22:21:55  26 of 44 OK created sql table model main.dim_product ........................... [[32mOK[0m in 0.06s]
[0m22:21:55  30 of 44 START sql table model main.dim_user ................................... [RUN]
[0m22:21:55  28 of 44 OK created sql table model main.fct_purchase .......................... [[32mOK[0m in 0.06s]
[0m22:21:55  27 of 44 OK created sql table model main.fct_referral .......................... [[32mOK[0m in 0.06s]
[0m22:21:55  31 of 44 START test not_null_fct_rewards_reward_id ............................. [RUN]
[0m22:21:55  32 of 44 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m22:21:55  29 of 44 OK created sql table model main.dim_school ............................ [[32mOK[0m in 0.05s]
[0m22:21:55  31 of 44 PASS not_null_fct_rewards_reward_id ................................... [[32mPASS[0m in 0.03s]
[0m22:21:55  33 of 44 START test not_null_dim_product_product_id ............................ [RUN]
[0m22:21:55  34 of 44 START test unique_dim_product_product_id .............................. [RUN]
[0m22:21:55  32 of 44 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.04s]
[0m22:21:55  35 of 44 START test not_null_fct_purchase_purchase_id .......................... [RUN]
[0m22:21:55  30 of 44 OK created sql table model main.dim_user .............................. [[32mOK[0m in 0.06s]
[0m22:21:55  36 of 44 START test not_null_fct_referral_referral_id .......................... [RUN]
[0m22:21:56  33 of 44 PASS not_null_dim_product_product_id .................................. [[32mPASS[0m in 0.04s]
[0m22:21:56  34 of 44 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.03s]
[0m22:21:56  37 of 44 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m22:21:56  38 of 44 START test unique_fct_referral_referral_id ............................ [RUN]
[0m22:21:56  35 of 44 PASS not_null_fct_purchase_purchase_id ................................ [[32mPASS[0m in 0.03s]
[0m22:21:56  36 of 44 PASS not_null_fct_referral_referral_id ................................ [[32mPASS[0m in 0.03s]
[0m22:21:56  39 of 44 START test not_null_dim_school_school_id .............................. [RUN]
[0m22:21:56  40 of 44 START test unique_dim_school_school_id ................................ [RUN]
[0m22:21:56  38 of 44 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.03s]
[0m22:21:56  37 of 44 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.04s]
[0m22:21:56  41 of 44 NO-OP exposure streamlit_product_dashboard ............................ [[33mNO-OP[0m in 0.00s]
[0m22:21:56  43 of 44 START test not_null_dim_user_user_id .................................. [RUN]
[0m22:21:56  42 of 44 NO-OP exposure streamlit_referral_finance_dashboard ................... [[33mNO-OP[0m in 0.00s]
[0m22:21:56  39 of 44 PASS not_null_dim_school_school_id .................................... [[32mPASS[0m in 0.03s]
[0m22:21:56  40 of 44 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m22:21:56  44 of 44 START test unique_dim_user_user_id .................................... [RUN]
[0m22:21:56  43 of 44 PASS not_null_dim_user_user_id ........................................ [[32mPASS[0m in 0.02s]
[0m22:21:56  44 of 44 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.01s]
[0m22:21:56  
[0m22:21:56  Finished running 2 exposures, 6 table models, 30 data tests, 6 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m22:21:56  
[0m22:21:56  [32mCompleted successfully[0m
[0m22:21:56  
[0m22:21:56  Done. PASS=42 WARN=0 ERROR=0 SKIP=0 NO-OP=2 TOTAL=44

$ dbt test --profiles-dir C:\repos\livefront\carton_caps_analytics\dbt_carton_caps --project-dir C:\repos\livefront\carton_caps_analytics\dbt_carton_caps
[0m22:21:58  Running with dbt=1.11.2
[0m22:21:58  Registered adapter: duckdb=1.10.0
[0m22:21:58  Found 12 models, 30 data tests, 6 sources, 2 exposures, 472 macros
[0m22:21:58  
[0m22:21:58  Concurrency: 4 threads (target='dev')
[0m22:21:58  
[0m22:21:58  1 of 30 START test not_null_dim_product_product_id ............................. [RUN]
[0m22:21:58  2 of 30 START test not_null_dim_school_school_id ............................... [RUN]
[0m22:21:58  3 of 30 START test not_null_dim_user_user_id ................................... [RUN]
[0m22:21:58  4 of 30 START test not_null_fct_purchase_purchase_id ........................... [RUN]
[0m22:21:58  3 of 30 PASS not_null_dim_user_user_id ......................................... [[32mPASS[0m in 0.05s]
[0m22:21:58  2 of 30 PASS not_null_dim_school_school_id ..................................... [[32mPASS[0m in 0.06s]
[0m22:21:58  4 of 30 PASS not_null_fct_purchase_purchase_id ................................. [[32mPASS[0m in 0.06s]
[0m22:21:58  1 of 30 PASS not_null_dim_product_product_id ................................... [[32mPASS[0m in 0.06s]
[0m22:21:58  5 of 30 START test not_null_fct_referral_referral_id ........................... [RUN]
[0m22:21:58  6 of 30 START test not_null_fct_rewards_reward_id .............................. [RUN]
[0m22:21:58  7 of 30 START test not_null_stg_events_event_id ................................ [RUN]
[0m22:21:58  8 of 30 START test not_null_stg_events_user_id ................................. [RUN]
[0m22:21:58  5 of 30 PASS not_null_fct_referral_referral_id ................................. [[32mPASS[0m in 0.06s]
[0m22:21:58  6 of 30 PASS not_null_fct_rewards_reward_id .................................... [[32mPASS[0m in 0.06s]
[0m22:21:58  8 of 30 PASS not_null_stg_events_user_id ....................................... [[32mPASS[0m in 0.06s]
[0m22:21:58  7 of 30 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.06s]
[0m22:21:58  9 of 30 START test not_null_stg_products_product_id ............................ [RUN]
[0m22:21:58  10 of 30 START test not_null_stg_purchases_product_id .......................... [RUN]
[0m22:21:58  11 of 30 START test not_null_stg_purchases_purchase_id ......................... [RUN]
[0m22:21:58  12 of 30 START test not_null_stg_purchases_user_id ............................. [RUN]
[0m22:21:58  9 of 30 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.03s]
[0m22:21:58  10 of 30 PASS not_null_stg_purchases_product_id ................................ [[32mPASS[0m in 0.03s]
[0m22:21:58  12 of 30 PASS not_null_stg_purchases_user_id ................................... [[32mPASS[0m in 0.03s]
[0m22:21:58  11 of 30 PASS not_null_stg_purchases_purchase_id ............................... [[32mPASS[0m in 0.03s]
[0m22:21:58  13 of 30 START test not_null_stg_referrals_referral_id ......................... [RUN]
[0m22:21:58  14 of 30 START test not_null_stg_referrals_referrer_user_id .................... [RUN]
[0m22:21:58  15 of 30 START test not_null_stg_schools_school_id ............................. [RUN]
[0m22:21:58  16 of 30 START test not_null_stg_users_school_id ............................... [RUN]
[0m22:21:58  14 of 30 PASS not_null_stg_referrals_referrer_user_id .......................... [[32mPASS[0m in 0.03s]
[0m22:21:58  13 of 30 PASS not_null_stg_referrals_referral_id ............................... [[32mPASS[0m in 0.03s]
[0m22:21:58  16 of 30 PASS not_null_stg_users_school_id ..................................... [[32mPASS[0m in 0.03s]
[0m22:21:58  15 of 30 PASS not_null_stg_schools_school_id ................................... [[32mPASS[0m in 0.03s]
[0m22:21:58  17 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m22:21:58  18 of 30 START test test_events_in_window ...................................... [RUN]
[0m22:21:58  19 of 30 START test unique_dim_product_product_id .............................. [RUN]
[0m22:21:58  20 of 30 START test unique_dim_school_school_id ................................ [RUN]
[0m22:21:58  17 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:21:58  21 of 30 START test unique_dim_user_user_id .................................... [RUN]
[0m22:21:58  19 of 30 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 0.03s]
[0m22:21:58  18 of 30 PASS test_events_in_window ............................................ [[32mPASS[0m in 0.03s]
[0m22:21:58  20 of 30 PASS unique_dim_school_school_id ...................................... [[32mPASS[0m in 0.03s]
[0m22:21:58  22 of 30 START test unique_fct_purchase_purchase_id ............................ [RUN]
[0m22:21:58  23 of 30 START test unique_fct_referral_referral_id ............................ [RUN]
[0m22:21:58  24 of 30 START test unique_fct_rewards_reward_id ............................... [RUN]
[0m22:21:58  21 of 30 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.03s]
[0m22:21:58  25 of 30 START test unique_stg_events_event_id ................................. [RUN]
[0m22:21:58  23 of 30 PASS unique_fct_referral_referral_id .................................. [[32mPASS[0m in 0.03s]
[0m22:21:58  26 of 30 START test unique_stg_products_product_id ............................. [RUN]
[0m22:21:58  24 of 30 PASS unique_fct_rewards_reward_id ..................................... [[32mPASS[0m in 0.04s]
[0m22:21:58  22 of 30 PASS unique_fct_purchase_purchase_id .................................. [[32mPASS[0m in 0.04s]
[0m22:21:58  27 of 30 START test unique_stg_purchases_purchase_id ........................... [RUN]
[0m22:21:58  28 of 30 START test unique_stg_referrals_referral_id ........................... [RUN]
[0m22:21:59  25 of 30 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.04s]
[0m22:21:59  26 of 30 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m22:21:59  29 of 30 START test unique_stg_schools_school_id ............................... [RUN]
[0m22:21:59  30 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m22:21:59  28 of 30 PASS unique_stg_referrals_referral_id ................................. [[32mPASS[0m in 0.03s]
[0m22:21:59  27 of 30 PASS unique_stg_purchases_purchase_id ................................. [[32mPASS[0m in 0.03s]
[0m22:21:59  29 of 30 PASS unique_stg_schools_school_id ..................................... [[32mPASS[0m in 0.02s]
[0m22:21:59  30 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.02s]
[0m22:21:59  
[0m22:21:59  Finished running 30 data tests in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m22:21:59  
[0m22:21:59  [32mCompleted successfully[0m
[0m22:21:59  
[0m22:21:59  Done. PASS=30 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=30
